<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><div id="myscoll"></div><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>7月笔记 | U7's Blog🍋</title><meta name="keywords" content="月笔记,Scala,Spark,SQL"><meta name="author" content="U7's Blog🍋"><meta name="copyright" content="U7's Blog🍋"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="大数据学习——Scala、hadoop、Spark、SQL">
<meta property="og:type" content="article">
<meta property="og:title" content="7月笔记">
<meta property="og:url" content="https://u7u7.top/posts/33ff80d0.html">
<meta property="og:site_name" content="U7&#39;s Blog🍋">
<meta property="og:description" content="大数据学习——Scala、hadoop、Spark、SQL">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://u7img.oss-cn-hangzhou.aliyuncs.com/202211081127417.webp">
<meta property="article:published_time" content="2023-03-10T14:21:25.000Z">
<meta property="article:modified_time" content="2023-03-10T14:21:25.000Z">
<meta property="article:author" content="U7&#39;s Blog🍋">
<meta property="article:tag" content="月笔记">
<meta property="article:tag" content="Scala">
<meta property="article:tag" content="Spark">
<meta property="article:tag" content="SQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://u7img.oss-cn-hangzhou.aliyuncs.com/202211081127417.webp"><link rel="shortcut icon" href="/"><link rel="canonical" href="https://u7u7.top/posts/33ff80d0"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.js',
      css: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '7月笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-10 22:21:25'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn1.tianli0.top/npm/element-ui@2.15.6/packages/theme-chalk/lib/index.css"><style id="themeColor"></style><style id="rightSide"></style><style id="transPercent"></style><style id="blurNum"></style><style id="settingStyle"></style><span id="fps"></span><style id="defineBg"></style><style id="menu_shadow"></style><svg aria-hidden="true" style="position:absolute; overflow:hidden; width:0; height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="U7's Blog🍋" type="application/atom+xml">
</head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/chengguo.jpg" onerror="onerror=null;src='/assets/r1.jpg'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-home"></use></svg><span class="menu_word" style="font-size:17px"> 首页</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--article"></use></svg><span class="menu_word" style="font-size:17px"> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang1">                   </use></svg><span class="menu_word" style="font-size:17px"> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-sekuaibiaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pinweishenghuo"></use></svg><span class="menu_word" style="font-size:17px"> 休闲</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-yinle">                   </use></svg><span class="menu_word" style="font-size:17px"> 八音盒</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-dianying1">                   </use></svg><span class="menu_word" style="font-size:17px"> 影院</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-youxishoubing">                   </use></svg><span class="menu_word" style="font-size:17px"> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> 八宝箱</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiaozhizuomoban">                   </use></svg><span class="menu_word" style="font-size:17px"> 画廊</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-nvwumao">                   </use></svg><span class="menu_word" style="font-size:17px"> 动画</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> 网址导航</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shejiaoxinxi"></use></svg><span class="menu_word" style="font-size:17px"> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pengyouquan">                   </use></svg><span class="menu_word" style="font-size:17px"> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyan">                   </use></svg><span class="menu_word" style="font-size:17px"> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-lianjie">                   </use></svg><span class="menu_word" style="font-size:17px"> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wangye"></use></svg><span class="menu_word" style="font-size:17px"> 网站</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--tongjibiao">                   </use></svg><span class="menu_word" style="font-size:17px"> 网站统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shujutongji1">                   </use></svg><span class="menu_word" style="font-size:17px"> 文章统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xianxingshalou">                   </use></svg><span class="menu_word" style="font-size:17px"> 旧时光</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-maoliang"></use></svg><span class="menu_word" style="font-size:17px"> 个人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-qunliaotian">                   </use></svg><span class="menu_word" style="font-size:17px"> 唠叨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-paperplane">                   </use></svg><span class="menu_word" style="font-size:17px"> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">U7's Blog🍋</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-home"></use></svg><span class="menu_word" style="font-size:17px"> 首页</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--article"></use></svg><span class="menu_word" style="font-size:17px"> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang1">                   </use></svg><span class="menu_word" style="font-size:17px"> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-sekuaibiaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pinweishenghuo"></use></svg><span class="menu_word" style="font-size:17px"> 休闲</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-yinle">                   </use></svg><span class="menu_word" style="font-size:17px"> 八音盒</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-dianying1">                   </use></svg><span class="menu_word" style="font-size:17px"> 影院</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-youxishoubing">                   </use></svg><span class="menu_word" style="font-size:17px"> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> 八宝箱</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiaozhizuomoban">                   </use></svg><span class="menu_word" style="font-size:17px"> 画廊</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-nvwumao">                   </use></svg><span class="menu_word" style="font-size:17px"> 动画</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> 网址导航</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shejiaoxinxi"></use></svg><span class="menu_word" style="font-size:17px"> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pengyouquan">                   </use></svg><span class="menu_word" style="font-size:17px"> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyan">                   </use></svg><span class="menu_word" style="font-size:17px"> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-lianjie">                   </use></svg><span class="menu_word" style="font-size:17px"> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wangye"></use></svg><span class="menu_word" style="font-size:17px"> 网站</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--tongjibiao">                   </use></svg><span class="menu_word" style="font-size:17px"> 网站统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shujutongji1">                   </use></svg><span class="menu_word" style="font-size:17px"> 文章统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xianxingshalou">                   </use></svg><span class="menu_word" style="font-size:17px"> 旧时光</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-maoliang"></use></svg><span class="menu_word" style="font-size:17px"> 个人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-qunliaotian">                   </use></svg><span class="menu_word" style="font-size:17px"> 唠叨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-paperplane">                   </use></svg><span class="menu_word" style="font-size:17px"> 关于</span></a></li></ul></div></div><center id="name-container"><a id="page-name" href="javascript:scrollToTop()">PAGE_NAME</a></center><div id="nav-right"><div id="search-button"><a class="search faa-parent animated-hover" title="检索站内任何你想要的信息"><svg class="faa-tada icon" style="height:24px;width:24px;fill:currentColor;position:relative;top:6px" aria-hidden="true"><use xlink:href="#icon-valentine_-search-love-find-heart"></use></svg><span> 搜索</span></a></div><a class="meihua faa-parent animated-hover" onclick="toggleWinbox()" title="美化设置-自定义你的风格" id="meihua-button"><svg class="faa-tada icon" style="height:26px;width:26px;fill:currentColor;position:relative;top:8px" aria-hidden="true"><use xlink:href="#icon-tupian1"></use></svg></a><a class="sun_moon faa-parent animated-hover" onclick="switchNightMode()" title="浅色和深色模式转换" id="nightmode-button"><svg class="faa-tada" style="height:25px;width:25px;fill:currentColor;position:relative;top:7px" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon">       </use></svg></a><div id="toggle-menu"><a><i class="fas fa-bars fa-fw"></i></a></div></div></div></nav><div id="post-info"><h1 class="post-title">7月笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><svg class="meta_icon post-meta-icon" style="width:30px;height:30px;position:relative;top:10px"><use xlink:href="#icon-rili"></use></svg><span class="post-meta-label">发表于 </span><time class="post-meta-date-created" datetime="2023-03-10T14:21:25.000Z" title="发表于 2023-03-10 22:21:25">2023-03-10</time><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-gengxin1"></use></svg><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-03-10T14:21:25.000Z" title="更新于 2023-03-10 22:21:25">2023-03-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-biaoqian"></use></svg><a class="post-meta-categories" href="/categories/%E5%B7%A5%E4%BD%9C%E5%AE%A4%E6%9C%88%E7%AC%94%E8%AE%B0/">工作室月笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:8px"><use xlink:href="#icon-charuword"></use></svg><span class="post-meta-label">字数总计:</span><span class="word-count">4.9w</span><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:20px;height:20px;position:relative;top:5px"><use xlink:href="#icon-shizhong"></use></svg><span class="post-meta-label">阅读时长:</span><span>195分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="7月笔记"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:5px"><use xlink:href="#icon-eye"></use></svg><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="7-7-linux入门-基础">7.7 linux入门 基础</h1>
<h2 id="1-头：日期、所学内容出处">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web">https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web</a></p>
<h2 id="2-标题">2.标题</h2>
<p>P1001_课程介绍<br>
P2002_入门篇_Linux概述（一）_Linux的诞生<br>
P3003_入门篇_Linux概述（二）_Unix<br>
P4004_入门篇_Linux概述（三）_Linux和Unix的渊源<br>
P5005_入门篇_Linux概述（四）_GNU-Linux<br>
P6006_入门篇_Linux概述（五）_Linux发行版<br>
P7007_入门篇_Linux概述（六）_Linux vs Windows<br>
P8008_入门篇_Linux安装（一）_CentOS的版本选择和下载<br>
P9009_入门篇_Linux安装（二）_VMware下载安装<br>
P10010_入门篇_Linux安装（三）_创建虚拟机<br>
P11011_入门篇_Linux安装（四）_安装CentOS<br>
P12012_基础篇_桌面和终端基本操作<br>
P13013_基础篇_Linux文件系统（一）_文件系统和挂载点<br>
P14014_基础篇_Linux文件系统（二）_目录结构<br>
P15015_基础篇_VIM编辑器（一）_整体介绍和模式转换<br>
P16016_基础篇_VIM编辑器（二）_普通模式<br>
P17017_基础篇_VIM编辑器（三）_编辑模式<br>
P18018_基础篇_VIM编辑器（四）_命令模式<br>
P19019_基础篇_网络配置（一）_网络连接测试<br>
P20020_基础篇_网络配置（二）_网络连接模式<br>
P21021_基础篇_网络配置（三）_修改静态IP<br>
P22022_基础篇_网络配置（四）_配置主机名<br>
P23023_基础篇_远程登录<br>
P24024_基础篇_系统管理（一）_Linux服务管理<br>
P25025_基础篇_系统管理（二）_系统运行级别<br>
P26026_基础篇_系统管理（三）_配置服务开机启动和关闭防火墙<br>
P27027_基础篇_系统管理（四）_关机重启<br>
P28028_实操篇_Shell命令整体介绍及帮助命令</p>
<h2 id="3-所学内容概述">3.所学内容概述</h2>
<h3 id="Linux-文件与目录结构"><strong>Linux</strong> <strong>文件与目录结构</strong></h3>
<h3 id="VI-VIM-编辑器（重要）"><strong>VI/VIM</strong> <strong>编辑器（重要）</strong></h3>
<h3 id="网络配置"><strong>网络配置</strong></h3>
<h3 id="系统管理">系统管理</h3>
<h2 id="4、根据概述分章节描述">4、根据概述分章节描述</h2>
<h3 id="Linux-文件与目录结构-2"><strong>Linux</strong> <strong>文件与目录结构</strong></h3>
<p>比较总结的一句话，Linux系统中一切皆文件。一些代码</p>
<p>Linux内计算机文件目录如图所示</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220707191931958.png" alt="image-20220707191931958"></p>
<p>注意：<code>带箭头是链接，查看属性可以找到其所指向目录</code></p>
<p>目录结构(树形图)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220707192104440.png" alt="image-20220707192104440"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">常见目录说明</span><br><span class="line">     ①. /bin ：存放常用命令（即二进制可执行程序）</span><br><span class="line"></span><br><span class="line">     ②. /etc ：存放系统配置文件</span><br><span class="line"></span><br><span class="line">     ③. /home ：所有普通用户的家目录</span><br><span class="line"></span><br><span class="line">     ④. /root ：管理员用户的家目录</span><br><span class="line"></span><br><span class="line">     ⑤. /usr ：存放系统应用程序及文档</span><br><span class="line"></span><br><span class="line">     ⑥. /proc ：虚拟文件系统目录，以进程为单位存储内存的映射</span><br><span class="line"></span><br><span class="line">     ⑦. /dev ：存放设备文件</span><br><span class="line"></span><br><span class="line">     ⑧. /mnt ：临时挂载点</span><br><span class="line"></span><br><span class="line">     ⑨. /lib ：存放库文件</span><br><span class="line"></span><br><span class="line">     ⑩. /boot ：系统内核及启动有关的文件</span><br><span class="line"></span><br><span class="line">     ⑪. /tmp ：存放各种临时文件，是所有用户均可访问的地点</span><br><span class="line"></span><br><span class="line">     ⑫. /<span class="keyword">var</span> ：存放系统运行中常改变的文件，如系统日志</span><br></pre></td></tr></table></figure>
<h3 id="VI-VIM-编辑器（重要）-2"><strong>VI/VIM</strong> <strong>编辑器（重要）</strong></h3>
<h4 id="简介">简介</h4>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">VI 是 Unix 操作系统和类 Unix 操作系统中最通用的文本编辑器。 </span><br><span class="line">VIM 编辑器是从 VI 发展出来的一个性能更强大的文本编辑器。可以主动的以字体颜 色辨别语法的正确性，方便程序设计。VIM 与 VI 编辑器完全兼容</span><br></pre></td></tr></table></figure>
<p>VI/VIM编辑器分为三个模式，一般模式，编辑模式和命令模式可以互相转换（默认进入是一般模式）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220707193310385.png" alt="image-20220707193310385"></p>
<h4 id="一般模式">一般模式</h4>
<p>语法，使用指南</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220707193349361.png" alt="image-20220707193349361"></p>
<h4 id="编辑模式">编辑模式</h4>
<p>和windows中的记事本差不多，弥补一般模式中无法编辑文件内容的缺点</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在一般模式中可以进行删除、复制、粘贴等的动作，但是却无法编辑文件内容的！要 等到你按下『<span class="selector-tag">i</span>, <span class="selector-tag">I</span>, o, O, <span class="selector-tag">a</span>, <span class="selector-tag">A</span>』等任何一个字母之后才会进入编辑模式</span><br></pre></td></tr></table></figure>
<p>[ESC]退出编辑模式到一般模式</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220707193840898.png" alt="image-20220707193840898"></p>
<h4 id="指令模式"><strong>指令模式</strong></h4>
<p>在一般模式当中，输入『 : / ?』3个中的任何一个按钮，就可以将光标移动到最底下那 一行</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220707194023022.png" alt="image-20220707194023022"></p>
<h3 id="网络配置-2"><strong>网络配置</strong></h3>
<h4 id="查看网络-IP-和-网关"><strong>查看网络</strong> <strong>IP</strong> <strong>和 网关</strong></h4>
<p>VMware自带虚拟网络编辑器，可以修改和查看IP地址和网关,<code>在虚拟机便签里</code></p>
<h4 id="配置网络ip地址">配置网络ip地址</h4>
<p>查看ip地址(Linux)</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ifconfig</span></span><br></pre></td></tr></table></figure>
<h4 id="修改-IP-地址"><strong>修改</strong> <strong>IP</strong> <strong>地址</strong></h4>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 桌面]#vim <span class="regexp">/etc/</span>sysconfig<span class="regexp">/network-scripts/i</span>fcfg-ens33</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220707200446620.png" alt="image-20220707200446620"></p>
<p>先把自动改成静态的，然后添加ip和网关和DNS，终端输入<strong>执行</strong> <strong>service network restart</strong></p>
<p>然后ping下主机，主机ping下linux，正常即可</p>
<h4 id="修改主机名称">修改主机名称</h4>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@hadoop100</span> 桌面]<span class="meta"># vi /etc/hostname</span></span><br></pre></td></tr></table></figure>
<p>修改完<code>reboot</code>重启</p>
<h4 id="下载了xshell和xfip">下载了xshell和xfip</h4>
<p>远程登录工具</p>
<h3 id="系统管理-2"><strong>系统管理</strong></h3>
<p>系统管理一些基本命令CSDN上面都有</p>
<h4 id="Linux-中的进程和服务"><strong>Linux</strong> <strong>中的进程和服务</strong></h4>
<p>计算机中，一个正在执行的程序或命令，被叫做“进程”（process）。</p>
<p>启动之后一直存在、常驻内存的进程，一般被称作“服务”（service）</p>
<h4 id="systemctl">systemctl</h4>
<p>在centos7中systemctl是很重要的查看命令</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220707202700316.png" alt="image-20220707202700316"></p>
<h4 id="常用关机重启命令如下">常用关机重启命令如下</h4>
<p>这个在后面还是少用，老是说在linux中大多用在服务器上，很少遇到关机的操作。毕竟服务器上跑一个服务是永无止境的，除非特殊情况下，不得已才会关机。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220707201601515.png" alt="image-20220707201601515"></p>
<h2 id="5-总结">5.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>开始学习linux，因为之前学python用过一段时间的ubuntu，都是基于linux系统的，一些基本命令都是互通的，查看ls之类的，上手很快，今天学习内容比较简单，入门篇和基础篇，了解到linux一切皆文件，比较有意思，重点中的难点没有，VI和VIM命令记住的话，重点就搞定了，网络配置花了会时间，最后下午把系统管理中重要的命令自己多敲了几遍，今天学习状态还可以，也没有什么地方卡住很久，没出BUG，把ubuntu换到了18.04。</p>
<h1 id="7-8-实操篇-文件和用户管理">7.8 实操篇 文件和用户管理</h1>
<h2 id="1-头：日期、所学内容出处-2">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web">https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web</a></p>
<h2 id="2-标题-2">2.标题</h2>
<p>P28028_实操篇_Shell命令整体介绍及帮助命令<br>
P29029_实操篇_文件目录类（一）_目录操作命令（一）_查看和切换工作目录<br>
P30030_实操篇_文件目录类（一）_目录操作命令（二）_列出目录内容<br>
P31031_实操篇_文件目录类（一）_目录操作命令（三）_创建和删除目录<br>
P32032_实操篇_文件目录类（二）_文件操作命令（一）_创建文件<br>
P33033_实操篇_文件目录类（二）_文件操作命令（二）_复制文件或文件夹<br>
P34034_实操篇_文件目录类（二）_文件操作命令（三）_删除和移动文件<br>
P35035_实操篇_文件目录类（二）_文件操作命令（四）_查看文件<br>
P36036_实操篇_文件目录类（三）_其它命令（一）_控制台显示和输出重定向<br>
P37037_实操篇_文件目录类（三）_其它命令（二）_监控文件变化<br>
P38038_实操篇_文件目录类（三）_其它命令（三）_软链接<br>
P39039_实操篇_文件目录类（三）_其它命令（四）_查看历史命令<br>
P40040_实操篇_时间日期类<br>
P41041_实操篇_用户权限类（一）_用户管理（一）_添加和查看用户<br>
P42042_实操篇_用户权限类（一）_用户管理（二）_获取root权限和删除用户<br>
P43043_实操篇_用户权限类（二）_用户组管理<br>
P44044_实操篇_用户权限类（三）_文件属性和权限<br>
P45045_实操篇_用户权限类（四）_更改文件权限<br>
P46046_实操篇_用户权限类（五）_综合应用案例<br>
P47047_实操篇_搜索查找类（一）_查找定位文件<br>
P48048_实操篇_搜索查找类（二）_内容过滤查找和管道操作<br>
P49049_实操篇_压缩解压类<br>
P50050_实操篇_磁盘管理类（一）_查看目录占用空间大小<br>
P51051_实操篇_磁盘管理类（二）_查看磁盘使用情况<br>
P52052_实操篇_磁盘管理类（三）_查看设备挂载情况<br>
P53053_实操篇_磁盘管理类（四）_挂载和卸载<br>
P54054_实操篇_磁盘管理类（五）_磁盘分区</p>
<h2 id="3-所学内容概述-2">3.所学内容概述</h2>
<h3 id="帮助命令">帮助命令</h3>
<h3 id="文件目录类">文件目录类</h3>
<h3 id="时间日期类">时间日期类</h3>
<h3 id="用户管理命令">用户管理命令</h3>
<h3 id="用户组管理命令">用户组管理命令</h3>
<h3 id="文件权限类">文件权限类</h3>
<h3 id="搜索查找类">搜索查找类</h3>
<h3 id="压缩和解压类">压缩和解压类</h3>
<h3 id="磁盘查看和分区类">磁盘查看和分区类</h3>
<h3 id="进程管理类">进程管理类</h3>
<h2 id="4、根据概述分章节描述-2">4、根据概述分章节描述</h2>
<h3 id="帮助命令-2">帮助命令</h3>
<p><code>man  help</code></p>
<p>后面跟命令或配置文件 help只能显示内置的而且是全英文</p>
<p>下载了man中文包，推荐自己使用man，相当于自带的一个tools查看</p>
<h3 id="文件目录类-2">文件目录类</h3>
<h4 id="pwd">pwd</h4>
<p>显示当前目录的绝对路径<code>pwd</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220708092158199.png" alt="image-20220708092158199"></p>
<h4 id="ls">ls</h4>
<p><strong>查看目录文件</strong></p>
<p><strong>显示说明</strong></p>
<p><code>每行列出的信息依次是:文件类型与权限 链接数 文件属主 文件属组 文件大小用byte </code></p>
<p><code>来表示 建立或最近修改的时间 名字</code></p>
<p>-a  <strong>全部的文件，连同隐藏档( 开头为 . 的文件) 一起列出来(常用)</strong></p>
<p>-l  <strong>长数据串列出，包含文件的属性与权限等等数据；(常用)等价于“ll”</strong></p>
<p>语法</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ls</span> -<span class="keyword">al</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220708093550842.png" alt="image-20220708093550842"></p>
<h4 id="cd">cd</h4>
<p>切换目录</p>
<h5 id="基本用法">基本用法</h5>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220708093638995.png" alt="image-20220708093638995"></p>
<h4 id="创建-删除-查找文件以及目录">创建 删除 查找文件以及目录</h4>
<h5 id="创建">创建</h5>
<p><code>mkdir 文件夹名</code></p>
<p>特殊用法 -p多级创建目录</p>
<p><code>mkdir -p hello/world/java</code></p>
<h5 id="删除">删除</h5>
<p>只能删除空的目录</p>
<p><code>rmdir 文件夹名</code></p>
<h5 id="创建文件">创建文件</h5>
<p><code>touch 文件名</code>只带文件名默认是文本文件</p>
<p>可加路径 touch 注意:<code>命令后面 直接有/就是绝对路径 否则是相对路径</code></p>
<h5 id="删除文件">删除文件</h5>
<p><code>rm 文件名</code></p>
<p>会提示是否删除 输入yes或者y   或者加入 -f 强制删除就没有提示了 <code>rm -rf</code>强制删除文件内所有目录</p>
<p><strong>删库跑路 <code>rm -rf /*</code>不要尝试！</strong></p>
<h5 id="复制文件">复制文件</h5>
<p>cp</p>
<p>递归复制 <code>-r</code></p>
<p>取消提示 <code>/cp</code></p>
<h5 id="移动文件">移动文件</h5>
<p><code>mv</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220708100810241.png" alt="image-20220708100810241"></p>
<h5 id="查看文件">查看文件</h5>
<p><code>cat more less</code></p>
<p>推荐使用less</p>
<p>less 指令用来分屏查看文件内容，它的功能与 more 指令类似，但是比 more 指令更加 强大，支持各种显示终端。less 指令在显示文件内容时，并不是一次将整个文件加载之后 才显示，而是根据显示需要加载内容，对于显示大型文件具有较高的效率。</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;less -e&quot;</span> 当文件显示结束后，自动离开，无需输入<span class="string">&quot;q&quot;</span></span><br><span class="line"><span class="string">&quot;less -f&quot;</span> 强迫打开特殊文件，例如外围设备代号、目录和二进制文件</span><br><span class="line"><span class="string">&quot;less -m&quot;</span> 显示类似<span class="keyword">more</span>命令的百分比</span><br><span class="line"><span class="string">&quot;less -N&quot;</span> 显示每行的行号</span><br><span class="line"><span class="string">&quot;less -s&quot;</span> 将连续的空行合并成一行显示</span><br><span class="line"><span class="string">&quot;less -S&quot;</span> 行信息过长时，将超出部分舍弃</span><br></pre></td></tr></table></figure>
<p><strong>操作说明</strong></p>
<p>=可以查看信息</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220708101628404.png" alt="image-20220708101628404"></p>
<p>g回到开头 G到最后一行</p>
<h4 id="输出重定向">输出重定向</h4>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220708102658336.png" alt="image-20220708102658336"></p>
<h5 id="echo">echo</h5>
<p>后面跟什么控制台输出什么</p>
<p>-e 转义可用</p>
<p><code>echo -e &quot;hello   \nworld&quot;</code></p>
<h5 id="tail">tail</h5>
<p>输出文件尾部内容</p>
<p>重要点是<code>tail -f </code>文件实时追踪该文档的所有更新内容</p>
<p>在开发环境调试程序，看实时日志很有用的。</p>
<h4 id="软链接">软链接</h4>
<p>软链接也称为符号链接，类似于 windows 里的快捷方式，有自己的数据块，主要存放 了链接其他文件的路径</p>
<p><strong>基本语法</strong></p>
<p><code>ln -s </code>[原文件或目录] [软链接名] （功能描述：给原文件创建一个软链接）</p>
<p><strong>删除和查询</strong></p>
<p>删除软链接： rm -rf 软链接名，而不是 rm -rf 软链接名/</p>
<p>如果使用 rm -rf 软链接名/ 删除，会把软链接对应的真实目录下内容删掉</p>
<p>查询：通过 ll 就可以查看，列表属性第 1 位是 l，尾部会有位置指向。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220708104911398.png" alt="image-20220708104911398"></p>
<h4 id="查看历史命令">查看历史命令</h4>
<p><code>history</code>在终端敲过的所有命令</p>
<h3 id="时间日期类-2">时间日期类</h3>
<p>主要就是date命令很简单</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">date</span> （功能描述：显示当前时间） </span><br><span class="line">（<span class="number">2</span>）<span class="keyword">date</span> +%Y （功能描述：显示当前年份） </span><br><span class="line">（<span class="number">3</span>）<span class="keyword">date</span> +%m （功能描述：显示当前月份） </span><br><span class="line">（<span class="number">4</span>）<span class="keyword">date</span> +%d （功能描述：显示当前是哪一天） </span><br><span class="line">（<span class="number">5</span>）<span class="keyword">date</span> <span class="string">&quot;+%Y-%m-%d %H:%M:%S&quot;</span> （功能描述：显示年月日时分秒）</span><br><span class="line">（<span class="number">1</span>）<span class="keyword">date</span> -d <span class="string">&#x27;1 days ago&#x27;</span> （功能描述：显示前一天时间） </span><br><span class="line">（<span class="number">2</span>）<span class="keyword">date</span> -d <span class="string">&#x27;-1 days ago&#x27;</span> （功能描述：显示明天时间）</span><br></pre></td></tr></table></figure>
<p><code>cal </code>查看本月日期  <code>cal 2003</code>查看2003年日历</p>
<h3 id="用户管理命令-2">用户管理命令</h3>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">useradd 用户名<span class="comment">(添加新用户)</span></span><br><span class="line">passwd 用户名<span class="comment">(设置该用户密码)</span></span><br><span class="line">id 用户名<span class="comment">(该用户是否存在)</span></span><br><span class="line">cat /etc/passwd<span class="comment">(查看创建了什么用户)</span></span><br><span class="line">su 用户名称 （功能描述：切换用户，只能获得用户的执行权限，不能获得环境变量） </span><br><span class="line">su - 用户名称 （功能描述：切换到用户并获得该用户的环境变量及执行权限）</span><br><span class="line">userdel 用户名<span class="comment">(删除用户)</span></span><br><span class="line">userdel -r 用户名<span class="comment">(删除用户，以及相关文件)</span></span><br><span class="line">who查看登录用户信息</span><br><span class="line">whoami （功能描述：显示自身用户名称）</span><br><span class="line">who am i （功能描述：显示登录用户的用户名以及登陆时间）</span><br><span class="line">usermod -g 用户组 用户名<span class="comment">(修改用户的初始登录组)</span></span><br></pre></td></tr></table></figure>
<h4 id="利用sudo命令给用户root权限">利用sudo命令给用户root权限</h4>
<p>需要修改配置文件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220708152311189.png" alt="image-20220708152311189"></p>
<h3 id="文件权限类-2">文件权限类</h3>
<p>认识文件权限</p>
<p>（1）0 首位表示类型</p>
<p>在Linux中第一个字符代表这个文件是目录、文件或链接文件等等</p>
<p>- 代表文件   d 代表目录   l 链接文档(link file)；</p>
<p>2）第1-3位确定属主（该文件的所有者）拥有该文件的权限。—User</p>
<p>3）第4-6位确定属组（所有者的同组用户）拥有该文件的权限，—Group</p>
<p>4）第7-9位确定其他用户拥有该文件的权限 —Other</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220708145803901.png" alt="image-20220708145803901"></p>
<h4 id="rew在文件和目录的解释">rew在文件和目录的解释</h4>
<p>（1）作用到文件：</p>
<p>[ r ]代表可读(read): 可以读取，查看</p>
<p>[ w ]代表可写(write): 可以修改，但是不代表可以删除该文件，删除一个文件的前 提条件是对该文件所在的目录有写权限，才能删除该文件</p>
<p>[ x ]代表可执行(execute):可以被系统执行</p>
<p>2）作用到目录：</p>
<p>[ r ]代表可读(read): 可以读取，ls查看目录内容</p>
<p>[ w ]代表可写(write): 可以修改，目录内创建+删除+重命名目录</p>
<p>[ x ]代表可执行(execute):可以进入该目录</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chmod改变权限</span><br><span class="line">第一种方式变更权限 chmod [&#123;ugoa&#125;&#123;+-=&#125;&#123;rwx&#125;] 文件或目录 </span><br><span class="line">第二种方式变更权限 chmod [<span class="attribute">mode</span>=421 ] [文件或目录]</span><br><span class="line">第二种经验</span><br><span class="line"><span class="attribute">r</span>=4 <span class="attribute">w</span>=2 <span class="attribute">x</span>=1 <span class="attribute">rwx</span>=4+2+1=7 <span class="attribute">rw</span>=4+2=6</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220708151136770.png" alt="image-20220708151136770"></p>
<p>修改所属组和用户(注意权限)</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">所属用户 递归-R</span><br><span class="line"><span class="keyword">chown</span></span><br><span class="line">[root@hadoop82 hello]<span class="comment"># chown sjh2 123.txt </span></span><br><span class="line">[root@hadoop82 hello]<span class="comment"># ll</span></span><br><span class="line">总用量 <span class="number">208</span></span><br><span class="line">-rw-r--r--. <span class="number">1</span> sjh2 root     <span class="number">41</span> <span class="number">7</span>月   <span class="number">7</span> <span class="number">10</span>:<span class="number">00</span> <span class="number">123</span>.txt</span><br></pre></td></tr></table></figure>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">所属组</span><br><span class="line">chgrp</span><br><span class="line">[root@hadoop82 hello]<span class="comment"># chgrp sjh2 123.txt </span></span><br><span class="line">[root@hadoop82 hello]<span class="comment"># ll</span></span><br><span class="line">总用量 208</span><br><span class="line">-rw-r--r--.<span class="number"> 1 </span>sjh2 sjh2    <span class="number"> 41 </span>7月  <span class="number"> 7 </span>10:00 123.txt</span><br></pre></td></tr></table></figure>
<h3 id="搜索查找类-2">搜索查找类</h3>
<p>find查找文件或者目录</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span> -name <span class="built_in">info</span></span><br><span class="line"><span class="built_in">find</span> /root -name <span class="string">&quot;*.cfg&quot;</span> (在root目录下结尾是cfg的文件)</span><br><span class="line"><span class="built_in">find</span> /home -size +204800/home目录下查找大于200m的文件)</span><br></pre></td></tr></table></figure>
<p><strong>locate</strong> <strong>快速定位文件路径</strong></p>
<p>locate 指令利用事先建立的系统中所有文件名称及路径的 locate 数据库实现快速定位给 定的文件。Locate 指令无需遍历整个文件系统，查询速度较快。为了保证查询结果的准确 度，管理员必须定期更新 locate 时刻。<code>updatedb</code></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">locate</span> <span class="number">123</span>.txt</span><br></pre></td></tr></table></figure>
<p><strong>grep</strong>过滤查找及 **“|” **管道符</p>
<p><code>-n</code>显示匹配行以及行号</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -<span class="built_in">n</span> <span class="built_in">info</span> MyU7.txt</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220708155140955.png" alt="image-20220708155140955"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> | grep .txt(当前目录中以有.txt的文件)</span><br><span class="line"><span class="built_in">wc</span>查找显示行数 单词 字节 </span><br></pre></td></tr></table></figure>
<h3 id="压缩和解压类-2">压缩和解压类</h3>
<h4 id="最常用的打包tar">最常用的打包tar</h4>
<p>tar [选项] XXX.tar.gz 将要打包进去的内容 （打包目录，压缩后的文件式.tar.gz）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220708161541045.png" alt="image-20220708161541045"></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tar -zcvf hello<span class="selector-class">.tar</span><span class="selector-class">.gz</span> hello/ <span class="number">1</span><span class="selector-class">.jpg</span></span><br><span class="line">将hello目录和<span class="number">1</span>.jpg图片打包压缩</span><br><span class="line">tar -zxvf hello<span class="selector-class">.tar</span><span class="selector-class">.gz</span> -C /tmp</span><br><span class="line">将hello<span class="selector-class">.tar</span>.gz压缩包，解压到tmp目录下</span><br></pre></td></tr></table></figure>
<h3 id="磁盘查看和分区类-2">磁盘查看和分区类</h3>
<p><code>du</code>命令</p>
<p>du 目录/文件 （功能描述：显示目录下每个子目录的磁盘使用情况）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220708163438401.png" alt="image-20220708163438401"></p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@hadoop82</span> ~]<span class="meta"># du --max-depth=1 -ah</span></span><br><span class="line">查看目录下一级的文件的大小和总计磁盘空间大小</span><br></pre></td></tr></table></figure>
<p>df<strong>查看磁盘空间使用情况</strong></p>
<p><code>df</code>  <code>-h</code>转换为数据内存格式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> -h /目录</span><br><span class="line"><span class="built_in">df</span> -h /(根目录)</span><br><span class="line"><span class="built_in">df</span> -h(当前目录)</span><br></pre></td></tr></table></figure>
<p><code>free -h</code>当前内存使用情况</p>
<p><strong>lsblk</strong> <strong>查看设备挂载情况</strong>(了解)</p>
<p><code>-f</code>查看详细的设备挂载情况，显示文件系统信息</p>
<h4 id="磁盘分区">磁盘分区</h4>
<p><strong>fdisk分区</strong></p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">fdisk</span> -l （功能描述：查看磁盘分区详情） </span><br><span class="line">fdisk 硬盘设备名 （功能描述：对新增硬盘进行分区操作）</span><br></pre></td></tr></table></figure>
<p><strong>要在root用户下进行</strong></p>
<h3 id="进程管理类-2">进程管理类</h3>
<h4 id="ps-查看当前系统进程状态"><strong>ps</strong> <strong>查看当前系统进程状态</strong></h4>
<p><code>ps aux</code>功能描述：查看系统中所有进程</p>
<p><code>ps -ef</code>功能描述：可以查看子父进程之间的关系</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220708201715785.png" alt="image-20220708201715785"></p>
<p>使用时机</p>
<p>如果想查看进程的 CPU 占用率和内存占用率，可以使用 aux;</p>
<p>如果想查看进程的父进程 ID 可以使用 -ef;</p>
<h4 id="终止进程">终止进程</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> [选项] 进程号 （功能描述：通过进程号杀死进程） </span><br><span class="line">killall 进程名称 （功能描述：通过进程名称杀死进程，也支持通配符，这 在系统因负载过大而变得很慢时很有用） </span><br></pre></td></tr></table></figure>
<p><code>kill -9</code>强制停止 谨慎使用</p>
<p>（1）杀死浏览器进程</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@hadoop101</span> 桌面]<span class="meta"># kill -9 5102 </span></span><br></pre></td></tr></table></figure>
<p>（2）通过进程名称杀死进程</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@hadoop101</span> 桌面]<span class="meta"># killall firefox</span></span><br></pre></td></tr></table></figure>
<h4 id="pstree查看进程树">pstree查看进程树</h4>
<p>显示进程pid</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@hadoop101</span> datas]<span class="meta"># pstree -p</span></span><br></pre></td></tr></table></figure>
<p>显示进程所属用户</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@hadoop101</span> datas]<span class="meta"># pstree -u</span></span><br></pre></td></tr></table></figure>
<h2 id="5-BUG点">5. BUG点</h2>
<p>难点(关键代码或关键配置，BUG截图+解决方案)</p>
<p>在分盘操作的时候，报错刚开始不知道什么原因，去CSDN找也没有什么先例，看尚硅谷的笔记，发现分盘只能在root用户下，自己不是root用户，因此会报错，换回root用户就正常了。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220708193913260.png" alt="image-20220708193913260"></p>
<h2 id="6-扩展学习部分">6.扩展学习部分</h2>
<h3 id="硬链接">硬链接</h3>
<p><a target="_blank" rel="noopener" href="http://t.csdn.cn/g8hbC%E6%9D%A5%E8%87%AA">http://t.csdn.cn/g8hbC来自</a> CSDN 解释清晰</p>
<p>硬链接的本质就是一条文件名和i结点的关联记录</p>
<p>结点就是inode</p>
<p>和软链接的区别：<code>硬链接的文件指向的结点和源文件的结点是一样的，而软链接则是重新建立了一个独立的文件</code></p>
<p><code>当我们删除了源文件之后，发现硬链接还能正常显示原本的内容，而软链接则提示文件不存在</code></p>
<p>硬链接关联着我们的源文件，所以源文件的大小是多大，它们就是多大</p>
<p>但是软链接指向的是文件名，它的大小就是文件名的字节数</p>
<h2 id="7-总结">7.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>今天学习的Linux命令量比较多，一下子记不住这么多，比较常用的倒是都掌握了，在实操篇的内容，敲的也比较多。难度其实一般，需要掌握的都掌握了，难点都是老师说不需要死钻明白的，最后的磁盘分区，其实实现原理并不太清除，但是实现方法是知道了，就过了。没什么很大的bug，是自己疏忽大意了，忘记自己在什么用户下，权限不够导致无法分区。文件目录类这部分是重点，也是花了一上午，这部分花费的时间和精力比较多，次数敲多了，掌握起来蛮熟练的，忘记的命令可以再看下笔记。</p>
<h1 id="7-9-扩展篇-Shell编程">7.9 扩展篇 Shell编程</h1>
<h2 id="1-头：日期、所学内容出处-3">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web">https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web</a></p>
<h2 id="2-标题-3">2.标题</h2>
<h2 id="3-所学内容概述-3">3.所学内容概述</h2>
<h2 id="4-根据概述分章节描述">4.根据概述分章节描述</h2>
<h3 id="软件包管理">软件包管理</h3>
<p><strong>YUM！</strong></p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">YUM（全称为 Yellow dog Updater, Modified）是一个在 Fedora 和 RedHat 以及 CentOS 中的 <span class="keyword">Shell</span><span class="language-bash"> 前端软件包管理器。基于 RPM 包管理，能够从指定的服务器自动下载 RPM 包 并且安装，可以自动处理依赖性关系，并且一次安装所有依赖的软件包，无须繁琐地一次 次下载、安装</span></span><br></pre></td></tr></table></figure>
<p>相当于是Linux中命令行版本的应用商店。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220710231632302.png" alt="image-20220710231632302"></p>
<p>比如安装火狐浏览器</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y <span class="keyword">install</span> firefox</span><br></pre></td></tr></table></figure>
<p>卸载火狐浏览器</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y <span class="built_in">remove</span> firefox</span><br></pre></td></tr></table></figure>
<h3 id="Shell">Shell</h3>
<h4 id="概述">概述</h4>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220710232213761.png" alt="image-20220710232213761"></p>
<p><code>shell默认的解释器是bash</code></p>
<p>查看命令是<code>  echo $SHELL</code></p>
<h4 id="Shell脚本">Shell脚本</h4>
<p>创建一个hello.sh文件，加入内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash </span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;helloworld&quot;</span></span><br></pre></td></tr></table></figure>
<p><strong>执行</strong></p>
<p>第一种：采用 bash 或 sh+脚本的相对路径或绝对路径（不用赋予脚本+x 权限）</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bash </span>+路径 或者su +路径</span><br></pre></td></tr></table></figure>
<p>第二种：采用输入脚本的绝对路径或相对路径执行脚本（必须具有可执行权限+x）</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@hadoop82</span> ~]<span class="meta"># chmod +x scripts/hello.sh </span></span><br></pre></td></tr></table></figure>
<p>再执行脚本</p>
<p>直接输入路径</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hello.sh   <span class="regexp">/root/</span>script/hello.sh</span><br></pre></td></tr></table></figure>
<h4 id="变量">变量</h4>
<p>基本语法</p>
<p>（1）定义变量：变量名=变量值，注意，=号前后不能有空格</p>
<p>（2）撤销变量：unset 变量名</p>
<p>变量定义规则</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220711004712936.png" alt="image-20220711004712936"></p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@hadoop82</span> scripts]<span class="meta"># my_var=<span class="string">&quot;hello,  world&quot;</span></span></span><br><span class="line">[root<span class="symbol">@hadoop82</span> scripts]<span class="meta"># echo $my_var</span></span><br><span class="line">hello, world</span><br></pre></td></tr></table></figure>
<p>升级成全局变量</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> my_var</span><br></pre></td></tr></table></figure>
<p>只读(静态变量)</p>
<figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">readonly</span> my_var</span><br></pre></td></tr></table></figure>
<p>特殊变量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$n 功能描述：n 为数字，$<span class="number">0</span> 代表该脚本名称，$<span class="number">1</span>-$<span class="number">9</span> 代表第一到第九个参数，十以 上的参数，十以上的参数需要用大括号包含，<span class="comment">#如$&#123;10&#125;</span></span><br><span class="line">$<span class="comment"># （功能描述：获取所有输入参数个数，常用于循环,判断参数的个数是否正确以及 加强脚本的健壮性</span></span><br><span class="line">$* 功能描述：这个变量代表命令行中所有的参数，<span class="comment">#$*把所有的参数看成一个整体</span></span><br><span class="line">$@ 功能描述：这个变量代表命令行中所有的参数，<span class="comment">#$*把所有的参数看成一个整体</span></span><br><span class="line">$? 功能描述：最后一次执行的命令的返回状态。如果这个变量的值为 <span class="number">0</span>，证明上一 个命令正确执行；如果这个变量的值为非 <span class="number">0</span>（具体是哪个数，由命令自己来决定），则证明 上一个命令执行不正确了。</span><br></pre></td></tr></table></figure>
<h4 id="条件判断">条件判断</h4>
<p>语法</p>
<p>（1）test condition</p>
<p>（2）[ condition ]<strong>（注意 condition 前后要有空格）</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220711110339052.png" alt="image-20220711110339052"></p>
<p><code>多条件判断（&amp;&amp; 表示前一条命令执行成功时，才执行后一条命令，|| 表示上一 条命令执行失败后，才执行下一条命令）</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop101 ~]$ [ atguigu ] &amp;&amp; <span class="built_in">echo</span> OK || <span class="built_in">echo</span> notOK </span><br><span class="line">OK</span><br><span class="line">[atguigu@hadoop101 shells]$ [ ] &amp;&amp; <span class="built_in">echo</span> OK || <span class="built_in">echo</span> notOK </span><br><span class="line">notOK</span><br></pre></td></tr></table></figure>
<h4 id="流程控制">流程控制</h4>
<h5 id="if语句">if<strong>语句</strong></h5>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if [ 条件判断式 ] </span><br><span class="line">then</span><br><span class="line">	程序 </span><br><span class="line">elif [ 条件判断式 ] </span><br><span class="line">then</span><br><span class="line">	程序 </span><br><span class="line">else</span><br><span class="line">	程序 </span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<h5 id="case"><strong>case</strong></h5>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">case $变量名 in </span><br><span class="line"><span class="string">&quot;值 1&quot;</span>）</span><br><span class="line">	如果变量的值等于值 <span class="number">1</span>，则执行程序 <span class="number">1</span> </span><br><span class="line"><span class="comment">;;</span></span><br><span class="line"><span class="string">&quot;值 2&quot;</span>）</span><br><span class="line">	如果变量的值等于值 <span class="number">2</span>，则执行程序 <span class="number">2</span> </span><br><span class="line"><span class="comment">;; </span></span><br><span class="line">	…省略其他分支… </span><br><span class="line">*） </span><br><span class="line">	如果变量的值都不是以上的值，则执行此程序 </span><br><span class="line"><span class="comment">;;</span></span><br><span class="line">esac</span><br></pre></td></tr></table></figure>
<h5 id="for循环">for<strong>循环</strong></h5>
<p>从1加到100</p>
<p>第一种</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sum=0 </span><br><span class="line">for((i=0;i&lt;=100;i++)) </span><br><span class="line">do </span><br><span class="line">	sum=$[$sum+$i] </span><br><span class="line">done </span><br><span class="line">echo $sum</span><br></pre></td></tr></table></figure>
<p>第二种</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sum=0</span><br><span class="line">for i in &#123;1..100&#125;</span><br><span class="line">do </span><br><span class="line">	sum=$[$sum+$i]</span><br><span class="line">done</span><br><span class="line">echo $sum</span><br></pre></td></tr></table></figure>
<h5 id="while循环">while循环</h5>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sum=0 </span><br><span class="line">i=1 </span><br><span class="line">while [ $i -le 100 ] </span><br><span class="line">do </span><br><span class="line">    sum=$[$sum+$i] </span><br><span class="line">    i=$[$i+1] </span><br><span class="line">done </span><br><span class="line">echo $sum</span><br></pre></td></tr></table></figure>
<h4 id="read读取控制台输入">read读取控制台输入</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-p：指定读取值时的提示符； </span><br><span class="line">-t：指定读取值时等待的时间（秒）如果-t 不加表示一直等待</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">read -t 7 -p &quot;Enter your name in 7 seconds :&quot; NN</span><br></pre></td></tr></table></figure>
<h4 id="函数">函数</h4>
<p>系统函数</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">basename (显示文件的名称)原理就是取/的最后一位</span><br><span class="line">dirname (显示文件的路径) 原理是取最后一位/的前面</span><br></pre></td></tr></table></figure>
<p>自定义函数</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span> </span><br><span class="line">function sum() </span><br><span class="line">&#123;</span><br><span class="line">s=0</span><br><span class="line">s=$[$1+$2]</span><br><span class="line">echo &quot;$s&quot; </span><br><span class="line">&#125;</span><br><span class="line">read -p &quot;请输入第一个数字: &quot; n1; </span><br><span class="line">read -p &quot;请输入第二个数字: &quot; n2; </span><br><span class="line">sum $n1 $n2;</span><br></pre></td></tr></table></figure>
<p><code>函数返回值，只能通过$?系统变量获得，可以显示加：return 返回，如果不加，将 以最后一条命令运行结果，作为返回值。return 后跟数值 n(0-255)</code></p>
<h2 id="5-总结-2">5.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>今天学习内容比较多，昨天的扩展篇收尾，软件包管理yum和一些进程管理类的再次了解。然后今天就是shell部分的学习完毕，shell在我理解有点像python，脚本语言。但是和python比，语言的简洁性,可读性都很差。毕竟是脚本语言，一些比较复杂的代码和程序，写出来就很麻烦用shell。因此现在shell是有一个let 可以用c和java的语言，还是方便的，shell今天学习就和之前的编程语言一样，变量，语法，流程和函数这些基本的。比较简单也就过掉了，在寝室学习雀氏是没有工作室学习的效率高，氛围也有差异，但是在寝室的学习今天算是满意了。</p>
<h1 id="7-11-Scala基础入门">7.11 Scala基础入门</h1>
<h2 id="1-头：日期、所学内容出处-4">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web">https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web</a></p>
<h2 id="2-标题-4">2.标题</h2>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">P1001_尚硅谷<span class="variable">_Scala_</span>课程简介</span><br><span class="line">P2002_尚硅谷<span class="variable">_Scala_Scala</span>概述（一）<span class="variable">_Scala</span>发展历史</span><br><span class="line">P3003_尚硅谷<span class="variable">_Scala_Scala</span>概述（二）<span class="variable">_Scala</span>和Java的关系</span><br><span class="line">P4004_尚硅谷<span class="variable">_Scala_Scala</span>概述（三）<span class="variable">_Scala</span>特点总结</span><br><span class="line">P5005_尚硅谷<span class="variable">_Scala_Scala</span>环境搭建（一）<span class="variable">_Scala</span>安装和交互式命令行测试</span><br><span class="line">P6006_尚硅谷<span class="variable">_Scala_Scala</span>环境搭建（二）<span class="variable">_Scala</span>源文件编写和运行</span><br><span class="line">P7007_尚硅谷<span class="variable">_Scala_Scala</span>环境搭建（三）<span class="variable">_Scala</span>编译结果的反编译深入分析</span><br><span class="line">P8008_尚硅谷<span class="variable">_Scala_</span>在IDE中编写HelloWorld（一）_项目创建和环境配置</span><br><span class="line">P9009_尚硅谷<span class="variable">_Scala_</span>在IDE中编写HelloWorld（二）_编写代码</span><br><span class="line">P10010_尚硅谷<span class="variable">_Scala_</span>在IDE中编写HelloWorld（三）_代码中语法的简单说明</span><br><span class="line">P11011_尚硅谷<span class="variable">_Scala_</span>在IDE中编写HelloWorld（四）_伴生对象的扩展说明</span><br><span class="line">P12012_尚硅谷<span class="variable">_Scala_</span>在IDE中编写HelloWorld（五）_关联源码和查看官方指南</span><br><span class="line">P13013_尚硅谷<span class="variable">_Scala_</span>变量和数据类型（一）_注释和基本编程习惯</span><br><span class="line">P14014_尚硅谷<span class="variable">_Scala_</span>变量和数据类型（二）_变量和常量</span><br><span class="line">P15015_尚硅谷<span class="variable">_Scala_</span>变量和数据类型（三）_标识符</span><br><span class="line">P16016_尚硅谷<span class="variable">_Scala_</span>变量和数据类型（四）_字符串</span><br><span class="line">P17017_尚硅谷<span class="variable">_Scala_</span>变量和数据类型（五）_控制台标准输入</span><br><span class="line">P18018_尚硅谷<span class="variable">_Scala_</span>变量和数据类型（六）_读写文件</span><br><span class="line">P19019_尚硅谷<span class="variable">_Scala_</span>变量和数据类型（七）_数据类型系统</span><br><span class="line">P20020_尚硅谷<span class="variable">_Scala_</span>变量和数据类型（八）_整型和浮点类型</span><br><span class="line">P21021_尚硅谷<span class="variable">_Scala_</span>变量和数据类型（九）_字符和布尔类型</span><br><span class="line">P22022_尚硅谷<span class="variable">_Scala_</span>变量和数据类型（十）_空类型</span><br><span class="line">P23023_尚硅谷<span class="variable">_Scala_</span>变量和数据类型（十一）<span class="variable">_Unit</span>类型的源码实现</span><br><span class="line">P24024_尚硅谷<span class="variable">_Scala_</span>变量和数据类型（十二）_类型转换（一）<span class="variable">_Java</span>类型转换复习</span><br><span class="line">P25025_尚硅谷<span class="variable">_Scala_</span>变量和数据类型（十二）_类型转换（三）<span class="variable">_Scala</span>自动类型转换</span><br><span class="line">P26026_尚硅谷<span class="variable">_Scala_</span>变量和数据类型（十二）_类型转换（四）<span class="variable">_Scala</span>强制类型转换</span><br><span class="line">P27027_尚硅谷<span class="variable">_Scala_</span>变量和数据类型（十二）_类型转换（五）_强转溢出面试题</span><br></pre></td></tr></table></figure>
<h2 id="3-所学内容概述-4">3.所学内容概述</h2>
<p>案发舒服案发分开</p>
<h2 id="4-根据概述分章节描述-2">4.根据概述分章节描述</h2>
<p>fff</p>
<h3 id="Scala概述">Scala概述</h3>
<p>因为Spark 所以要学Scala<code>Spark的兴起，带动Scala语言的发展！</code></p>
<p>Scala基于Java，Scala和Java有密不可分的关系 关系图如下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220713181600104.png" alt="image-20220713181600104"></p>
<h4 id="Scala特点">Scala特点</h4>
<p>Scala是一门以Java虚拟机为运行环境面向对象和函数式编程结合的静态类型的<code>编程语言</code>，scala跟java差不多，源代码编译成字节码文件。</p>
<p>我使用Scala下来，感觉Scala像是python和java的结合，很简洁，很多地方看到了python的影子。</p>
<h4 id="Scala环境搭建">Scala环境搭建</h4>
<p>搭建过这么多的环境，Scala也不复杂，两三分钟就完成了。</p>
<p>IDEA中导入Scala稍微耗费了点时间，要引入框架。</p>
<h3 id="Scala入门">Scala入门</h3>
<p>Scala注解和java完全一样 /* /** 和//</p>
<h4 id="变量和常量">变量和常量</h4>
<p>大体和其他编程语言一样，但是要提前声明是变量还是常量</p>
<p>基本语法</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//var 变量名 [: 变量类型] = 初始值 </span></span><br><span class="line"><span class="keyword">var</span> i:<span class="type">Int</span> = <span class="number">10</span></span><br><span class="line"><span class="comment">//val 常量名 [: 常量类型] = 初始值 </span></span><br><span class="line"><span class="keyword">val</span> j:<span class="type">Int</span> = <span class="number">20</span></span><br></pre></td></tr></table></figure>
<p>注意点</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">（<span class="number">1</span>）声明变量时，类型可以省略，编译器自动推导，即类型推导</span><br><span class="line">（<span class="number">2</span>）类型确定后，就不能修改，说明 Scala 是强数据类型语言。</span><br><span class="line">（<span class="number">3</span>）变量声明时，必须要有初始值</span><br><span class="line">（<span class="number">4</span>）在声明/定义一个变量时，可以使用 <span class="keyword">var</span> 或者 <span class="keyword">val</span> 来修饰，<span class="keyword">var</span> 修饰的变量可改变，</span><br><span class="line"><span class="keyword">val</span> 修饰的变量不可改。</span><br></pre></td></tr></table></figure>
<h4 id="标识符的命名规范">标识符的命名规范</h4>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Scala </span>对各种变量、方法、函数等命名时使用的字符序列称为标识符。即：凡是自己可以起名字的地方都叫标识符。</span><br></pre></td></tr></table></figure>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">和java基本差不多，</span><br><span class="line">（<span class="number">1</span>）以字母或者下划线开头，后接字母、数字、下划线</span><br><span class="line">（<span class="number">2</span>）以操作符开头，且只包含操作符（+ - * / # !等）</span><br><span class="line">（<span class="number">3</span>）用反引号`....`包括的任意字符串，即使是 Scala 关键字（<span class="number">39</span> 个）也可以</span><br></pre></td></tr></table></figure>
<h4 id="字符串输出">字符串输出</h4>
<p>关键字<code>println</code></p>
<h3 id="数据类型-重点"><strong>数据类型(重点)</strong></h3>
<p>Scala一切是数据都是对象，是Any的子类 如下图</p>
<p>Scala两大数据类型，引用类AnyRef和数值类型的AnyVal</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220713191734135.png" alt="image-20220713191734135"></p>
<p>数值类型和其他语言大差不差，语法不一样而已</p>
<p>如果变量或者常量后面没有声明类型，直接等于号，不报错，是Scala自动给你匹配了对应的类型，就和python一样，还是人性化的，但是最好加上吧，可读性强一些。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确</span></span><br><span class="line"> <span class="keyword">var</span> n1:<span class="type">Byte</span> = <span class="number">127</span></span><br><span class="line"> <span class="keyword">var</span> n2:<span class="type">Byte</span> = <span class="number">-128</span></span><br><span class="line"> <span class="comment">// 错误</span></span><br><span class="line"> <span class="comment">// var n3:Byte = 128</span></span><br><span class="line"> <span class="comment">// var n4:Byte = -129</span></span><br><span class="line"> <span class="comment">// 不带数据类型整型数据默认是int</span></span><br><span class="line"> <span class="keyword">var</span> n5 = <span class="number">10</span></span><br><span class="line"> println(n5)</span><br><span class="line"> <span class="keyword">var</span> n6 = <span class="number">9223372036854775807</span>L</span><br><span class="line"> println(n6)</span><br><span class="line"><span class="comment">//不带数据类型 浮点型默认是Double</span></span><br><span class="line"><span class="comment">// 建议，在开发中需要高精度小数时，请选择 Double</span></span><br><span class="line"> <span class="keyword">var</span> n7 = <span class="number">2.2345678912</span>f</span><br><span class="line"> <span class="keyword">var</span> n8 = <span class="number">2.2345678912</span></span><br><span class="line"> println(<span class="string">&quot;n7=&quot;</span> + n7)</span><br><span class="line"> println(<span class="string">&quot;n8=&quot;</span> + n8)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//（1）字符常量是用单引号 &#x27; &#x27; 括起来的单个字符。</span></span><br><span class="line"> <span class="keyword">var</span> c1: <span class="type">Char</span> = &#x27;a&#x27;</span><br><span class="line"> println(<span class="string">&quot;c1=&quot;</span> + c1)</span><br><span class="line"><span class="comment">//注意：这里涉及自动类型提升，其实编译器可以自定判断是否超出范围，</span></span><br><span class="line"> <span class="comment">//不过 idea 提示报错</span></span><br><span class="line"><span class="keyword">var</span> c2:<span class="type">Char</span> = &#x27;a&#x27; + <span class="number">1</span></span><br><span class="line">println(c2)</span><br><span class="line"> </span><br><span class="line"> <span class="comment">//（2）\t ：一个制表位，实现对齐的功能</span></span><br><span class="line"> println(<span class="string">&quot;姓名\t 年龄&quot;</span>)</span><br><span class="line"> <span class="comment">//（3）\n ：换行符</span></span><br><span class="line"> println(<span class="string">&quot;西门庆\n 潘金莲&quot;</span>)</span><br><span class="line"> <span class="comment">//（4）\\ ：表示\</span></span><br><span class="line"> println(<span class="string">&quot;c:\\岛国\\avi&quot;</span>)</span><br><span class="line"> <span class="comment">//（5）\&quot; ：表示&quot;</span></span><br><span class="line"> println(<span class="string">&quot;同学们都说：\&quot;大海哥最帅\&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//布尔类 只能false和true占用一个字节</span></span><br><span class="line"><span class="keyword">var</span> isResult : <span class="type">Boolean</span> = <span class="literal">false</span></span><br><span class="line"> <span class="keyword">var</span> isResult2 : <span class="type">Boolean</span> = <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h2 id="5-总结-3">5.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>今天是进入Scala的学习，Scala算是一个半新的语言，基于java的。也算是java++，一些语法和规则不太一样，基本运行原理还是差不多的，学习步骤主要是看文档，因为是语言，自己学了很多种了，前面基本的部分，大多语言都大差不差，看看文档还是比较快的，代码敲了四五个吧，关于变量的部分不是很多，今天学习的任务也不是很重，顺便把前几天的centOS中的命令，在ubuntu中，又使用了一些，ubuntu安装是用apt的,不是用Centos的yum，ubuntu下了一个java。</p>
<h1 id="7-13-hadoop基础入门">7.13 hadoop基础入门</h1>
<h2 id="1-头：日期、所学内容出处-5">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web">https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web</a></p>
<h2 id="2-标题-5">2.标题</h2>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">01</span>_尚硅谷_课程简介_大数据课程</span><br><span class="line"><span class="number">02</span>_尚硅谷_课程简介<span class="variable">_Hadoop</span>课程</span><br><span class="line"><span class="number">03</span>_尚硅谷_入门_大数据概念</span><br><span class="line"><span class="number">04</span>_尚硅谷_入门_大数据特点（<span class="number">4</span>V）</span><br><span class="line"><span class="number">05</span>_尚硅谷_入门_大数据应用场景</span><br><span class="line"><span class="number">06</span>_尚硅谷_入门_大数据发展前景</span><br><span class="line"><span class="number">07</span>_尚硅谷_入门_大数据部门业务流程分析</span><br><span class="line"><span class="number">08</span>_尚硅谷_入门_大数据部门组织结构（重点）</span><br><span class="line"><span class="number">09</span>_尚硅谷<span class="variable">_Hadoop_</span>是什么</span><br><span class="line"><span class="number">10</span>_尚硅谷<span class="variable">_Hadoop_</span>发展历史</span><br><span class="line"><span class="number">11</span>_尚硅谷<span class="variable">_Hadoop_</span>三大发行版本</span><br><span class="line"><span class="number">12</span>_尚硅谷<span class="variable">_Hadoop_</span>优势（<span class="number">4</span>高）</span><br><span class="line"><span class="number">13</span>_尚硅谷<span class="variable">_Hadoop_1</span>.x和<span class="number">2</span>.x区别</span><br><span class="line"><span class="number">14</span>_尚硅谷<span class="variable">_Hadoop_</span>组成</span><br><span class="line"><span class="number">15</span>_尚硅谷<span class="variable">_Hadoop_</span>大数据技术生态体系</span><br><span class="line"><span class="number">16</span>_尚硅谷<span class="variable">_Hadoop_</span>推荐系统框架图</span><br><span class="line"><span class="number">17</span>_尚硅谷_环境搭建_虚拟机准备</span><br><span class="line"><span class="number">18</span>_尚硅谷_环境搭建<span class="variable">_JDK</span>安装</span><br><span class="line"><span class="number">19</span>_尚硅谷_环境搭建<span class="variable">_Hadoop</span>安装</span><br><span class="line"><span class="number">20</span>_尚硅谷_环境搭建<span class="variable">_Hadoop</span>目录结构</span><br><span class="line"><span class="number">21</span>_尚硅谷_环境搭建<span class="variable">_Hadoop</span>官网手册</span><br><span class="line"><span class="number">22</span>_尚硅谷_本地模式<span class="variable">_Grep</span>官方案例</span><br><span class="line"><span class="number">23</span>_尚硅谷_本地模式<span class="variable">_WordCount</span>官方案例</span><br><span class="line"><span class="number">24</span>_尚硅谷_伪分布式_启动HDFS并运行MR程序</span><br><span class="line"><span class="number">25</span>_尚硅谷_伪分布式<span class="variable">_Log</span>日志查看和NN格式化前强调</span><br><span class="line"><span class="number">26</span>_尚硅谷_伪分布式<span class="variable">_NameNode</span>格式化注意事项</span><br><span class="line"><span class="number">27</span>_尚硅谷_伪分布式_启动YARN并运行MR程序</span><br><span class="line"><span class="number">28</span>_尚硅谷_伪分布式_配置历史服务器</span><br><span class="line"><span class="number">29</span>_尚硅谷_伪分布式_配置日志聚集</span><br><span class="line"><span class="number">30</span>_尚硅谷_伪分布式_配置文件说明</span><br></pre></td></tr></table></figure>
<h2 id="3-所学内容概述-5">3.所学内容概述</h2>
<p>大数据入门</p>
<p>hadoop概述入门</p>
<p>环境搭建</p>
<p>本地模式</p>
<p>伪分布式</p>
<h2 id="4-根据概述分章节描述-3">4.根据概述分章节描述</h2>
<h3 id="hadoop概述">hadoop概述</h3>
<p><code>hadoop是一个分布式的基础架构，用于存储和分析计算数据，解决数据问题。</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wps1.png" alt="img"></p>
<p><strong>hadoop的组成</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wps2.png" alt="img"></p>
<p><code>MapReduce和HDFS是重点</code></p>
<h3 id="虚拟机环境搭建准备"><strong>虚拟机环境搭建准备</strong></h3>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span>	克隆虚拟机		</span><br><span class="line"><span class="bullet">2.</span>	修改克隆虚拟机的静态IP</span><br><span class="line"><span class="bullet">3.</span>	修改主机名</span><br><span class="line"><span class="bullet">4.</span>	关闭防火墙</span><br><span class="line"><span class="bullet">5.</span>	创建atguigu用户</span><br><span class="line"><span class="bullet">6.</span>	配置atguigu用户具有root权限</span><br><span class="line">安装JDK 和 hadoop</span><br></pre></td></tr></table></figure>
<p>安装Jdk和Hadoop时候注意路径，配好环境变量，需要检查。</p>
<p><code>java -version</code>和<code>hadoop</code>可以检查环境变量有没有配置好</p>
<h3 id="hadoop目录结构">hadoop目录结构</h3>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">（<span class="number">1</span>）<span class="keyword">bin目录：存放对Hadoop相关服务（HDFS,YARN）进行操作的脚本</span></span><br><span class="line"><span class="keyword"></span>（<span class="number">2</span>）etc目录：Hadoop的配置文件目录，存放Hadoop的配置文件</span><br><span class="line">（<span class="number">3</span>）lib目录：存放Hadoop的本地库（对数据进行压缩解压缩功能）</span><br><span class="line">（<span class="number">4</span>）<span class="keyword">sbin目录：存放启动或停止Hadoop相关服务的脚本</span></span><br><span class="line"><span class="keyword"></span>（<span class="number">5</span>）<span class="keyword">share目录：存放Hadoop的依赖jar包、文档、和官方案例</span></span><br></pre></td></tr></table></figure>
<h3 id="Hadoop运行模式">Hadoop运行模式</h3>
<h4 id="本地运行">本地运行</h4>
<p>执行命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.2.jar wordcount wcinput wcoutput</span><br></pre></td></tr></table></figure>
<h4 id="伪分布式运行模式">伪分布式运行模式</h4>
<p>具体配置以及测试命令见 文档</p>
<p>配置集群文档一定要注意命令以及主机名</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（<span class="number">1</span>）配置集群</span><br><span class="line">（<span class="number">2</span>）启动、测试集群增、删、查</span><br><span class="line">（<span class="number">3</span>）执行<span class="built_in">WordCount</span>案例</span><br></pre></td></tr></table></figure>
<p>查看集群启动成功用<code>jps</code></p>
<p>MapReduce和YARN大同小异</p>
<h4 id="配置历史服务器-日志聚集">配置历史服务器 日志聚集</h4>
<p>步骤都是配置yarn-site.xml文件然后添加配置</p>
<p>启动集群 执行即可</p>
<p><strong>运行情况</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220714002441191.png" alt="image-20220714002441191"></p>
<h2 id="6-扩展学习部分-2">6.扩展学习部分</h2>
<p>说下这一星期操作linux系统出现的一些常见问题吧，最常见的就是路径问题，经常cd或者解压包的时候，vim和cat找不到文件，大多数就是自己路径的问题。自己出现了的一次问题：我在hadoop-2.7.1中有个文件名叫etc，但是在Linux中根目录也有一个文件名叫etc，所以有好几次，cd和调用命令的时候，报错，说找不到路径，闲下来的时候去CSDN搜了一下，路径的问题，<code>单独一个/代表跟根目录</code>，像<code>/etc/hadoop</code>就是进入根目录的etc中的hadoop目录，如果<code>etc/hadoop</code>就是当前目录有个文件叫etc，是相对的路径，而etc中的hadoop前面带/就是绝对路径，算是两种路径结合在一起，导致自己好几次不成功，几次的经验就是换一个新的路径的时候，ll看一下路径的文件，防止解压等操作的时候，造成不必要的麻烦。</p>
<h3 id="大数据的技术生态系统体系">大数据的技术生态系统体系</h3>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220714002628742.png" alt="image-20220714002628742"></p>
<figure class="highlight tp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>）Sqoop：Sqoop是一款开源的工具，主要用于在Hadoop、Hive与传统的数据库(MySql)间进行数据的传递，可以将一个关系型数据库（例如 ：MySQL，Oracle 等）中的数据导进到Hadoop的HDFS中，也可以将HDFS的数据导进到关系型数据库中。</span><br><span class="line"><span class="number">2</span>）Flume：Flume是Cloudera提供的一个高可用的，高可靠的，分布式的海量日志采集、聚合和传输的系统，Flume支持在日志系统中定制各类数据发送方，用于收集数据；同时，Flume提供对数据进行简单处理，并写到各种数据接受方（可定制）的能力。</span><br><span class="line"><span class="number">3</span>）Kafka：Kafka是一种高吞吐量的分布式发布订阅消息系统，有如下特性：</span><br><span class="line">（<span class="number">1</span>）通过O(<span class="number">1</span>)的磁盘数据结构提供消息的持久化，这种结构对于即使数以<span class="keyword">TB</span>的消息存储也能够保持长时间的稳定性能。</span><br><span class="line">（<span class="number">2</span>）高吞吐量：即使是非常普通的硬件Kafka也可以支持每秒数百万的消息。</span><br><span class="line">（<span class="number">3</span>）支持通过Kafka服务器和消费机集群来分区消息。</span><br><span class="line">（<span class="number">4</span>）支持Hadoop并行数据加载。</span><br><span class="line"><span class="number">4</span>）Storm：Storm用于“连续计算”，对数据流做连续查询，在计算时就将结果以流的形式输出给用户。</span><br><span class="line"><span class="number">5</span>）Spark：Spark是当前最流行的开源大数据内存计算框架。可以基于Hadoop上存储的大数据进行计算。</span><br><span class="line"><span class="number">6</span>）Oozie：Oozie是一个管理Hdoop作业（job）的工作流程调度管理系统。</span><br><span class="line"><span class="number">7</span>）Hbase：HBase是一个分布式的、面向列的开源数据库。HBase不同于一般的关系数据库，它是一个适合于非结构化数据存储的数据库。</span><br><span class="line"><span class="number">8</span>）Hive：Hive是基于Hadoop的一个数据仓库工具，可以将结构化的数据文件映射为一张数据库表，并提供简单的SQL查询功能，可以将SQL语句转换为MapReduce任务进行运行。 其优点是学习成本低，可以通过类SQL语句快速实现简单的MapReduce统计，不必开发专门的MapReduce应用，十分适合数据仓库的统计分析。</span><br><span class="line"><span class="number">10</span>）<span class="keyword">R</span>语言：<span class="keyword">R</span>是用于统计分析、绘图的语言和操作环境。<span class="keyword">R</span>是属于GNU系统的一个自由、免费、源代码开放的软件，它是一个用于统计计算和统计制图的优秀工具。</span><br><span class="line"><span class="number">11</span>）Mahout：Apache Mahout是个可扩展的机器学习和数据挖掘库。</span><br><span class="line"><span class="number">12</span>）ZooKeeper：Zookeeper是Google的Chubby一个开源的实现。它是一个针对大型分布式系统的可靠协调系统，提供的功能包括：配置维护、名字服务、 分布式同步、组服务等。ZooKeeper的目标就是封装好复杂易出错的关键服务，将简单易用的接口和性能高效、功能稳定的系统提供给用户。</span><br></pre></td></tr></table></figure>
<h2 id="7-总结-2">7.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>今天从Scala又来看hadoop了，hadoop的概念性不是很好理解，在我看来hadoop是一个框架，而且是开源的。相当于一个思想，它有提供模块和软件做支撑，是大数据必学的东西。今天的内容有点难度，代码会敲，但是内容和代码实现的原因，不是很理解透彻，今天配置java和hadoop的时候，路径出现了一些问题，学习内容也是偏概念性的，hadoop的目录结构作用等，一些命令已经熟悉了，伪分布式运行这里问题有点大，不理解这样做的原理和原因。</p>
<h1 id="7-14-hadoop完全分布式">7.14 hadoop完全分布式</h1>
<h2 id="1-头：日期、所学内容出处-6">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web">https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web</a></p>
<h2 id="2-标题-6">2.标题</h2>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">31</span><span class="literal">_</span>尚硅谷<span class="literal">_</span>完全分布式<span class="literal">_</span>虚拟机环境准备</span><br><span class="line"><span class="number">32</span><span class="literal">_</span>尚硅谷<span class="literal">_</span>完全分布式_scp案例</span><br><span class="line"><span class="number">33</span><span class="literal">_</span>尚硅谷<span class="literal">_</span>完全分布式_rsync案例</span><br><span class="line"><span class="number">34</span><span class="literal">_</span>尚硅谷<span class="literal">_</span>完全分布式<span class="literal">_</span>集群分发脚本xsync</span><br><span class="line"><span class="number">35</span><span class="literal">_</span>尚硅谷<span class="literal">_</span>完全分布式<span class="literal">_</span>集群配置</span><br><span class="line"><span class="number">36</span><span class="literal">_</span>尚硅谷<span class="literal">_</span>完全分布式<span class="literal">_</span>集群单节点启动</span><br><span class="line"><span class="number">37</span><span class="literal">_</span>尚硅谷<span class="literal">_</span>完全分布式<span class="literal">_</span>集群ssh配置</span><br><span class="line"><span class="number">38</span><span class="literal">_</span>尚硅谷<span class="literal">_</span>完全分布式<span class="literal">_</span>集群群起</span><br><span class="line"><span class="number">39</span><span class="literal">_</span>尚硅谷<span class="literal">_</span>完全分布式<span class="literal">_</span>集群文件存储路径说明</span><br><span class="line"><span class="number">40</span><span class="literal">_</span>尚硅谷<span class="literal">_</span>完全分布式<span class="literal">_</span>集群启动停止方式总结</span><br><span class="line"><span class="number">41</span><span class="literal">_</span>尚硅谷<span class="literal">_</span>每日回顾</span><br><span class="line"><span class="number">42</span><span class="literal">_</span>尚硅谷<span class="literal">_</span>完全分布式_RM启动注意事项</span><br><span class="line"><span class="number">43</span><span class="literal">_</span>尚硅谷<span class="literal">_</span>完全分布式_Crondtab定时任务调度</span><br><span class="line"><span class="number">44</span><span class="literal">_</span>尚硅谷<span class="literal">_</span>完全分布式<span class="literal">_</span>集群时间同步</span><br></pre></td></tr></table></figure>
<h2 id="3-所学内容概述-6">3.所学内容概述</h2>
<h3 id="准备虚拟机克隆">准备虚拟机克隆</h3>
<h4 id="编写集群分发脚本">编写集群分发脚本</h4>
<h4 id="集群配置">集群配置</h4>
<h2 id="4-根据概述分章节描述-4">4.根据概述分章节描述.</h2>
<h3 id="准备虚拟机克隆-2">准备虚拟机克隆</h3>
<p>虚拟机克隆回来需要进行ip配置，看那个老师克隆步骤和自己的对不上，文件都不一样，自己是对着实验指导书配的。查了资料，总结了自己的步骤,后面也是全部对的上的都成功的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">配置ip</span><br><span class="line">[root@localhost ~]<span class="comment"># vim /etc/sysconfig/network-scripts/ifcfg-ens33 </span></span><br><span class="line"><span class="comment">#将IPADDR这里修改成自己需要的ip最好一个集群在一个网段 然后把 BOOTPROTO=static改成静态的，原本是none</span></span><br><span class="line">systemctl restart network</span><br><span class="line">systemctl restart NetworkManager</span><br><span class="line"><span class="comment">#这两条是重启网络配置 如果这种不行，就把network关了，再只重启NetworkManager，成功的话，reboot重启一次就好</span></span><br><span class="line">虚拟机的网络配置就如上</span><br></pre></td></tr></table></figure>
<h3 id="编写集群分发配置">编写集群分发配置</h3>
<p>克隆机的配置和原来是一样的，明显是不妥当的，一个一个改又很麻烦，就需要集群分发。用xsync</p>
<h4 id="xsync集群分发脚本">xsync集群分发脚本</h4>
<p>在/usr/sjh/bin这个目录下存放的脚本，sjh用户可以在系统任何地方直接执行。</p>
<p>（a）在/home/atguigu目录下创建bin目录，并在bin目录下xsync创建文件，文件内容如下：</p>
<p><code>原来的教程是在/home/sjh目录 试了不行 改到了/usr/sjh 就好了</code></p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="variable">@hadoop83</span> ~]<span class="variable">$ </span>mkdir bin</span><br><span class="line">[root<span class="variable">@hadoop83</span> ~]<span class="variable">$ </span>cd bin/</span><br><span class="line">[root<span class="variable">@hadoop83</span> bin]<span class="variable">$ </span>touch xsync</span><br><span class="line">[root<span class="variable">@hadoop83</span> bin]<span class="variable">$ </span>vi xsync</span><br></pre></td></tr></table></figure>
<p>写入xsync</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#1 获取输入参数个数，如果没有参数，直接退出</span></span><br><span class="line">pcount=$<span class="comment">#</span></span><br><span class="line"><span class="keyword">if</span>((pcount==<span class="number">0</span>)); then</span><br><span class="line">echo no args;</span><br><span class="line">exit;</span><br><span class="line">fi</span><br><span class="line"><span class="comment">#2 获取文件名称</span></span><br><span class="line">p1=$<span class="number">1</span></span><br><span class="line">fname=`basename $p1`</span><br><span class="line">echo fname=$fname</span><br><span class="line"><span class="comment">#3 获取上级目录到绝对路径</span></span><br><span class="line">pdir=`cd -P $(dirname $p1); pwd`</span><br><span class="line">echo pdir=$pdir</span><br><span class="line"><span class="comment">#4 获取当前用户名称</span></span><br><span class="line">user=`whoami`</span><br><span class="line"><span class="comment">#5 循环</span></span><br><span class="line"><span class="keyword">for</span>((host=<span class="number">103</span>; host&lt;<span class="number">105</span>; host++)); do</span><br><span class="line">echo ------------------- hadoop$host --------------</span><br><span class="line">rsync -rvl $pdir/$fname $user@hadoop$host:$pdir</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<p>修改脚本的权限 主要是添加执行权限 以及各用户能调用</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[sjh<span class="symbol">@hadoop83</span> bin]<span class="meta"># chmod 777 xsync</span></span><br></pre></td></tr></table></figure>
<p>修改脚本形式</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[sjh<span class="symbol">@hadoop83</span> bin]<span class="meta"># xsync /usr/sjh/bin</span></span><br></pre></td></tr></table></figure>
<h3 id="集群配置-2">集群配置</h3>
<p>部署规划</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220714194338973.png" alt="image-20220714194338973"></p>
<p>以下配置文件直接copy尚硅谷的 自己的集群搭建 注意自己路径和文件名</p>
<h4 id="核心配置文件">核心配置文件</h4>
<p>配置core-site.xml</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu<span class="variable">@hadoop102</span> hadoop]<span class="variable">$ </span>vi core-site.xml</span><br></pre></td></tr></table></figure>
<p>在该文件中编写如下配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 指定HDFS中NameNode的地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://hadoop102:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定Hadoop运行时产生文件的存储目录 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/module/hadoop-2.7.2/data/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="HDFS配置文件">HDFS配置文件</h4>
<p><a target="_blank" rel="noopener" href="http://xn--hadoop-env-o150at28m.sh">配置hadoop-env.sh</a></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop]$ vi hadoop-env.sh</span><br><span class="line"><span class="built_in">export</span> <span class="attribute">JAVA_HOME</span>=/opt/module/jdk1.8.0_144</span><br></pre></td></tr></table></figure>
<p>配置hdfs-site.xml</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu<span class="variable">@hadoop102</span> hadoop]<span class="variable">$ </span>vi hdfs-site.xml</span><br></pre></td></tr></table></figure>
<p>配置如下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定Hadoop辅助名称节点主机配置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop104:50090<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="YARN配置">YARN配置</h4>
<p><a target="_blank" rel="noopener" href="http://xn--yarn-env-vz2ve12k.sh">配置yarn-env.sh</a></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop]$ vi yarn-env.sh</span><br><span class="line"><span class="built_in">export</span> <span class="attribute">JAVA_HOME</span>=/opt/module/jdk1.8.0_144</span><br></pre></td></tr></table></figure>
<p>配置yarn-site.xml</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu<span class="variable">@hadoop102</span> hadoop]<span class="variable">$ </span>vi yarn-site.xml</span><br></pre></td></tr></table></figure>
<p>配置如下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Reducer获取数据的方式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定YARN的ResourceManager的地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop103<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="MapReduce配置文件">MapReduce配置文件</h4>
<p><a target="_blank" rel="noopener" href="http://xn--mapred-env-o150at28m.sh">配置mapred-env.sh</a></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop]$ vi mapred-env.sh</span><br><span class="line"><span class="built_in">export</span> <span class="attribute">JAVA_HOME</span>=/opt/module/jdk1.8.0_144</span><br></pre></td></tr></table></figure>
<p>配置mapred-site.xml</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[atguigu@hadoop102 hadoop]</span>$ cp mapred-site<span class="selector-class">.xml</span><span class="selector-class">.template</span> mapred-site<span class="selector-class">.xml</span></span><br><span class="line"><span class="selector-attr">[atguigu@hadoop102 hadoop]</span>$ vi mapred-site.xml</span><br></pre></td></tr></table></figure>
<p>在该文件中增加如下配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 指定MR运行在Yarn上 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="在集群上分发配置好的Hadoop配置文件">在集群上分发配置好的Hadoop配置文件</h4>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop]$ xsync <span class="regexp">/opt/m</span>odule<span class="regexp">/hadoop-2.7.2/</span></span><br></pre></td></tr></table></figure>
<p>分发完毕 去克隆机查看分发配置情况</p>
<h3 id="集群单点启动">集群单点启动</h3>
<p>这个很常规，之前的笔记有</p>
<p>每次都一个一个节点启动，如果节点数增加到1000个怎么办。所以要学一起启动利用集群 群起</p>
<p>首先要解决SSH无密登陆配置 不然每次群起要输入很多次密码</p>
<h4 id="SSh无密登录配置">SSh无密登录配置</h4>
<p>进入另外一台电脑 ssh语法</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">ssh</span> <span class="built_in">IP</span>地址 或者 软连接</span><br></pre></td></tr></table></figure>
<p>无密钥登录原理</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wps1-16578004146091.png" alt="img"></p>
<p>第一步生成公钥和私钥：</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu<span class="variable">@hadoop102</span> .ssh]<span class="variable">$ </span>ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>
<p>在/root/.ssh会生成两个文件id_rsa（私钥）、id_rsa.pub（公钥）</p>
<p>拷贝到免密的机器上 自身也需要</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 .ssh]$ ssh-<span class="keyword">copy</span>-<span class="built_in">id</span> hadoop102</span><br><span class="line">[atguigu@hadoop102 .ssh]$ ssh-<span class="keyword">copy</span>-<span class="built_in">id</span> hadoop103</span><br><span class="line">[atguigu@hadoop102 .ssh]$ ssh-<span class="keyword">copy</span>-<span class="built_in">id</span> hadoop104</span><br></pre></td></tr></table></figure>
<p>.ssh文件夹文件功能解释</p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">known_hosts	记录ssh访问过计算机的公钥(<span class="keyword">public</span> <span class="built_in">key</span>)</span><br><span class="line">id_rsa	生成的私钥</span><br><span class="line">id_rsa.<span class="property">pub</span>	生成的公钥</span><br><span class="line">authorized_keys	存放授权过得无密登录服务器公钥</span><br></pre></td></tr></table></figure>
<h3 id="群起集群">群起集群</h3>
<p>配置Slaves</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/opt/m</span>odule<span class="regexp">/hadoop-2.7.2/</span>etc<span class="regexp">/hadoop/</span>slaves</span><br><span class="line">[atguigu@hadoop102 hadoop]$ vi slaves</span><br></pre></td></tr></table></figure>
<p>该文件增加内容</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hadoop83</span><br><span class="line">hadoop84</span><br><span class="line">hadoop85</span><br></pre></td></tr></table></figure>
<p>同步所有节点配置文件</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu<span class="variable">@hadoop102</span> hadoop]<span class="variable">$ </span>xsync slaves</span><br></pre></td></tr></table></figure>
<p>启动集群</p>
<p>在hadoop83中 放集群的克隆机</p>
<p>格式化</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu<span class="variable">@hadoop102</span> hadoop-<span class="number">2.7</span>.<span class="number">2</span>]<span class="variable">$ </span>bin/hdfs namenode -format</span><br></pre></td></tr></table></figure>
<p>启动HDFS</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu<span class="variable">@hadoop102</span> hadoop-<span class="number">2.7</span>.<span class="number">2</span>]<span class="variable">$ </span>sbin/start-dfs.sh</span><br></pre></td></tr></table></figure>
<p>启动YARN</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu<span class="variable">@hadoop103</span> hadoop-<span class="number">2.7</span>.<span class="number">2</span>]<span class="variable">$ </span>sbin/start-yarn.sh</span><br></pre></td></tr></table></figure>
<h4 id="集群基本测试">集群基本测试</h4>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ hdfs dfs -mkdir -p <span class="regexp">/user/</span>atguigu/input</span><br><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ hdfs dfs -put wcinput<span class="regexp">/wc.input /u</span>ser<span class="regexp">/atguigu/i</span>nput</span><br></pre></td></tr></table></figure>
<p>上传大文件</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ bin/hadoop fs -put</span><br><span class="line"><span class="regexp">/opt/</span>software<span class="regexp">/hadoop-2.7.2.tar.gz  /u</span>ser<span class="regexp">/atguigu/i</span>nput</span><br></pre></td></tr></table></figure>
<p>查看磁盘存储文件内容</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[atguigu<span class="variable">@hadoop102</span> subdir0]<span class="variable">$ </span>cat blk_1073741825</span><br><span class="line">hadoop yarn</span><br><span class="line">hadoop mapreduce </span><br><span class="line">atguigu</span><br><span class="line">atguigu</span><br></pre></td></tr></table></figure>
<h3 id="集群启动-停止方式总结">集群启动/停止方式总结</h3>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">（<span class="number">1</span>）分别启动/停止HDFS组件</span><br><span class="line">hadoop-daemon.sh  start <span class="regexp">/ stop  namenode /</span> datanode / secondarynamenode</span><br><span class="line">（<span class="number">2</span>）启动/停止YARN</span><br><span class="line">yarn-daemon.sh  start <span class="regexp">/ stop  resourcemanager /</span> nodemanager</span><br></pre></td></tr></table></figure>
<h4 id="集群时间同步">集群时间同步</h4>
<p>检查ntp是否安装</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@hadoop102</span> 桌面]<span class="meta"># rpm -qa|grep ntp</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220714212915085.png" alt="image-20220714212915085"></p>
<h4 id="其他机器配置（必须root）">其他机器配置（必须root）</h4>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@hadoop103</span>桌面]<span class="meta"># crontab -e</span></span><br></pre></td></tr></table></figure>
<p>修改文件时间 Linux中有，指每十分钟切换一次</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="emphasis">*/10 *</span> * * <span class="emphasis">*</span></span><br></pre></td></tr></table></figure>
<h2 id="5-BUG点-2">5. BUG点</h2>
<p>难点(关键代码或关键配置，BUG截图+解决方案)</p>
<p>克隆机的时候，因为路径和老师不一样，代码打出来，老师有的文件打开是有的，但是我打开是没的，但是最终目标都是连接配置静态ip地址，和能正常上网，自己找linux尚硅谷的资料，看着配置的，方法很不一样，目的是正常达成了，详情在笔记 虚拟机环境准备有。</p>
<p>还有个报错的问题。就是在执行ssh命令的时候，提示lias cman='man -M /usr//share/man/zh_CN’报错，看提示信息是在etc/profile.d/cman.sh这个文件下的问题，ssh我使用的时候是正常的，但是会报出这个错误，百度找了，然后进该文件比对，发现最前面少个a然后路径//中间少了local。加上以后ssh就没报错信息了，好像是自己最开始安装中文语言包的时候复制进去的时候光标的原因吧，不太清楚。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220714235620184.png" alt="image-20220714235620184"></p>
<h2 id="6-总结">6.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>今天的学习内容不是很多，但是有一定的难度，和小问题比较多，但都解决了。问题不大，集群的配置比较麻烦，但是单机开启和昨天的命令是一样的。无非是配置多集群的时候，稍微麻烦了点，而且配置文件和老师差异比较大，源被克隆的机子和老师配置很多不一样，克隆出来的机子很多都是要自己去搜命令。好在顺利启动RM了。也能正常使。还是偏向概念性多点，理解集群运行的原理，代码就那么来回几条，多敲几遍就OK了，文件也是配置一次以后，用集群配置就方便了很多。</p>
<h1 id="7-16-HDFS">7.16 HDFS</h1>
<h2 id="1-头：日期、所学内容出处-7">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web">https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web</a></p>
<h2 id="2-标题-7">2.标题</h2>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">70</span>_尚硅谷<span class="variable">_HDFS_</span>机架感知-副本存储节点选择</span><br><span class="line">P71 <span class="number">71</span>_尚硅谷<span class="variable">_HDFS_</span>读数据流程（面试重点）</span><br><span class="line"><span class="number">72</span>_尚硅谷<span class="variable">_HDFS_NN</span>和<span class="number">2</span>NN工作机制（面试重点）</span><br><span class="line"><span class="number">73</span>_尚硅谷<span class="variable">_HDFS_Fsimage</span>和Edits解析</span><br><span class="line"><span class="number">74</span>_尚硅谷<span class="variable">_HDFS_CheckPoint</span>时间设置</span><br><span class="line"><span class="number">75</span>_尚硅谷<span class="variable">_HDFS_NN</span>故障处理_案例</span><br><span class="line"><span class="number">76</span>_尚硅谷<span class="variable">_HDFS_</span>安全模式</span><br><span class="line"><span class="number">77</span>_尚硅谷<span class="variable">_HDFS_</span>集群安全模式_案例</span><br><span class="line"><span class="number">78</span>_尚硅谷<span class="variable">_HDFS_NN</span>多目录配置_案例</span><br><span class="line"><span class="number">79</span>_尚硅谷_每日回顾</span><br><span class="line"><span class="number">80</span>_尚硅谷<span class="variable">_HDFS_DN</span>工作机制（面试重点）</span><br><span class="line"><span class="number">81</span>_尚硅谷<span class="variable">_HDFS_</span>数据完整性</span><br><span class="line"><span class="number">82</span>_尚硅谷<span class="variable">_HDFS_</span>掉线时限参数设置</span><br><span class="line"><span class="number">83</span>_尚硅谷<span class="variable">_HDFS_</span>服役新节点_案例</span><br><span class="line"><span class="number">84</span>_尚硅谷<span class="variable">_HDFS_</span>添加白名单_案例</span><br><span class="line"><span class="number">85</span>_尚硅谷<span class="variable">_HDFS_</span>黑名单退役_案例</span><br><span class="line"><span class="number">86</span>_尚硅谷<span class="variable">_HDFS_DN</span>多目录配置_案例</span><br><span class="line"><span class="number">87</span>_尚硅谷<span class="variable">_HDFS</span>新特性_集群间数据拷贝</span><br><span class="line"><span class="number">88</span>_尚硅谷<span class="variable">_HDFS</span>新特性_小文件归档案例</span><br><span class="line"><span class="number">89</span>_尚硅谷<span class="variable">_HDFS</span>新特性_回收站案例</span><br><span class="line"><span class="number">90</span>_尚硅谷<span class="variable">_HDFS</span>新特性_快照管理</span><br></pre></td></tr></table></figure>
<h2 id="3-所学内容概述-7">3.所学内容概述</h2>
<h3 id="HDFS概述">HDFS概述</h3>
<h4 id="HDFS的shell操作">HDFS的shell操作</h4>
<h4 id="HDFS客户端环境准备">HDFS客户端环境准备</h4>
<h4 id="HDFS的API操作">HDFS的API操作</h4>
<h4 id="HDFS的I-O流操作">HDFS的I/O流操作</h4>
<h2 id="4-根据概述分章节描述-5">4.根据概述分章节描述</h2>
<h3 id="HDFS概述-2">HDFS概述</h3>
<p>HDFS是分布式文件管理系统的一种。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220715084956748.png" alt="image-20220715084956748"></p>
<h4 id="优点">优点</h4>
<p>高容错 <code>数据自动保存多个副本 副本丢失以后可以自动恢复</code></p>
<p>适合处理大数据</p>
<p><code>数据规模 能处理数据规模达到GB TB 甚至PB的数据</code></p>
<p><code>文件规模：能处理百万规模以上的文件数量，数量相当之大</code></p>
<p>可以构建在廉价机器上</p>
<p><code>通过多副本机制，提高可靠性</code></p>
<h4 id="缺点">缺点</h4>
<p>不适合低延迟数据访问，毫秒这种数据存储，做不到</p>
<p>对小文件存储，不够高效</p>
<p>仅仅支持数据追加append 不支持修改</p>
<h4 id="HDFS组成架构">HDFS组成架构</h4>
<p>分为4个方面 NameNode DataNode Client客户端 和 Secondary NameNode</p>
<p><code>Secondary NameNode</code>辅助NameNode，可以定期合并Edits和Fsming，必要的时候可以辅助恢复NameNode，提高安全性。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wps2-16578472731763.png" alt="img"></p>
<h3 id="HDFS的Shell操作（开发重点）">HDFS的Shell操作（开发重点）</h3>
<p>基本语法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bin</span>/hadoop fs - 具体命令</span><br><span class="line"><span class="built_in">bin</span>/hdfs dfs 具体命令</span><br><span class="line"><span class="comment">#dfs是fs的实现类</span></span><br></pre></td></tr></table></figure>
<p>查看命令大全</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/hadoop fs</span><br></pre></td></tr></table></figure>
<p>基本常用命令合集</p>
<p>（0）启动Hadoop集群（方便后续的测试）</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[atguigu<span class="variable">@hadoop102</span> hadoop-<span class="number">2.7</span>.<span class="number">2</span>]<span class="variable">$ </span>sbin/start-dfs.sh</span><br><span class="line">[atguigu<span class="variable">@hadoop103</span> hadoop-<span class="number">2.7</span>.<span class="number">2</span>]<span class="variable">$ </span>sbin/start-yarn.sh</span><br></pre></td></tr></table></figure>
<p>（1）-help：输出这个命令参数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-2.7.2]$ hadoop fs -<span class="built_in">help</span> <span class="built_in">rm</span></span><br></pre></td></tr></table></figure>
<p>（2）-ls: 显示目录信息</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu<span class="variable">@hadoop102</span> hadoop-<span class="number">2.7</span>.<span class="number">2</span>]<span class="variable">$ </span>hadoop fs -ls /</span><br></pre></td></tr></table></figure>
<p>( 3 )-mkdir:在HDFS上创建目录</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ hadoop fs -mkdir -p <span class="regexp">/sanguo/</span>shuguo</span><br></pre></td></tr></table></figure>
<p>（4）-moveFromLocal：从本地剪切粘贴到HDFS</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[atguigu<span class="variable">@hadoop102</span> hadoop-<span class="number">2.7</span>.<span class="number">2</span>]<span class="variable">$ </span>touch kongming.txt</span><br><span class="line">[atguigu<span class="variable">@hadoop102</span> hadoop-<span class="number">2.7</span>.<span class="number">2</span>]<span class="variable">$ </span>hadoop fs  -moveFromLocal  ./kongming.txt  /sanguo/shuguo</span><br></pre></td></tr></table></figure>
<p>（5）-appendToFile：追加一个文件到已经存在的文件末尾</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[atguigu<span class="variable">@hadoop102</span> hadoop-<span class="number">2.7</span>.<span class="number">2</span>]<span class="variable">$ </span>touch liubei.txt</span><br><span class="line">[atguigu<span class="variable">@hadoop102</span> hadoop-<span class="number">2.7</span>.<span class="number">2</span>]<span class="variable">$ </span>vi liubei.txt</span><br><span class="line">输入</span><br><span class="line">san gu mao lu</span><br><span class="line">[atguigu<span class="variable">@hadoop102</span> hadoop-<span class="number">2.7</span>.<span class="number">2</span>]<span class="variable">$ </span>hadoop fs -appendToFile liubei.txt /sanguo/shuguo/kongming.txt</span><br></pre></td></tr></table></figure>
<p>（6）-cat：显示文件内容</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ hadoop fs -cat <span class="regexp">/sanguo/</span>shuguo/kongming.txt</span><br></pre></td></tr></table></figure>
<p>（7）-chgrp 、-chmod、-chown：Linux文件系统中的用法一样，修改文件所属权限</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ hadoop fs  -chmod  <span class="number">666</span>  <span class="regexp">/sanguo/</span>shuguo/kongming.txt</span><br><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ hadoop fs  -chown  atguigu:atguigu   <span class="regexp">/sanguo/</span>shuguo/kongming.txt</span><br></pre></td></tr></table></figure>
<p>（8）-copyFromLocal：从本地文件系统中拷贝文件到HDFS路径去</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu<span class="variable">@hadoop102</span> hadoop-<span class="number">2.7</span>.<span class="number">2</span>]<span class="variable">$ </span>hadoop fs -copyFromLocal README.txt /</span><br></pre></td></tr></table></figure>
<p>（9）-copyToLocal：从HDFS拷贝到本地</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ hadoop fs -copyToLocal <span class="regexp">/sanguo/</span>shuguo<span class="regexp">/kongming.txt ./</span></span><br></pre></td></tr></table></figure>
<p>（10）-cp ：从HDFS的一个路径拷贝到HDFS的另一个路径</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ hadoop fs -cp <span class="regexp">/sanguo/</span>shuguo<span class="regexp">/kongming.txt /</span>zhuge.txt</span><br></pre></td></tr></table></figure>
<p>（11）-mv：在HDFS目录中移动文件</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ hadoop fs -mv <span class="regexp">/zhuge.txt /</span>sanguo<span class="regexp">/shuguo/</span></span><br></pre></td></tr></table></figure>
<p>（12）-get：等同于copyToLocal，就是从HDFS下载文件到本地</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ hadoop fs -get <span class="regexp">/sanguo/</span>shuguo<span class="regexp">/kongming.txt ./</span></span><br></pre></td></tr></table></figure>
<p>（13）-getmerge：合并下载多个文件</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ hadoop fs -getmerge <span class="regexp">/user/</span>atguigu<span class="regexp">/test/</span>* ./zaiyiqi.txt</span><br></pre></td></tr></table></figure>
<p>（14）-put：等同于copyFromLocal</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ hadoop fs -put .<span class="regexp">/zaiyiqi.txt /u</span>ser<span class="regexp">/atguigu/</span>test/</span><br></pre></td></tr></table></figure>
<p>（15）-tail：显示一个文件的末尾</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ hadoop fs -tail <span class="regexp">/sanguo/</span>shuguo/kongming.txt</span><br></pre></td></tr></table></figure>
<p>（16）-rm：删除文件或文件夹</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ hadoop fs -rm <span class="regexp">/user/</span>atguigu<span class="regexp">/test/</span>jinlian2.txt</span><br></pre></td></tr></table></figure>
<p>（17）-rmdir：删除空目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-2.7.2]$ hadoop fs -<span class="built_in">rmdir</span> /test</span><br></pre></td></tr></table></figure>
<p>（18）-du统计文件夹的大小信息</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ hadoop fs -du -s -h <span class="regexp">/user/</span>atguigu/test</span><br><span class="line"><span class="number">2.7</span> K  <span class="regexp">/user/</span>atguigu/test</span><br><span class="line"></span><br><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ hadoop fs -du  -h <span class="regexp">/user/</span>atguigu/test</span><br><span class="line"><span class="number">1.3</span> K  <span class="regexp">/user/</span>atguigu<span class="regexp">/test/</span>README.txt</span><br><span class="line"><span class="number">15</span>     <span class="regexp">/user/</span>atguigu<span class="regexp">/test/</span>jinlian.txt</span><br><span class="line"><span class="number">1.4</span> K  <span class="regexp">/user/</span>atguigu<span class="regexp">/test/</span>zaiyiqi.txt</span><br></pre></td></tr></table></figure>
<p>（19）-setrep：设置HDFS中文件的副本数量</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hadoop-<span class="number">2.7</span>.<span class="number">2</span>]$ hadoop fs -setrep <span class="number">10</span> <span class="regexp">/sanguo/</span>shuguo/kongming.txt</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220715191439091.png" alt="image-20220715191439091"></p>
<h3 id="HDFS客户端环境准备-2">HDFS客户端环境准备</h3>
<p>因为教学老师版本那不一样，也没有下载资料，所以环境什么都是自己搜的。</p>
<p>解压hadoop2.7.1的linux安装包在，windows系统中，然后在CSDN搜到了两个文件，覆盖在hadoop中的bin目录中。两个文件有链接的。然后配置环境变量</p>
<p>%HADOOP_HOME%指定bin目录</p>
<p>path中 %HADOOP_HOME%\bin</p>
<p><a target="_blank" rel="noopener" href="http://t.csdn.cn/W0kBg">http://t.csdn.cn/W0kBg</a> 来自CSDN中</p>
<h3 id="HDFS的API操作-2">HDFS的API操作</h3>
<p><code>参数优先级</code></p>
<p>参数优先级排序：（1）客户端代码中设置的值 &gt;（2）ClassPath下的用户自定义配置文件 &gt;（3）然后是服务器的默认配置</p>
<h4 id="文件下载">文件下载</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testCopyToLocalFile</span><span class="params">()</span> <span class="keyword">throws</span> IOException, InterruptedException, URISyntaxException&#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 1 获取文件系统</span></span><br><span class="line">		<span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">		<span class="type">FileSystem</span> <span class="variable">fs</span> <span class="operator">=</span> FileSystem.get(<span class="keyword">new</span> <span class="title class_">URI</span>(<span class="string">&quot;hdfs://hadoop102:9000&quot;</span>), configuration, <span class="string">&quot;atguigu&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 2 执行下载操作</span></span><br><span class="line">		<span class="comment">// boolean delSrc 指是否将原文件删除</span></span><br><span class="line">		<span class="comment">// Path src 指要下载的文件路径</span></span><br><span class="line">		<span class="comment">// Path dst 指将文件下载到的路径</span></span><br><span class="line">		<span class="comment">// boolean useRawLocalFileSystem 是否开启文件校验</span></span><br><span class="line">		fs.copyToLocalFile(<span class="literal">false</span>, <span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;/banzhang.txt&quot;</span>), <span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;e:/banhua.txt&quot;</span>), <span class="literal">true</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 3 关闭资源</span></span><br><span class="line">		fs.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="HDFS文件删除">HDFS文件删除</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testDelete</span><span class="params">()</span> <span class="keyword">throws</span> IOException, InterruptedException, URISyntaxException&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 1 获取文件系统</span></span><br><span class="line">	<span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">	<span class="type">FileSystem</span> <span class="variable">fs</span> <span class="operator">=</span> FileSystem.get(<span class="keyword">new</span> <span class="title class_">URI</span>(<span class="string">&quot;hdfs://hadoop102:9000&quot;</span>), configuration, <span class="string">&quot;atguigu&quot;</span>);</span><br><span class="line">		</span><br><span class="line">	<span class="comment">// 2 执行删除</span></span><br><span class="line">	fs.delete(<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;/0508/&quot;</span>), <span class="literal">true</span>);</span><br><span class="line">		</span><br><span class="line">	<span class="comment">// 3 关闭资源</span></span><br><span class="line">	fs.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="HDFS文件名更改">HDFS文件名更改</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testRename</span><span class="params">()</span> <span class="keyword">throws</span> IOException, InterruptedException, URISyntaxException&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 1 获取文件系统</span></span><br><span class="line">	<span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">	<span class="type">FileSystem</span> <span class="variable">fs</span> <span class="operator">=</span> FileSystem.get(<span class="keyword">new</span> <span class="title class_">URI</span>(<span class="string">&quot;hdfs://hadoop102:9000&quot;</span>), configuration, <span class="string">&quot;atguigu&quot;</span>); </span><br><span class="line">		</span><br><span class="line">	<span class="comment">// 2 修改文件名称</span></span><br><span class="line">	fs.rename(<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;/banzhang.txt&quot;</span>), <span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;/banhua.txt&quot;</span>));</span><br><span class="line">		</span><br><span class="line">	<span class="comment">// 3 关闭资源</span></span><br><span class="line">	fs.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="HDFS文件详情查看">HDFS文件详情查看</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testListFiles</span><span class="params">()</span> <span class="keyword">throws</span> IOException, InterruptedException, URISyntaxException&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 1获取文件系统</span></span><br><span class="line">	<span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">	<span class="type">FileSystem</span> <span class="variable">fs</span> <span class="operator">=</span> FileSystem.get(<span class="keyword">new</span> <span class="title class_">URI</span>(<span class="string">&quot;hdfs://hadoop102:9000&quot;</span>), configuration, <span class="string">&quot;atguigu&quot;</span>); </span><br><span class="line">		</span><br><span class="line">	<span class="comment">// 2 获取文件详情</span></span><br><span class="line">	RemoteIterator&lt;LocatedFileStatus&gt; listFiles = fs.listFiles(<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;/&quot;</span>), <span class="literal">true</span>);</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">while</span>(listFiles.hasNext())&#123;</span><br><span class="line">		<span class="type">LocatedFileStatus</span> <span class="variable">status</span> <span class="operator">=</span> listFiles.next();</span><br><span class="line">			</span><br><span class="line">		<span class="comment">// 输出详情</span></span><br><span class="line">		<span class="comment">// 文件名称</span></span><br><span class="line">		System.out.println(status.getPath().getName());</span><br><span class="line">		<span class="comment">// 长度</span></span><br><span class="line">		System.out.println(status.getLen());</span><br><span class="line">		<span class="comment">// 权限</span></span><br><span class="line">		System.out.println(status.getPermission());</span><br><span class="line">		<span class="comment">// 分组</span></span><br><span class="line">		System.out.println(status.getGroup());</span><br><span class="line">			</span><br><span class="line">		<span class="comment">// 获取存储的块信息</span></span><br><span class="line">		BlockLocation[] blockLocations = status.getBlockLocations();</span><br><span class="line">			</span><br><span class="line">		<span class="keyword">for</span> (BlockLocation blockLocation : blockLocations) &#123;</span><br><span class="line">				</span><br><span class="line">			<span class="comment">// 获取块存储的主机节点</span></span><br><span class="line">			String[] hosts = blockLocation.getHosts();</span><br><span class="line">				</span><br><span class="line">			<span class="keyword">for</span> (String host : hosts) &#123;</span><br><span class="line">				System.out.println(host);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">			</span><br><span class="line">		System.out.println(<span class="string">&quot;-----------班长的分割线----------&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3 关闭资源</span></span><br><span class="line">fs.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="文件和文件夹判断">文件和文件夹判断</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testListStatus</span><span class="params">()</span> <span class="keyword">throws</span> IOException, InterruptedException, URISyntaxException&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1 获取文件配置信息</span></span><br><span class="line">    <span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">    <span class="type">FileSystem</span> <span class="variable">fs</span> <span class="operator">=</span> FileSystem.get(<span class="keyword">new</span> <span class="title class_">URI</span>(<span class="string">&quot;hdfs://hadoop83:9000&quot;</span>), configuration, <span class="string">&quot;root&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2 判断是文件还是文件夹</span></span><br><span class="line">    FileStatus[] listStatus = fs.listStatus(<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;/&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (FileStatus fileStatus : listStatus) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果是文件</span></span><br><span class="line">        <span class="keyword">if</span> (fileStatus.isFile()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;文件:&quot;</span>+fileStatus.getPath().getName());</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;文件名:&quot;</span>+fileStatus.getPath().getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3 关闭资源</span></span><br><span class="line">    fs.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="HDFS的I-O流操作-2">HDFS的I/O流操作</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 把本地e盘上的banhua.txt文件上传到到HDFS根目录</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">putFileToHDFS</span><span class="params">()</span> <span class="keyword">throws</span> URISyntaxException, IOException, InterruptedException &#123;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//1.获取对象</span></span><br><span class="line">       <span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">       <span class="type">FileSystem</span> <span class="variable">fs</span> <span class="operator">=</span> FileSystem.get(<span class="keyword">new</span> <span class="title class_">URI</span>(<span class="string">&quot;hdfs://hadoop83:9000&quot;</span>), configuration, <span class="string">&quot;root&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//2.获取输入法</span></span><br><span class="line">       <span class="type">FileInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;E:/banhua.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//3.获取输出流</span></span><br><span class="line">       <span class="type">FSDataOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> fs.create(<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;/banzhang.txt&quot;</span>));</span><br><span class="line"></span><br><span class="line">       <span class="comment">//4.流的对拷</span></span><br><span class="line">       IOUtils.copyBytes(fis,fos,configuration);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//5.关闭资源</span></span><br><span class="line">       IOUtils.closeStream(fis);</span><br><span class="line">       IOUtils.closeStream(fos);</span><br><span class="line">       fs.close();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h4 id="文件下载-2">文件下载</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 从HDFS上下载banhua.txt 到本地e盘中</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getFileFromHDFS</span><span class="params">()</span> <span class="keyword">throws</span> URISyntaxException, IOException, InterruptedException &#123;</span><br><span class="line">    <span class="comment">//1.获取对象</span></span><br><span class="line">    <span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">    <span class="type">FileSystem</span> <span class="variable">fs</span> <span class="operator">=</span> FileSystem.get(<span class="keyword">new</span> <span class="title class_">URI</span>(<span class="string">&quot;hdfs://hadoop83:9000&quot;</span>), configuration, <span class="string">&quot;root&quot;</span>);</span><br><span class="line">    <span class="comment">//2.获取输入流</span></span><br><span class="line">    <span class="type">FSDataInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> fs.open(<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;/banhua.txt&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.获取输出流</span></span><br><span class="line">    <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;e:/HDFS-banhua.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4.流的对拷</span></span><br><span class="line">    IOUtils.copyBytes(fis,fos,configuration);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.关闭资源</span></span><br><span class="line">    IOUtils.closeStream(fis);</span><br><span class="line">    IOUtils.closeStream(fos);</span><br><span class="line">    fs.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="定位文件读取">定位文件读取</h4>
<p>分两步</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//下载第一块</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readFileSeek1</span><span class="params">()</span> <span class="keyword">throws</span> IOException, InterruptedException, URISyntaxException&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1 获取文件系统</span></span><br><span class="line">    <span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">    <span class="type">FileSystem</span> <span class="variable">fs</span> <span class="operator">=</span> FileSystem.get(<span class="keyword">new</span> <span class="title class_">URI</span>(<span class="string">&quot;hdfs://hadoop83:9000&quot;</span>), configuration, <span class="string">&quot;root&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2 获取输入流</span></span><br><span class="line">    <span class="type">FSDataInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> fs.open(<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;/hadoop-2.7.1.tar.gz&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3 创建输出流</span></span><br><span class="line">    <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;e:/hadoop-2.7.1.tar.gz.part1&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4 流的拷贝</span></span><br><span class="line">    <span class="type">byte</span>[] buf = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span><span class="number">0</span> ; i &lt; <span class="number">1024</span> * <span class="number">128</span>; i++)&#123;</span><br><span class="line">        fis.read(buf);</span><br><span class="line">        fos.write(buf);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5关闭资源</span></span><br><span class="line">    IOUtils.closeStream(fis);</span><br><span class="line">    IOUtils.closeStream(fos);</span><br><span class="line">    fs.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readFileSeek2</span><span class="params">()</span> <span class="keyword">throws</span> IOException, InterruptedException, URISyntaxException&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1 获取文件系统</span></span><br><span class="line">    <span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">    <span class="type">FileSystem</span> <span class="variable">fs</span> <span class="operator">=</span> FileSystem.get(<span class="keyword">new</span> <span class="title class_">URI</span>(<span class="string">&quot;hdfs://hadoop83:9000&quot;</span>), configuration, <span class="string">&quot;root&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2 打开输入流</span></span><br><span class="line">    <span class="type">FSDataInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> fs.open(<span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;/hadoop-2.7.1.tar.gz&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3 定位输入数据位置</span></span><br><span class="line">    fis.seek(<span class="number">1024</span>*<span class="number">1024</span>*<span class="number">128</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4 创建输出流</span></span><br><span class="line">    <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;e:/hadoop-2.7.1.tar.gz.part2&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5 流的对拷</span></span><br><span class="line">    IOUtils.copyBytes(fis, fos, configuration);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 6 关闭资源</span></span><br><span class="line">    IOUtils.closeStream(fis);</span><br><span class="line">    IOUtils.closeStream(fos);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-BUG点-3">5. BUG点</h2>
<p>难点(关键代码或关键配置，BUG截图+解决方案)</p>
<p>是这样报错的，也看不太懂，大致意思就是找不到，文件的权限，之类的话，去CSDN看别人写的，突然发现有人在get最后面是写的root，想到自己一直都是以root用户登陆，就把用户sjh改成了root，就好了。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://docimg8.docs.qq.com/image/cMLQ9ZBtZy5gqj1iXty_7A.png?w=2560&amp;h=1440" alt="img"></p>
<h2 id="7-总结-3">7.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>今天的学习内容的重点在于掌握Java来充当客户端，利用HDFS来做上传数据或者从hadoop下载数据。这次的内容就偏向代码的敲写了，每次操作自己都去敲了一遍，看完视频自己去敲过来的，难度一般，因为对代码的处理比较多，自己对代码比较敏感，学习起来上手也快。比较麻烦的地方是windows配置环境，和IDEA配置客户端的环境准备。配置了一个小时左右，找压缩包，和pox文件花费了很多时间，中间也出现了一些小问题，但是都解决了。学习状态还不错，优于大量的概念问题的章节。</p>
<h1 id="7-18-Scala函数式编程-面向对象">7.18 Scala函数式编程 面向对象</h1>
<h2 id="1-头：日期、所学内容出处-8">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web">https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web</a></p>
<h2 id="2-标题-8">2.标题</h2>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">057</span>_尚硅谷<span class="variable">_Scala_</span>函数式编程（三）_函数高级（二）_高阶函数（三）_函数作为返回值</span><br><span class="line"><span class="number">058</span>_尚硅谷<span class="variable">_Scala_</span>函数式编程（三）_函数高级（二）_高阶函数（四）_应用案例</span><br><span class="line"><span class="number">059</span>_尚硅谷<span class="variable">_Scala_</span>函数式编程（三）_函数高级（三）_扩展练习（一）_匿名函数</span><br><span class="line"><span class="number">060</span>_尚硅谷<span class="variable">_Scala_</span>函数式编程（三）_函数高级（三）_扩展练习（二）_函数作为返回值</span><br><span class="line"><span class="number">061</span>_尚硅谷<span class="variable">_Scala_</span>函数式编程（三）_函数高级（四）_闭包（一）_概念和原理</span><br><span class="line"><span class="number">062</span>_尚硅谷<span class="variable">_Scala_</span>函数式编程（三）_函数高级（四）_闭包（二）_具体应用</span><br><span class="line"><span class="number">063</span>_尚硅谷<span class="variable">_Scala_</span>函数式编程（三）_函数高级（四）_柯里化</span><br><span class="line"><span class="number">064</span>_尚硅谷<span class="variable">_Scala_</span>函数式编程（三）_函数高级（五）_递归（一）_概念和实现</span><br><span class="line"><span class="number">065</span>_尚硅谷<span class="variable">_Scala_</span>函数式编程（三）_函数高级（五）_递归（二）_尾递归优</span><br><span class="line"><span class="number">066</span>_尚硅谷<span class="variable">_Scala_</span>函数式编程（三）_函数高级（六）_控制抽象（一）参数</span><br><span class="line"><span class="number">067</span>_尚硅谷<span class="variable">_Scala_</span>函数式编程（三）_函数高级（六）_控制抽象（二）_传名参数</span><br><span class="line"><span class="number">068</span>_尚硅谷<span class="variable">_Scala_</span>函数式编程（三）_函数高级（六）_控制抽象（三）_自定义<span class="keyword">While</span>循环</span><br><span class="line"><span class="number">069</span>_尚硅谷<span class="variable">_Scala_</span>函数式编程（三）_函数高级（七）_惰性加载</span><br><span class="line"><span class="number">070</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（一）_包（一）_声明和访问</span><br><span class="line"><span class="number">071</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（一）_包（二）_包对象</span><br><span class="line"><span class="number">072</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（一）_包（三）_导包说明</span><br><span class="line"><span class="number">073</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（二）_类和对象</span><br><span class="line"><span class="number">074</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（三）_封装（一）_访问权限</span><br><span class="line"><span class="number">075</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（三）_封装（二）_构造器</span><br><span class="line"><span class="number">076</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（三）_封装（三）_构造器参数</span><br><span class="line"><span class="number">077</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（四）_继承</span><br><span class="line"><span class="number">078</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（五）_多态</span><br><span class="line"><span class="number">080</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（六）_抽象类（二）_匿名子类</span><br><span class="line"><span class="number">082</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（七）_伴生对象（二）_单例设计模式</span><br><span class="line"><span class="number">084</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（八）_特质（二）_特质的混入</span><br><span class="line"><span class="number">085</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（八）_特质（三）_特质的叠加</span><br><span class="line"><span class="number">087</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（八）_特质（五）_特质和抽象类的区别</span><br><span class="line"><span class="number">088</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（八）_特质（六）_自身类型</span><br><span class="line"><span class="number">089</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（九）_扩展内容（一）_类型检测和转换</span><br><span class="line"><span class="number">090</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（九）_扩展内容（二）_枚举类和应用类</span><br></pre></td></tr></table></figure>
<h2 id="3-所学内容概述-8">3.所学内容概述</h2>
<p>函数基础</p>
<p>函数高级</p>
<h2 id="4-根据概述分章节描述-6">4.根据概述分章节描述</h2>
<h3 id="函数基础">函数基础</h3>
<h4 id="面向对象编程和函数式编程的区别">面向对象编程和函数式编程的区别</h4>
<p><code>面向对象编程：解决问题，分解对象，属性，行为，然后通过对象的关系以及行为的调用来解决问题。</code></p>
<p>Scala语言是一个完全面向对象编程语言。万物皆对象，比Java还有过之。对象的本质就是对数据和行为的封装</p>
<p><code>函数式编程:将问题分解成步骤，将步骤封装，调用封装好的步骤解决问题 </code></p>
<p>Scala 语言是一个完全函数式编程语言。万物皆函数。函数的本质：函数可以当做一个值进行传递</p>
<p><strong>自己的使用体验来讲，Scala运行速度和python差不多，比Java慢了很多，Scala编译很慢，效率不高，可能函数式编程运行速度都很慢吧</strong></p>
<h4 id="函数基本语法">函数基本语法</h4>
<p>在main里面的是函数，在main外面的是方法</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printTest</span></span>(x:<span class="type">String</span>) : <span class="type">String</span> = &#123;</span><br><span class="line">    println(<span class="string">&quot;hi&quot;</span>+x)</span><br><span class="line">    x</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//打印里面的值 并返回</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220718090955061.png" alt="image-20220718090955061"></p>
<p>Scala函数参数和返回值的几种情况</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">// 函数 1：无参，无返回值</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test1</span></span>(): <span class="type">Unit</span> =&#123;</span><br><span class="line">      println(<span class="string">&quot;无参，无返回值&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    println(test1())</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 函数 2：无参，有返回值</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test2</span></span>():<span class="type">String</span>=&#123;</span><br><span class="line">      <span class="string">&quot;无参，有返回值&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    println(test2())</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 函数 3：有参，无返回值</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test3</span></span>(s:<span class="type">String</span>):<span class="type">Unit</span>=&#123;</span><br><span class="line">      println(s)</span><br><span class="line">    &#125;</span><br><span class="line">    test3(<span class="string">&quot;jingling&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 函数 4：有参，有返回值</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test4</span></span>(s:<span class="type">String</span>):<span class="type">String</span>=&#123;</span><br><span class="line">      s+<span class="string">&quot;有参，有返回值&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    println(test4(<span class="string">&quot;hello &quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 函数 5：多参，无返回值</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test5</span></span>(name:<span class="type">String</span>, age:<span class="type">Int</span>):<span class="type">Unit</span>=&#123;</span><br><span class="line">      println(<span class="string">s&quot;我叫<span class="subst">$&#123;name&#125;</span>, 我的年龄是<span class="subst">$&#123;age&#125;</span>岁&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    println(test5(<span class="string">&quot;dealing&quot;</span>,<span class="number">40</span>))</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>函数的特殊情况</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">  <span class="comment">// （1）可变参数</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">test</span></span>( s : <span class="type">String</span>* ): <span class="type">Unit</span> = &#123;</span><br><span class="line">    println(s)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 有输入参数：输出 Array</span></span><br><span class="line">  test(<span class="string">&quot;Hello&quot;</span>, <span class="string">&quot;Scala&quot;</span>)</span><br><span class="line">  <span class="comment">// 无输入参数：输出 List()</span></span><br><span class="line">  test()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// (2)如果参数列表中存在多个参数，那么可变参数一般放置在最后</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">test2</span></span>( name : <span class="type">String</span>, s: <span class="type">String</span>* ): <span class="type">Unit</span> = &#123;</span><br><span class="line">    println(name + <span class="string">&quot;,&quot;</span> + s)</span><br><span class="line">  &#125;</span><br><span class="line">  test2(<span class="string">&quot;jinlian&quot;</span>, <span class="string">&quot;dalang&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// (3)参数默认值</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">test3</span></span>( name : <span class="type">String</span>, age : <span class="type">Int</span> = <span class="number">30</span> ): <span class="type">Unit</span> = &#123;</span><br><span class="line">    println(<span class="string">s&quot;<span class="subst">$name</span>, <span class="subst">$age</span>&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 如果参数传递了值，那么会覆盖默认值</span></span><br><span class="line">  test3(<span class="string">&quot;jinlian&quot;</span>, <span class="number">20</span>)</span><br><span class="line">  <span class="comment">// 如果参数有默认值，在调用的时候，可以省略这个参数</span></span><br><span class="line">  test3(<span class="string">&quot;dalang&quot;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 一般情况下，将有默认值的参数放置在参数列表的后面</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">test4</span></span>( sex : <span class="type">String</span> = <span class="string">&quot;男&quot;</span>, name : <span class="type">String</span> ): <span class="type">Unit</span> = &#123;</span><br><span class="line">    println(<span class="string">s&quot;<span class="subst">$name</span>, <span class="subst">$sex</span>&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Scala 函数中参数传递是，从左到右</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">//（4）带名参数</span></span><br><span class="line">  test4(name=<span class="string">&quot;ximenqing&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Scala代码的简化</p>
<p>能简则简，可读性会差很多！</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">  <span class="comment">// （0）函数标准写法</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">f</span></span>( s : <span class="type">String</span> ): <span class="type">String</span> = &#123;</span><br><span class="line">    <span class="keyword">return</span> s + <span class="string">&quot; jinlian&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">  println(f(<span class="string">&quot;Hello&quot;</span>))</span><br><span class="line">  <span class="comment">// 至简原则:能省则省</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//（1） return 可以省略,Scala 会使用函数体的最后一行代码作为返回值</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">f1</span></span>( s : <span class="type">String</span> ): <span class="type">String</span> = &#123;</span><br><span class="line">    s + <span class="string">&quot; jinlian&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">  println(f1(<span class="string">&quot;Hello&quot;</span>))</span><br><span class="line"></span><br><span class="line">  <span class="comment">//（2）如果函数体只有一行代码，可以省略花括号</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">f2</span></span>(s:<span class="type">String</span>):<span class="type">String</span> = s + <span class="string">&quot; jinlian&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//（3）返回值类型如果能够推断出来，那么可以省略（:和返回值类型一起 省略）</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">f3</span></span>( s : <span class="type">String</span> ) = s + <span class="string">&quot; jinlian&quot;</span></span><br><span class="line">  println(f3(<span class="string">&quot;Hello3&quot;</span>))</span><br><span class="line"></span><br><span class="line">  <span class="comment">//（4）如果有 return，则不能省略返回值类型，必须指定。</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">f4</span></span>() :<span class="type">String</span> = &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ximenqing4&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">  println(f4())</span><br><span class="line"></span><br><span class="line">  <span class="comment">//（5）如果函数明确声明 unit，那么即使函数体中使用 return 关键字也 不起作用</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">f5</span></span>(): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;dalang5&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">  println(f5())</span><br><span class="line"></span><br><span class="line">  <span class="comment">//（6）Scala 如果期望是无返回值类型,可以省略等号</span></span><br><span class="line">  <span class="comment">// 将无返回值的函数称之为过程</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">f6</span></span>() &#123;</span><br><span class="line">    <span class="string">&quot;dalang6&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  println(f6())</span><br><span class="line">  <span class="comment">//（7）如果函数无参，但是声明了参数列表，那么调用时，小括号，可加可 不加</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">f7</span></span>() = <span class="string">&quot;dalang7&quot;</span></span><br><span class="line">  println(f7())</span><br><span class="line">  println(f7)</span><br><span class="line"></span><br><span class="line">  <span class="comment">//（8）如果函数没有参数列表，那么小括号可以省略,调用时小括号必须省 略</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">f8</span> </span>= <span class="string">&quot;dalang&quot;</span></span><br><span class="line">  <span class="comment">//println(f8())</span></span><br><span class="line">  println(f8)</span><br><span class="line"></span><br><span class="line">  <span class="comment">//（9）如果不关心名称，只关心逻辑处理，那么函数名（def）可以省略 和Java的lambda相似</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">f9</span> </span>= (x:<span class="type">String</span>)=&gt;&#123;println(<span class="string">&quot;wusong&quot;</span>)&#125;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">f10</span></span>(f:<span class="type">String</span>=&gt;<span class="type">Unit</span>) = &#123;</span><br><span class="line">    f(<span class="string">&quot;&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  f10(f9)</span><br><span class="line">  println(f10((x:<span class="type">String</span>)=&gt;&#123;println(<span class="string">&quot;wusong&quot;</span>)&#125;))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="函数高级">函数高级</h3>
<p>函数的高阶用法 我认为可读性极差极差！</p>
<h4 id="函数作为值传递">函数作为值传递</h4>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">//（1）调用 foo 函数，把返回值给变量 f</span></span><br><span class="line">  <span class="comment">//val f = foo()</span></span><br><span class="line">  <span class="keyword">val</span> f = foo</span><br><span class="line">  println(f)</span><br><span class="line">  <span class="comment">//（2）在被调用函数 foo 后面加上 _，相当于把函数 foo 当成一个整体， 传递给变量 f1</span></span><br><span class="line">  <span class="keyword">val</span> f1 = foo _</span><br><span class="line">  foo()</span><br><span class="line">  f1()</span><br><span class="line">  <span class="comment">//（3）如果明确变量类型，那么不使用下划线也可以将函数作为整体传递给 变量</span></span><br><span class="line">  <span class="keyword">var</span> f2:()=&gt;<span class="type">Int</span> = foo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span></span>():<span class="type">Int</span> = &#123;</span><br><span class="line">  println(<span class="string">&quot;foo...&quot;</span>)</span><br><span class="line">  <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>函数也可以作为函数传递</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// （1）定义一个函数，函数参数还是一个函数签名；f 表示函数名称;(Int,Int)表示输入两个 Int 参数；Int 表示函数返回值</span></span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">f1</span></span>(f: (<span class="type">Int</span>, <span class="type">Int</span>) =&gt; <span class="type">Int</span>): <span class="type">Int</span> = &#123;</span><br><span class="line"> f(<span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="comment">// （2）定义一个函数，参数和返回值类型和 f1 的输入参数一致</span></span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">add</span></span>(a: <span class="type">Int</span>, b: <span class="type">Int</span>): <span class="type">Int</span> = a + b</span><br><span class="line"> </span><br><span class="line"> <span class="comment">// （3）将 add 函数作为参数传递给 f1 函数，如果能够推断出来不是调用，_可以省略</span></span><br><span class="line"> println(f1(add))</span><br><span class="line">println(f1(add _))</span><br><span class="line"><span class="comment">//可以传递匿名函数</span></span><br></pre></td></tr></table></figure>
<p>函数可以作为函数的返回值返回</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f1</span></span>() = &#123;</span><br><span class="line"> 	<span class="function"><span class="keyword">def</span> <span class="title">f2</span></span>() = &#123;</span><br><span class="line">        </span><br><span class="line">	&#125;</span><br><span class="line">f2 _</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">val</span> f = f1()</span><br><span class="line"><span class="comment">// 因为 f1 函数的返回值依然为函数，所以可以变量 f 可以作为函数继续调用</span></span><br><span class="line">f()</span><br><span class="line"><span class="comment">// 上面的代码可以简化为</span></span><br><span class="line">f1()()</span><br></pre></td></tr></table></figure>
<h4 id="匿名函数">匿名函数</h4>
<p>语法说明</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(x:<span class="type">Int</span>) =&gt; &#123;println&#123;<span class="string">&quot;....&quot;</span>&#125;&#125;</span><br><span class="line">x：表示输入参数类型；<span class="type">Int</span>：表示输入参数类型；函数体：表示具体代码逻辑</span><br></pre></td></tr></table></figure>
<p>匿名函数也可以至简</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（<span class="number">1</span>）参数的类型可以省略，会根据形参进行自动的推导</span><br><span class="line">（<span class="number">2</span>）类型省略之后，发现只有一个参数，则圆括号可以省略；其他情况：没有参数和参数超过 <span class="number">1</span> 的永远不能省略圆括号。 （<span class="number">3</span>）匿名函数如果只有一行，则大括号也可以省略</span><br><span class="line">（<span class="number">4</span>）如果参数只出现一次，则参数省略且后面参数可以用<span class="literal">_</span>代替</span><br></pre></td></tr></table></figure>
<p>代码实现 简化一个形参匿名函数</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">// （1）定义一个函数：参数包含数据和逻辑函数</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">operation</span></span>(arr: <span class="type">Array</span>[<span class="type">Int</span>], op: <span class="type">Int</span> =&gt; <span class="type">Int</span>) = &#123;</span><br><span class="line">      <span class="keyword">for</span> (elem &lt;- arr) <span class="keyword">yield</span> op(elem)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// （2）定义逻辑函数</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">op</span></span>(ele: <span class="type">Int</span>): <span class="type">Int</span> = &#123;</span><br><span class="line">      ele + <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// （3）标准函数调用</span></span><br><span class="line">    <span class="keyword">val</span> arr = operation(<span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>), op)</span><br><span class="line">    println(arr.mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    <span class="comment">// （4）采用匿名函数</span></span><br><span class="line">    <span class="keyword">val</span> arr1 = operation(<span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>), (ele: <span class="type">Int</span>) =&gt; &#123;</span><br><span class="line">      ele + <span class="number">1</span></span><br><span class="line">    &#125;)</span><br><span class="line">    println(arr1.mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    <span class="comment">// （4.1）参数的类型可以省略，会根据形参进行自动的推导;</span></span><br><span class="line">    <span class="keyword">val</span> arr2 = operation(<span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>), (ele) =&gt; &#123;</span><br><span class="line">      ele + <span class="number">1</span></span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    println(arr2.mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// （4.2）类型省略之后，发现只有一个参数，则圆括号可以省略；其他情 况：没有参数和参数超过 1 的永远不能省略圆括号。</span></span><br><span class="line">    <span class="keyword">val</span> arr3 = operation(<span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>), ele =&gt; &#123;</span><br><span class="line">      ele + <span class="number">1</span></span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    println(arr3.mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    <span class="comment">// (4.3) 匿名函数如果只有一行，则大括号也可以省略</span></span><br><span class="line">    <span class="keyword">val</span> arr4 = operation(<span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>), ele =&gt; ele + <span class="number">1</span>)</span><br><span class="line">    println(arr4.mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    <span class="comment">//（4.4）如果参数只出现一次，则参数省略且后面参数可以用_代替</span></span><br><span class="line">    <span class="keyword">val</span> arr5 = operation(<span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>), _ + <span class="number">1</span>)</span><br><span class="line">    println(arr5.mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>如果有多个参数</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">calculator</span></span>(a: <span class="type">Int</span>, b: <span class="type">Int</span>, op: (<span class="type">Int</span>, <span class="type">Int</span>) =&gt; <span class="type">Int</span>): <span class="type">Int</span> = &#123;</span><br><span class="line">     op(a, b)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">// （1）标准版</span></span><br><span class="line"> println(calculator(<span class="number">2</span>, <span class="number">3</span>, (x: <span class="type">Int</span>, y: <span class="type">Int</span>) =&gt; &#123;x + y&#125;))</span><br><span class="line"> <span class="comment">// （2）如果只有一行，则大括号也可以省略</span></span><br><span class="line"> println(calculator(<span class="number">2</span>, <span class="number">3</span>, (x: <span class="type">Int</span>, y: <span class="type">Int</span>) =&gt; x + y))</span><br><span class="line"> <span class="comment">// （3）参数的类型可以省略，会根据形参进行自动的推导;</span></span><br><span class="line"> println(calculator(<span class="number">2</span>, <span class="number">3</span>, (x , y) =&gt; x + y))</span><br><span class="line"> <span class="comment">// （4）如果参数只出现一次，则参数省略且后面参数可以用_代替</span></span><br><span class="line"> println(calculator(<span class="number">2</span>, <span class="number">3</span>, _ + _))</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h4 id="函数柯里化和闭包">函数柯里化和闭包</h4>
<p>闭包：如果一个函数，访问到了它的外部（局部）变量的值，那么这个函数和他所处的环境，称为闭包</p>
<p>柯里化的写法和 闭包的调用很像，建议：闭包都用柯里化写</p>
<p><strong>闭包就是本质就是一个函数，只不过使用了外部变量作为返回值的函数，只是语法如果使用柯里化，可读性不一样</strong></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span></span>(a:<span class="type">Int</span>,b:<span class="type">Int</span>)  = a+ b <span class="comment">//实用性差 每次调用都需要输入a</span></span><br><span class="line">    <span class="comment">//可以先将A定义成一个其他变量 然后调用内部的B</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addByA</span></span>(a:<span class="type">Int</span>) : <span class="type">Int</span> =&gt; <span class="type">Int</span> = &#123;</span><br><span class="line">      <span class="function"><span class="keyword">def</span> <span class="title">addByB</span></span>(b:<span class="type">Int</span>) = a + b</span><br><span class="line">      addByB</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    println(add(<span class="number">5</span>,<span class="number">8</span>))</span><br><span class="line">    println(addByA(<span class="number">5</span>)(<span class="number">8</span>))</span><br><span class="line">    <span class="keyword">val</span> addByFive = addByA(<span class="number">5</span>) <span class="comment">//封装成addByFive常量</span></span><br><span class="line">    println(addByFive(<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">//    lambda简写</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addByA1</span></span>(a:<span class="type">Int</span>) : <span class="type">Int</span> =&gt; <span class="type">Int</span> =  a + _</span><br><span class="line">    println(addByA1(<span class="number">3</span>)(<span class="number">4</span>))</span><br><span class="line">    </span><br><span class="line">        <span class="comment">//5.柯里化</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addCurrying</span></span>(a:<span class="type">Int</span>)(b:<span class="type">Int</span>) = a + b</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> addByFour = addCurrying(<span class="number">5</span>)(<span class="number">53</span>)</span><br><span class="line">    println(addByFour)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h4 id="递归-阶乘">递归 阶乘</h4>
<p>就和Java递归是差不多的，无非是方法的格式不一样</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">  println(test(<span class="number">5</span>))</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span></span>(i : <span class="type">Int</span>):<span class="type">Int</span> = &#123;</span><br><span class="line">  <span class="keyword">if</span> (i == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  test(i - <span class="number">1</span>) * i</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="控制抽象">控制抽象</h4>
<p>分两种 值传递和名传递</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1. 传值参数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f0</span></span>(a:<span class="type">Int</span>): <span class="type">Unit</span> = &#123;</span><br><span class="line">  println(<span class="string">&quot;a: &quot;</span> + a)</span><br><span class="line">  println(<span class="string">&quot;a: &quot;</span> + a)</span><br><span class="line">&#125;</span><br><span class="line">f0(<span class="number">23</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f1</span></span>():<span class="type">Int</span> = &#123;</span><br><span class="line">  println(<span class="string">&quot;f1调用&quot;</span>)</span><br><span class="line">  <span class="number">12</span></span><br><span class="line">&#125;</span><br><span class="line">f0(f1())</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.传名参数 传递不再是具体的值，而是代码块</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f2</span></span>(a: =&gt; <span class="type">Int</span>): <span class="type">Unit</span> = &#123;</span><br><span class="line">  println(<span class="string">&quot;a: &quot;</span> + a)</span><br><span class="line">  println(<span class="string">&quot;a: &quot;</span> + a)</span><br><span class="line">&#125;</span><br><span class="line">f2(<span class="number">23</span>)</span><br><span class="line">f2(f1())</span><br></pre></td></tr></table></figure>
<h4 id="惰性加载">惰性加载</h4>
<p>当<strong>函数返回值被声明为</strong> <strong>lazy</strong> <strong>时</strong>，函数的<strong>执行将被推迟</strong>，直到我们第一次对此取值，该函数才会执行。这种函数我们称之为惰性函数。</p>
<p>应用点我觉得像线程的时候，会用得到，使用该方法(函数)，线程执行。和线程的堵塞和锁有点类似。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">  <span class="keyword">lazy</span> <span class="keyword">val</span> res = sum(<span class="number">10</span>,<span class="number">30</span>)</span><br><span class="line">  println(<span class="string">&quot;1，函数调用&quot;</span>)</span><br><span class="line">  println(<span class="string">&quot;2.res = &quot;</span> + res)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum</span></span>(i: <span class="type">Int</span>, i1: <span class="type">Int</span>):<span class="type">Int</span> = &#123;</span><br><span class="line">  println(<span class="string">&quot;3.sum 被执行。。。&quot;</span>)</span><br><span class="line">  i + i1</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//运行结果</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1，函数调用</span></span><br><span class="line"><span class="comment">3.sum 被执行。。。</span></span><br><span class="line"><span class="comment">2.res = 40</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h2 id="6-扩展学习部分-3">6.扩展学习部分</h2>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">定义一个函数 <span class="keyword">func</span>，它接收一个 <span class="title function_">Int</span> 类型的参数，返回一个函数（记作 <span class="title function_">f1</span>）。它返回的函数 <span class="title function_">f1</span>，接收一个 <span class="title function_">String</span> 类型的参数，同样返回一个函数（记作 <span class="title function_">f2</span>）。函数 <span class="title function_">f2</span> 接收一个 <span class="title function_">Char</span> 类型的参数，返回一个 <span class="title function_">Boolean</span> 的值。</span><br><span class="line">要求调用函数 <span class="keyword">func</span><span class="params">(<span class="number">0</span>)</span> <span class="params">(“”)</span> <span class="params">(‘<span class="number">0</span>’)</span>得到返回值为 <span class="title function_">false</span>，其它情况均返回 <span class="title function_">true</span>。</span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span></span>(int: <span class="type">Int</span>)= &#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">f1</span></span>(string: <span class="type">String</span>) = &#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f2</span></span>(char: <span class="type">Char</span>)  = &#123;</span><br><span class="line">      <span class="keyword">if</span> (int == <span class="number">0</span> &amp;&amp; string == <span class="string">&quot;&quot;</span> &amp;&amp; char == &#x27;<span class="number">0</span>&#x27;) <span class="literal">false</span> <span class="keyword">else</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    f2 _</span><br><span class="line">  &#125;</span><br><span class="line">  f1 _</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>全匿名函数实现</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func1</span></span>(x: <span class="type">Int</span>):<span class="type">String</span> =&gt; <span class="type">Char</span> =&gt; <span class="type">Boolean</span>= &#123;</span><br><span class="line">  y =&gt; z :  =&gt; &#123;<span class="keyword">if</span> (x == <span class="number">0</span> &amp;&amp; y == <span class="string">&quot;&quot;</span> &amp;&amp; z == &#x27;<span class="number">0</span>&#x27;) <span class="literal">false</span> <span class="keyword">else</span> <span class="literal">true</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="7-总结-4">7.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>今天是学习任务是Scala的函数式和部分面向对象，以及对未来大数据比赛的规划。Scala的函数式编程是它的特点，他和Java最大的区别，Scala不仅是函数式编程也是面向对象编程，而且比Java更面向对象，Java8更新的lambda就是借鉴Scala的函数式的。函数式会非常非常简洁，像六七行很长的代码，能缩的很短，而且比java的lambda更短，比python也要短，但是自己简化完，自己都不知道写的什么，可读性就很一言难尽。学习难度是一般，就是代码解读和后面的闭包不是很好掌握，重点还是函数式的简化吧，大部分都是在讲这个，今天状态很佳。</p>
<h1 id="7-19-Scala面向对象">7.19 Scala面向对象</h1>
<h2 id="1-头：日期、所学内容出处-9">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Xh411S7bP?p=79&amp;share_source=copy_web&amp;vd_source=c8ae4150b2286ee39a13a79bbe12b843">https://www.bilibili.com/video/BV1Xh411S7bP?p=79&amp;share_source=copy_web&amp;vd_source=c8ae4150b2286ee39a13a79bbe12b843</a></p>
<h2 id="2-标题-9">2.标题</h2>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">070</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（一）_包（一）_声明和访问</span><br><span class="line"><span class="number">071</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（一）_包（二）_包对象</span><br><span class="line"><span class="number">072</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（一）_包（三）_导包说明</span><br><span class="line"><span class="number">073</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（二）_类和对象</span><br><span class="line"><span class="number">074</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（三）_封装（一）_访问权限</span><br><span class="line"><span class="number">075</span>_尚硅谷<span class="variable">_Scala_</span>面向对象（三）_封装（二）_构造器</span><br><span class="line">|</span><br><span class="line">|</span><br><span class="line">|</span><br><span class="line"><span class="number">106</span>_尚硅谷<span class="variable">_Scala_</span>集合（三）_列表（二）_可变列表</span><br><span class="line"><span class="number">107</span>_尚硅谷<span class="variable">_Scala_</span>集合（四）<span class="variable">_Set</span>集合（一）_不可变<span class="built_in">Set</span></span><br><span class="line"><span class="number">108</span>_尚硅谷<span class="variable">_Scala_</span>集合（四）<span class="variable">_Set</span>集合（二）_可变<span class="built_in">Set</span></span><br><span class="line"><span class="number">109</span>_尚硅谷<span class="variable">_Scala_</span>集合（五）<span class="variable">_Map</span>集合（一）_不可变Map</span><br><span class="line"><span class="number">110</span>_尚硅谷<span class="variable">_Scala_</span>集合（五）<span class="variable">_Map</span>集合（二）_可变Map</span><br><span class="line"><span class="number">111</span>_尚硅谷<span class="variable">_Scala_</span>集合（六）_元组</span><br></pre></td></tr></table></figure>
<h2 id="3-所学内容概述-9">3.所学内容概述</h2>
<h3 id="类和对象">类和对象</h3>
<h3 id="封装">封装</h3>
<h4 id="继承和多态">继承和多态</h4>
<h2 id="4-根据概述分章节描述-7">4.根据概述分章节描述</h2>
<h3 id="类和对象-2">类和对象</h3>
<p>定义属性语法</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">var</span> name : <span class="type">String</span> = <span class="string">&quot;alice&quot;</span></span><br><span class="line"><span class="keyword">var</span> age : <span class="type">Int</span> = <span class="number">18</span></span><br><span class="line"><span class="meta">@BeanProperty</span>   <span class="comment">//自动生成get和set的属性方法 是标签</span></span><br><span class="line"><span class="keyword">var</span> sex : <span class="type">String</span> = _</span><br></pre></td></tr></table></figure>
<h4 id="封装-2">封装</h4>
<p>Scala默认权限是public 但是Scala没有public关键字</p>
<p>protected 为受保护权限，Scala 中受保护权限比 Java 中更严格，同类、子类可以访问，同包无法访问。</p>
<p>private[包名]增加包访问权限，包名下的其他类也可以使用 <code>不加包名就是私有的只能在类的内部和伴生对象中使用</code></p>
<h5 id="构造器">构造器</h5>
<p>和Java区别有点大，主构造器是不用声明的。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">类名</span>(<span class="params">形参列表</span>) </span>&#123; <span class="comment">// 主构造器</span></span><br><span class="line"> <span class="comment">// 类体</span></span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">this</span></span>(形参列表) &#123; <span class="comment">// 辅助构造器</span></span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">this</span></span>(形参列表) &#123; <span class="comment">//辅助构造器可以有多个...</span></span><br><span class="line"> &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="继承和多态-2">继承和多态</h4>
<p>语法和Java一样</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>子类会继承父类的属性和方法 同样都是单继承(一个子类只能有一个父类)</p>
<p>继承的调用顺序：父类构造器-&gt;子类构造器</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(<span class="params">nameParam: <span class="type">String</span></span>) </span>&#123;</span><br><span class="line"> <span class="keyword">var</span> name = nameParam</span><br><span class="line"> <span class="keyword">var</span> age: <span class="type">Int</span> = _</span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">this</span></span>(nameParam: <span class="type">String</span>, ageParam: <span class="type">Int</span>) &#123;</span><br><span class="line"> <span class="keyword">this</span>(nameParam)</span><br><span class="line"> <span class="keyword">this</span>.age = ageParam</span><br><span class="line"> println(<span class="string">&quot;父类辅助构造器&quot;</span>)</span><br><span class="line"> &#125;</span><br><span class="line"> println(<span class="string">&quot;父类主构造器&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Emp</span>(<span class="params">nameParam: <span class="type">String</span>, ageParam: <span class="type">Int</span></span>) <span class="keyword">extends</span> </span></span><br><span class="line"><span class="type">Person</span>(nameParam, ageParam) &#123;</span><br><span class="line"> <span class="keyword">var</span> empNo: <span class="type">Int</span> = _</span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">this</span></span>(nameParam: <span class="type">String</span>, ageParam: <span class="type">Int</span>, empNoParam: <span class="type">Int</span>) &#123;</span><br><span class="line"> <span class="keyword">this</span>(nameParam, ageParam)</span><br><span class="line"> <span class="keyword">this</span>.empNo = empNoParam</span><br><span class="line"> println(<span class="string">&quot;子类的辅助构造器&quot;</span>)</span><br><span class="line"> &#125;</span><br><span class="line">   println(<span class="string">&quot;子类主构造器&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line"> <span class="keyword">new</span> <span class="type">Emp</span>(<span class="string">&quot;z3&quot;</span>, <span class="number">11</span>,<span class="number">1001</span>)</span><br><span class="line"> &#125; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>上面案例的运行结果是</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220719105724978.png" alt="image-20220719105724978"></p>
<p>验证了继承，创建对象先调用父类的构造器</p>
<h5 id="多态">多态</h5>
<p>动态绑定</p>
<p><code>Scala 中属性和方法都是动态绑定，而 Java 中只有方法为动态绑定。</code></p>
<p>自己写了一个Java一个Scala的代码验证</p>
<p>Java多态代码如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DynamicBind</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">PersonByJava</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PersonByJava</span>();</span><br><span class="line">        System.out.println(person.name);</span><br><span class="line">        person.hello();</span><br><span class="line"></span><br><span class="line">        <span class="type">PersonByJava</span> <span class="variable">studentByJava</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StudentByJava</span>();</span><br><span class="line">        System.out.println(studentByJava.name);</span><br><span class="line">        studentByJava.hello();</span><br><span class="line"></span><br><span class="line">        <span class="type">StudentByJava</span> <span class="variable">studentByJava1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StudentByJava</span>();</span><br><span class="line">        System.out.println(studentByJava1.name);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PersonByJava</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;person&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hello</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hello person&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">StudentByJava</span> <span class="keyword">extends</span> <span class="title class_">PersonByJava</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;student&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hello</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hello student&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hi</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hi student&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Scala多态代码</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test08_DynamicBind</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> student: <span class="type">Person8</span> = <span class="keyword">new</span> <span class="type">Student8</span></span><br><span class="line">    println(student.name)</span><br><span class="line">    student.hello()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person8</span></span>&#123;</span><br><span class="line">  <span class="keyword">val</span> name : <span class="type">String</span> = <span class="string">&quot;person&quot;</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">hello</span></span>(): <span class="type">Unit</span> =&#123;</span><br><span class="line">    println(<span class="string">&quot;hello person&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student8</span> <span class="keyword">extends</span> <span class="title">Person8</span></span>&#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="keyword">val</span> name : <span class="type">String</span> = <span class="string">&quot;student&quot;</span></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">hello</span></span>(): <span class="type">Unit</span> =&#123;</span><br><span class="line">    println(<span class="string">&quot;hello student&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220719110732747.png" alt="image-20220719110732747"></p>
<p>可见Scala的动态绑定更为的完善，Java是没有属性绑定的，Scala有。</p>
<h4 id="重写">重写</h4>
<p>Scala重写父类的属性和方法的时候，除了类型和名称一样(和java一样)，还要在属性和方法前面加上oberride修饰</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student8</span> <span class="keyword">extends</span> <span class="title">Person8</span></span>&#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="keyword">val</span> name : <span class="type">String</span> = <span class="string">&quot;student&quot;</span></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">hello</span></span>(): <span class="type">Unit</span> =&#123;</span><br><span class="line">    println(<span class="string">&quot;hello student&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样的好处显而易见，更为清楚明了的 告知该方法或者属性是父类重写的。</p>
<h4 id="抽象类">抽象类</h4>
<p>Scala和Java一模一样，声明方法也差不多</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test09_abstract</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> teacher = <span class="keyword">new</span> <span class="type">Teacher9</span>()</span><br><span class="line">    teacher.hello9()</span><br><span class="line">    println(teacher.name)</span><br><span class="line">    <span class="comment">// 匿名子类  和 Java 一样，可以通过包含带有定义或重写的代码块的方式创建一个匿名的子类。</span></span><br><span class="line">    <span class="keyword">val</span> workers = <span class="keyword">new</span> <span class="type">Person9</span> &#123;</span><br><span class="line">      <span class="keyword">override</span> <span class="keyword">val</span> name: <span class="type">String</span> = <span class="string">&quot;workers&quot;</span></span><br><span class="line">      <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">hello9</span></span>(): <span class="type">Unit</span> = println(<span class="string">&quot;hello worker&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    workers.hello9()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//abstract 声明</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Person9</span></span>&#123;</span><br><span class="line">  <span class="keyword">val</span> name: <span class="type">String</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">hello9</span></span>() : <span class="type">Unit</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Teacher9</span> <span class="keyword">extends</span> <span class="title">Person9</span></span>&#123; <span class="comment">//继承抽象类 要重写方法 如果不重写就可以不加override</span></span><br><span class="line">  <span class="keyword">override</span> <span class="keyword">val</span> name: <span class="type">String</span> = <span class="string">&quot;teacher&quot;</span></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">hello9</span></span>(): <span class="type">Unit</span> = println(<span class="string">&quot;hello 9 abstract and teacher&quot;</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="伴生对象">伴生对象</h4>
<p>伴生对象是Scala所独有的，可以通过伴生对象设计单例设计模式 懒汉式和饿汉式</p>
<p>基础伴生对象使用，将主构造器设计为私有，通过伴生类去调用 推荐使用apply 可以省略方法名 直接创建(和python创建对象一样了就)</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test10_Object</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//（3）伴生对象中的属性和方法都可以通过伴生对象名（类名）直接调用访问。</span></span><br><span class="line"><span class="comment">//    val student = new Person10(&quot;alice&quot;,18)</span></span><br><span class="line"><span class="comment">//    student.printInfo()</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> person2 = <span class="type">Person10</span>.newPerson10(<span class="string">&quot;alice&quot;</span>,<span class="number">18</span>)</span><br><span class="line">    person2.printInfo()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> person3 = <span class="type">Person10</span>.apply(<span class="string">&quot;bob&quot;</span>,<span class="number">29</span>) <span class="comment">//使用apply方法</span></span><br><span class="line">    person3.printInfo()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> person4 = <span class="type">Person10</span>(<span class="string">&quot;akko&quot;</span>,<span class="number">35</span>) <span class="comment">// apply可以省略</span></span><br><span class="line">    person4.printInfo()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//（1）伴生对象采用 object 关键字声明</span></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Person10</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">newPerson10</span></span>(name:<span class="type">String</span>,age:<span class="type">Int</span>): <span class="type">Person10</span> = <span class="keyword">new</span> <span class="type">Person10</span>(name,age)</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(name:<span class="type">String</span>,age:<span class="type">Int</span>): <span class="type">Person10</span> = <span class="keyword">new</span> <span class="type">Person10</span>(name,age)  <span class="comment">//apply写方法去调用构造器</span></span><br><span class="line">  <span class="comment">//相当于静态存在</span></span><br><span class="line">  <span class="keyword">var</span> school: <span class="type">String</span> = <span class="string">&quot;ZhongCe&quot;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//（2）伴生对象对应的类称之为伴生类，伴生对象的名称应该和伴生类名一致。</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person10</span> <span class="title">private</span>(<span class="params">val name : <span class="type">String</span>,val age : <span class="type">Int</span></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">printInfo</span></span>(): <span class="type">Unit</span> =&#123;</span><br><span class="line">    println(<span class="string">s&quot;student: name = <span class="subst">$name</span> ,age = <span class="subst">$age</span> , school = <span class="subst">$&#123;Person10.school&#125;</span>&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="特质">特质</h4>
<p>Scala 语言中，采用特质 trait（特征）来代替接口的概念，也就是说，多个类具有相同的特质时，就可以将这个特质（独立出来，采用关键字 trait 声明。可写可不写 。<code>与接口不同的是，它还可以定义属性和方法的实现。</code></p>
<p>我认为和java里一样，是因为都是单继承语言，然后通过这样的方式，对单继承机制的补充 <code>单继承多实现</code></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test12_Trait</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> student12: <span class="type">Student12</span>= <span class="keyword">new</span> <span class="type">Student12</span></span><br><span class="line">    student12.sysHello()</span><br><span class="line">    student12.study()</span><br><span class="line">    student12.dating()</span><br><span class="line">    student12.play()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义一个父类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person12</span></span>&#123;</span><br><span class="line">  <span class="keyword">val</span> name: <span class="type">String</span> = <span class="string">&quot;person&quot;</span></span><br><span class="line">  <span class="keyword">val</span> age: <span class="type">Int</span> = <span class="number">18</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">sysHello</span></span>(): <span class="type">Unit</span> =&#123;</span><br><span class="line">    println(<span class="string">&quot;hello from: &quot;</span> + name)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//特质</span></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Young</span></span>&#123;</span><br><span class="line">  <span class="comment">//定义抽象或者非抽象的属性和方法都可以</span></span><br><span class="line">  <span class="keyword">val</span> age: <span class="type">Int</span> <span class="comment">//抽象</span></span><br><span class="line">  <span class="keyword">val</span> name: <span class="type">String</span> = <span class="string">&quot;young&quot;</span> <span class="comment">//非抽象</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//抽象和非抽象方法</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">play</span></span>(): <span class="type">Unit</span> =&#123;</span><br><span class="line">    println(<span class="string">&quot;young people is playing&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">dating</span></span>():<span class="type">Unit</span> <span class="comment">//抽象</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义一个子类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student12</span> <span class="keyword">extends</span> <span class="title">Person12</span> <span class="keyword">with</span> <span class="title">Young</span> </span>&#123;</span><br><span class="line">  <span class="comment">//重写冲突的属性</span></span><br><span class="line">  <span class="keyword">override</span> <span class="keyword">val</span> name: <span class="type">String</span> = <span class="string">&quot;student&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="keyword">val</span> age: <span class="type">Int</span> = <span class="number">19</span></span><br><span class="line">  <span class="comment">//实现抽象方法</span></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">dating</span></span>(): <span class="type">Unit</span> = println(<span class="string">s&quot;student <span class="subst">$name</span> is dating&quot;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">study</span></span>(): <span class="type">Unit</span> = println(<span class="string">s&quot;student <span class="subst">$name</span> is study&quot;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">//重写父类方法</span></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">sysHello</span></span>(): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">super</span>.sysHello()</span><br><span class="line">    println(<span class="string">s&quot;hello from: student <span class="subst">$name</span>&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>特质混用</p>
<p>其实就是类似于Java中一个类实现多个接口一样的概念，Java中已有的接口都可以当作Scala的特质直接使用</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Teacher</span> <span class="keyword">extends</span> <span class="title">PersonTrait</span> <span class="keyword">with</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line"> <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">say</span></span>(): <span class="type">Unit</span> = &#123;</span><br><span class="line"> println(<span class="string">&quot;say&quot;</span>)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">override</span> <span class="keyword">var</span> age: <span class="type">Int</span> = _</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Teacher</span></span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Person</span></span>&#123;&#125;</span><br><span class="line"><span class="comment">//所谓动态混用就是一个类用两个特质</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">with</span> <span class="title">Teacher</span> <span class="keyword">with</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>特质和抽象类的使用场景</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.优先使用特质。一个类扩展多个特质是很方便的，但却只能扩展一个抽象类。</span><br><span class="line">2.如果你需要构造函数参数，使用抽象类。因为抽象类可以定义带参数的构造函数，而特质不行（有无参构造）。</span><br></pre></td></tr></table></figure>
<h2 id="5-BUG点-4">5. BUG点</h2>
<p>难点(关键代码或关键配置，BUG截图+解决方案)</p>
<p>类和对象代码打完，发现运行的时候，IDEA运行的界面都没了，后面检查，发现编译没错，那就是运行错误，看提示是类的原因，结果发现自己没写main类，无法运行，Scala的这点和Java是一样的。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://docimg3.docs.qq.com/image/o6Ax0mlG8JjME539efv5-Q.png?w=1822&amp;h=1013" alt="img"></p>
<p>看报错信息，是name的问题，检查了一遍代码发现了问题，特质中声明了name，父类person也声明了name。student子类又继承又实现，应该是运行的时候，不知道调用哪个，解决办法：子类自己重写方法，让name属性使用自己的。修改完又报错，翻译是age接口的问题，var要重写set和get方法，想想算了，就把var改成了val常量，正常运行了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220719170042441.png" alt="image-20220719170042441"></p>
<h2 id="6-扩展学习部分-4">6.扩展学习部分</h2>
<p>上面的第二个错误，我看弹幕也有很多人这样，就去搜了一次Scala特质这种冲突问题，发现是有解释和方法解决的。</p>
<p>由于一个类可以混入多个 trait，且 trait 中可以有具体的属性和方法，若混入的特质中具有相同的方法（方法名，参数列表，返回值均相同），必然会出现继承冲突问题。冲突分为以下两种：<code>继承的父类也算</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220719234527002.png" alt="image-20220719234527002"></p>
<p>我就是上图的第一种，并没有什么关联的，重写冲突方法或者属性就好了。</p>
<h3 id="特质叠加">特质叠加</h3>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220719235950669.png" alt="image-20220719235950669"></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Ball</span> </span>&#123;</span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">describe</span></span>(): <span class="type">String</span> = &#123;</span><br><span class="line"> <span class="string">&quot;ball&quot;</span></span><br><span class="line"> &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Color</span> <span class="keyword">extends</span> <span class="title">Ball</span> </span>&#123;</span><br><span class="line"> <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">describe</span></span>(): <span class="type">String</span> = &#123;</span><br><span class="line"> <span class="string">&quot;blue-&quot;</span> + <span class="keyword">super</span>.describe()</span><br><span class="line"> &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Category</span> <span class="keyword">extends</span> <span class="title">Ball</span> </span>&#123;</span><br><span class="line"> <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">describe</span></span>(): <span class="type">String</span> = &#123;</span><br><span class="line"> <span class="string">&quot;foot-&quot;</span> + <span class="keyword">super</span>.describe()</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyBall</span> <span class="keyword">extends</span> <span class="title">Category</span> <span class="keyword">with</span> <span class="title">Color</span> </span>&#123;</span><br><span class="line"> <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">describe</span></span>(): <span class="type">String</span> = &#123;</span><br><span class="line"> <span class="string">&quot;my ball is a &quot;</span> + <span class="keyword">super</span>.describe()</span><br><span class="line"> &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">TestTrait</span> </span>&#123;</span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line"> println(<span class="keyword">new</span> <span class="type">MyBall</span>().describe())</span><br><span class="line"> &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上图就是钻石问题了。运行结果：my ball is a blue-foot-ball</p>
<p><strong>MyClass</strong> <strong>中的</strong> <strong>super</strong> 指代Color,Color <strong>中的</strong> <strong>super</strong> <strong>指代</strong> **Category，**Category <strong>中的</strong> <strong>super</strong>指代 <strong>Ball</strong>。</p>
<p>那么叠加顺序就是</p>
<p>MyClass ----Color ----Category—Ball</p>
<h2 id="7-总结-5">7.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>今天Scala的学习内容是面向对象这块，也是学完了，前面的封装以及继承等和Java基本没有改动，只是优化了权限。抽象类也没变化，Scala面向对象的特别之处就是升级版的接口了，特质，这点也是比较重要的点，存在一定的难度。看文档没有很会，就又去看了一遍视频，结合文档，特质的基本使用已经掌握了，还有一些混用等，代码敲多了，掌握清除没什么问题，今天的学习状态和过程都不错， 明天进入集合和元组的学习，希望能保持今天的劲头。</p>
<h1 id="7-20-数组和集合">7.20 数组和集合</h1>
<h2 id="1-头：日期、所学内容出处-10">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web">https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web</a></p>
<h2 id="2-标题-10">2.标题</h2>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">P91</span><br><span class="line"><span class="number">091</span>_尚硅谷<span class="variable">_Scala_</span>集合（一）_集合类型系统</span><br><span class="line">P92</span><br><span class="line"><span class="number">092</span>_尚硅谷<span class="variable">_Scala_</span>集合（二）_数组（一）_不可变数组（一）_创建数组</span><br><span class="line">P93</span><br><span class="line"><span class="number">093</span>_尚硅谷<span class="variable">_Scala_</span>集合（二）_数组（一）_不可变数组（二）_访问和修改元素</span><br><span class="line">P94</span><br><span class="line"><span class="number">094</span>_尚硅谷<span class="variable">_Scala_</span>集合（二）_数组（一）_不可变数组（三）_遍历数组</span><br><span class="line">P95</span><br><span class="line"><span class="number">095</span>_尚硅谷<span class="variable">_Scala_</span>集合（二）_数组（一）_不可变数组（四）_添加元素</span><br><span class="line">|</span><br><span class="line">|</span><br><span class="line"><span class="number">141</span>_尚硅谷<span class="variable">_Scala_</span>泛型（一）_概念和意义</span><br><span class="line">P142</span><br><span class="line"><span class="number">142</span>_尚硅谷<span class="variable">_Scala_</span>泛型（二）_逆变和协变</span><br><span class="line">P143</span><br><span class="line"><span class="number">143</span>_尚硅谷<span class="variable">_Scala_</span>泛型（三）_上下限</span><br></pre></td></tr></table></figure>
<h2 id="3-所学内容概述-10">3.所学内容概述</h2>
<h3 id="Scasla集合简介">Scasla集合简介</h3>
<h4 id="数组">数组</h4>
<h5 id="列表">列表</h5>
<h5 id="set集合">set集合</h5>
<h5 id="Map集合">Map集合</h5>
<h5 id="元组">元组</h5>
<h5 id="常用函数-方法">常用函数 方法</h5>
<h5 id="队列">队列</h5>
<h5 id="并行集合">并行集合</h5>
<h5 id="模式匹配">模式匹配</h5>
<h5 id="异常处理">异常处理</h5>
<h2 id="4-根据概述分章节描述-8">4.根据概述分章节描述</h2>
<h3 id="Scala集合简介">Scala集合简介</h3>
<p>将Java三大集合照搬了，修改了List为Seq，但是List在Scala还存在</p>
<p>Scala 的集合有三大类：序列 Seq、集 Set、映射 Map，所有的集合都扩展自 Iterable特质。</p>
<p>对于几乎所有的集合类，Scala 都同时提供了<strong>可变</strong>和<strong>不可变</strong>的版本</p>
<p><code>Scala 不可变集合，就是指该集合对象不可修改，每次修改就会返回一个新对象</code></p>
<p><code>可变集合，就是这个集合可以直接对原对象进行修改，而不会返回新的对象。</code></p>
<h3 id="数组-2">数组</h3>
<p>可变和不可变都放下面的案例练习了</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> chapter03</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> scala.collection.mutable.<span class="type">ArrayBuffer</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test01_Array</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//不可变数组</span></span><br><span class="line">    <span class="keyword">val</span> arr01 = <span class="keyword">new</span> <span class="type">Array</span>[<span class="type">Int</span>](<span class="number">9</span>)</span><br><span class="line">    arr01.update(<span class="number">1</span>,<span class="number">4</span>) <span class="comment">//指定位置 添加元素 也可以修改</span></span><br><span class="line">    println(arr01.mkString(<span class="string">&quot;,&quot;</span>)) <span class="comment">//查看数组 ,隔开</span></span><br><span class="line"><span class="comment">//    arr01.foreach(println)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> arr1 = <span class="type">Array</span>(<span class="number">1</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="string">&quot;jack&quot;</span>)</span><br><span class="line">    println(<span class="string">&quot;arr1长度:&quot;</span> + arr1.length)</span><br><span class="line">    arr1.foreach(print)</span><br><span class="line">    println()</span><br><span class="line">    println(<span class="string">&quot;-----------------------&quot;</span>)</span><br><span class="line">    <span class="comment">//（4）增加元素（由于创建的是不可变数组，增加元素，其实是产生新的数组）</span></span><br><span class="line">    println(arr01)</span><br><span class="line">    <span class="keyword">val</span> ints: <span class="type">Array</span>[<span class="type">Int</span>] = arr01 :+ <span class="number">5</span></span><br><span class="line">    println(ints)</span><br><span class="line">    println(<span class="string">&quot;-----------------------&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//    可变数组</span></span><br><span class="line">    <span class="keyword">val</span> arr2 = <span class="type">ArrayBuffer</span>[<span class="type">Any</span>](<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="string">&quot;helen&quot;</span>)</span><br><span class="line">    println(<span class="string">&quot;arr2长度:&quot;</span> +arr2.length)</span><br><span class="line">    println(arr2.mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line"><span class="comment">//    arr2.foreach(println)</span></span><br><span class="line">    println(<span class="string">&quot;arr2.hash= &quot;</span> + arr2.hashCode())</span><br><span class="line">    <span class="comment">//（3）增加元素</span></span><br><span class="line">    <span class="comment">//（3.1）追加数据</span></span><br><span class="line">    arr2.+=(<span class="number">4</span>)</span><br><span class="line">    println(arr2.mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">//（3.2）向数组最后追加数据</span></span><br><span class="line">    arr2.append(<span class="number">5</span>,<span class="number">6</span>)</span><br><span class="line">    println(arr2.mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">//（3.3）向指定的位置插入数据 第一位指定下标位置 后面加多少数据都行</span></span><br><span class="line">    arr2.insert(<span class="number">1</span>,<span class="number">7</span>,<span class="number">0.8</span>)</span><br><span class="line">    println(arr2.mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line"></span><br><span class="line">    println(<span class="string">&quot;arr2.hash= &quot;</span> + arr2.hashCode())</span><br><span class="line"><span class="comment">//    修改</span></span><br><span class="line">    arr2(<span class="number">5</span>) = <span class="string">&quot;kiss&quot;</span> <span class="comment">//修改指定下标的值</span></span><br><span class="line">    println(arr2.mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span></span><br><span class="line">arr1长度:<span class="number">7</span></span><br><span class="line"><span class="number">145669</span>jack</span><br><span class="line">-----------------------</span><br><span class="line">[<span class="type">I</span>@<span class="number">22</span>f71333</span><br><span class="line">[<span class="type">I</span>@<span class="number">13969</span>fbe</span><br><span class="line">-----------------------</span><br><span class="line">arr2长度:<span class="number">4</span></span><br><span class="line"><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,helen</span><br><span class="line">arr2.hash= <span class="number">100581814</span></span><br><span class="line"><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,helen,<span class="number">4</span></span><br><span class="line"><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,helen,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span></span><br><span class="line"><span class="number">1</span>,<span class="number">7</span>,<span class="number">0.8</span>,<span class="number">2</span>,<span class="number">3</span>,helen,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span></span><br><span class="line">arr2.hash= <span class="number">-18482605</span></span><br><span class="line"><span class="number">1</span>,<span class="number">7</span>,<span class="number">0.8</span>,<span class="number">2</span>,<span class="number">3</span>,kiss,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="type">Process</span> finished <span class="keyword">with</span> exit code <span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="可变数组和不可变数组的转换">可变数组和不可变数组的转换</h4>
<p>对原本的数组没有改变，方法返回一个新数组</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//转换说明</span></span><br><span class="line">arr1.toBuffer <span class="comment">//不可变数组转可变数组</span></span><br><span class="line">arr2.toArray <span class="comment">//可变数组转不可变数组</span></span><br><span class="line">（<span class="number">1</span>）arr2.toArray 返回结果才是一个不可变数组，arr2 本身没有变化</span><br><span class="line">（<span class="number">2</span>）arr1.toBuffer 返回结果才是一个可变数组，arr1 本身没有变化</span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test02_ArrayChange</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> arr2 = <span class="type">ArrayBuffer</span>[<span class="type">Int</span>]() <span class="comment">//创建可变数组</span></span><br><span class="line">    arr2.append(<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>)<span class="comment">//添加值</span></span><br><span class="line">    println(arr2)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//（3）ArrayBuffer ==&gt; Array</span></span><br><span class="line">    <span class="comment">//（3.1）arr2.toArray 返回的结果是一个新的定长数组集合</span></span><br><span class="line">    <span class="comment">//（3.2）arr2 它没有变化</span></span><br><span class="line">    <span class="keyword">val</span> newArr:<span class="type">Array</span>[<span class="type">Int</span>] = arr2.toArray</span><br><span class="line">    println(newArr.mkString(<span class="string">&quot;--&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">//（4）Array ===&gt; ArrayBuffer</span></span><br><span class="line">    <span class="comment">//（4.1）newArr.toBuffer 返回一个变长数组 newArr2</span></span><br><span class="line">    <span class="comment">//（4.2）newArr 没有任何变化，依然是定长数组</span></span><br><span class="line">    <span class="keyword">val</span> newArr2 = newArr.toBuffer</span><br><span class="line">    newArr2.append(<span class="number">123</span>)</span><br><span class="line">    println(newArr2)</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>多维数组</p>
<p>这个和Java一样，用处也不是很大感觉，过了一遍，很容易理解</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test03_DimArray</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//（1）创建了一个二维数组, 有三个元素，每个元素是，含有 4 个元素一维数组()</span></span><br><span class="line">    <span class="keyword">val</span> arr = <span class="type">Array</span>.ofDim[<span class="type">Int</span>](<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">    arr(<span class="number">1</span>)(<span class="number">2</span>) = <span class="number">88</span></span><br><span class="line">    <span class="comment">//遍历二维数组</span></span><br><span class="line">    <span class="keyword">for</span> (i &lt;- arr)&#123; <span class="comment">//此时i是三个一维数组</span></span><br><span class="line">      <span class="keyword">for</span> (j &lt;- i)&#123;</span><br><span class="line">        print(j + <span class="string">&quot; &quot;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      println()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="列表List">列表List</h3>
<h4 id="不可变List">不可变List</h4>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test04_List</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//（1）List 默认为不可变集合</span></span><br><span class="line">    <span class="comment">//（2）创建一个 List（数据有顺序，可重复）</span></span><br><span class="line">    <span class="keyword">val</span> list: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>)</span><br><span class="line">    <span class="comment">//(3)遍历查看列表 打印</span></span><br><span class="line">    list.foreach(println)</span><br><span class="line">    println(list.mkString(<span class="string">&quot;--&quot;</span>))</span><br><span class="line">    <span class="comment">//（4）List 增加数据</span></span><br><span class="line">    <span class="comment">//（4.1）::的运算规则从右向左</span></span><br><span class="line">    <span class="keyword">val</span> list1 = <span class="number">7</span> :: <span class="number">9</span> :: <span class="number">8</span> :: list</span><br><span class="line">    println(list1.mkString(<span class="string">&quot;--&quot;</span>))</span><br><span class="line">    <span class="keyword">val</span> list2 = list1 .+:(<span class="number">10</span>) <span class="comment">//将10添加到数组的第一位创造新数组</span></span><br><span class="line">    println(list2.mkString(<span class="string">&quot;--&quot;</span>))</span><br><span class="line">    <span class="keyword">val</span> list3 = <span class="type">List</span>(<span class="number">8</span>,<span class="number">9</span>,<span class="number">53</span>)</span><br><span class="line">    <span class="keyword">val</span> list4 = list3 ::: list2 <span class="comment">//list3元素在左 list2在右 成一个新数组list4</span></span><br><span class="line">    println(list4.mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">1--2--3--4--3</span></span><br><span class="line"><span class="comment">7--9--8--1--2--3--4--3</span></span><br><span class="line"><span class="comment">10--7--9--8--1--2--3--4--3</span></span><br><span class="line"><span class="comment">8,9,53,10,7,9,8,1,2,3,4,3</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="可变ListBuffer">可变ListBuffer</h4>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test05_ListChange</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//（1）创建一个可变集合</span></span><br><span class="line">    <span class="keyword">val</span> buffer = <span class="type">ListBuffer</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">    <span class="comment">//（2）向集合中添加数据</span></span><br><span class="line">    buffer.+=(<span class="number">5</span>)</span><br><span class="line">    buffer.append(<span class="number">6</span>)</span><br><span class="line">    buffer.insert(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">    <span class="comment">//（3）打印集合数据</span></span><br><span class="line">    buffer.foreach(print)</span><br><span class="line">    println()</span><br><span class="line">    println(buffer.mkString(<span class="string">&quot;-&quot;</span>))</span><br><span class="line">    <span class="comment">//（4）修改数据</span></span><br><span class="line">    buffer(<span class="number">1</span>) = <span class="number">6</span></span><br><span class="line">    buffer.update(<span class="number">1</span>,<span class="number">7</span>)</span><br><span class="line">    <span class="comment">//（5）删除数据</span></span><br><span class="line">    buffer.-(<span class="number">5</span>)</span><br><span class="line">    buffer.-=(<span class="number">5</span>)</span><br><span class="line">    buffer.remove(<span class="number">5</span>)</span><br><span class="line">    println(buffer.mkString(<span class="string">&quot;-&quot;</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Set集合">Set集合</h3>
<p>Set 默认是不可变集合，数据无序 数据不能重复</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test06_Set</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//（1）Set 默认是不可变集合，数据无序</span></span><br><span class="line">    <span class="keyword">val</span> set = <span class="type">Set</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>)</span><br><span class="line">    println(set.mkString(<span class="string">&quot;,&quot;</span>)) <span class="comment">//5,1,2,7,3,4</span></span><br><span class="line">    <span class="comment">//（2）数据不可重复</span></span><br><span class="line">    <span class="keyword">val</span> set1 = <span class="type">Set</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">3</span>)</span><br><span class="line">    <span class="comment">//（3）遍历集合</span></span><br><span class="line">    <span class="keyword">for</span>(x&lt;-set1)&#123; <span class="comment">//5 1 6 2 3 4 3取消一个因为不能重复</span></span><br><span class="line">      println(x)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="mutable-Set可变集合">mutable.Set可变集合</h4>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test07_MutableSet</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//（1）创建可变集合</span></span><br><span class="line">    <span class="keyword">val</span> set = mutable.<span class="type">Set</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>)</span><br><span class="line">    println(set.mkString(<span class="string">&quot;-&quot;</span>))</span><br><span class="line">    set += <span class="number">8</span> <span class="comment">//集合添加元素</span></span><br><span class="line">    println(set.mkString(<span class="string">&quot;-&quot;</span>))</span><br><span class="line">    <span class="comment">//（4）向集合中添加元素，返回一个新的 Set</span></span><br><span class="line">    <span class="keyword">val</span> ints = set.+(<span class="number">9</span>)</span><br><span class="line">    println(ints)</span><br><span class="line">    println(<span class="string">&quot;set2=&quot;</span> + set)</span><br><span class="line">    <span class="comment">//（5）删除数据</span></span><br><span class="line">    set-=(<span class="number">5</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Map集合-2">Map集合</h3>
<p>Scala 中的 Map 和 Java 类似，<strong>也是一个散列表</strong>，它存储的内容也是键值对（<strong>key-value</strong>）映射</p>
<p><code>不变的Map是有序的 可变的Map是无序的</code></p>
<h4 id="不可变Map">不可变Map</h4>
<p>如果 key 不存在，返回 0</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test08_Map</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">   <span class="comment">//Map</span></span><br><span class="line">   <span class="comment">//（1）创建不可变集合 Map</span></span><br><span class="line">    <span class="keyword">val</span> map = <span class="type">Map</span>( <span class="string">&quot;a&quot;</span>-&gt;<span class="string">&quot;A&quot;</span>, <span class="string">&quot;b&quot;</span>-&gt;<span class="number">2</span>, <span class="string">&quot;c&quot;</span>-&gt;<span class="number">3</span> )</span><br><span class="line">    map.foreach(println)<span class="comment">//打印键值对 带括号的</span></span><br><span class="line">    <span class="comment">//3.访问数据 格式为 keys = Value</span></span><br><span class="line">    <span class="keyword">for</span> (elem &lt;- map.keys)&#123;</span><br><span class="line">      <span class="comment">//使用get访问map集合的数据，会返回特殊Option选项：有值 无值</span></span><br><span class="line">      println(elem + <span class="string">&quot;=&quot;</span> + map(elem))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//（4）如果 key 不存在，返回 ,后面的值</span></span><br><span class="line">    println(map.getOrElse(<span class="string">&quot;s&quot;</span>,<span class="number">5</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 运行结果</span></span><br><span class="line"><span class="comment">(a,A)</span></span><br><span class="line"><span class="comment">(b,2)</span></span><br><span class="line"><span class="comment">(c,3)</span></span><br><span class="line"><span class="comment">a=A</span></span><br><span class="line"><span class="comment">b=2</span></span><br><span class="line"><span class="comment">c=3</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment"></span></span><br></pre></td></tr></table></figure>
<h4 id="可变Map">可变Map</h4>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test09_MapChange</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//（1）创建可变集合</span></span><br><span class="line">    <span class="keyword">val</span> map = mutable.<span class="type">Map</span>( <span class="string">&quot;a&quot;</span>-&gt;<span class="number">1</span>, <span class="string">&quot;b&quot;</span>-&gt;<span class="number">2</span>, <span class="string">&quot;c&quot;</span>-&gt;<span class="number">3</span> )</span><br><span class="line">    println(map.mkString(<span class="string">&quot; , &quot;</span>))</span><br><span class="line">    <span class="comment">//（3）向集合增加数据</span></span><br><span class="line">    map.+=(<span class="string">&quot;d&quot;</span>-&gt;<span class="number">4</span>)</span><br><span class="line">    println(map.mkString(<span class="string">&quot; , &quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将数值 4 添加到集合，并把集合中a原值 1 返回</span></span><br><span class="line">    <span class="keyword">val</span> maybeInt = map.put(<span class="string">&quot;a&quot;</span>, <span class="number">4</span>) <span class="comment">// 相当于修改 有返回值</span></span><br><span class="line">    println(map.mkString(<span class="string">&quot; , &quot;</span>))</span><br><span class="line">    println(maybeInt)</span><br><span class="line">    println(maybeInt.getOrElse(<span class="number">0</span>)) <span class="comment">//获取返回值</span></span><br><span class="line">    <span class="comment">//删除键 对应的值也会删除</span></span><br><span class="line">    println(map.-=(<span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>))</span><br><span class="line">    println(map.mkString(<span class="string">&quot; , &quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">//（5）修改数据 键对应的值</span></span><br><span class="line">    map.update(<span class="string">&quot;d&quot;</span>,<span class="number">5</span>)</span><br><span class="line">    map(<span class="string">&quot;a&quot;</span>) = <span class="number">1</span></span><br><span class="line">    println(map.mkString(<span class="string">&quot; , &quot;</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">b -&gt; 2 , a -&gt; 1 , c -&gt; 3</span></span><br><span class="line"><span class="comment">b -&gt; 2 , d -&gt; 4 , a -&gt; 1 , c -&gt; 3</span></span><br><span class="line"><span class="comment">b -&gt; 2 , d -&gt; 4 , a -&gt; 4 , c -&gt; 3</span></span><br><span class="line"><span class="comment">Some(1)</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">Map(d -&gt; 4, a -&gt; 4)</span></span><br><span class="line"><span class="comment">d -&gt; 4 , a -&gt; 4</span></span><br><span class="line"><span class="comment">d -&gt; 5 , a -&gt; 1</span></span><br><span class="line"><span class="comment"></span></span><br></pre></td></tr></table></figure>
<h3 id="元组-2">元组</h3>
<p>元组算是一个容器，可以这么理解，就是可加将很多无关的数据封装为一个整体 元组最大只能有22个元素</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test10_Tuple</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//（1）声明元组的方式：(元素 1，元素 2，元素 3)</span></span><br><span class="line">    <span class="keyword">val</span> tuple = (<span class="number">40</span>,<span class="string">&quot;bobo&quot;</span>,<span class="literal">true</span>)</span><br><span class="line">    <span class="comment">//（2）访问元组</span></span><br><span class="line">    <span class="comment">//（2.1）通过元素的顺序进行访问，调用方式：_顺序号</span></span><br><span class="line">    println(tuple._1)</span><br><span class="line">    println(tuple._2)</span><br><span class="line">    println(tuple._3)</span><br><span class="line">    <span class="comment">//（2.2）通过索引访问数据</span></span><br><span class="line">    println(tuple.productElement(<span class="number">1</span>))</span><br><span class="line">    <span class="comment">//（2.3）通过迭代器访问数据</span></span><br><span class="line">    <span class="keyword">for</span> (elem &lt;- tuple.productIterator) &#123;</span><br><span class="line">      println(elem)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//（3）Map 中的键值对其实就是元组,只不过元组的元素个数为 2，称之为 对偶</span></span><br><span class="line">    <span class="keyword">val</span> map = <span class="type">Map</span>(<span class="string">&quot;a&quot;</span>-&gt;<span class="number">1</span>, <span class="string">&quot;b&quot;</span>-&gt;<span class="number">2</span>, <span class="string">&quot;c&quot;</span>-&gt;<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">val</span> map1 = <span class="type">Map</span>((<span class="string">&quot;a&quot;</span>,<span class="number">1</span>), (<span class="string">&quot;b&quot;</span>,<span class="number">2</span>), (<span class="string">&quot;c&quot;</span>,<span class="number">3</span>))</span><br><span class="line">    map.foreach(tuple1=&gt;&#123;println(tuple1._1 + <span class="string">&quot;=&quot;</span> + tuple1._2)&#125;)</span><br><span class="line">    map1.foreach(tuple1=&gt;&#123;println(tuple1._1 + <span class="string">&quot;=&quot;</span> + tuple1._2)&#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 运行结果</span></span><br><span class="line"><span class="comment">40</span></span><br><span class="line"><span class="comment">bobo</span></span><br><span class="line"><span class="comment">true</span></span><br><span class="line"><span class="comment">bobo</span></span><br><span class="line"><span class="comment">40</span></span><br><span class="line"><span class="comment">bobo</span></span><br><span class="line"><span class="comment">true</span></span><br><span class="line"><span class="comment">a=1</span></span><br><span class="line"><span class="comment">b=2</span></span><br><span class="line"><span class="comment">c=3</span></span><br><span class="line"><span class="comment">a=1</span></span><br><span class="line"><span class="comment">b=2</span></span><br><span class="line"><span class="comment">c=3</span></span><br></pre></td></tr></table></figure>
<h3 id="集合常用函数">集合常用函数</h3>
<p><strong>基本属性和常用操作</strong></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test01_TestList</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> list: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>)</span><br><span class="line">    <span class="comment">//（1）获取集合长度</span></span><br><span class="line">    println(list.length)</span><br><span class="line">    <span class="comment">//（2）获取集合大小,等同于 length</span></span><br><span class="line">    println(list.size)</span><br><span class="line">    <span class="comment">//（3）循环遍历</span></span><br><span class="line">    list.foreach(println)</span><br><span class="line">    <span class="comment">//（4）迭代器</span></span><br><span class="line">    <span class="keyword">for</span> (elem &lt;- list.iterator) &#123;</span><br><span class="line">      println(elem)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//（5）生成字符串</span></span><br><span class="line">    println(list.mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    <span class="comment">//（6）是否包含</span></span><br><span class="line">    println(list.contains(<span class="number">3</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">7</span></span><br><span class="line"><span class="comment">7</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">7</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">7</span></span><br><span class="line"><span class="comment">1,2,3,4,5,6,7</span></span><br><span class="line"><span class="comment">true</span></span><br></pre></td></tr></table></figure>
<h4 id="衍生集合">衍生集合</h4>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test02_TestListPlus</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> list1: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>,<span class="number">11</span>)</span><br><span class="line">    <span class="keyword">val</span> list2: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>)</span><br><span class="line">    <span class="comment">//（1）获取集合的头</span></span><br><span class="line">    println(list1.head)</span><br><span class="line">    <span class="comment">//（2）获取集合的尾（不是头的就是尾 除去第一个）</span></span><br><span class="line">    println(list1.tail)</span><br><span class="line">    <span class="comment">//（3）集合最后一个数据</span></span><br><span class="line">    println(list1.last)</span><br><span class="line">    <span class="comment">//（4）集合初始数据 除去最后一个</span></span><br><span class="line">    println(list1.init)</span><br><span class="line">    <span class="comment">//（5）反转</span></span><br><span class="line">    println(list1.reverse)</span><br><span class="line">    println(list1.mkString(<span class="string">&quot;,&quot;</span>)) <span class="comment">//查看当前数据顺序</span></span><br><span class="line">    <span class="comment">//（6）取前（后）n 个元素</span></span><br><span class="line">    println(list1.take(<span class="number">4</span>)) <span class="comment">//获取前四个</span></span><br><span class="line">    println(list1.takeRight(<span class="number">3</span>)) <span class="comment">//获取后四个</span></span><br><span class="line">    <span class="comment">//（7）去掉前（后）n 个元素</span></span><br><span class="line">    println(list1.drop(<span class="number">3</span>))</span><br><span class="line">    println(list1.dropRight(<span class="number">3</span>))</span><br><span class="line">    println(list1.mkString(<span class="string">&quot;,&quot;</span>)) <span class="comment">//查看当前数据顺序</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//（8）并集</span></span><br><span class="line">    println(list1.union(list2)) <span class="comment">//重复的也会存在</span></span><br><span class="line">    <span class="comment">//（9）交集</span></span><br><span class="line">    println(list1.intersect(list2))</span><br><span class="line">    <span class="comment">//（10）差集</span></span><br><span class="line">    println(list1.diff(list2))</span><br><span class="line">    println(list1.mkString(<span class="string">&quot;,&quot;</span>)) <span class="comment">//查看当前数据顺序</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//（11）滑窗</span></span><br><span class="line">    list1.sliding(<span class="number">2</span>, <span class="number">5</span>).foreach(println) <span class="comment">// 长度为2输出 从头开始 一次5位步长 1 2 3 4 5 6 7 11</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//（11）拉链 注:如果两个集合的元素个数不相等，那么会将同等数量的数据进行拉链，多余的数据省略不用 取小的</span></span><br><span class="line">    println(<span class="string">&quot;拉链&quot;</span>)</span><br><span class="line">    println(list1.zip(list2)) <span class="comment">//说白了就是上下对应生成一个新二维列表，二维列表里的列表是两个元素</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*运行结果</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">List(2, 3, 4, 5, 6, 7, 11)</span></span><br><span class="line"><span class="comment">11</span></span><br><span class="line"><span class="comment">List(1, 2, 3, 4, 5, 6, 7)</span></span><br><span class="line"><span class="comment">List(11, 7, 6, 5, 4, 3, 2, 1)</span></span><br><span class="line"><span class="comment">1,2,3,4,5,6,7,11</span></span><br><span class="line"><span class="comment">List(1, 2, 3, 4)</span></span><br><span class="line"><span class="comment">List(6, 7, 11)</span></span><br><span class="line"><span class="comment">List(4, 5, 6, 7, 11)</span></span><br><span class="line"><span class="comment">List(1, 2, 3, 4, 5)</span></span><br><span class="line"><span class="comment">1,2,3,4,5,6,7,11</span></span><br><span class="line"><span class="comment">List(1, 2, 3, 4, 5, 6, 7, 11, 4, 5, 6, 7, 8, 9, 10)</span></span><br><span class="line"><span class="comment">List(4, 5, 6, 7)</span></span><br><span class="line"><span class="comment">List(1, 2, 3, 11)</span></span><br><span class="line"><span class="comment">1,2,3,4,5,6,7,11</span></span><br><span class="line"><span class="comment">List(1, 2)</span></span><br><span class="line"><span class="comment">List(6, 7)</span></span><br><span class="line"><span class="comment">拉链</span></span><br><span class="line"><span class="comment">List((1,4), (2,5), (3,6), (4,7), (5,8), (6,9), (7,10))</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Process finished with exit code 0</span></span><br><span class="line"><span class="comment"></span></span><br></pre></td></tr></table></figure>
<h4 id="集合计算简单函数">集合计算简单函数</h4>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test03_ListMath</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> list: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">5</span>, <span class="number">-3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">-7</span>, <span class="number">6</span>)</span><br><span class="line">    <span class="comment">//（1）求和</span></span><br><span class="line">    println(list.sum)</span><br><span class="line">    <span class="comment">//（2）求乘积</span></span><br><span class="line">    println(list.product)</span><br><span class="line">    <span class="comment">//（3）最大值</span></span><br><span class="line">    println(list.max)</span><br><span class="line">    <span class="comment">//（4）最小值</span></span><br><span class="line">    println(list.min)</span><br><span class="line">    <span class="comment">//（5）排序</span></span><br><span class="line">    println(list.sorted) <span class="comment">// 自然排序</span></span><br><span class="line">    <span class="comment">// （5.1）按照元素大小排序</span></span><br><span class="line">    println(list.sortBy(x =&gt; x))</span><br><span class="line">    <span class="comment">// （5.2）按照元素的绝对值大小排序</span></span><br><span class="line">    println(list.sortBy(x =&gt; x.abs))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// （5.3）按元素大小升序排序</span></span><br><span class="line">    println(list.sortWith((x, y) =&gt; x &lt; y))</span><br><span class="line">    <span class="comment">// （5.4）按元素大小降序排序</span></span><br><span class="line">    println(list.sortWith((x, y) =&gt; x &gt; y))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">8</span></span><br><span class="line"><span class="comment">5040</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">-7</span></span><br><span class="line"><span class="comment">List(-7, -3, 1, 2, 4, 5, 6)</span></span><br><span class="line"><span class="comment">List(-7, -3, 1, 2, 4, 5, 6)</span></span><br><span class="line"><span class="comment">List(1, 2, -3, 4, 5, 6, -7)</span></span><br><span class="line"><span class="comment">List(-7, -3, 1, 2, 4, 5, 6)</span></span><br><span class="line"><span class="comment">List(6, 5, 4, 2, 1, -3, -7)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Process finished with exit code 0</span></span><br></pre></td></tr></table></figure>
<h3 id="集合计算高级函数">集合计算高级函数</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test04_HighLevelFunction_Map</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> list = <span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>)</span><br><span class="line">    <span class="comment">//1.过滤</span></span><br><span class="line">    <span class="comment">//选取偶数</span></span><br><span class="line">    println(list.filter(_ % <span class="number">2</span> == <span class="number">0</span> ))</span><br><span class="line">    <span class="comment">//选取奇数</span></span><br><span class="line">    println(list.filter(_ % <span class="number">2</span> == <span class="number">1</span> ))</span><br><span class="line">    println(<span class="string">&quot;=========================&quot;</span>)</span><br><span class="line">    <span class="comment">//2.map</span></span><br><span class="line">    <span class="comment">//集合元素映射</span></span><br><span class="line">    println(list.map(_ * <span class="number">2</span>)) <span class="comment">//集合每个数乘2</span></span><br><span class="line">    println(list.map(x =&gt; x * x)) <span class="comment">//集合每个数平方</span></span><br><span class="line"></span><br><span class="line">    println(<span class="string">&quot;=========================&quot;</span>)</span><br><span class="line">    <span class="comment">//3.扁平化</span></span><br><span class="line">    <span class="keyword">val</span> nestedList: <span class="type">List</span>[<span class="type">List</span>[<span class="type">Int</span>]] = <span class="type">List</span>(<span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>),<span class="type">List</span>(<span class="number">4</span>,<span class="number">5</span>),<span class="type">List</span>(<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>))</span><br><span class="line">    println(nestedList.flatten)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4.扁平化加映射 flatMap 相当于先进行 map 操作，在进行 flatten操作</span></span><br><span class="line">    <span class="keyword">val</span> wordList: <span class="type">List</span>[<span class="type">String</span>] = <span class="type">List</span>(<span class="string">&quot;hello world&quot;</span>, <span class="string">&quot;hello atguigu&quot;</span>, <span class="string">&quot;hello scala&quot;</span>)</span><br><span class="line">    println(wordList.flatMap(_.split(<span class="string">&quot; &quot;</span>)))</span><br><span class="line"></span><br><span class="line">    <span class="comment">//（5）分组</span></span><br><span class="line">    println(list.groupBy(_ % <span class="number">2</span> == <span class="number">0</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">List(2, 4, 6, 8)</span></span><br><span class="line"><span class="comment">List(1, 3, 5, 7, 9)</span></span><br><span class="line"><span class="comment">=========================</span></span><br><span class="line"><span class="comment">List(2, 4, 6, 8, 10, 12, 14, 16, 18)</span></span><br><span class="line"><span class="comment">List(1, 4, 9, 16, 25, 36, 49, 64, 81)</span></span><br><span class="line"><span class="comment">=========================</span></span><br><span class="line"><span class="comment">List(1, 2, 3, 4, 5, 6, 7, 8, 9)</span></span><br><span class="line"><span class="comment">List(hello, world, hello, atguigu, hello, scala)</span></span><br><span class="line"><span class="comment">Map(false -&gt; List(1, 3, 5, 7, 9), true -&gt; List(2, 4, 6, 8))</span></span><br></pre></td></tr></table></figure>
<h3 id="队列-2">队列</h3>
<p>Scala 也提供了队列（Queue）的数据结构，队列的特点就是先进先出。进队和出队的方法分别为 enqueue 和 dequeue。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test11_Queue</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> que = <span class="keyword">new</span> mutable.<span class="type">Queue</span>[<span class="type">String</span>]()</span><br><span class="line">    que.enqueue(<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>)</span><br><span class="line">    println(que.dequeue())</span><br><span class="line">    que.enqueue(<span class="string">&quot;T&quot;</span>)</span><br><span class="line">    println(que.dequeue())</span><br><span class="line">    println(que.dequeue())</span><br><span class="line">    println(que.dequeue())</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*看运行结果得知 队列是取的时候一个一个来，后面添加也不能插队取</span></span><br><span class="line"><span class="comment">a</span></span><br><span class="line"><span class="comment">b</span></span><br><span class="line"><span class="comment">c</span></span><br><span class="line"><span class="comment">T</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h3 id="并行集合-2">并行集合</h3>
<p>是一种利用多核CPU的集合，进行多核的并行运算</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test12_Par</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> result1 = (<span class="number">0</span> to <span class="number">100</span>).map(_ =&gt;  <span class="type">Thread</span>.currentThread.getName)</span><br><span class="line">    <span class="keyword">val</span> result2 = (<span class="number">0</span> to <span class="number">100</span>).par.map(_ =&gt; <span class="type">Thread</span>.currentThread.getName)</span><br><span class="line">    println(result1)</span><br><span class="line">    println(result2)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220720144457598.png" alt="image-20220720144457598"></p>
<p>可见原本的集合是一直都是main线程，而par的则是利用了不同的核心，这样使得 集合创建和运行的效率大大提高。</p>
<h3 id="异常处理-2">异常处理</h3>
<p>和java一模一样，只有catch部分有区别，Catch在java中多异常的时候，多写几个Catch就好了，在Scala则是多写几个Case。具体实现代码如下</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test01_Exception</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">val</span> n= <span class="number">10</span> / <span class="number">0</span></span><br><span class="line">      println(n)</span><br><span class="line"><span class="comment">//      println(&quot;abc&quot;.toInt)</span></span><br><span class="line">    &#125;<span class="keyword">catch</span> &#123;</span><br><span class="line">      <span class="keyword">case</span> _: <span class="type">ArithmeticException</span>=&gt;</span><br><span class="line">        <span class="comment">// 发生算术异常</span></span><br><span class="line">        println(<span class="string">&quot;发生算术异常&quot;</span>)</span><br><span class="line">      <span class="keyword">case</span> _: <span class="type">Exception</span>=&gt;</span><br><span class="line">        <span class="comment">// 对异常处理</span></span><br><span class="line">        println(<span class="string">&quot;发生了异常 1&quot;</span>)</span><br><span class="line">        println(<span class="string">&quot;发生了异常 2&quot;</span>)</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">      println(<span class="string">&quot;finally&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>抛出异常 关键字和java一样都是throw</p>
<p>下面是自己写了一个异常处理嵌套的简单代码，我理解Scala和Java异常处理是没有大变化的</p>
<p>区别点在异常捕获机制等，看文档，不重要没有深究</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test02_ExceptionThrow</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      test1()</span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">      <span class="keyword">case</span> _: <span class="type">Exception</span>=&gt; println(<span class="string">&quot;报错咯&quot;</span>)</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        f11()</span><br><span class="line">        <span class="comment">//      println(&quot;abc&quot;.toInt)</span></span><br><span class="line">      &#125;<span class="keyword">catch</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> _: <span class="type">ArithmeticException</span>=&gt;</span><br><span class="line">          <span class="comment">// 发生算术异常</span></span><br><span class="line">          println(<span class="string">&quot;发生算术异常0&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> _: <span class="type">Exception</span>=&gt;</span><br><span class="line">          <span class="comment">// 对异常处理</span></span><br><span class="line">          println(<span class="string">&quot;发生了异常 1&quot;</span>)</span><br><span class="line">          println(<span class="string">&quot;发生了异常 2&quot;</span>)</span><br><span class="line">      &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        println(<span class="string">&quot;finally&quot;</span>)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@throws</span>(classOf[<span class="type">NumberFormatException</span>])</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">f11</span></span>()=&#123;</span><br><span class="line">    <span class="string">&quot;abc&quot;</span>.toInt</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">test1</span></span>(): <span class="type">Nothing</span> = &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="type">Exception</span>(<span class="string">&quot;不可以哦&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="模式匹配-2">模式匹配</h3>
<p>我感觉像是switch的超级升级版，基础使用的话是差不多的，但是Scala用上闭包和柯里化，能让模式匹配变得很强大，可以代替If函数。</p>
<p>如下是基础使用，了解语法</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test01_MatchCase</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    println(<span class="string">&quot;请输入第一个数字:&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> a: <span class="type">Int</span> = <span class="type">StdIn</span>.readInt()</span><br><span class="line"></span><br><span class="line">    println(<span class="string">&quot;请输入你要进行的操作 (+ - * /)&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> c = <span class="type">StdIn</span>.readChar()</span><br><span class="line"></span><br><span class="line">    println(<span class="string">&quot;请输入第二个数字:&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> b: <span class="type">Int</span> = <span class="type">StdIn</span>.readInt()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">result</span></span>(x:<span class="type">Char</span>) = x <span class="keyword">match</span> &#123;</span><br><span class="line">      <span class="keyword">case</span> &#x27;+&#x27; =&gt; a + b</span><br><span class="line">      <span class="keyword">case</span> &#x27;-&#x27; =&gt; a - b</span><br><span class="line">      <span class="keyword">case</span> &#x27;*&#x27; =&gt; a * b</span><br><span class="line">      <span class="keyword">case</span> &#x27;/&#x27; =&gt; a / b</span><br><span class="line">      <span class="keyword">case</span> _ =&gt; <span class="string">&quot;illegal&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    println(<span class="string">&quot;请输入你要进行的操作 (+ - * /)&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> value = result(c)</span><br><span class="line">    println(<span class="string">s&quot;<span class="subst">$a</span> <span class="subst">$c</span> <span class="subst">$b</span> = <span class="subst">$value</span>&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以通过_来进行输入类型判断</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test02_MatchVal</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    println(describe(<span class="number">6</span>))</span><br><span class="line">    <span class="comment">//泛型擦除</span></span><br><span class="line">    println(describe(<span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)))</span><br><span class="line">    <span class="comment">//数组例外，可保留泛型</span></span><br><span class="line">    println(describe(<span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)))</span><br><span class="line">    println(describe(<span class="type">Array</span>(<span class="string">&quot;abc&quot;</span>))) <span class="comment">//是java中lang包的泛型</span></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">describe</span></span>(x: <span class="type">Any</span>) = x <span class="keyword">match</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> i: <span class="type">Int</span> =&gt; <span class="string">&quot;Int&quot;</span></span><br><span class="line">    <span class="keyword">case</span> s: <span class="type">String</span> =&gt; <span class="string">&quot;String hello&quot;</span></span><br><span class="line">    <span class="keyword">case</span> m: <span class="type">List</span>[_] =&gt; <span class="string">&quot;List&quot;</span></span><br><span class="line">    <span class="keyword">case</span> c: <span class="type">Array</span>[<span class="type">Int</span>] =&gt; <span class="string">&quot;Array[Int]&quot;</span></span><br><span class="line">    <span class="keyword">case</span> someThing =&gt; <span class="string">&quot;something else &quot;</span> + someThing</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Int</span></span><br><span class="line"><span class="comment">List</span></span><br><span class="line"><span class="comment">Array[Int]</span></span><br><span class="line"><span class="comment">something else [Ljava.lang.String;@6debcae2</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Process finished with exit code 0</span></span><br><span class="line"><span class="comment"></span></span><br></pre></td></tr></table></figure>
<p>模式匹配的用法很多，但大致使用都一样，就不一一列举了。</p>
<h2 id="5-BUG点-5">5.BUG点</h2>
<p>自己写扩展练习的时候，报错了，因为自己对Scala中元组的._这用法不是很熟悉，都是边看笔记边敲出来，看提示信息，是16行类型出现的问题，我先把前面声明类型删除了，让系统自己去匹配类型，结果后面又会有一条报错，来回检查发现x._2是Map变成的list，而我要做的的是统计次数，因此后面应该是x._2的size或者length方法，统计出list的长度。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220723111125032.png" alt="image-20220723111125032"></p>
<h2 id="6-扩展学习部分-5">6.扩展学习部分</h2>
<h3 id="记数排序">记数排序</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Test07_subject</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">// 单词计数：将集合中出现的相同的单词，进行计数，取计数排名前三的结果</span></span><br><span class="line">    <span class="keyword">val</span> stringList = <span class="type">List</span>(<span class="string">&quot;Hello Scala Hbase kafka&quot;</span>, <span class="string">&quot;Hello Scala Hbase&quot;</span>, <span class="string">&quot;Hello Scala&quot;</span>, <span class="string">&quot;Hello&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1) 将每一个字符串转换成一个一个单词</span></span><br><span class="line">    <span class="keyword">val</span> wordList: <span class="type">List</span>[<span class="type">String</span>] = stringList.flatMap(_.split(<span class="string">&quot; &quot;</span>))</span><br><span class="line">        println(wordList)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2) 将相同的单词放置在一起</span></span><br><span class="line">    <span class="keyword">val</span> wordToMap: <span class="type">Map</span>[<span class="type">String</span>,<span class="type">List</span>[<span class="type">String</span>]] = wordList.groupBy(a =&gt; a)</span><br><span class="line">        println(wordToMap)</span><br><span class="line">    <span class="comment">// 3) 对相同的单词进行计数</span></span><br><span class="line">    <span class="keyword">val</span> wordToMapCount: <span class="type">Map</span>[<span class="type">String</span>,<span class="type">Int</span>] = wordToMap.map(x =&gt; (x._1, x._2.size))</span><br><span class="line">    println(wordToMapCount)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4) 对计数完成后的结果进行排序（降序）</span></span><br><span class="line">    <span class="keyword">val</span> wordListToCount : <span class="type">List</span>[(<span class="type">String</span>, <span class="type">Int</span>)]= wordToMapCount.toList</span><br><span class="line">    <span class="keyword">val</span> sortList =wordListToCount.sortWith &#123;</span><br><span class="line">      (x, y) =&gt; &#123;</span><br><span class="line">        x._2 &gt; y._2</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    println(sortList)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5) 对排序后的结果取前 3 名</span></span><br><span class="line">    println(sortList.take(<span class="number">3</span>))</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="7-总结-6">7.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>今天的学习状态非常不错，已经熟练掌握了看文档的技能了，一天看了将近视频的70集。Scala后面的面向对象和集合方面都是以代码为主，逻辑性的问题，在Java早就牢记于心了，看文档的案例，复制到IDEA，自己基本就能分析出来方法的作用，以及使用场景。难点和Scala独特的点是同一点，就是元组的._使用，<code>._</code>能很大程度上优化Scala的代码长度，让代码更简洁，而且<code>._</code>匿名调用集合中的元素，以及列表中嵌元组，Map集合中嵌列表，二维列表中是偶元组，这种场景下，就显得非常好用，在for循环遍历也是如此。元组还是Scala比较重要，实用的点。今日算超额完成任务了，进入了Spark的学习，配置好了基本环境，将快速上手小案例做了出来，有前面Hadoop的铺垫，Spark理解应该会稍微容易点的，希望明天正式进入Spark的学习状态能和今天一样吧。</p>
<h1 id="7-21-Spark入门">7.21 Spark入门</h1>
<h2 id="1-头：日期、所学内容出处-11">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web">https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web</a></p>
<h2 id="2-标题-11">2.标题</h2>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">P1001</span>.尚硅谷_Spark框架 - 简介	<span class="number">4</span>:<span class="number">54</span></span><br><span class="line"><span class="attribute">P2002</span>.尚硅谷_Spark框架 - Vs Hadoop	<span class="number">7</span>:<span class="number">49</span></span><br><span class="line"><span class="attribute">P3003</span>.尚硅谷_Spark框架 - 核心模块 - 介绍	<span class="number">2</span>:<span class="number">24</span></span><br><span class="line"><span class="attribute">P4004</span>.尚硅谷_Spark框架 - 快速上手 - 开发环境准备	<span class="number">5</span>:<span class="number">46</span></span><br><span class="line"><span class="attribute">P5005</span>.尚硅谷_Spark框架 - 快速上手 - WordCount - 案例分析	<span class="number">7</span>:<span class="number">57</span></span><br><span class="line"><span class="attribute">P6006</span>.尚硅谷_Spark框架 - 快速上手 - WordCount - Spark环境	<span class="number">7</span>:<span class="number">07</span></span><br><span class="line"><span class="attribute">P7007</span>.尚硅谷_Spark框架 - 快速上手 - WordCount - 功能实现	<span class="number">11</span>:<span class="number">56</span></span><br><span class="line"><span class="attribute">P8008</span>.尚硅谷_Spark框架 - 快速上手 - WordCount - 不同的实现	<span class="number">8</span>:<span class="number">31</span></span><br><span class="line"><span class="attribute">P9009</span>.尚硅谷_Spark框架 - 快速上手 - WordCount - Spark的实现	<span class="number">4</span>:<span class="number">24</span></span><br><span class="line"><span class="attribute">P10010</span>.尚硅谷_Spark框架 - 快速上手 - WordCount - 日志和错误	<span class="number">3</span>:<span class="number">50</span></span><br><span class="line"><span class="attribute">P11011</span>.尚硅谷_Spark框架 - 运行环境 - 本地环境 - 基本配置和操作	<span class="number">8</span>:<span class="number">11</span></span><br><span class="line"><span class="attribute">P12012</span>.尚硅谷_Spark框架 - 运行环境 - 本地环境 - 提交应用程序	<span class="number">3</span>:<span class="number">10</span></span><br><span class="line"><span class="attribute">P13013</span>.尚硅谷_Spark框架 - 运行环境 - 独立部署环境 - 基本配置和操作	<span class="number">6</span>:<span class="number">13</span></span><br><span class="line"><span class="attribute">P14014</span>.尚硅谷_Spark框架 - 运行环境 - 独立部署环境 - 提交参数解析	<span class="number">3</span>:<span class="number">08</span></span><br><span class="line"><span class="attribute">P15015</span>.尚硅谷_Spark框架 - 运行环境 - 独立部署环境 - 配置历史服务	<span class="number">4</span>:<span class="number">08</span></span><br><span class="line"><span class="attribute">P16016</span>.尚硅谷_Spark框架 - 运行环境 - 独立部署环境 - 配置高可用	<span class="number">5</span>:<span class="number">51</span></span><br><span class="line"><span class="attribute">P17017</span>.尚硅谷_Spark框架 - 运行环境 - Yarn环境 - 基本配置 &amp; 历史服务	<span class="number">6</span>:<span class="number">42</span></span><br><span class="line"><span class="attribute">P18018</span>.尚硅谷_Spark框架 - 运行环境 - Windows环境 &amp; 总结	<span class="number">11</span>:<span class="number">06</span></span><br><span class="line"><span class="attribute">P19019</span>.尚硅谷_Spark框架 - 核心组件 - 介绍	<span class="number">3</span>:<span class="number">33</span></span><br><span class="line"><span class="attribute">P20020</span>.尚硅谷_Spark框架 - 核心概念 - Executor &amp; Core &amp; 并行度	<span class="number">3</span>:<span class="number">31</span></span><br><span class="line"><span class="attribute">P21021</span>.尚硅谷_Spark框架 - 核心概念 - DAG &amp; 提交流程 &amp; Yarn两种部署模式	<span class="number">7</span>:<span class="number">00</span></span><br><span class="line"><span class="attribute">P22022</span>.尚硅谷_SparkCore - 分布式计算模拟 - 搭建基础的架子	<span class="number">12</span>:<span class="number">48</span></span><br><span class="line"><span class="attribute">P23023</span>.尚硅谷_SparkCore - 分布式计算模拟 - 客户端向服务器发送计算任务	<span class="number">10</span>:<span class="number">50</span></span><br><span class="line"><span class="attribute">P24024</span>.尚硅谷_SparkCore - 分布式计算模拟 - 数据结构和分布式计算	<span class="number">11</span>:<span class="number">39</span></span><br><span class="line"><span class="attribute">P25025</span>.尚硅谷_SparkCore - 核心编程 - RDD - 概念介绍	<span class="number">5</span>:<span class="number">31</span></span><br><span class="line"><span class="attribute">P26026</span>.尚硅谷_SparkCore - 核心编程 - RDD - IO基本实现原理 - <span class="number">1</span>	<span class="number">10</span>:<span class="number">11</span></span><br><span class="line"><span class="attribute">P27027</span>.尚硅谷_SparkCore - 核心编程 - RDD - IO基本实现原理 - <span class="number">2</span>	<span class="number">8</span>:<span class="number">49</span></span><br><span class="line"><span class="attribute">P28028</span>.尚硅谷_SparkCore - 核心编程 - RDD - RDD和IO之间的关系	<span class="number">12</span>:<span class="number">24</span></span><br><span class="line"><span class="attribute">P29029</span>.尚硅谷_SparkCore - 核心编程 - RDD - 特点	<span class="number">13</span>:<span class="number">34</span></span><br><span class="line"><span class="attribute">P30030</span>.尚硅谷_SparkCore - 核心编程 - RDD - 五大主要配置	<span class="number">11</span>:<span class="number">19</span></span><br><span class="line"><span class="attribute">P31031</span>.尚硅谷_SparkCore - 核心编程 - RDD - 执行原理	<span class="number">3</span>:<span class="number">05</span></span><br><span class="line"><span class="attribute">P32032</span>.尚硅谷_SparkCore - 核心编程 - RDD - 创建 - 内存	<span class="number">11</span>:<span class="number">02</span></span><br><span class="line"><span class="attribute">P33033</span>.尚硅谷_SparkCore - 核心编程 - RDD - 创建 - 文件	<span class="number">6</span>:<span class="number">28</span></span><br><span class="line"><span class="attribute">P34034</span>.尚硅谷_SparkCore - 核心编程 - RDD - 创建 - 文件<span class="number">1</span>	<span class="number">4</span>:<span class="number">42</span></span><br><span class="line"><span class="attribute">P35035</span>.尚硅谷_SparkCore - 核心编程 - RDD - 集合数据源 - 分区的设定	<span class="number">11</span>:<span class="number">41</span></span><br><span class="line"><span class="attribute">P36036</span>.尚硅谷_SparkCore - 核心编程 - RDD - 集合数据源 - 分区数据的分配	<span class="number">13</span>:<span class="number">54</span></span><br><span class="line"><span class="attribute">P37037</span>.尚硅谷_SparkCore - 核心编程 - RDD - 文件数据源 - 分区的设定	<span class="number">11</span>:<span class="number">33</span></span><br><span class="line"><span class="attribute">P38038</span>.尚硅谷_SparkCore - 核心编程 - RDD - 文件数据源 - 分区数据的分配	<span class="number">8</span>:<span class="number">21</span></span><br><span class="line"><span class="attribute">P39039</span>.尚硅谷_SparkCore - 核心编程 - RDD - 文件数据源 - 分区数据的分配 - 案例分析	<span class="number">6</span>:<span class="number">13</span></span><br></pre></td></tr></table></figure>
<h2 id="3-所学内容概述-11">3.所学内容概述</h2>
<h3 id="Spark的快速上手">Spark的快速上手</h3>
<h4 id="Spark在Linux的部署配置">Spark在Linux的部署配置</h4>
<h4 id="RDD简介-和-逻辑以及执行过程-原理">RDD简介 和 逻辑以及执行过程 原理</h4>
<h2 id="4-根据概述分章节描述-9">4.根据概述分章节描述</h2>
<h3 id="Spark的快速上手-2">Spark的快速上手</h3>
<p>Spark 由 Scala 语言开发的，所以本课件接下来的开发所使用的语言也为 Scala</p>
<p>在IDEA中创建Maven项目</p>
<p>增加依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-core_2.12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="WorldCount案例">WorldCount案例</h4>
<p>这个案例昨天拿scala刚做过  基本逻辑是一样的，但是在Spark框架有更简单的方法，作者已经提供，不同的是要先建立和框架的连接 再去执行操作，看得出来，底层源码都是Scala</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BigDataSparkDay1</span>.wc</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark01_wordCount</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Application</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//Spark框架</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 建立和Spark框架的连接</span></span><br><span class="line">    <span class="comment">//JDBC:Connection</span></span><br><span class="line">    <span class="keyword">val</span> conf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local&quot;</span>).setAppName(<span class="string">&quot;WordCount&quot;</span>)</span><br><span class="line">    <span class="comment">// 创建 Spark 上下文环境对象（连接对象）</span></span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(conf)</span><br><span class="line"><span class="comment">//    sc.textFile(&quot;data/word.txt&quot;).flatMap(_.split(&quot; &quot;)).map((_,1)).reduceByKey(_+_).collect()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 执行业务操作</span></span><br><span class="line">    <span class="comment">// 读取文件数据</span></span><br><span class="line">    <span class="keyword">val</span> fileRDD: <span class="type">RDD</span>[<span class="type">String</span>] = sc.textFile(<span class="string">&quot;../bigdata/datas&quot;</span>)</span><br><span class="line">    <span class="comment">// 将文件中的数据进行分词</span></span><br><span class="line">    <span class="keyword">val</span> wordRDD: <span class="type">RDD</span>[<span class="type">String</span>] = fileRDD.flatMap( _.split(<span class="string">&quot; &quot;</span>) )</span><br><span class="line">    <span class="comment">// 转换数据结构 word =&gt; (word, 1)</span></span><br><span class="line">    <span class="keyword">val</span> <span class="type">WorldToOne</span>:<span class="type">RDD</span>[(<span class="type">String</span>,<span class="type">Int</span>)] = wordRDD.map((_, <span class="number">1</span>))</span><br><span class="line">    <span class="comment">// 将转换结构后的数据按照相同的单词进行分组聚合</span></span><br><span class="line"><span class="comment">//    val WordGroup:RDD[(String,Iterable[(String,Int)])] = WorldToOne.groupBy(</span></span><br><span class="line"><span class="comment">//      t =&gt; t._1</span></span><br><span class="line"><span class="comment">//    )</span></span><br><span class="line"><span class="comment">//    val wordCount = WordGroup.map &#123;</span></span><br><span class="line"><span class="comment">//      case (_, y) =&gt;</span></span><br><span class="line"><span class="comment">//        y.reduce(</span></span><br><span class="line"><span class="comment">//          (y1, y2) =&gt; (y1._1, y1._2 + y2._2)</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        )</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line">    <span class="keyword">val</span> wordCount = <span class="type">WorldToOne</span>.reduceByKey(_ + _)</span><br><span class="line">    <span class="comment">// 将数据聚合结果采集到内存中</span></span><br><span class="line">    <span class="keyword">val</span> word2Count = wordCount.collect()</span><br><span class="line">    <span class="comment">// 打印结果</span></span><br><span class="line">    word2Count.foreach(println)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭连接</span></span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="RDD简介">RDD简介</h3>
<p>弹性分布式数据集，是 Spark 中最基本的数据处理模型。代码中是一个抽象类，它代表一个弹性的、不可变、可分区、里面的元素可并行计算的<strong>集合</strong></p>
<p>自己理解：RDD的弹性安全性比较好，高容错，适合开发。它是一个集合，但并不保存数据，而且封装了计算逻辑，同时也是一个抽象类，需要其他的子类来具体实现。</p>
<h4 id="执行原理">执行原理</h4>
<p>RDD先申请资源，然后将应用程序的数据处理逻辑分解成一个一个的计算任务。然后将任务发到已经分配资源的计算节点上, 按照指定的计算模型进行数据计算。最后得到计算结果。</p>
<p>在Yarn中的执行原理</p>
<h5 id="1-启动环境">1.启动环境</h5>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220722141756608.png" alt="image-20220722141756608"></p>
<h5 id="2-Spark通过申请资源创建节点">2.Spark通过申请资源创建节点</h5>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220722141829718.png" alt="image-20220722141829718"></p>
<h5 id="3-根据需求根据分区划分任务">3.根据需求根据分区划分任务</h5>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220722141903056.png" alt="image-20220722141903056"></p>
<h5 id="4-调度节点将任务根据计算节点状态发送到对应的计算节点进行计算">4.调度节点将任务根据计算节点状态发送到对应的计算节点进行计算</h5>
<p>如下图</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220722141944559.png" alt="image-20220722141944559"></p>
<p>根据这四幅图，便能看出来RDD的 流程中的作用主要就是将逻辑封装，生成Task也就是任务点，发送给Executor节点</p>
<h3 id="RDD创建">RDD创建</h3>
<p>在 Spark 中创建 RDD 的创建方式可以分为四种：</p>
<p>在文件中创建RDD 用<code>makeRDD</code></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BigDataSparkDay1</span>.wc</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">SPark02_RDD_Memory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//准备环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;RDD&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建RDD</span></span><br><span class="line">    <span class="comment">//从内存中创建RDD，将内存中集合的数据作为处理的数据源</span></span><br><span class="line">    <span class="keyword">val</span> seq = <span class="type">Seq</span>[<span class="type">Int</span>](<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//parallelize 并行</span></span><br><span class="line"><span class="comment">//    val rdd : RDD[Int]= sc.parallelize(seq)</span></span><br><span class="line">    <span class="comment">//makeRDD方法在底层实现时其实就是调用了rdd对象的parallelize方法 以后都用sc.makeRDD</span></span><br><span class="line">    <span class="keyword">val</span> rdd = sc.makeRDD(seq)</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    rdd.collect().foreach(println)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>剩下三种暂时说是用不到</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220722142947372.png" alt="image-20220722142947372"></p>
<h4 id="RDD读取文件-路径问题">RDD读取文件 路径问题</h4>
<p>代码注解中已经解释</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BigDataSparkDay1</span>.wc</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">SPark03_RDD_File</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 准备文件环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;RDD&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建RDD</span></span><br><span class="line">    <span class="comment">//从文件中创建RDD，将内存中集合的数据作为处理的数据源</span></span><br><span class="line">    <span class="comment">//path路径默认以当前环境的根路径为基准 可以写绝对路径也可以写相对路径</span></span><br><span class="line"><span class="comment">//    val rdd = sc.textFile(&quot;datas/1.txt&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//    val rdd:RDD[String] = sc.textFile(&quot;datas&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//也可以在HDFS在外部 读取</span></span><br><span class="line">    <span class="comment">//    sc.textFile(&quot;hdfs://hadoop86/test.txt&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//textFile:以行为单位来读取数据 读取是字符串</span></span><br><span class="line">    <span class="comment">//wholeTextFiles:以文件为单位来读取数据 读取的数据是元组 第一个数据是路径</span></span><br><span class="line">    <span class="keyword">val</span> rdd:<span class="type">RDD</span>[(<span class="type">String</span>,<span class="type">String</span>)] = sc.wholeTextFiles(<span class="string">&quot;datas&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    rdd.collect().foreach(println)</span><br><span class="line">    <span class="comment">//关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>总结：</p>
<p>RDD的使用在IDEA中，大致分为三步 准备环境 创建RDD 关闭环境</p>
<p>准备环境的代码基本很固定  而创建RDD 就要看是读取文件 还是直接在IDEA中配置</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BigDataSparkDay1</span>.wc</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">SPark02_RDD_Memory2</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 准备环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;RDD&quot;</span>)</span><br><span class="line">    sparkConf.set(<span class="string">&quot;spark.default.parallelism&quot;</span>,<span class="string">&quot;5&quot;</span>)  <span class="comment">//修改默认并行核数 为5 ‘0-4’</span></span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 创建RDD</span></span><br><span class="line">    <span class="comment">//RDD的并行度 &amp; 分区</span></span><br><span class="line">    <span class="comment">//makeRDD方法可以传递第二个参数,这个参数表示分区的数量</span></span><br><span class="line">    <span class="comment">// 第二个参数 numSlices可以不传递 有默认并行度 带了*所以是电脑CPU的并行核数 我是16个</span></span><br><span class="line">    <span class="keyword">val</span> rdd = sc.makeRDD(</span><br><span class="line">      <span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将处理的数据保存成分区文件</span></span><br><span class="line">    rdd.saveAsTextFile(<span class="string">&quot;output&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-BUG点-6">5.BUG点</h2>
<p>跟老师一模一样的代码报错，刚进入也不知道什么原因就按报错信息去CSDN搜，发现有人有一样的问题，在resources中配置一个log4j文件就好了，<strong>也不是刚开始怀疑的版本问题</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220723111109882.png" alt="image-20220723111109882"></p>
<h2 id="6-扩展学习部分-6">6.扩展学习部分</h2>
<h3 id="Linux中Spark部署">Linux中Spark部署</h3>
<p>步骤  克隆三台虚拟机</p>
<p>修改IP地址 主机名 和 映射</p>
<p>配置无密  创建xsync文件并配置信息 给其增加执行权限</p>
<p>下载rsync yum</p>
<p>分发命令<code>sbin/start -all.sh</code></p>
<h2 id="7-总结-7">7.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>昨天配置了spark在IDEA中的环境，并没有入门，今天对Spark进行一个上手入门，发现Spark框架，都是使用scala代码进行功能实现的，然后就是Linux系统中，Spark的环境部署，和框架搭建，因为不是自己负责的板块，听听作用就过去了，后面弄懂了什么是Spark以及执行原理和流程。今天难度还是有的，都是概念性的东西，要一个一个去记住和理解，明天就是转子算法的学习，就会有代码量了。</p>
<h1 id="7-22-Spark-RDD转换算子">7.22 Spark-RDD转换算子</h1>
<h2 id="1-头：日期、所学内容出处-12">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web">https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web</a></p>
<h2 id="2-标题-12">2.标题</h2>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">P40040</span>.尚硅谷_SparkCore - 核心编程 - RDD - 算子介绍	<span class="number">7</span>:<span class="number">49</span></span><br><span class="line"><span class="attribute">P41041</span>.尚硅谷_SparkCore - 核心编程 - RDD - 转换算子 - map	<span class="number">7</span>:<span class="number">46</span></span><br><span class="line"><span class="attribute">P42042</span>.尚硅谷_SparkCore - 核心编程 - RDD - 转换算子 - map - 小功能	<span class="number">5</span>:<span class="number">12</span></span><br><span class="line"><span class="attribute">P43043</span>.尚硅谷_SparkCore - 核心编程 - RDD - 转换算子 - map - 并行计算效果演示	<span class="number">8</span>:<span class="number">54</span></span><br><span class="line"><span class="attribute">P44044</span>.尚硅谷_SparkCore - 核心编程 - RDD - 转换算子 - mapPartitions	<span class="number">6</span>:<span class="number">12</span></span><br><span class="line"><span class="attribute">P45045</span>.尚硅谷_SparkCore - 核心编程 - RDD - 转换算子 - mapPartitions - 小练习	<span class="number">3</span>:<span class="number">49</span></span><br><span class="line"><span class="attribute">P46046</span>.尚硅谷_SparkCore - 核心编程 - RDD - 转换算子 - mapPartitions &amp; map的区别 - 完成比完美更重要</span><br><span class="line"><span class="attribute">P47047</span>.尚硅谷_SparkCore - 核心编程 - RDD - 转换算子 - mapPartitionsWithIndex	<span class="number">6</span>:<span class="number">30</span></span><br><span class="line"><span class="attribute">P48048</span>.尚硅谷_SparkCore - 核心编程 - RDD - 转换算子 - flatMap	<span class="number">5</span>:<span class="number">07</span></span><br><span class="line"><span class="attribute">P49049</span>.尚硅谷_SparkCore - 核心编程 - RDD - 转换算子 - flatMap - 小练习	<span class="number">2</span>:<span class="number">41</span></span><br><span class="line"><span class="attribute">P50050</span>.尚硅谷_SparkCore - 核心编程 - RDD - 转换算子 - glom	<span class="number">6</span>:<span class="number">33</span></span><br><span class="line"><span class="attribute">P51051</span>.尚硅谷_SparkCore - 核心编程 - RDD - 转换算子 - 理解分区不变的含义	<span class="number">6</span>:<span class="number">48</span></span><br><span class="line"><span class="attribute">P52052</span>.尚硅谷_SparkCore - 核心编程 - RDD - 转换算子 - groupBy	<span class="number">5</span>:<span class="number">25</span></span><br><span class="line"><span class="attribute">P53053</span>.尚硅谷_SparkCore - 核心编程 - RDD - 转换算子 - groupBy - shuffle来袭	<span class="number">6</span>:<span class="number">01</span></span><br><span class="line"><span class="attribute">P54054</span>.尚硅谷_SparkCore - 核心编程 - RDD - 转换算子 - groupBy - 小练习	<span class="number">7</span>:<span class="number">51</span></span><br><span class="line"><span class="attribute">P55055</span>.尚硅谷_SparkCore - 核心编程 - RDD - 转换算子 - filter - 数据倾斜	<span class="number">7</span>:<span class="number">11</span></span><br><span class="line"><span class="attribute">P56056</span>.尚硅谷_SparkCore - 核心编程 - RDD - 转换算子 - sample - 抽奖喽	<span class="number">16</span>:<span class="number">11</span></span><br><span class="line"><span class="attribute">057Core</span> - 核心编程 - RDD - 转换算子 - distinct</span><br><span class="line"><span class="attribute">058Core</span> - 核心编程 - RDD - 转换算子 - coalesce</span><br><span class="line"><span class="attribute">059Core</span> - 核心编程 - RDD - 转换算子 - repartition</span><br><span class="line"><span class="attribute">060Core</span> - 核心编程 - RDD - 转换算子 - sortBy</span><br><span class="line"><span class="attribute">061Core</span> - 核心编程 - RDD - 转换算子 - 交集&amp;并集&amp;差集&amp;拉链</span><br><span class="line"><span class="attribute">062Core</span> - 核心编程 - RDD - 转换算子 - 交集&amp;并集&amp;差集&amp;拉链 - 注意事项</span><br><span class="line"><span class="attribute">063Core</span> - 核心编程 - RDD - 转换算子 - partitionBy（前面有吸气，中间有等待）</span><br><span class="line"><span class="attribute">064Core</span> - 核心编程 - RDD - 转换算子 - partitionBy - 思考的问题</span><br><span class="line"><span class="attribute">065Core</span> - 核心编程 - RDD - 转换算子 - reduceByKey</span><br><span class="line"><span class="attribute">066Core</span> - 核心编程 - RDD - 转换算子 - groupByKey</span><br><span class="line"><span class="attribute">067Core</span> - 核心编程 - RDD - 转换算子 - groupByKey &amp; reduceByKey的区别</span><br><span class="line"><span class="attribute">068Core</span> - 核心编程 - RDD - 转换算子 - aggregateByKey</span><br><span class="line"><span class="attribute">069Core</span> - 核心编程 - RDD - 转换算子 - aggregateByKey - 图解</span><br><span class="line"><span class="attribute">070Core</span> - 核心编程 - RDD - 转换算子 - foldByKey</span><br><span class="line"><span class="attribute">071Core</span> - 核心编程 - RDD - 转换算子 - aggregateByKey - 小练习</span><br><span class="line"><span class="attribute">072Core</span> - 核心编程 - RDD - 转换算子 - aggregateByKey - 小练习 - 图解</span><br><span class="line"><span class="attribute">073Core</span> - 核心编程 - RDD - 转换算子 - combineByKey</span><br><span class="line"><span class="attribute">074Core</span> - 核心编程 - RDD - 转换算子 - 聚合算子的区别</span><br><span class="line"><span class="attribute">075Core</span> - 核心编程 - RDD - 转换算子 - join</span><br><span class="line"><span class="attribute">076Core</span> - 核心编程 - RDD - 转换算子 - leftOuterJoin &amp; rightOuterJoin</span><br><span class="line"><span class="attribute">077Core</span> - 核心编程 - RDD - 转换算子 - cogroup</span><br><span class="line"><span class="attribute">078Core</span> - 核心编程 - RDD - 案例实操 - 需求介绍 &amp; 分析</span><br><span class="line"><span class="attribute">079Core</span> - 核心编程 - RDD - 案例实操 - 需求设计</span><br><span class="line"><span class="attribute">080Core</span> - 核心编程 - RDD - 案例实操 - 功能实现</span><br><span class="line"><span class="attribute">081Core</span> - 核心编程 - RDD - 行动算子 - 介绍</span><br><span class="line"><span class="attribute">082Core</span> - 核心编程 - RDD - 行动算子 - 算子演示</span><br><span class="line"><span class="attribute">083Core</span> - 核心编程 - RDD - 行动算子 - aggregate</span><br><span class="line"><span class="attribute">084Core</span> - 核心编程 - RDD - 行动算子 - countByKey &amp; countByValue</span><br><span class="line"><span class="attribute">085Core</span> - 核心编程 - RDD - WordCount不同的实现方式 - (<span class="number">1</span>-<span class="number">8</span>)</span><br><span class="line"><span class="attribute">086Core</span> - 核心编程 - RDD - WordCount不同的实现方式 - (<span class="number">9</span>-<span class="number">11</span>)</span><br><span class="line"><span class="attribute">087Core</span> - 核心编程 - RDD - 行动算子 - save的方法</span><br><span class="line"><span class="attribute">088Core</span> - 核心编程 - RDD - 行动算子 - foreach</span><br><span class="line"><span class="attribute">089Core</span> - 核心编程 - RDD - 序列化 - 闭包检测</span><br><span class="line"><span class="attribute">090Core</span> - 核心编程 - RDD - 序列化 - 实际执行时的问题</span><br></pre></td></tr></table></figure>
<h2 id="3-所学内容概述-12">3.所学内容概述</h2>
<h2 id="4-根据概述分章节描述-10">4.根据概述分章节描述</h2>
<h3 id="RDD单Value转换算子">RDD单Value转换算子</h3>
<p>RDD根据处理方式的不同分为了Value类型 双Value 和Key-Value类型</p>
<p>代码都是在昨天三大步骤的基础上进行，改变点在创建RDD中，</p>
<p>看得出 如下代码是将List集合中每个值都*2  然后打印出来 用map方法转换 映射转换 在Scala的高级算法中有说明</p>
<h4 id="map">map</h4>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark01_RDD_Operator_Transform</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> sparkConf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --map</span></span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[<span class="type">Int</span>] = sc.makeRDD(<span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line">    <span class="comment">//2 4 6 8</span></span><br><span class="line">    <span class="comment">//转换函数</span></span><br><span class="line"><span class="comment">//    def mapFunction(num:Int)=&#123;num * 2&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//    val mapRDD = rdd.map(mapFunction)</span></span><br><span class="line">    <span class="keyword">val</span> mapRDD: <span class="type">RDD</span>[<span class="type">Int</span>] = rdd.map((_: <span class="type">Int</span>) * <span class="number">2</span>) <span class="comment">//匿名函数至简原则</span></span><br><span class="line"></span><br><span class="line">    mapRDD.collect().foreach(println)</span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如上map方法的执行效率会很低，因为是读一个执行一次，这样需要执行多次，就像IO中对文件的处理一样，IO流解决办法是使用缓冲流Buffer，在Spark也有一种方法类似，</p>
<h4 id="mapPartitions">mapPartitions</h4>
<p>将待处理的数据以分区为单位发送到计算节点进行处理</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark01_RDD_Operator_Transform_partitions</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> sparkConf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --map</span></span><br><span class="line">    <span class="keyword">val</span> rdd = sc.makeRDD(<span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>),<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*mapPartitions:</span></span><br><span class="line"><span class="comment">                   算子是以分区为单位进行批处理操作</span></span><br><span class="line"><span class="comment">                   算子会长时间占用内存，那么这样会导致内存可能</span></span><br><span class="line"><span class="comment">                   不够用，出现内存溢出的错误。所以在内存有限的情况下，不推荐使用。使用 map 操作。 */</span></span><br><span class="line">    <span class="keyword">val</span> rddMapPartitions = rdd.mapPartitions(</span><br><span class="line">      iter =&gt; &#123;</span><br><span class="line">        println(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&quot;</span>)</span><br><span class="line">        iter.map(_ * <span class="number">2</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    )</span><br><span class="line">    rddMapPartitions.collect().foreach(println)</span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">&gt;&gt;&gt;&gt;&gt;</span></span><br><span class="line"><span class="comment">&gt;&gt;&gt;&gt;&gt;</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">8</span></span><br></pre></td></tr></table></figure>
<p>看案例的执行结果，能分析出来mapPartitions是分区操作的，比如案例两个分区，就先执行一个分区，再是另外一个，性能是比map高的，<strong>缺点</strong>写在代码里面了</p>
<h4 id="mapPartitionsWithIndex">mapPartitionsWithIndex</h4>
<p>将待处理的数据以分区为单位发送到计算节点进行处理，这里的处理是指可以进行任意的处理，哪怕是过滤数据，在处理时同时可以<strong>获取当前分区索引</strong>。</p>
<p>小案例 获取数据分区的数据</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark01_RDD_Operator_Transform_partitionsWithIndex_Test</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --map</span></span><br><span class="line">    <span class="comment">//显示分区号</span></span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[<span class="type">Int</span>] = sc.makeRDD(<span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>),<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">val</span> rddMap:<span class="type">RDD</span>[(<span class="type">Int</span>,<span class="type">Int</span>)] = rdd.mapPartitionsWithIndex(</span><br><span class="line">      (index: <span class="type">Int</span>, iter: <span class="type">Iterator</span>[<span class="type">Int</span>]) =&gt; &#123;</span><br><span class="line">        iter.map(</span><br><span class="line">          (num: <span class="type">Int</span>) =&gt; &#123; <span class="comment">//将原本返回一个数据map 改成返回元组</span></span><br><span class="line">            (index, num) <span class="comment">//index是分区号 num是分区内的数据</span></span><br><span class="line">          &#125;</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    rddMap.collect().foreach(println)</span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="flatMap">flatMap</h4>
<p>将处理的数据进行扁平化后再进行映射处理，所以算子也称之为扁平映射</p>
<p>将 List(List(1,2),3,List(4,5))进行扁平化操作</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark02_RDD_Operator_Transform_TestFlat2</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --flatMap</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[<span class="type">Any</span>] = sc.makeRDD(<span class="type">List</span>(<span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>),<span class="number">3</span>,<span class="type">List</span>(<span class="number">4</span>,<span class="number">5</span>))) <span class="comment">//创建RDD集合</span></span><br><span class="line">    <span class="keyword">val</span> rddMap: <span class="type">RDD</span>[<span class="type">Any</span>] = rdd.flatMap &#123; <span class="comment">//读取</span></span><br><span class="line">      <span class="keyword">case</span> list1: <span class="type">List</span>[_] =&gt; list1 <span class="comment">//模式匹配 如果是List集合 直接返回</span></span><br><span class="line">      <span class="keyword">case</span> dat =&gt; <span class="type">List</span>(dat) <span class="comment">// 如果是其他值 转换成List集合后返回</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    rddMap.collect().foreach(println)</span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="glom">glom</h4>
<p>将同一个分区的数据直接转换为相同类型的内存数组进行处理  <strong>看代码执行过后是返回一个数组类型的</strong></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark02_RDD_Operator_Transform_Glom</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --flatMap</span></span><br><span class="line">    <span class="comment">//返回两个分区的数据的最大值相加</span></span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[<span class="type">Int</span>] = sc.makeRDD(<span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>),<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">val</span> glom: <span class="type">RDD</span>[<span class="type">Array</span>[<span class="type">Int</span>]] = rdd.glom()</span><br><span class="line">    <span class="comment">//取出两个分区的数据 用map进行数据执行</span></span><br><span class="line">    <span class="keyword">val</span> glomRDD: <span class="type">RDD</span>[<span class="type">Int</span>] = glom.map(</span><br><span class="line">      (array: <span class="type">Array</span>[<span class="type">Int</span>]) =&gt; &#123;</span><br><span class="line">        array.max <span class="comment">//2 4</span></span><br><span class="line">      &#125;</span><br><span class="line">    )</span><br><span class="line">    println(glomRDD.collect().foreach((data: <span class="type">Int</span>) =&gt; print(data + <span class="string">&quot;,&quot;</span>)))</span><br><span class="line">    println(glomRDD.sum())</span><br><span class="line">    </span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="groupBy">groupBy</h4>
<p>将数据源中的每个数据进行分组判断  根据返回的分组key 进行分组 相同的key值会放在一个组中</p>
<p><strong>注意分组和分区没有必然的关系</strong></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark04_RDD_Operator_Transform_GlomBy</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --flatMap</span></span><br><span class="line"><span class="comment">//  首字母一样的放一个组中</span></span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[<span class="type">String</span>] = sc.makeRDD(<span class="type">List</span>(<span class="string">&quot;Hello&quot;</span>,<span class="string">&quot;Spark&quot;</span>,<span class="string">&quot;Scala&quot;</span>,<span class="string">&quot;Hadoop&quot;</span>),<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">val</span> groupRDD: <span class="type">RDD</span>[(<span class="type">Char</span>, <span class="type">Iterable</span>[<span class="type">String</span>])] = rdd.groupBy((_: <span class="type">String</span>)(<span class="number">0</span>))</span><br><span class="line">    groupRDD.collect().foreach(println)</span><br><span class="line"></span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">(H,CompactBuffer(Hello, Hadoop))</span></span><br><span class="line"><span class="comment">(S,CompactBuffer(Spark, Scala))</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p>groupBy会把不同区的数据打乱，重新组合，这个操作我们称为shuffle</p>
<h4 id="filter">filter</h4>
<p>当数据进行筛选过滤后，分区不变，但是分区内的数据可能不均衡，生产环境下，可能会出现数据倾斜 <strong>了解</strong></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark05_RDD_Operator_Transform_filter_Test</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 准备SPark 环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --filter</span></span><br><span class="line">    <span class="comment">//将数据根据指定的规则进行筛选过滤，符合规则的数据保留，不符合规则的数据丢弃。</span></span><br><span class="line">    <span class="keyword">val</span> rdd = sc.textFile(<span class="string">&quot;datas/apache.log&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> rddFilter: <span class="type">RDD</span>[<span class="type">String</span>] = rdd.filter(</span><br><span class="line">      line =&gt; &#123;</span><br><span class="line">        <span class="keyword">val</span> time = line.split(<span class="string">&quot; &quot;</span>)(<span class="number">3</span>)</span><br><span class="line">        time.startsWith(<span class="string">&quot;17/05/2015&quot;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    )</span><br><span class="line">    rddFilter.collect().foreach(println)</span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="sample">sample</h4>
<p>根据指定的规则从数据集中抽取数据</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark06_RDD_Operator_Transform_sample</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 准备SPark 环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --filter</span></span><br><span class="line">    <span class="keyword">val</span> dataRDD: <span class="type">RDD</span>[<span class="type">Int</span>] = sc.makeRDD(<span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>))</span><br><span class="line">    <span class="comment">// 抽取数据不放回（伯努利算法）</span></span><br><span class="line">    <span class="comment">// 伯努利算法：又叫 0、1 分布。例如扔硬币，要么正面，要么反面。</span></span><br><span class="line">    <span class="comment">// 具体实现：根据种子和随机算法算出一个数和第二个参数设置几率比较，小于第二个参数要，大于不 要</span></span><br><span class="line">    <span class="comment">// 第一个参数：抽取的数据是否放回，false：不放回</span></span><br><span class="line">    <span class="comment">// 第二个参数：抽取的几率，范围在[0,1]之间,0：全不取；1：全取；</span></span><br><span class="line">    <span class="comment">// 第三个参数：随机数种子</span></span><br><span class="line">    <span class="keyword">val</span> dataRDD1: <span class="type">RDD</span>[<span class="type">Int</span>] = dataRDD.sample(withReplacement = <span class="literal">false</span>, <span class="number">0.5</span>)</span><br><span class="line">    <span class="comment">// 抽取数据放回（泊松算法）</span></span><br><span class="line">    <span class="comment">// 第一个参数：抽取的数据是否放回，true：放回；false：不放回</span></span><br><span class="line">    <span class="comment">// 第二个参数：重复数据的几率，范围大于等于 0.表示每一个元素被期望抽取到的次数</span></span><br><span class="line">    <span class="comment">// 第三个参数：随机数种子</span></span><br><span class="line">    <span class="keyword">val</span> dataRDD2: <span class="type">RDD</span>[<span class="type">Int</span>] = dataRDD.sample(withReplacement = <span class="literal">true</span>, <span class="number">2</span>)</span><br><span class="line">    println(<span class="string">&quot;不放回&quot;</span>)</span><br><span class="line">    println(dataRDD1.collect().mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    println(<span class="string">&quot;放回&quot;</span>)</span><br><span class="line">    println(dataRDD2.collect().mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="distinct">distinct</h4>
<p>将数据集中重复的数据去重</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark07_RDD_Operator_Transform_distinct</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 准备SPark 环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --distinct</span></span><br><span class="line">    <span class="comment">//将数据集中重复的数据去重</span></span><br><span class="line">    <span class="keyword">val</span> dataRDD: <span class="type">RDD</span>[<span class="type">Int</span>] = sc.makeRDD(<span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">21</span>,<span class="number">6</span>,<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">val</span> value: <span class="type">RDD</span>[<span class="type">Int</span>] = dataRDD.distinct() <span class="comment">//去重</span></span><br><span class="line">    <span class="keyword">val</span> value1: <span class="type">RDD</span>[<span class="type">Int</span>] = dataRDD.distinct(<span class="number">2</span>) <span class="comment">//先将2的倍数放前面去重</span></span><br><span class="line">    println(value.collect().mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    println(value1.collect().mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="coaleses-可增大-可减小">coaleses(可增大 可减小)</h4>
<p>对增减分区的操作</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark08_RDD_Operator_Transform_coalesce</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 准备SPark 环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --coalesce</span></span><br><span class="line">    <span class="comment">//根据数据量缩减分区，用于大数据集过滤后，提高小数据集的执行效率</span></span><br><span class="line">    <span class="comment">//当 spark 程序中，存在过多的小任务的时候，可以通过 coalesce 方法，收缩合并分区，减少</span></span><br><span class="line">    <span class="comment">//分区的个数，减小任务调度成本</span></span><br><span class="line">    <span class="keyword">val</span> dataRDD: <span class="type">RDD</span>[<span class="type">Int</span>] = sc.makeRDD(<span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">2</span>),<span class="number">6</span>) <span class="comment">//6个分区</span></span><br><span class="line">    <span class="comment">//变两个分区 第二个参数默认是false改成true就会随机打乱 就是groupBy那里提到的shuffle</span></span><br><span class="line">    <span class="comment">//如果设置shuffle为true coalesce就可以扩大分区</span></span><br><span class="line">    <span class="keyword">val</span> dataRDD1: <span class="type">RDD</span>[<span class="type">Int</span>] = dataRDD.coalesce(<span class="number">2</span>,<span class="literal">true</span>)</span><br><span class="line">    <span class="keyword">val</span> dataRDD1Index = dataRDD1.mapPartitionsWithIndex(</span><br><span class="line">      (index: <span class="type">Int</span>, group: <span class="type">Iterator</span>[<span class="type">Int</span>]) =&gt; &#123;</span><br><span class="line">        group.map(</span><br><span class="line">          (num:<span class="type">Int</span>) =&gt; (index,num)</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    )</span><br><span class="line">    dataRDD1Index.collect().foreach(println)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="repartition">repartition</h4>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark09_RDD_Operator_Transform_repartition</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 准备SPark 环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --repartition</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> dataRDD: <span class="type">RDD</span>[<span class="type">Int</span>] = sc.makeRDD(<span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">2</span>),<span class="number">2</span>) <span class="comment">//2个分区</span></span><br><span class="line">    <span class="keyword">val</span> dataRDD2: <span class="type">RDD</span>[<span class="type">Int</span>] = dataRDD.repartition(<span class="number">4</span>) <span class="comment">//变4个分区 默认shuffle是false</span></span><br><span class="line">    <span class="keyword">val</span> dataRDD2Index: <span class="type">RDD</span>[(<span class="type">Int</span>, <span class="type">Int</span>)] = dataRDD2.mapPartitionsWithIndex(</span><br><span class="line">      (index: <span class="type">Int</span>, group: <span class="type">Iterator</span>[<span class="type">Int</span>]) =&gt; &#123;</span><br><span class="line">        group.map(</span><br><span class="line">          (num:<span class="type">Int</span>) =&gt; (index,num)</span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    )</span><br><span class="line">    dataRDD2Index.collect().foreach(println)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="coalesce-和-repartition-区别">coalesce 和 repartition 区别</h4>
<p>repartition 一定会发生 shuffle，coalesce 根据传进来的参数来判断是否发生 shuffle。<br>
一般情况下<strong>增大rdd的partition数量</strong>使用<strong>repartition</strong>，<strong>减少partition数量时</strong>使用<strong>coalesce</strong></p>
<h4 id="sortBy">sortBy</h4>
<p>该操作用于排序数据。在排序之前，可以将数据通过 f 函数进行处理，之后按照 f 函数处理的结果进行排序</p>
<p>排序是不管多少分区的，所以sortBy执行过程一定存在shuffle打乱的过程</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark10_RDD_Operator_Transform_sortBy</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 准备SPark 环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --repartition</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> dataRDD: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = sc.makeRDD(<span class="type">List</span>((<span class="string">&quot;1&quot;</span>,<span class="number">1</span>),(<span class="string">&quot;11&quot;</span>,<span class="number">2</span>),(<span class="string">&quot;2&quot;</span>,<span class="number">3</span>))) <span class="comment">//2个分区</span></span><br><span class="line">    <span class="comment">//默认是true是升序 false是降序</span></span><br><span class="line">    <span class="keyword">val</span> dataRDD1: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = dataRDD.sortBy((t: (<span class="type">String</span>, <span class="type">Int</span>)) =&gt; t._1.toInt,ascending = <span class="literal">false</span>)</span><br><span class="line">    println(dataRDD1.collect().mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="RDD双Value转换算子">RDD双Value转换算子</h3>
<p>两个数据源之间的关联操作</p>
<h4 id="集合基本操作">集合基本操作</h4>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark11_RDD_Operator_Transform_DoubleValue</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 准备SPark 环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 -- 双Value基本集合操作</span></span><br><span class="line">    <span class="comment">//注意 交集 差集 并集 类型都要一致</span></span><br><span class="line">    <span class="keyword">val</span> dataRDD1 = sc.makeRDD(<span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line">    <span class="keyword">val</span> dataRDD2: <span class="type">RDD</span>[<span class="type">Int</span>] = sc.makeRDD(<span class="type">List</span>(<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>))</span><br><span class="line">    <span class="keyword">val</span> dataRDDIn = dataRDD1.intersection(dataRDD2) <span class="comment">//3,4 交集</span></span><br><span class="line">    <span class="keyword">val</span> dataRDDUn = dataRDD1.union(dataRDD2) <span class="comment">//1,2,3,4,3,4,5,6 并集</span></span><br><span class="line">    <span class="keyword">val</span> dataRDDSu: <span class="type">RDD</span>[<span class="type">Int</span>] = dataRDD1.subtract(dataRDD2) <span class="comment">// 1,2 差集 .前面集合为主 和后面不交的</span></span><br><span class="line">    <span class="keyword">val</span> dataRDDZip = dataRDD1.zip(dataRDD2) <span class="comment">// 拉链 将两个 RDD 中的元素，以键值对的形式进行合并 对应的 .zip前面的是key</span></span><br><span class="line">    println(dataRDDZip.collect().mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="partitionBy">partitionBy</h4>
<p>Spark的分区器</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">HashPartitioner</span>, <span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark12_RDD_Operator_Transform_partitionBy</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 准备SPark 环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 -- keys-value</span></span><br><span class="line">    <span class="comment">//将数据按照指定 Partitioner 重新进行分区。Spark 默认的分区器是 HashPartitioner</span></span><br><span class="line">    <span class="comment">//就是通过partitionBy方法改变数据的分区</span></span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[(<span class="type">Int</span>, <span class="type">String</span>)] = sc.makeRDD(<span class="type">Array</span>((<span class="number">1</span>,<span class="string">&quot;aaa&quot;</span>),(<span class="number">2</span>,<span class="string">&quot;bbb&quot;</span>),(<span class="number">3</span>,<span class="string">&quot;ccc&quot;</span>),(<span class="number">4</span>,<span class="string">&quot;DDD&quot;</span>)),<span class="number">2</span>) <span class="comment">//hash是默认取余</span></span><br><span class="line"><span class="comment">//    可以模仿HashPartitioner自己写自己的分区器</span></span><br><span class="line">    rdd.partitionBy(<span class="keyword">new</span> <span class="type">HashPartitioner</span>(<span class="number">2</span>)).saveAsTextFile(<span class="string">&quot;output&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>reduceByKey</strong></p>
<p>最开始在WordCount就有用到，元组聚合 相同key聚合</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">HashPartitioner</span>, <span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark13_RDD_Operator_Transform_reduceByKey</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 准备SPark 环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 -- keys-value</span></span><br><span class="line">    <span class="keyword">val</span> rdd = sc.makeRDD(<span class="type">List</span>(</span><br><span class="line">    (<span class="string">&quot;a&quot;</span>,<span class="number">1</span>),(<span class="string">&quot;a&quot;</span>,<span class="number">2</span>),(<span class="string">&quot;a&quot;</span>,<span class="number">3</span>),(<span class="string">&quot;b&quot;</span>,<span class="number">3</span>)</span><br><span class="line">    ))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rddKey: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = rdd.reduceByKey((_: <span class="type">Int</span>) + (_: <span class="type">Int</span>))</span><br><span class="line">    println(rddKey.collect().mkString(<span class="string">&quot;,&quot;</span>)) <span class="comment">//(a,6)(b,3)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>groupByKey</strong></p>
<p>分组将数据源的数据根据 key 对 value 进行分组</p>
<p>返回值第一个是key 第二个是元组,元组内是相同key的值</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark14_RDD_Operator_Transform_groupByKey</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 准备SPark 环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 -- keys-value</span></span><br><span class="line">    <span class="keyword">val</span> rdd = sc.makeRDD(<span class="type">List</span>(</span><br><span class="line">    (<span class="string">&quot;a&quot;</span>,<span class="number">1</span>),(<span class="string">&quot;a&quot;</span>,<span class="number">2</span>),(<span class="string">&quot;a&quot;</span>,<span class="number">3</span>),(<span class="string">&quot;b&quot;</span>,<span class="number">3</span>)</span><br><span class="line">    ))</span><br><span class="line">    <span class="keyword">val</span> rddKey1 = rdd.groupBy(_._1)</span><br><span class="line">    <span class="keyword">val</span> rddKey = rdd.groupByKey()</span><br><span class="line">    println(rddKey.collect().mkString(<span class="string">&quot; ,&quot;</span>)) <span class="comment">//(a,CompactBuffer(1, 2, 3)),(b,CompactBuffer(3))</span></span><br><span class="line">    println(rddKey1.collect().mkString(<span class="string">&quot; ,&quot;</span>)) <span class="comment">// (a,CompactBuffer((a,1), (a,2), (a,3))),(b,CompactBuffer((b,3)))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>reduceByKey 和 groupByKey 的区别</p>
<p>reduceByKey 其实包含分组和聚合的功能。GroupByKey 只能分组，不能聚合，所以在分组聚合的场合下，推荐使用 reduceByKey，如果仅仅是分组而不需要聚合。那么还是只能使用 groupByKey</p>
<h4 id="aggregateByKey">aggregateByKey</h4>
<p>将数据根据不同的规则进行分区内计算和分区间计算</p>
<p>两个分区先取最大值 (a,2)(c,3) + (a,5)(c,6)</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span>.rddToPairRDDFunctions</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark15_RDD_Operator_Transform_aggregateByKey</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 准备SPark 环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --  取出每个分区内相同 key 的最大值然后分区间相加</span></span><br><span class="line">    <span class="comment">// aggregateByKey 算子是函数柯里化，存在两个参数列表</span></span><br><span class="line">    <span class="comment">// 1. 第一个参数列表中的参数表示初始值</span></span><br><span class="line">    <span class="comment">//主要用于当碰见第一个key 的时候 和value进行分区计算</span></span><br><span class="line">    <span class="comment">// 2. 第二个参数列表中含有两个参数</span></span><br><span class="line">    <span class="comment">// 2.1 第一个参数表示分区内的计算规则</span></span><br><span class="line">    <span class="comment">// 2.2 第二个参数表示分区间的计算规则</span></span><br><span class="line">    <span class="keyword">val</span> rdd = &#123;</span><br><span class="line">      sc.makeRDD(<span class="type">List</span>(</span><br><span class="line">        (<span class="string">&quot;a&quot;</span>,<span class="number">1</span>),(<span class="string">&quot;a&quot;</span>,<span class="number">2</span>),(<span class="string">&quot;c&quot;</span>,<span class="number">3</span>),</span><br><span class="line">        (<span class="string">&quot;c&quot;</span>,<span class="number">4</span>),(<span class="string">&quot;a&quot;</span>,<span class="number">5</span>),(<span class="string">&quot;c&quot;</span>,<span class="number">6</span>)</span><br><span class="line">      ),<span class="number">2</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    rdd.aggregateByKey(<span class="number">0</span>)(</span><br><span class="line">      (x, y) =&gt; math.max(x, y),</span><br><span class="line">      (x, y) =&gt; x + y</span><br><span class="line">    ).collect().foreach(println)</span><br><span class="line">      <span class="comment">//(a,7)</span></span><br><span class="line">      <span class="comment">//(c,9)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>foldByKey</strong></p>
<p>当分区内计算规则和分区间计算规则相同时，aggregateByKey 就可以简化为 foldByKey</p>
<p>两边分区相同key先加 加完分区间key加</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> dataRDD1 = sparkContext.makeRDD(<span class="type">List</span>((<span class="string">&quot;a&quot;</span>,<span class="number">1</span>),(<span class="string">&quot;b&quot;</span>,<span class="number">2</span>),(<span class="string">&quot;c&quot;</span>,<span class="number">3</span>)))</span><br><span class="line"><span class="keyword">val</span> dataRDD2 = dataRDD1.foldByKey(<span class="number">0</span>)(_+_)</span><br></pre></td></tr></table></figure>
<p><strong>combineByKey</strong></p>
<p>最通用的对 key-value 型 rdd 进行聚集操作的聚集函数</p>
<p>允许用户返回值的类型与输入不一致。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span>.rddToPairRDDFunctions</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark16_RDD_Operator_Transform_combineByKey</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 准备SPark 环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --  combineByKey</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rdd = &#123;</span><br><span class="line">      sc.makeRDD(<span class="type">List</span>(</span><br><span class="line">        (<span class="string">&quot;a&quot;</span>,<span class="number">1</span>),(<span class="string">&quot;a&quot;</span>,<span class="number">2</span>),(<span class="string">&quot;b&quot;</span>,<span class="number">3</span>),</span><br><span class="line">        (<span class="string">&quot;b&quot;</span>,<span class="number">4</span>),(<span class="string">&quot;b&quot;</span>,<span class="number">5</span>),(<span class="string">&quot;a&quot;</span>,<span class="number">6</span>)</span><br><span class="line">      ),<span class="number">2</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//方法需要三个参数</span></span><br><span class="line">    <span class="comment">//第一个 将相同key的第一个数据进行结构的转换 实现操作</span></span><br><span class="line">    <span class="comment">//第二个 分区内运算</span></span><br><span class="line">    <span class="comment">//第三个 分区间运算</span></span><br><span class="line">    <span class="keyword">val</span> newRDD: <span class="type">RDD</span>[(<span class="type">String</span>, (<span class="type">Int</span>, <span class="type">Int</span>))] = rdd.combineByKey(</span><br><span class="line">      (v: <span class="type">Int</span>) =&gt; (v, <span class="number">1</span>),</span><br><span class="line">      (x: (<span class="type">Int</span>, <span class="type">Int</span>), y: <span class="type">Int</span>) =&gt; &#123;</span><br><span class="line">        (x._1 + y, x._2 + <span class="number">1</span>)</span><br><span class="line">      &#125;,</span><br><span class="line">      (t1: (<span class="type">Int</span>, <span class="type">Int</span>), t2: (<span class="type">Int</span>, <span class="type">Int</span>)) =&gt; &#123;</span><br><span class="line">        (t1._1 + t2._1, t1._2 + t2._2)</span><br><span class="line">      &#125;</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> resultRDD: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = newRDD.mapValues &#123; <span class="comment">//元组内int /</span></span><br><span class="line">      <span class="keyword">case</span> (num, count) =&gt; num / count</span><br><span class="line">    &#125;</span><br><span class="line">    println(newRDD.collect().mkString(<span class="string">&quot; ,&quot;</span>))  <span class="comment">//(b,(12,3)),(a,(9,3))</span></span><br><span class="line">    println(resultRDD.collect().mkString(<span class="string">&quot;,&quot;</span>)) <span class="comment">// (b,4),(a,3)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>sortByKey</strong></p>
<p>在一个(K,V)的 RDD 上调用，K 必须实现 Ordered 接口(特质)，返回一个按照 key 进行排序</p>
<p>上限比较高 可以自定义类 当作key</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> dataRDD1 = sparkContext.makeRDD(<span class="type">List</span>((<span class="string">&quot;a&quot;</span>,<span class="number">1</span>),(<span class="string">&quot;b&quot;</span>,<span class="number">2</span>),(<span class="string">&quot;c&quot;</span>,<span class="number">3</span>)))</span><br><span class="line"><span class="keyword">val</span> sortRDD1: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = dataRDD1.sortByKey(<span class="literal">true</span>)</span><br><span class="line"><span class="keyword">val</span> sortRDD1: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = dataRDD1.sortByKey(<span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
<p><strong>join</strong></p>
<p>在类型为(K,V)和(K,W)的 RDD 上调用，返回一个相同 key 对应的所有元素连接在一起的(K,(V,W))的 RDD</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span>.rddToPairRDDFunctions</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark17_RDD_Operator_Transform_join</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 准备SPark 环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --  join</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = sc.makeRDD(<span class="type">List</span>((<span class="string">&quot;a&quot;</span>,<span class="number">1</span>),(<span class="string">&quot;b&quot;</span>,<span class="number">2</span>),(<span class="string">&quot;c&quot;</span>,<span class="number">3</span>)))</span><br><span class="line">    <span class="keyword">val</span> rdd1: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = sc.makeRDD(<span class="type">List</span>((<span class="string">&quot;b&quot;</span>,<span class="number">4</span>),(<span class="string">&quot;a&quot;</span>,<span class="number">5</span>),(<span class="string">&quot;c&quot;</span>,<span class="number">3</span>)))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> joinRDD: <span class="type">RDD</span>[(<span class="type">String</span>, (<span class="type">Int</span>, <span class="type">Int</span>))] = rdd.join(rdd1)</span><br><span class="line">    <span class="comment">/*join两个相同的key的value会连接在一起形成元组 不同的key 不会返回</span></span><br><span class="line"><span class="comment">            (a,(1,5))</span></span><br><span class="line"><span class="comment">            (b,(2,4))</span></span><br><span class="line"><span class="comment">            (c,(3,3))</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    joinRDD.mapValues&#123; <span class="keyword">case</span> (x,y) =&gt; x+y &#125;.collect().foreach(println)</span><br><span class="line">    joinRDD.collect().foreach(println)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>cogroup</strong></p>
<p>在类型为(K,V)和(K,W)的 RDD 上调用，返回一个(K,(Iterable<V>,Iterable<W>))类型的 RDD</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span>.rddToPairRDDFunctions</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark18_RDD_Operator_Transform_cogroup</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 准备SPark 环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --  join</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = sc.makeRDD(<span class="type">List</span>((<span class="string">&quot;a&quot;</span>,<span class="number">1</span>),(<span class="string">&quot;b&quot;</span>,<span class="number">2</span>)))</span><br><span class="line">    <span class="keyword">val</span> rdd1: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = sc.makeRDD(<span class="type">List</span>((<span class="string">&quot;b&quot;</span>,<span class="number">4</span>),(<span class="string">&quot;a&quot;</span>,<span class="number">5</span>),(<span class="string">&quot;c&quot;</span>,<span class="number">3</span>),(<span class="string">&quot;c&quot;</span>,<span class="number">6</span>)))</span><br><span class="line">    <span class="keyword">val</span> rdd2: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = sc.makeRDD(<span class="type">List</span>((<span class="string">&quot;c&quot;</span>,<span class="number">4</span>),(<span class="string">&quot;e&quot;</span>,<span class="number">5</span>),(<span class="string">&quot;a&quot;</span>,<span class="number">3</span>),(<span class="string">&quot;a&quot;</span>,<span class="number">6</span>)))</span><br><span class="line">    <span class="comment">//cogroup = connect + group  分区完了 分组</span></span><br><span class="line">    rdd.cogroup(rdd1,rdd2).collect().foreach(println)</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    (a,(CompactBuffer(1),CompactBuffer(5),CompactBuffer(3, 6)))</span></span><br><span class="line"><span class="comment">    (b,(CompactBuffer(2),CompactBuffer(4),CompactBuffer()))</span></span><br><span class="line"><span class="comment">    (c,(CompactBuffer(),CompactBuffer(3, 6),CompactBuffer(4)))</span></span><br><span class="line"><span class="comment">    (e,(CompactBuffer(),CompactBuffer(),CompactBuffer(5)))</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>leftOuterJoin</strong></p>
<p>类似于 SQL 语句的左外连接</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span>.rddToPairRDDFunctions</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark19_RDD_Operator_Transform_leftOuterJoin</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 准备SPark 环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --  join</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rdd1: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = sc.makeRDD(<span class="type">List</span>((<span class="string">&quot;b&quot;</span>,<span class="number">4</span>),(<span class="string">&quot;a&quot;</span>,<span class="number">5</span>),(<span class="string">&quot;c&quot;</span>,<span class="number">3</span>)))</span><br><span class="line">    <span class="keyword">val</span> rdd2: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = sc.makeRDD(<span class="type">List</span>((<span class="string">&quot;b&quot;</span>,<span class="number">3</span>),(<span class="string">&quot;a&quot;</span>,<span class="number">2</span>),(<span class="string">&quot;c&quot;</span>,<span class="number">6</span>)))</span><br><span class="line">    rdd1.leftOuterJoin(rdd2).collect().foreach(println)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    sc.stop()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-BUG点-7">5.BUG点</h2>
<p>在RDD操作中有一项拉链操作，就是将两组集合变成key-Vlaue类型的，在Scala中，如果两组数据不一样长，Vlaue会变成默认值，但是在RDD中我就出现了报错，报错信息说两组RDD值长度要一样。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://docimg4.docs.qq.com/image/5NktxWQQgO1OFMYZkNdtfg.png?w=1820&amp;h=479" alt="img"></p>
<h2 id="6-扩展学习部分-7">6.扩展学习部分</h2>
<p>用Spark读取文件 一行一行 并用map读取路径</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark01_RDD_Operator_Transform_Test</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> sparkConf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 算子 --map</span></span><br><span class="line">    <span class="keyword">val</span> text = sc.textFile(<span class="string">&quot;datas/apache.log&quot;</span>) <span class="comment">//读取文件</span></span><br><span class="line">    <span class="keyword">val</span> value = text.map(</span><br><span class="line">      (line: <span class="type">String</span>) =&gt;&#123;<span class="comment">//获取行</span></span><br><span class="line">        <span class="keyword">val</span> strings: <span class="type">Array</span>[<span class="type">String</span>] = line.split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">        strings(<span class="number">6</span>)<span class="comment">//以空格切割成数组并取第6个数据</span></span><br><span class="line">      &#125;</span><br><span class="line">    )</span><br><span class="line">    value.collect().foreach(println)</span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220722145042216.png" alt="image-20220722145042216"></p>
<h2 id="7-总结-8">7.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>今天的学习内容是算法方面的，Spark独有的，转换算子，将scala中的优秀特质结合，把RDD中的数据做各种各样的处理，有25个左右的方法，单Value和双Value的都有，难度是很大的，偏向算法，比之前的scala集合的高阶还难不少，想搞定这个还得在去看一下scala集合的高阶方法，元组方面用的比较多，这样能让代码很简洁，自己去CSDN搜了scala的自动类型补全，这样理解起来比之前好了很多。掌握程度70%，因为在赶进度，有些小案例没去敲，更多是自己的理解，结合文档的讲解。方法太多了，也不是很能记住，还是得等案例的时候，能上场使用一下，这样对自己理解有很大的帮助。</p>
<h1 id="7-23-Spark-RDD完结">7.23 Spark-RDD完结</h1>
<h2 id="1-头：日期、所学内容出处-13">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web">https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web</a></p>
<h2 id="2-标题-13">2.标题</h2>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">081</span>Core - 核心编程 - RDD - 行动算子 - 介绍</span><br><span class="line"><span class="number">082</span>Core - 核心编程 - RDD - 行动算子 - 算子演示</span><br><span class="line"><span class="number">083</span>Core - 核心编程 - RDD - 行动算子 - aggregate</span><br><span class="line"><span class="number">084</span>Core - 核心编程 - RDD - 行动算子 - countByKey <span class="meta">&amp; countByValue</span></span><br><span class="line"><span class="number">085</span>Core - 核心编程 - RDD - WordCount不同的实现方式 - (<span class="number">1</span>-<span class="number">8</span>)</span><br><span class="line"><span class="number">086</span>Core - 核心编程 - RDD - WordCount不同的实现方式 - (<span class="number">9</span>-<span class="number">11</span>)</span><br><span class="line"><span class="number">087</span>Core - 核心编程 - RDD - 行动算子 - save的方法</span><br><span class="line"><span class="number">088</span>Core - 核心编程 - RDD - 行动算子 - foreach</span><br><span class="line"><span class="number">089</span>Core - 核心编程 - RDD - 序列化 - 闭包检测</span><br><span class="line"><span class="number">090</span>Core - 核心编程 - RDD - 序列化 - 实际执行时的问题</span><br><span class="line"><span class="number">091</span>Core - 核心编程 - RDD - 序列化 - Kryo序列化Core介绍</span><br><span class="line"><span class="number">092</span>Core - 核心编程 - RDD - 依赖关系 - 依赖 <span class="meta">&amp; 血缘关系介绍</span></span><br><span class="line"><span class="number">093</span>Core - 核心编程 - RDD - 依赖关系 - 血缘关系 - 演示</span><br><span class="line"><span class="number">094</span>Core - 核心编程 - RDD - 依赖关系 - 宽窄依赖</span><br><span class="line"><span class="number">095</span>Core - 核心编程 - RDD - 依赖关系 - 阶段<span class="meta">&amp;分区&amp;任务 - 概念解析 - 秋游了</span></span><br><span class="line"><span class="number">096</span>Core - 核心编程 - RDD - 依赖关系 - 阶段划分源码解读</span><br><span class="line"><span class="number">097</span>Core - 核心编程 - RDD - 依赖关系 - 任务划分源码解读</span><br><span class="line"><span class="number">098</span>Core - 核心编程 - RDD - 依赖关系 - 任务分类</span><br><span class="line"><span class="number">099</span>Core - 核心编程 - RDD - 持久化 - cache <span class="meta">&amp; persist基本原理和演示</span></span><br><span class="line"><span class="number">100</span>Core - 核心编程 - RDD - 持久化 - 作用</span><br><span class="line"><span class="number">101</span>Core - 核心编程 - RDD - 持久化 - 检查点</span><br><span class="line"><span class="number">102</span>Core - 核心编程 - RDD - 持久化 - 区别</span><br></pre></td></tr></table></figure>
<h2 id="3-所学内容概述-13">3.所学内容概述</h2>
<h3 id="行动算子">行动算子</h3>
<h4 id="序列化">序列化</h4>
<h4 id="依赖关系">依赖关系</h4>
<h4 id="持久化">持久化</h4>
<h2 id="4-根据概述分章节描述-11">4.根据概述分章节描述</h2>
<h3 id="RDD行动算子">RDD行动算子</h3>
<p>行动算子就是触发作业(job)执行的方法<br>
底层代码调用的是环境对象的runJob</p>
<h4 id="reduce">reduce</h4>
<p>以及基本简单方法</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay3</span>.action</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark02_RDD_Operator_reduce</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">// 创建连接</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[<span class="type">Int</span>] = sc.makeRDD(<span class="type">List</span>(<span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 行动算子</span></span><br><span class="line">    <span class="comment">//reduce</span></span><br><span class="line">    <span class="keyword">val</span> i: <span class="type">Int</span> = rdd.reduce((_: <span class="type">Int</span>) + (_: <span class="type">Int</span>))</span><br><span class="line">    println(i) <span class="comment">// 10</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//collect 采集 方法会将不同分区的数据按照分区顺序采集到Driver端内存中，形成数组</span></span><br><span class="line">    <span class="keyword">val</span> ints: <span class="type">Array</span>[<span class="type">Int</span>] = rdd.collect()</span><br><span class="line">    println(ints.mkString(<span class="string">&quot;,&quot;</span>)) <span class="comment">// 1,4,3,2</span></span><br><span class="line">    <span class="comment">// count返回 RDD 中元素的个数</span></span><br><span class="line">    <span class="keyword">val</span> countResult: <span class="type">Long</span> = rdd.count()</span><br><span class="line">    println(countResult) <span class="comment">// 4</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// first 返回RDD第一个元素</span></span><br><span class="line">    println(rdd.first())</span><br><span class="line">    <span class="comment">//take 返回一个由 RDD 的前 n 个元素组成的数组</span></span><br><span class="line">    <span class="keyword">val</span> ints1: <span class="type">Array</span>[<span class="type">Int</span>] = rdd.take(<span class="number">3</span>)</span><br><span class="line">    println(ints1.mkString(<span class="string">&quot;,&quot;</span>)) <span class="comment">//1,4,3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//takeOrdered 返回该 RDD 排序后的前 n 个元素组成的数组</span></span><br><span class="line">    <span class="keyword">val</span> ints2: <span class="type">Array</span>[<span class="type">Int</span>] = rdd.takeOrdered(<span class="number">3</span>) <span class="comment">//1,2,3</span></span><br><span class="line">    println(ints2.mkString(<span class="string">&quot;,&quot;</span>))</span><br><span class="line"></span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="collect">collect</h4>
<p>在驱动程序中，以数组 Array 的形式返回数据集的所有元素</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay3</span>.action</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark01_RDD_Operator_Action</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">// 创建连接</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[<span class="type">Int</span>] = sc.makeRDD(<span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 行动算子</span></span><br><span class="line">    <span class="comment">//行动算子就是触发作业(job)执行的方法</span></span><br><span class="line">    <span class="comment">//底层代码调用的是环境对象的runJob</span></span><br><span class="line">    rdd.collect() <span class="comment">//collect就是行动算子</span></span><br><span class="line"></span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="aggregate-fold">aggregate &amp; fold</h4>
<p>分区的数据通过初始值和分区内的数据进行聚合，然后再和初始值进行分区间的数据聚合</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay3</span>.action</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark03_RDD_Operator_aggregate</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">// 创建连接</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[<span class="type">Int</span>] = sc.makeRDD(<span class="type">List</span>(<span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>),<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 行动算子</span></span><br><span class="line">    <span class="comment">// 将该 RDD 所有元素相加得到结果</span></span><br><span class="line">    <span class="comment">//初始值参与分区内的计算 分区间计算也有</span></span><br><span class="line">    <span class="keyword">val</span> result1: <span class="type">Int</span> = rdd.aggregate(<span class="number">0</span>)(_ + _, _ + _)</span><br><span class="line">    <span class="keyword">val</span> result2: <span class="type">Int</span> = rdd.aggregate(<span class="number">10</span>)(_ + _, _ + _) <span class="comment">//初始值看分区间</span></span><br><span class="line">    println(result1)<span class="comment">//10</span></span><br><span class="line">    println(result2)<span class="comment">//40 1+4+10 + 3+2+10 + 10</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//fold aggregate的简化操作</span></span><br><span class="line">    <span class="keyword">val</span> foldResult1: <span class="type">Int</span> = rdd.fold(<span class="number">0</span>)(_+_) <span class="comment">//分区内和分区间一样的操作</span></span><br><span class="line">    <span class="keyword">val</span> foldResult2: <span class="type">Int</span> = rdd.fold(<span class="number">10</span>)(_+_) <span class="comment">//分区内和分区间一样的操作</span></span><br><span class="line">    println(foldResult1) <span class="comment">//10</span></span><br><span class="line">    println(foldResult2) <span class="comment">//40 15 + 15 +10</span></span><br><span class="line"></span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="countByKey-countByValue">countByKey &amp; countByValue</h4>
<p>统计每种 key 的个数</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay3</span>.action</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark04_RDD_Operator_countByKey</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">// 创建连接</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 行动算子</span></span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[(<span class="type">Int</span>, <span class="type">String</span>)] = sc.makeRDD(<span class="type">List</span>((<span class="number">1</span>, <span class="string">&quot;a&quot;</span>), (<span class="number">1</span>, <span class="string">&quot;a&quot;</span>), (<span class="number">1</span>, <span class="string">&quot;a&quot;</span>), (<span class="number">2</span>, <span class="string">&quot;b&quot;</span>), (<span class="number">3</span>, <span class="string">&quot;c&quot;</span>), (<span class="number">3</span>, <span class="string">&quot;c&quot;</span>)))</span><br><span class="line"></span><br><span class="line">    <span class="comment">//统计每种key的个数</span></span><br><span class="line">    <span class="keyword">val</span> resultKey: collection.<span class="type">Map</span>[<span class="type">Int</span>, <span class="type">Long</span>] = rdd.countByKey()</span><br><span class="line">    <span class="keyword">val</span> resultValue: collection.<span class="type">Map</span>[(<span class="type">Int</span>, <span class="type">String</span>), <span class="type">Long</span>] = rdd.countByValue()</span><br><span class="line">    println(resultKey) <span class="comment">//key出现了几次</span></span><br><span class="line">    println(resultValue) <span class="comment">// RDD内的元素出现了几次</span></span><br><span class="line"></span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="save相关算子">save相关算子</h4>
<p>保存文件</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay3</span>.action</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark05_RDD_Operator_Save</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">// 创建连接</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 行动算子</span></span><br><span class="line">    <span class="comment">//save 将RDD数据保存到不同格式的文件中</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[(<span class="type">Int</span>, <span class="type">String</span>)] = sc.makeRDD(<span class="type">List</span>((<span class="number">1</span>, <span class="string">&quot;a&quot;</span>), (<span class="number">1</span>, <span class="string">&quot;a&quot;</span>), (<span class="number">1</span>, <span class="string">&quot;a&quot;</span>), (<span class="number">2</span>, <span class="string">&quot;b&quot;</span>), (<span class="number">3</span>, <span class="string">&quot;c&quot;</span>), (<span class="number">3</span>, <span class="string">&quot;c&quot;</span>)))</span><br><span class="line">    <span class="comment">// 保存成 Text 文件</span></span><br><span class="line">    rdd.saveAsTextFile(<span class="string">&quot;output&quot;</span>) <span class="comment">//比较常用</span></span><br><span class="line">    <span class="comment">// 序列化成对象保存到文件</span></span><br><span class="line">    rdd.saveAsObjectFile(<span class="string">&quot;output1&quot;</span>)</span><br><span class="line">    <span class="comment">// 保存成 Sequencefile 文件 要求数据格式必须是key-Value类型</span></span><br><span class="line">    rdd.saveAsSequenceFile(<span class="string">&quot;output2&quot;</span>)</span><br><span class="line"></span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="foreach">foreach</h4>
<p>分布式遍历 RDD 中的每一个元素，调用指定函数  下文有行动算子的执行原理解释</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay3</span>.action</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark06_RDD_Operator_Foreach</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">// 创建连接</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;Operator&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 行动算子</span></span><br><span class="line">    <span class="comment">//算子： Operator（操作）</span></span><br><span class="line">    <span class="comment">//  RDD的方法和Scala集合对象的方法不一样</span></span><br><span class="line"><span class="comment">//    集合对象的方法都是在同一个节点的内存中完成的</span></span><br><span class="line"><span class="comment">//    RDD的方法可以将计算逻辑发送到Executor端执行</span></span><br><span class="line"><span class="comment">//    为了区分不同的处理效果，所以将RDD的方法称之为算子</span></span><br><span class="line"><span class="comment">//    RDD的方法的操作都是在Driver端执行的，而方法内部的逻辑代码是在Executor端执行。</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[<span class="type">Int</span>] = sc.makeRDD(<span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line">    <span class="comment">//foreach 其实是Driver端内存集合的循环遍历方法</span></span><br><span class="line">    <span class="comment">// 收集后打印</span></span><br><span class="line">    rdd.collect().foreach(println) <span class="comment">// 有顺序</span></span><br><span class="line"></span><br><span class="line">    println(<span class="string">&quot;****************&quot;</span>)</span><br><span class="line">    <span class="comment">// 分布式打印</span></span><br><span class="line">    <span class="comment">// Executor端内存数据打印</span></span><br><span class="line">    rdd.foreach(println) <span class="comment">// 无序</span></span><br><span class="line"></span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="RDD序列化">RDD序列化</h3>
<p><code>算子以外的代码都是在 Driver 端执行, 算子里面的代码都是在 Executor端执行</code></p>
<p>要清晰上面这句话，Scala是函数式编程，，就会导致算子内经常会用到算子外的数据，这样就形成了闭包的效果，如果使用的算子外的数据无法序列化，就意味着无法传值给 Executor端执行，就会发生错误。所以要解决算子使用算子外数据的问题，就需要数据序列化。</p>
<p><code>java中序列化是继承Serializable，在scala中称之为混入</code></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay3</span>.serial</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark01_RDD_Serial</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 建立和Spark框架的连接</span></span><br><span class="line">    <span class="comment">//JDBC:Connection</span></span><br><span class="line">    <span class="keyword">val</span> conf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local&quot;</span>).setAppName(<span class="string">&quot;WordCount&quot;</span>)</span><br><span class="line">    <span class="comment">// 创建 Spark 上下文环境对象（连接对象）</span></span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(conf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 执行业务操作</span></span><br><span class="line">    <span class="comment">// 读取文件数据</span></span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[<span class="type">String</span>] = sc.makeRDD(<span class="type">Array</span>(<span class="string">&quot;hello world&quot;</span>, <span class="string">&quot;hello spark&quot;</span>, <span class="string">&quot;hive&quot;</span>, <span class="string">&quot;atguigu&quot;</span>))</span><br><span class="line">    <span class="keyword">val</span> search = <span class="keyword">new</span> <span class="type">Search</span>(<span class="string">&quot;h&quot;</span>) <span class="comment">//算子使用算子外的数据</span></span><br><span class="line"><span class="comment">//    search.getMatch1(rdd).collect().foreach(println)</span></span><br><span class="line">    search.getMatch2(rdd).collect().foreach(println)</span><br><span class="line">    <span class="comment">//TODO 关闭连接</span></span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Search</span>(<span class="params">query:<span class="type">String</span></span>) <span class="keyword">extends</span> <span class="title">Serializable</span> </span>&#123; <span class="comment">//混入Serializable</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isMatch</span></span>(s: <span class="type">String</span>): <span class="type">Boolean</span> = &#123;</span><br><span class="line">      s.contains(query)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 函数序列化案例</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getMatch1</span> </span>(rdd: <span class="type">RDD</span>[<span class="type">String</span>]): <span class="type">RDD</span>[<span class="type">String</span>] = &#123;</span><br><span class="line">      rdd.filter(isMatch)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 属性序列化案例</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getMatch2</span></span>(rdd: <span class="type">RDD</span>[<span class="type">String</span>]): <span class="type">RDD</span>[<span class="type">String</span>] = &#123;</span><br><span class="line">      rdd.filter((x: <span class="type">String</span>) =&gt; x.contains(query))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="RDD依赖关系">RDD依赖关系</h3>
<p>依赖关系，其实就是两个相邻 RDD 之间的关系 和java中的子类父类差不多吧</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220723165704674.png" alt="image-20220723165704674"></p>
<h3 id="RDD的持久化">RDD的持久化</h3>
<p>RDD代码，很长一些是重复的，如果使用不同是行动算子，会重新调用一遍之前的代码，这样效率太低了。</p>
<p>持久化可以将之前的依赖和代码保存在临时文件或者磁盘中。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay3</span>.persist</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.storage.<span class="type">StorageLevel</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SPARK_BRANCH</span>, <span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark01_RDD_Persist</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">// TODO  Spark 上下文环境对象（连接对象）</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local&quot;</span>).setAppName(<span class="string">&quot;Persist&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> list = <span class="type">List</span>(<span class="string">&quot;Hello Scala&quot;</span>, <span class="string">&quot;Hello Spark&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rdd:<span class="type">RDD</span>[<span class="type">String</span>] = sc.makeRDD(list)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> flatRDD: <span class="type">RDD</span>[<span class="type">String</span>] = rdd.flatMap((_:<span class="type">String</span>).split(<span class="string">&quot; &quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> mapRDD: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = flatRDD.map(</span><br><span class="line">      (word: <span class="type">String</span>) =&gt; &#123;</span><br><span class="line">        println(<span class="string">&quot;@@@@@@@@@@@@@@@@@&quot;</span>)</span><br><span class="line">        (word,<span class="number">1</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment">//cache默认保存咋在内存中</span></span><br><span class="line"><span class="comment">//    mapRDD.cache() //放内存中持久化了 数据这样只会一遍</span></span><br><span class="line">    <span class="comment">//可以放磁盘</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//持久化操作必须在行动算子执行时完成</span></span><br><span class="line">    mapRDD.persist(<span class="type">StorageLevel</span>.<span class="type">DISK_ONLY</span>) <span class="comment">//保存的是临时文件</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> reduceRDD: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = mapRDD.reduceByKey((_:<span class="type">Int</span>) + (_:<span class="type">Int</span>))</span><br><span class="line">    <span class="keyword">val</span> reduceRDD1: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Iterable</span>[<span class="type">Int</span>])] = mapRDD.groupByKey()</span><br><span class="line"></span><br><span class="line">    reduceRDD.collect().foreach(println)</span><br><span class="line">    println(<span class="string">&quot;————————————————————————————————————&quot;</span>)</span><br><span class="line">    reduceRDD1.collect().foreach(println)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// TODO 关闭连接</span></span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="checkpoint的使用">checkpoint的使用</h4>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay3</span>.persist</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.storage.<span class="type">StorageLevel</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark02_RDD_Persist</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">// TODO  Spark 上下文环境对象（连接对象）</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local&quot;</span>).setAppName(<span class="string">&quot;Persist&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line">    sc.setCheckpointDir(<span class="string">&quot;cp&quot;</span>) <span class="comment">//设置保存路径</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> list = <span class="type">List</span>(<span class="string">&quot;Hello Scala&quot;</span>, <span class="string">&quot;Hello Spark&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rdd:<span class="type">RDD</span>[<span class="type">String</span>] = sc.makeRDD(list)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> flatRDD: <span class="type">RDD</span>[<span class="type">String</span>] = rdd.flatMap((_:<span class="type">String</span>).split(<span class="string">&quot; &quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> mapRDD: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = flatRDD.map(</span><br><span class="line">      (word: <span class="type">String</span>) =&gt; &#123;</span><br><span class="line">        println(<span class="string">&quot;@@@@@@@@@@@@@@@@@&quot;</span>)</span><br><span class="line">        (word,<span class="number">1</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    )</span><br><span class="line">    <span class="comment">//需要落盘 需要指定检查点的保存路径</span></span><br><span class="line">    <span class="comment">//检查点路径保存的文件 当作业执行完毕后 不会被删除</span></span><br><span class="line">    <span class="comment">//一般保存路径都是在分布式存储系统 HDFS 在13行</span></span><br><span class="line">    mapRDD.cache()</span><br><span class="line">    mapRDD.checkpoint()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> reduceRDD: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = mapRDD.reduceByKey((_:<span class="type">Int</span>) + (_:<span class="type">Int</span>))</span><br><span class="line">    <span class="keyword">val</span> reduceRDD1: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Iterable</span>[<span class="type">Int</span>])] = mapRDD.groupByKey()</span><br><span class="line"></span><br><span class="line">    reduceRDD.collect().foreach(println)</span><br><span class="line">    println(<span class="string">&quot;————————————————————————————————————&quot;</span>)</span><br><span class="line">    reduceRDD1.collect().foreach(println)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// TODO 关闭连接</span></span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>持久化几种方式的区别</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//cache : 将数据临时存储在内存中进行数据重用</span></span><br><span class="line"><span class="comment">//persist : 将数据临时存储在磁盘文件中进行数据重用</span></span><br><span class="line">            <span class="comment">//涉及到磁盘IO，性能较低，但是数据安全</span></span><br><span class="line">            <span class="comment">//如果作业执行完毕，临时保存的数据文件就会丢失</span></span><br><span class="line"><span class="comment">//checkpoint：将数据长久地保存在磁盘文件中进行数据的重用</span></span><br><span class="line">            <span class="comment">//为了保证数据安全，所以一般情况下，会独立执行作业</span></span><br><span class="line">            <span class="comment">//为了能够提高效率，一般情况下，是需要和cache联合使用</span></span><br></pre></td></tr></table></figure>
<h3 id="分区器">分区器</h3>
<p>➢ 只有 Key-Value 类型的 RDD 才有分区器，非 Key-Value 类型的 RDD 分区的值是 None</p>
<p>之前使用过repartition 是hash分区 现在可以自定义分区</p>
<p>分区类 要继承 Partitioner</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">WordCount</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">Partitioner</span>, <span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark03_RDD_repartition</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">// TODO  Spark 上下文环境对象（连接对象）</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local&quot;</span>).setAppName(<span class="string">&quot;Persist&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> list = <span class="type">List</span>((<span class="string">&quot;NBA&quot;</span>,<span class="number">1</span>),(<span class="string">&quot;CBA&quot;</span>,<span class="number">2</span>),(<span class="string">&quot;WNBA&quot;</span>,<span class="number">3</span>),(<span class="string">&quot;CUBA&quot;</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = sc.makeRDD(list, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> value: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = rdd.partitionBy(<span class="keyword">new</span> <span class="type">MyPartitioner</span>)</span><br><span class="line"></span><br><span class="line">    value.saveAsTextFile(<span class="string">&quot;output&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// TODO 关闭连接</span></span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">MyPartitioner</span> <span class="keyword">extends</span> <span class="title">Partitioner</span></span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">numPartitions</span></span>: <span class="type">Int</span> = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">getPartition</span></span>(key: <span class="type">Any</span>): <span class="type">Int</span> = &#123;</span><br><span class="line">      key <span class="keyword">match</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;NBA&quot;</span> =&gt; <span class="number">0</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;CBA&quot;</span> =&gt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">case</span> _ =&gt; <span class="number">2</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="累加器">累加器</h3>
<p>累加器用来把 Executor 端变量信息聚合到 Driver 端。在 Driver 程序中定义的变量，在Executor 端的每个 Task 都会得到这个变量的一份新的副本，每个 task 更新这些副本的值后，传回 Driver 端进行 merge。</p>
<p>像Range使用的时候就不会传回到Driver端 Driver传到Executor端以后，在Executor端做任务，不会传回Driver端</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay3</span>.add</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.util.<span class="type">LongAccumulator</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark01_RDD_add</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> sparkConf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;add&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(sparkConf)</span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[<span class="type">Int</span>] = sc.makeRDD(<span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>))</span><br><span class="line">    <span class="comment">// 声明累加器</span></span><br><span class="line">    <span class="keyword">val</span> sum: <span class="type">LongAccumulator</span> = sc.longAccumulator(<span class="string">&quot;sum2&quot;</span>)</span><br><span class="line">    rdd.foreach(</span><br><span class="line">      (num: <span class="type">Int</span>) =&gt; &#123;</span><br><span class="line">        <span class="comment">// 使用累加器</span></span><br><span class="line">        sum.add(num)</span><br><span class="line">      &#125; )</span><br><span class="line">    <span class="comment">// 获取累加器的值</span></span><br><span class="line">    println(<span class="string">&quot;sum = &quot;</span> + sum.value)</span><br><span class="line">    sc.stop()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-BUG点-8">5. BUG点</h2>
<p>难点(关键代码或关键配置，BUG截图+解决方案)</p>
<p>执行自定义分区器的时候，报了一大串的错误，一个一个翻译过来，有一个错误是指向了自己自定义类的case表达式，检查过后发现，自己有四个Key-value,3个分区，按照索引下标 0 1 2 ，所以后面自己自定义match类应该返回三个值，而且key值得都有返回值。所以按自己的写法，会有一个键值对没有返回值，也就没有分区导致报错。把最后一个改成        <code>case _ =&gt; 2</code>表示除了前两个之外，返回值都是分区2</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220724143959415.png" alt="image-20220724143959415"></p>
<h2 id="6-扩展学习部分-8">6.扩展学习部分</h2>
<h3 id="Kryo-序列化框架">Kryo 序列化框架</h3>
<p>scala所独有的，java中序列化的升级版，性能大大提高。</p>
<p>Kryo 速度是 Serializable 的 10 倍。当 RDD 在 Shuffle 数据的时候，简单数据类型、数组和字符串类型已经在 Spark 内部使用 Kryo 来序列化。</p>
<p><code>注意：即使使用 Kryo 序列化，也要继承 Serializable 接口。</code>代码量会增加一点，但是效率大大提高</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">BIgDataSparkDay3</span>.serial</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark02_RDD_SerialKryo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Application</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//Spark框架</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 建立和Spark框架的连接</span></span><br><span class="line">    <span class="comment">//JDBC:Connection</span></span><br><span class="line">    <span class="keyword">val</span> conf: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local&quot;</span>).setAppName(<span class="string">&quot;WordCount&quot;</span>)<span class="comment">// 替换默认的序列化机制</span></span><br><span class="line">      .set(<span class="string">&quot;spark.serializer&quot;</span>, <span class="string">&quot;org.apache.spark.serializer.KryoSerializer&quot;</span>)</span><br><span class="line">      <span class="comment">// 注册需要使用 kryo 序列化的自定义类</span></span><br><span class="line">      .registerKryoClasses(<span class="type">Array</span>(classOf[<span class="type">Search</span>]))</span><br><span class="line">    <span class="comment">// 创建 Spark 上下文环境对象（连接对象）</span></span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(conf)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 执行业务操作</span></span><br><span class="line">    <span class="comment">// 读取文件数据</span></span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[<span class="type">String</span>] = sc.makeRDD(<span class="type">Array</span>(<span class="string">&quot;hello world&quot;</span>, <span class="string">&quot;hello spark&quot;</span>, <span class="string">&quot;hive&quot;</span>, <span class="string">&quot;atguigu&quot;</span>))</span><br><span class="line">    <span class="keyword">val</span> search = <span class="keyword">new</span> <span class="type">Search</span>(<span class="string">&quot;h&quot;</span>) <span class="comment">//使用算子外的数据</span></span><br><span class="line"><span class="comment">//    search.getMatch1(rdd).collect().foreach(println)</span></span><br><span class="line">    search.getMatch2(rdd).collect().foreach(println)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭连接</span></span><br><span class="line">    sc.stop()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">case</span>  <span class="class"><span class="keyword">class</span> <span class="title">Search</span>(<span class="params">query:<span class="type">String</span></span>) </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isMatch</span></span>(s: <span class="type">String</span>): <span class="type">Boolean</span> = &#123;</span><br><span class="line">      s.contains(query)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 函数序列化案例</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getMatch1</span> </span>(rdd: <span class="type">RDD</span>[<span class="type">String</span>]): <span class="type">RDD</span>[<span class="type">String</span>] = &#123;</span><br><span class="line">      rdd.filter(isMatch)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 属性序列化案例</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getMatch2</span></span>(rdd: <span class="type">RDD</span>[<span class="type">String</span>]): <span class="type">RDD</span>[<span class="type">String</span>] = &#123;</span><br><span class="line">      rdd.filter((x: <span class="type">String</span>) =&gt; x.contains(query))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="RDD-任务划分"><strong>RDD</strong> <strong>任务划分</strong></h3>
<p>RDD 任务切分中间分为：Application、Job、Stage 和 Task</p>
<p>Application：初始化一个 SparkContext 即生成一个 Application；</p>
<p>Job：一个 Action 算子就会生成一个 Job；</p>
<p>Stage：Stage 等于宽依赖(ShuffleDependency)的个数加 1；</p>
<p>Task：一个 Stage 阶段中，最后一个 RDD 的分区个数就是 Task 的个数。</p>
<p><strong>注意：Application-&gt;Job-&gt;Stage-&gt;Task 每一层都是 1 对 n 的关系。</strong></p>
<h2 id="7-总结-9">7.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>今天的学习内容和难度都是有点大的，前面先学的行动算子，比较简单，和昨天的转换算子差不多，比转换算子的算法还简单不少，但是代码比较多的，也是今天学习的重点，敲了一上午才结束行动算子，做了小案例。后面下午，精神状态还不错，看到序列化  依赖 持久之类的，在Java中都有点类似的东西，加上老师的画图理解，自己结合案例，也是弄得明白个八九十了。学习步骤，因为文档没有讲解，就看了视频，案例自己敲，没什么问题就跳着看老师的运行，看和自己有什么不一样，明天就是SQL的学习了。代码应该也比较多，还要记SQL语句的。</p>
<h1 id="7-24-Spark-SQL">7.24 Spark SQL</h1>
<h2 id="1-头：日期、所学内容出处-14">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web">https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web</a></p>
<h2 id="2-标题-14">2.标题</h2>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">153</span>SQL - 介绍</span><br><span class="line"><span class="number">154</span>SQL - 特点</span><br><span class="line"><span class="number">155</span>SQL - 数据模型 - DataFrame &amp; DataSet</span><br><span class="line"><span class="number">156</span>SQL - 核心编程 - DataFrame - 简单演示</span><br><span class="line"><span class="number">157</span>SQL - 核心编程 - DataFrame - SQL的基本使用</span><br><span class="line"><span class="number">158</span>SQL - 核心编程 - DataFrame - DSL语法的基本使用</span><br><span class="line"><span class="number">159</span>SQL - 核心编程 - DataFrame - RDD之间的转换</span><br><span class="line"><span class="number">160</span>SQL - 核心编程 - DataSet - 介绍</span><br><span class="line"><span class="number">161</span>SQL - 核心编程 - DataSet - DataFrame的转换</span><br><span class="line"><span class="number">162</span>SQL - 核心编程 - DataSet - RDD的转换</span><br><span class="line"><span class="number">163</span>SQL - 核心编程 - DataSet &amp; DataFrame &amp; RDD之间的关系</span><br><span class="line"><span class="number">164</span>SQL - 核心编程 - IDEA创建SparkSQL环境对象</span><br><span class="line"><span class="number">165</span>SQL - 核心编程 - IDEA - DataFrame基本操作</span><br><span class="line"><span class="number">166</span>SQL - 核心编程 - IDEA - DataSet基本操作</span><br><span class="line"><span class="number">167</span>SQL - 核心编程 - IDEA - RDD &amp; DataFrame &amp; DataSet互相转换</span><br><span class="line"><span class="number">168</span>SQL - 核心编程 - IDEA - UDF函数</span><br><span class="line"><span class="number">169</span>SQL - 核心编程 - IDEA - UDAF函数 - 实现原理</span><br><span class="line"><span class="number">170</span>SQL - 核心编程 - IDEA - UDAF函数 - 弱类型函数实现</span><br><span class="line"><span class="number">171</span>.尚硅谷<span class="variable">_SparkSQL</span> - 核心编程 - IDEA - UDAF函数 - 强类型函数实现</span><br><span class="line"><span class="number">172</span>.尚硅谷<span class="variable">_SparkSQL</span> - 核心编程 - IDEA - UDAF函数 - 早期强类型函数实现</span><br><span class="line"><span class="number">173</span>.尚硅谷<span class="variable">_SparkSQL</span> - 核心编程 - IDEA - UDAF函数 - 课件梳理</span><br><span class="line"><span class="number">174</span>.尚硅谷<span class="variable">_SparkSQL</span> - 核心编程 - 数据读取和保存 - 通用方法</span><br><span class="line"><span class="number">175</span>.尚硅谷<span class="variable">_SparkSQL</span> - 核心编程 - 数据读取和保存 - 操作JSON &amp; CSV</span><br><span class="line"><span class="number">176</span>.尚硅谷<span class="variable">_SparkSQL</span> - 核心编程 - 数据读取和保存 - 操作MySQL</span><br><span class="line"><span class="number">177</span>.尚硅谷<span class="variable">_SparkSQL</span> - 核心编程 - 数据读取和保存 - 操作内置Hive</span><br><span class="line"><span class="number">178</span>.尚硅谷<span class="variable">_SparkSQL</span> - 核心编程 - 数据读取和保存 - 操作外置Hive</span><br><span class="line"><span class="number">179</span>.尚硅谷<span class="variable">_SparkSQL</span> - 核心编程 - 数据读取和保存 - 代码操作外置Hive</span><br><span class="line"><span class="number">180</span>.尚硅谷<span class="variable">_SparkSQL</span> - 核心编程 - 数据读取和保存 - beeline操作Hive</span><br><span class="line"><span class="number">181</span>.尚硅谷<span class="variable">_SparkSQL</span> - 案例实操 - 数据准备</span><br><span class="line"><span class="number">182</span>.尚硅谷<span class="variable">_SparkSQL</span> - 案例实操 - 需求部分实现</span><br><span class="line"><span class="number">183</span>.尚硅谷<span class="variable">_SparkSQL</span> - 案例实操 - 需求完整实现</span><br><span class="line"><span class="number">184</span>.尚硅谷<span class="variable">_SparkSQL</span> - 总结 - 课件梳理 </span><br></pre></td></tr></table></figure>
<h2 id="3-所学内容概述-14">3.所学内容概述</h2>
<h2 id="4-根据概述分章节描述-12">4.根据概述分章节描述</h2>
<h3 id="SparkSQL概述">SparkSQL概述</h3>
<p><code>Spark SQL 是 Spark 用于结构化数据(structured data)处理的 Spark 模块。</code></p>
<p>对于开发人员来讲，SparkSQL 可以简化 RDD 的开发，提高开发效率，且执行效率非常快，所以实际工作中，基本上采的就是 SparkSQL。Spark SQL 为了简化 RDD 的开发，提高开发效率，提供了 2 个编程抽象，类似 Spark Core 中的 RDD</p>
<p>➢ DataFrame</p>
<p>➢ DataSet</p>
<h4 id="SparkSQL-特点"><strong>SparkSQL</strong> 特点</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">易整合：无缝的整合了 <span class="keyword">SQL</span> 查询和 Spark 编程</span><br><span class="line">统一的数据访问：使用相同的方式。连接不同的数据源</span><br><span class="line">兼容Hive：在已有的仓库上直接运行<span class="keyword">SQL</span> 或者 HIveQL.</span><br><span class="line">标准数据连接：通过JDBC或者ODBC来连接</span><br></pre></td></tr></table></figure>
<h4 id="DataFrame是什么">DataFrame是什么</h4>
<p>在 Spark 中，DataFrame 是一种以 RDD 为基础的分布式数据集，类似于传统数据库中的二维表格。</p>
<p>下图直观地体现了 DataFrame 和 RDD 的区别。 DataFrame<strong>每一列都带有名称和类型</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220725095120995.png" alt="image-20220725095120995"></p>
<p><strong>DataSet</strong> <strong>是什么</strong></p>
<p>DataSet 是分布式数据集合。DataSet 是 Spark 1.6 中添加的一个新抽象，是 DataFrame的一个扩展。</p>
<p>用编程的话说就是DataSet是DataFrame的子类，升级版。DataFrame拥有的功能DataSet都有。</p>
<h3 id="SparkSQL的核心编程">SparkSQL的核心编程</h3>
<h4 id="DataFrame">DataFrame</h4>
<p><code>Spark SQL 的 DataFrame API 允许我们使用 DataFrame 而不用必须去注册临时表或者生成 SQL 表达式。DataFrame API 既有 transformation 操作也有 action 操作。</code></p>
<h5 id="创建DataFrame">创建DataFrame</h5>
<h5 id="1-从Spark数据源进行创建">1.从Spark数据源进行创建</h5>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scala &gt; spark.read.</span><br><span class="line"><span class="comment">//下面都是支持创建文件的数据源格式</span></span><br><span class="line">csv format jdbc json load option options orc parquet schema table text textFile</span><br></pre></td></tr></table></figure>
<p>读取json创建DataFrame</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> df = spark.read.json(<span class="string">&quot;data/user.json&quot;</span>)</span><br><span class="line">df: org.apache.spark.sql.<span class="type">DataFrame</span> = [age: bigint， username: string] <span class="comment">//bigint是数据类型 因为不知道什么类型 所以用bigint接收 bigint可以和Long类型转换，但是和Int不能进行转换</span></span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+---+--------+</span><br><span class="line">|age|username|</span><br><span class="line">+---+--------+</span><br><span class="line">| <span class="number">20</span>|zhangsan|</span><br><span class="line">+---+--------+</span><br></pre></td></tr></table></figure>
<h5 id="2-用SQL语法">2.用SQL语法</h5>
<p>对 DataFrame 创建一个临时表</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; df.createOrReplaceTempView(<span class="string">&quot;people&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>通过 SQL 语句实现查询全表</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; val sqlDF = spark.sql(&quot;SELECT * FROM people&quot;)</span><br><span class="line"><span class="function">sqlDF: <span class="title">org.apache.spark.sql.DataFrame</span> = [<span class="title">age</span>: <span class="title">bigint</span>， <span class="title">name</span>: <span class="title">string</span>]</span></span><br></pre></td></tr></table></figure>
<p><code>show</code>进行一个输出</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; sqlDF.show</span><br><span class="line">+---+--------+</span><br><span class="line">|age|username|</span><br><span class="line">+---+--------+</span><br><span class="line">| <span class="number">20</span>|zhangsan|</span><br><span class="line">| <span class="number">30</span>| lisi|</span><br><span class="line">| <span class="number">40</span>| wangwu|</span><br><span class="line">+---+--------+</span><br></pre></td></tr></table></figure>
<h4 id="DSL语法">DSL语法</h4>
<p>DataFrame 提供一个特定领域语言去管理结构化的数据。可以在 Scala, Java, Python 和 R 中使用 DSL，使用 DSL 语法风格不必去创建临时视图了。</p>
<p>只查看&quot;username&quot;列数据</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; df.select(&quot;username&quot;).show()</span><br><span class="line">+--------+</span><br><span class="line">|username|</span><br><span class="line">+--------+</span><br><span class="line">|zhangsan|</span><br><span class="line">| lisi|</span><br><span class="line">| wangwu|</span><br><span class="line">+--------+</span><br></pre></td></tr></table></figure>
<p>查看&quot;username&quot;列数据以及&quot;age+1&quot;数据</p>
<p><code>注意:涉及到运算的时候, 每列都必须使用$, 或者采用引号表达式：单引号+字段名</code></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; df.select($<span class="string">&quot;username&quot;</span>,$<span class="string">&quot;age&quot;</span> + <span class="number">1</span>).show</span><br><span class="line">scala&gt; df.select(&#x27;username, &#x27;age + <span class="number">1</span>).show() <span class="comment">//推荐这种 比较简单而且可读性好</span></span><br></pre></td></tr></table></figure>
<p>DataFrame可以用很多RDD的方法 filter  group等</p>
<h3 id="IDEA开发SparkSQL">IDEA开发SparkSQL</h3>
<p>实际开发中，都是使用 IDEA 进行开发的。</p>
<p>要添加XML依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-core_2.12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-sql_2.12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-yarn_2.12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>之前CMD敲的代码在IDEA实现</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">SQL</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.&#123;<span class="type">DataFrame</span>, <span class="type">Dataset</span>, <span class="type">Row</span>, <span class="type">SparkSession</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark01_SparkSQL_Basic</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 创建SparkSQL的运行环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkSQL: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;SparkSQL&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> spark: <span class="type">SparkSession</span> = <span class="type">SparkSession</span>.builder().config(sparkSQL).getOrCreate()</span><br><span class="line">    <span class="keyword">import</span> spark.implicits._  <span class="comment">//导入</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 执行逻辑操作</span></span><br><span class="line">    <span class="comment">//DataFrame</span></span><br><span class="line"><span class="comment">//    val df: DataFrame = spark.read.json(&quot;data/user.json&quot;)</span></span><br><span class="line">    <span class="comment">//    df.show()</span></span><br><span class="line">    <span class="comment">//TODO RDD=&gt;DataFrame=&gt;DataSet 转换需要引入隐式转换规则，否则无法转换</span></span><br><span class="line">    <span class="comment">//TODO DataFrame =&gt; SQL</span></span><br><span class="line"><span class="comment">//    df.createOrReplaceTempView(&quot;user&quot;)</span></span><br><span class="line">    <span class="comment">//    spark.sql(&quot;select * from user&quot;).show()</span></span><br><span class="line">    <span class="comment">//    spark.sql(&quot;select age from user&quot;).show()</span></span><br><span class="line">    <span class="comment">//    spark.sql(&quot;select username from user&quot;).show()</span></span><br><span class="line">    <span class="comment">//    spark.sql(&quot;select avg(age) from user&quot;).show()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO DataFrame =&gt; DSL</span></span><br><span class="line">    <span class="comment">// 在使用DataFrame时，如果涉及到转换操作，需要引入转换规则</span></span><br><span class="line">    <span class="comment">//    df.select(&quot;age&quot;,&quot;username&quot;).show()</span></span><br><span class="line">    <span class="comment">//    df.select($&quot;age&quot; + 1).show</span></span><br><span class="line">    <span class="comment">//    df.select(&#x27;age + 1).show</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO DataSet</span></span><br><span class="line">    <span class="comment">// DataFrame其实是特定泛型的DataSet 是类型只能是Row的DataSet</span></span><br><span class="line">    <span class="comment">// 所以DataFrame的东西DataSet也都有都能用</span></span><br><span class="line"><span class="comment">//    val ints = Seq(1, 2, 3, 4)</span></span><br><span class="line"><span class="comment">//    val ds: Dataset[Int] = ints.toDS()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO RDD &lt;=&gt; DataFrame</span></span><br><span class="line">    <span class="keyword">val</span> context: <span class="type">SparkContext</span> = spark.sparkContext</span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[(<span class="type">Int</span>, <span class="type">String</span>, <span class="type">Int</span>)] = context.makeRDD(<span class="type">List</span>((<span class="number">1</span>, <span class="string">&quot;zhangsan&quot;</span>, <span class="number">30</span>), (<span class="number">2</span>, <span class="string">&quot;lisa&quot;</span>, <span class="number">40</span>)))</span><br><span class="line">    <span class="keyword">val</span> df: <span class="type">DataFrame</span> = rdd.toDF(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;name&quot;</span>, <span class="string">&quot;age&quot;</span>) <span class="comment">//DataFrame</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rowRDD: <span class="type">RDD</span>[<span class="type">Row</span>] = df.rdd <span class="comment">//RDD</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO DataSet &lt;=&gt; DataFrame</span></span><br><span class="line">    <span class="keyword">val</span> ds: <span class="type">Dataset</span>[<span class="type">User</span>] = df.as[<span class="type">User</span>]</span><br><span class="line">    <span class="keyword">val</span> df1: <span class="type">DataFrame</span> = ds.toDF()</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO RDD &lt;=&gt; DataSet</span></span><br><span class="line">    <span class="keyword">val</span> ds1: <span class="type">Dataset</span>[<span class="type">User</span>] = rdd.map &#123;</span><br><span class="line">      <span class="keyword">case</span> (id, name, age) =&gt; <span class="type">User</span>(id, name, age)</span><br><span class="line">    &#125;.toDS() <span class="comment">//DataSet</span></span><br><span class="line">    <span class="keyword">val</span> userRDD: <span class="type">RDD</span>[<span class="type">User</span>] = ds1.rdd <span class="comment">//RDD</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line"></span><br><span class="line">    spark.stop()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span>(<span class="params">id:<span class="type">Int</span>,username:<span class="type">String</span>,age:<span class="type">Int</span></span>)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="用户自定义函数">用户自定义函数</h4>
<p>用户可以通过 spark.udf 功能添加自定义函数，实现自定义功能。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">SQL</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.&#123;<span class="type">DataFrame</span>, <span class="type">Dataset</span>, <span class="type">Row</span>, <span class="type">SparkSession</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark02_SparkSQL_UDF</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 创建SparkSQL的运行环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkSQL: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;SparkSQL&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> spark: <span class="type">SparkSession</span> = <span class="type">SparkSession</span>.builder().config(sparkSQL).getOrCreate()</span><br><span class="line">    <span class="keyword">import</span> spark.implicits._</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 执行逻辑操作</span></span><br><span class="line">    <span class="keyword">val</span> df: <span class="type">DataFrame</span> = spark.read.json(<span class="string">&quot;data/user.json&quot;</span>)</span><br><span class="line">    df.createOrReplaceTempView(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">    <span class="comment">//udf 用户可以通过 spark.udf 功能添加自定义函数，实现自定义功能</span></span><br><span class="line">	<span class="comment">//注册UDF</span></span><br><span class="line">    spark.udf.register(<span class="string">&quot;prefixName&quot;</span>,(name:<span class="type">String</span>) =&gt; <span class="string">&quot;姓名: &quot;</span> + name)</span><br><span class="line">    <span class="comment">//应用UDF</span></span><br><span class="line">    spark.sql(<span class="string">&quot;select * from user&quot;</span>).show()</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    spark.stop()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span>(<span class="params">id:<span class="type">Int</span>,username:<span class="type">String</span>,age:<span class="type">Int</span></span>)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="UDAF">UDAF</h4>
<p>是Spark3.0后面出现的自定义强类型聚合函数Aggreg 代替原来的弱类型的聚合函数UserDefinedAggregateFunction</p>
<p>计算平均工资</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">SQL</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.<span class="type">SparkConf</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.expressions.<span class="type">Aggregator</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql._</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark04_SparkSQL_UDAF1</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 创建SparkSQL的运行环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkSQL: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;SparkSQL&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> spark: <span class="type">SparkSession</span> = <span class="type">SparkSession</span>.builder().config(sparkSQL).getOrCreate()</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 执行逻辑操作</span></span><br><span class="line">    <span class="keyword">val</span> df: <span class="type">DataFrame</span> = spark.read.json(<span class="string">&quot;data/user.json&quot;</span>)</span><br><span class="line">    df.createOrReplaceTempView(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">    <span class="comment">//udf 用户可以通过 spark.udf 功能添加自定义函数，实现自定义功能</span></span><br><span class="line"></span><br><span class="line">    spark.udf.register(<span class="string">&quot;ageAvg&quot;</span>,functions.udaf(<span class="keyword">new</span> <span class="type">MyAvgUDAF</span>()))</span><br><span class="line"></span><br><span class="line">    spark.sql(<span class="string">&quot;select ageAvg(age) from user&quot;</span>).show()</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    spark.stop()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  自定义聚合函数类：计算年龄的平均值</span></span><br><span class="line"><span class="comment">  1. 继承org.apache.spark.sql.expressions.Aggregator, 定义泛型</span></span><br><span class="line"><span class="comment">      IN : 输入的数据类型 Long</span></span><br><span class="line"><span class="comment">      BUF : 缓冲区的数据类型 Buff</span></span><br><span class="line"><span class="comment">      OUT : 输出的数据类型 Long</span></span><br><span class="line"><span class="comment">  2. 重写方法(6)</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">ByMyBuff</span>(<span class="params">var total: <span class="type">Long</span>,var count: <span class="type">Long</span></span>)</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">MyAvgUDAF</span> <span class="keyword">extends</span> <span class="title">Aggregator</span>[<span class="type">Long</span>,<span class="type">ByMyBuff</span>,<span class="type">Long</span>]</span>&#123;</span><br><span class="line">    <span class="comment">// z &amp; zero : 初始值或零值</span></span><br><span class="line">    <span class="comment">// 缓冲区的初始化</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">zero</span></span>: <span class="type">ByMyBuff</span> = &#123;</span><br><span class="line">      <span class="type">ByMyBuff</span>(<span class="number">0</span>L,<span class="number">0</span>L)<span class="comment">//Long默认初始0</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 根据输入的数据更新缓冲区的数据</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">reduce</span></span>(b: <span class="type">ByMyBuff</span>, a: <span class="type">Long</span>): <span class="type">ByMyBuff</span> = &#123;</span><br><span class="line">      b.total = b.total + a <span class="comment">//ByMyBuff的total和下一行的数据中的total相加</span></span><br><span class="line">      b.count = b.count + <span class="number">1</span> <span class="comment">//加一次算一个 用户</span></span><br><span class="line">      b</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 合并缓冲区</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">merge</span></span>(b1: <span class="type">ByMyBuff</span>, b2: <span class="type">ByMyBuff</span>): <span class="type">ByMyBuff</span> = &#123;</span><br><span class="line">      b1.total = b1.total + b2.total <span class="comment">//整合一体</span></span><br><span class="line">      b1.count = b1.count + b2.count</span><br><span class="line">      b1</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//计算结果</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">finish</span></span>(reduction: <span class="type">ByMyBuff</span>): <span class="type">Long</span> = &#123;</span><br><span class="line">      reduction.total / reduction.count</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 缓冲区的编码操作</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">bufferEncoder</span></span>: <span class="type">Encoder</span>[<span class="type">ByMyBuff</span>] = <span class="type">Encoders</span>.product</span><br><span class="line">    <span class="comment">// 输出区的编码操作</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">outputEncoder</span></span>: <span class="type">Encoder</span>[<span class="type">Long</span>] = <span class="type">Encoders</span>.scalaLong</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>数据的加载和保存</strong></p>
<p>SparkSQL 提供了通用的保存数据和数据加载的方式。这里的通用指的是使用相同的API，根据不同的参数读取和保存不同格式的数据，SparkSQL 默认读取和保存的文件格式为 <strong>parquet</strong></p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spark.read.load 是加载数据的通用方法</span><br><span class="line">scala&gt; spark.read.<span class="built_in">format</span>(&quot;…&quot;)[.option(&quot;…&quot;)].load(&quot;…&quot;)</span><br><span class="line">df.write.save 是保存数据的通用方法</span><br><span class="line">scala&gt;df.write.<span class="built_in">format</span>(&quot;…&quot;)[.option(&quot;…&quot;)].save(&quot;…&quot;)</span><br></pre></td></tr></table></figure>
<p>➢ format(“…”)：指定加载的数据类型，包括&quot;csv&quot;、“jdbc”、“json”、“orc”、“parquet&quot;和&quot;textFile”。</p>
<p>➢ load(“…”)：在&quot;csv&quot;、“jdbc”、“json”、“orc”、&quot;parquet&quot;和&quot;textFile&quot;格式下需要传入加载数据的路径。</p>
<p>➢ option(“…”)：在&quot;jdbc&quot;格式下需要传入 JDBC 相应参数，url、user、password 和 dbtable</p>
<h4 id="加载MySQL数据">加载MySQL数据</h4>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">SQL</span>.<span class="type">MySQL</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.<span class="type">SparkConf</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.&#123;<span class="type">DataFrame</span>, <span class="type">SparkSession</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark01_SparkSQL_MySQL</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 创建SparkSQL的运行环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkSQL: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;SparkSQL&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> spark: <span class="type">SparkSession</span> = <span class="type">SparkSession</span>.builder().config(sparkSQL).getOrCreate()</span><br><span class="line">    <span class="keyword">import</span> spark.implicits._</span><br><span class="line">    <span class="comment">//TODO 执行逻辑操作</span></span><br><span class="line">    spark.read</span><br><span class="line">      .format(<span class="string">&quot;jdbc&quot;</span>)</span><br><span class="line">      <span class="comment">//localhost主机 3306端口号(SQL8.0)_atguigudb数据库名 </span></span><br><span class="line">      .option(<span class="string">&quot;url&quot;</span>, <span class="string">&quot;jdbc:mysql://localhost:3306/atguigudb?rewriteBatchedStatements=true&quot;</span>)</span><br><span class="line">      .option(<span class="string">&quot;driverClass&quot;</span>, <span class="string">&quot;com.mysql.cj.jdbc.Drive&quot;</span>)</span><br><span class="line">      .option(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;root&quot;</span>)</span><br><span class="line">      .option(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;root&quot;</span>)</span><br><span class="line">      <span class="comment">//表名</span></span><br><span class="line">      .option(<span class="string">&quot;dbtable&quot;</span>, <span class="string">&quot;employees&quot;</span>)</span><br><span class="line">      .load().show</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line">    spark.stop()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span>(<span class="params">id:<span class="type">Int</span>,username:<span class="type">String</span>,age:<span class="type">Int</span></span>)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-BUG点-9">5. BUG点</h2>
<p>难点(关键代码或关键配置，BUG截图+解决方案)</p>
<p>错误点如图，显而易见又是路径问题，同样的代我之前是在Spark下载文件直接打开Spark-shell使用的，之前是好的，因为太麻烦，所以设置了环境变量，在任何地方输入spark-shell都能打开spark，但是这样我输之前的路径就不行了，必须要绝对路径，不知道原因</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220725101816366.png" alt="image-20220725101816366"></p>
<h2 id=""></h2>
<h3 id="RDD、DataFrame、DataSet-三者的关系">RDD、DataFrame、DataSet 三者的关系</h3>
<p><code>因为是在文档中看的 基本都是文字性的描述</code></p>
<p>版本出现的时间</p>
<p>➢ Spark1.0 =&gt; RDD</p>
<p>➢ Spark1.3 =&gt; DataFrame</p>
<p>➢ Spark1.6 =&gt; Dataset</p>
<p>时代是在进步的，所以看出现版本就知道哪个更加强大，所以DataSet也是现在的主流</p>
<p><code>在后期的 Spark 版本中，DataSet 有可能会逐步取代 RDD和 DataFrame 成为唯一的 API 接口。</code></p>
<p><strong>三者的共性</strong></p>
<p>➢ RDD、DataFrame、DataSet 全都是 spark 平台下的分布式弹性数据集，为处理超大型数据提供便利;</p>
<p>➢ 三者都有惰性机制，在进行创建、转换，如 map 方法时，不会立即执行，只有在遇到Action 如 foreach 时，三者才会开始遍历运算;</p>
<p>➢ 三者有许多共同的函数，如 filter，排序等;</p>
<p>➢ 在对 DataFrame 和 Dataset 进行操作许多操作都需要这个包:import spark.implicits._（在创建好 SparkSession 对象后尽量直接导入）</p>
<p>➢ 三者都会根据 Spark 的内存情况自动缓存运算，这样即使数据量很大，也不用担心会内存溢出</p>
<p>➢ 三者都有 partition 的概念</p>
<p>➢ DataFrame 和 DataSet 均可使用模式匹配获取各个字段的值和类型</p>
<h4 id="DataSet">DataSet</h4>
<p>DataSet</p>
<p>➢ Dataset 和 DataFrame 拥有完全相同的成员函数，区别只是每一行的数据类型不同。DataFrame 其实就是 DataSet 的一个特例 type DataFrame = Dataset[Row]</p>
<p>➢ DataFrame 也可以叫 Dataset[Row],每一行的类型是 Row，不解析，每一行究竟有哪些字段，各个字段又是什么类型都无从得知，只能用上面提到的 getAS 方法或者共性中的第七条提到的模式匹配拿出特定字段。而 Dataset 中，每一行是什么类型是不一定的，在自定义了 case class 之后可以很自由的获得每一行的信息</p>
<p>三者是可以互相转换的 通过特定方式</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220725101311213.png" alt="image-20220725101311213"></p>
<p>具体代码如下</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">SQL</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.&#123;<span class="type">DataFrame</span>, <span class="type">Dataset</span>, <span class="type">Row</span>, <span class="type">SparkSession</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Spark01_SparkSQL_Basic</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//TODO 创建SparkSQL的运行环境</span></span><br><span class="line">    <span class="keyword">val</span> sparkSQL: <span class="type">SparkConf</span> = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;SparkSQL&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> spark: <span class="type">SparkSession</span> = <span class="type">SparkSession</span>.builder().config(sparkSQL).getOrCreate()</span><br><span class="line">    <span class="keyword">import</span> spark.implicits._</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 执行逻辑操作</span></span><br><span class="line">    <span class="comment">//DataFrame</span></span><br><span class="line"><span class="comment">//    val df: DataFrame = spark.read.json(&quot;data/user.json&quot;)</span></span><br><span class="line">    <span class="comment">//    df.show()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO DataFrame =&gt; SQL</span></span><br><span class="line"><span class="comment">//    df.createOrReplaceTempView(&quot;user&quot;)</span></span><br><span class="line">    <span class="comment">//    spark.sql(&quot;select * from user&quot;).show()</span></span><br><span class="line">    <span class="comment">//    spark.sql(&quot;select age from user&quot;).show()</span></span><br><span class="line">    <span class="comment">//    spark.sql(&quot;select username from user&quot;).show()</span></span><br><span class="line">    <span class="comment">//    spark.sql(&quot;select avg(age) from user&quot;).show()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO DataFrame =&gt; DSL</span></span><br><span class="line">    <span class="comment">// 在使用DataFrame时，如果涉及到转换操作，需要引入转换规则</span></span><br><span class="line">    <span class="comment">//    df.select(&quot;age&quot;,&quot;username&quot;).show()</span></span><br><span class="line">    <span class="comment">//    df.select($&quot;age&quot; + 1).show</span></span><br><span class="line">    <span class="comment">//    df.select(&#x27;age + 1).show</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO DataSet</span></span><br><span class="line">    <span class="comment">// DataFrame其实是特定泛型的DataSet 是类型只能是Row的DataSet</span></span><br><span class="line">    <span class="comment">// 所以DataFrame的东西DataSet也都有都能用</span></span><br><span class="line"><span class="comment">//    val ints = Seq(1, 2, 3, 4)</span></span><br><span class="line"><span class="comment">//    val ds: Dataset[Int] = ints.toDS()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO RDD &lt;=&gt; DataFrame</span></span><br><span class="line">    <span class="keyword">val</span> context: <span class="type">SparkContext</span> = spark.sparkContext</span><br><span class="line">    <span class="keyword">val</span> rdd: <span class="type">RDD</span>[(<span class="type">Int</span>, <span class="type">String</span>, <span class="type">Int</span>)] = context.makeRDD(<span class="type">List</span>((<span class="number">1</span>, <span class="string">&quot;zhangsan&quot;</span>, <span class="number">30</span>), (<span class="number">2</span>, <span class="string">&quot;lisa&quot;</span>, <span class="number">40</span>)))</span><br><span class="line">    <span class="keyword">val</span> df: <span class="type">DataFrame</span> = rdd.toDF(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;name&quot;</span>, <span class="string">&quot;age&quot;</span>) <span class="comment">//DataFrame</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rowRDD: <span class="type">RDD</span>[<span class="type">Row</span>] = df.rdd <span class="comment">//RDD</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO DataSet &lt;=&gt; DataFrame</span></span><br><span class="line">    <span class="keyword">val</span> ds: <span class="type">Dataset</span>[<span class="type">User</span>] = df.as[<span class="type">User</span>]</span><br><span class="line">    <span class="keyword">val</span> df1: <span class="type">DataFrame</span> = ds.toDF()</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO RDD &lt;=&gt; DataSet</span></span><br><span class="line">    <span class="keyword">val</span> ds1: <span class="type">Dataset</span>[<span class="type">User</span>] = rdd.map &#123;</span><br><span class="line">      <span class="keyword">case</span> (id, name, age) =&gt; <span class="type">User</span>(id, name, age)</span><br><span class="line">    &#125;.toDS() <span class="comment">//DataSet</span></span><br><span class="line">    <span class="keyword">val</span> userRDD: <span class="type">RDD</span>[<span class="type">User</span>] = ds1.rdd <span class="comment">//RDD</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO 关闭环境</span></span><br><span class="line"></span><br><span class="line">    spark.stop()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span>(<span class="params">id:<span class="type">Int</span>,username:<span class="type">String</span>,age:<span class="type">Int</span></span>)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="7-总结-10">7.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>今天的学习内容还是很重的，把SparkSQL看完，内容概念性的太多了，花费了很多时间去理解，弄懂，像搞懂RDD，DataFrame和DataSet三者就花费了2个多小时，比较麻烦，前面cmd执行出了点问题，好在解决了，但是没弄懂原因。重点在DataSet的使用和几个自定义方法吧，DataSet应该是现在开发最常用的，这部分我也花重点时间去掌握了，其他一些抽象的概念简单过了一下，有些是对Hive的操作，因为Hive还没写，就没看，明天学Hive了，后面再回来把对Hive操作的这几集看了。</p>
<h1 id="7-27-Hive-配置以及DDL语句">7.27 Hive 配置以及DDL语句</h1>
<h2 id="1-头：日期、所学内容出处-15">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web">https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web</a></p>
<h2 id="2-标题-15">2.标题</h2>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">P1001-尚硅谷-Hive-课程介绍</span><br><span class="line">P2002-尚硅谷-Hive-概念介绍-</span><br><span class="line">P3003-尚硅谷-Hive-优缺点</span><br><span class="line">P4004-尚硅谷-Hive-架构</span><br><span class="line">P5005-尚硅谷-Hive-与数据库比较</span><br><span class="line">P6006-尚硅谷-Hive-安装<span class="meta">&amp;启动</span></span><br><span class="line">P7007-尚硅谷-Hive-简单使用<span class="meta">&amp;Derby存储元数据的问题</span></span><br><span class="line">P8008-尚硅谷-Hive-MySQL的安装<span class="meta">&amp;启动</span></span><br><span class="line">P9009-尚硅谷-Hive-配置Hive元数据存储为MySQL<span class="meta">&amp;再次启动测试</span></span><br><span class="line">P10010-尚硅谷-Hive-使用元数据服务的方式访问Hive</span><br><span class="line">P11011-尚硅谷-Hive-使用JDBC的方式访问Hive</span><br><span class="line">P12012-尚硅谷-Hive-元数据服务<span class="meta">&amp;Hiveserver2脚本封装</span></span><br><span class="line">P13013-尚硅谷-Hive-修改配置文件使用直连方式访问Hive</span><br><span class="line">P14014-尚硅谷-Hive-其他交互方式</span><br><span class="line">P15015-尚硅谷-Hive-配置日志文件位置<span class="meta">&amp;打印当前库名&amp;表头信息</span></span><br><span class="line">P16016-尚硅谷-Hive-配置信息位置<span class="meta">&amp;优先级</span></span><br><span class="line">P17017-尚硅谷-Hive-课程回顾</span><br><span class="line">P18018-尚硅谷-Hive-关于count star不执行MR任务的说明</span><br><span class="line">P19019-尚硅谷-Hive-Hive中数据类型 一</span><br><span class="line">P20020-尚硅谷-Hive-Hive中数据类型 二</span><br><span class="line">P21021-尚硅谷-Hive-DDL 创建数据库</span><br><span class="line">P22022-尚硅谷-Hive-DDL 查询<span class="meta">&amp;切换数据库</span></span><br><span class="line">P23023-尚硅谷-Hive-DDL 修改<span class="meta">&amp;删除数据库</span></span><br><span class="line">P24024-尚硅谷-Hive-DDL 建表语句分析</span><br><span class="line">P25025-尚硅谷-Hive-DDL 内外部创建<span class="meta">&amp;区别</span></span><br><span class="line">P26026-尚硅谷-Hive-DDL 内外部互相转换</span><br><span class="line">P27027-尚硅谷-Hive-DDL 建表时指定字段分隔符</span><br><span class="line">P28028-尚硅谷-Hive-DDL 修改<span class="meta">&amp;删除表</span></span><br></pre></td></tr></table></figure>
<h2 id="3-所学内容概述-15">3.所学内容概述</h2>
<h3 id="1-18配置Hive在Centos7">1-18配置Hive在Centos7</h3>
<h4 id="Hive数据类型">Hive数据类型</h4>
<h4 id="DDL操作">DDL操作</h4>
<h2 id="4-根据概述分章节描述-13">4.根据概述分章节描述</h2>
<h3 id="Hive数据类型-2">Hive数据类型</h3>
<p>注意一点 时间类型 可以直接String类型yyyy-mm-dd，这样用。</p>
<p><code>对于 Hive 的 String 类型相当于数据库的 varchar 类型，该类型是一个可变的字符串，不过它不能声明其中最多能存储多少个字符，理论上它可以存储 2GB 的字符数。</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220727205745194.png" alt="image-20220727205745194"></p>
<h3 id="集合数据类型">集合数据类型</h3>
<p>Hive 有三种复杂数据类型 ARRAY、MAP 和 STRUCT。ARRAY 和 MAP 与 Java 中的 Array和 Map 类似，而 STRUCT 与 C 语言中的 Struct 类似，它封装了一个命名字段集合，复杂数据类型允许任意层次的嵌套。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220727205903414.png" alt="image-20220727205903414"></p>
<p>案例实操</p>
<p>创建本地测试文件 test.txt</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">songsong,bingbing_lili,xiao song:<span class="number">18</span>_xiaoxiao song:<span class="number">19</span>,hui long guan_beijing</span><br><span class="line">yangyang,caicai_susu,xiao yang:<span class="number">18</span>_xiaoxiao yang:<span class="number">19</span>,chao yang_beijing</span><br></pre></td></tr></table></figure>
<p>Hive 上创建测试表 test</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">create table test(</span><br><span class="line">name string,</span><br><span class="line">friends array&lt;string&gt;,</span><br><span class="line">children map&lt;string, int&gt;,</span><br><span class="line">address struct&lt;street:string, city:string&gt; )</span><br><span class="line">row format delimited fields terminated by &#x27;,&#x27;</span><br><span class="line">collection items terminated by &#x27;_&#x27;</span><br><span class="line">map keys terminated by &#x27;:&#x27;</span><br><span class="line">lines terminated by &#x27;\n&#x27;;</span><br></pre></td></tr></table></figure>
<p>后面四个字段的解释</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">row format delimited fields terminated by &#x27;,&#x27; -- 列分隔符</span><br><span class="line">collection items terminated by &#x27;_&#x27; --MAP STRUCT 和 ARRAY 的分隔符(数据分割符号)</span><br><span class="line">map keys terminated by &#x27;:&#x27; -- MAP 中的 key 与 value 的分隔符</span><br><span class="line">lines terminated by &#x27;\n&#x27;; -- 行分隔符</span><br></pre></td></tr></table></figure>
<h3 id="DDL数据定义">DDL数据定义</h3>
<h4 id="创建数据库"><strong>创建数据库</strong></h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database if <span class="keyword">not</span> <span class="keyword">exists</span> db_hive; #增加 if <span class="keyword">not</span> <span class="keyword">exists</span>判断</span><br></pre></td></tr></table></figure>
<p><strong>指定数据库在</strong> <strong>HDFS</strong> <strong>上存放的位置</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database db_hive2 location <span class="string">&#x27;/db_hive2.db&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h4 id="查询数据库"><strong>查询数据库</strong></h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> databases;</span><br></pre></td></tr></table></figure>
<p><strong>切换当前数据库</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; use db_hive;</span><br></pre></td></tr></table></figure>
<p>修改数据库</p>
<p>用户可以使用 ALTER DATABASE 命令为某个数据库的 DBPROPERTIES 设置键-值对属性值，来描述这个数据库的属性信息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; alter database db_hive </span><br><span class="line">set dbproperties(&#x27;createtime&#x27;=&#x27;20170830&#x27;);</span><br></pre></td></tr></table></figure>
<p><strong>删除数据库</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hvie&gt;drop database db_hive2; //删除空的数据库</span><br><span class="line">hive&gt; drop database if exists db_hive2; //判断数据库是否存在</span><br><span class="line">hive&gt; drop database db_hive cascade; //强制删除数据库 不管是否为空</span><br></pre></td></tr></table></figure>
<h3 id="创建表"><strong>创建表</strong></h3>
<p><strong>建表语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">CREATE [EXTERNAL] TABLE [IF NOT EXISTS] table_name</span><br><span class="line">[(col_name data_type [COMMENT col_comment], ...)]</span><br><span class="line">[COMMENT table_comment]</span><br><span class="line">[PARTITIONED BY (col_name data_type [COMMENT col_comment], ...)]</span><br><span class="line">[CLUSTERED BY (col_name, col_name, ...)</span><br><span class="line">[SORTED BY (col_name [ASC|DESC], ...)] INTO num_buckets BUCKETS]</span><br><span class="line">[ROW FORMAT row_format]</span><br><span class="line">[STORED AS file_format]</span><br><span class="line">[LOCATION hdfs_path]</span><br><span class="line">[TBLPROPERTIES (property_name=property_value, ...)]</span><br><span class="line">[AS select_</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">（1）CREATE TABLE 创建一个指定名字的表。如果相同名字的表已经存在，则抛出异常；用户可以用 IF NOT EXISTS 选项来忽略这个异常。</span><br><span class="line">（2）EXTERNAL 关键字可以让用户创建一个外部表，在建表的同时可以指定一个指向实际数据的路径（LOCATION），在删除表的时候，内部表的元数据和数据会被一起删除，而外部表只删除元数据，不删除数据。 </span><br><span class="line">（3）COMMENT：为表和列添加注释。</span><br><span class="line">（4）PARTITIONED BY 创建分区表</span><br><span class="line">（5）CLUSTERED BY 创建分桶表</span><br><span class="line">（6）SORTED BY 不常用，对桶中的一个或多个列另外排序</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220727211124456.png" alt="image-20220727211124456"></p>
<p><strong>实操案例</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">（1）查询表结构</span><br><span class="line">hive&gt; desc dept;</span><br><span class="line">（2）添加列</span><br><span class="line">hive (default)&gt; alter table dept add columns(deptdesc string);</span><br><span class="line">（3）查询表结构</span><br><span class="line">hive&gt; desc dept;</span><br><span class="line">（4）更新列</span><br><span class="line">hive (default)&gt; alter table dept change column deptdesc desc string; （5）查询表结构</span><br><span class="line">hive&gt; desc dept;</span><br><span class="line">（6）替换列</span><br><span class="line">hive (default)&gt; alter table dept replace columns(deptno string, dname</span><br><span class="line">string, loc string);</span><br><span class="line">（7）查询表结构</span><br><span class="line">hive&gt; desc dept;</span><br></pre></td></tr></table></figure>
<h2 id="7-总结-11">7.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>前天和昨天基本配置了一天的hive,第一天自己配置和yzg帮我一起弄的，后面jar包找不到了，第二天自己又建了一组克隆机，然而配置到JDBC的时候又出现了问题，等了20分钟都没启动起来。后面干脆不管了，就跳过去了，JDBC的部分，因为后面都是直连使用的，就直接看过去了。等部署的同学搞好帮我配一台，Hive的数据类型和Java基本一样就是Long变成了BIGINT,DDL的操作也和MySQL差不多，创建表稍微有点繁琐。语法有很多的字段代码不太好记，DDL似乎不太重要，后面用到的时候，语法敲着敲着就熟悉了，明天学DML了。</p>
<h1 id="7-28-DML操作">7.28 DML操作</h1>
<h2 id="1-头：日期、所学内容出处-16">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web">https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web</a></p>
<h2 id="2-标题-16">2.标题</h2>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">P29029-尚硅谷-Hive-DML 加载数据 <span class="keyword">load</span></span><br><span class="line">P30030-尚硅谷-Hive-DML 加载数据 <span class="keyword">insert</span></span><br><span class="line">P31031-尚硅谷-Hive-DML 加载数据 <span class="keyword">as</span> <span class="keyword">select</span></span><br><span class="line">P32032-尚硅谷-Hive-DML 加载数据 <span class="keyword">location</span></span><br><span class="line">P33033-尚硅谷-Hive-DML 加载数据 <span class="keyword">import</span> 未完待续</span><br><span class="line">P34034-尚硅谷-Hive-DML 导出数据 <span class="keyword">insert</span></span><br><span class="line">P35035-尚硅谷-Hive-DML 导出数据 hadoop命令&amp;Hive shell</span><br><span class="line">P36036-尚硅谷-Hive-DML 导出数据 export&amp;sqoop说明 <span class="keyword">import</span>补充</span><br><span class="line">P37037-尚硅谷-Hive-DML 清空全表</span><br><span class="line">P38038-尚硅谷-Hive-DML 查询 准备数据</span><br><span class="line">P39039-尚硅谷-Hive-DML 查询 查询全表&amp;指定列 注意事项</span><br><span class="line">P40040-尚硅谷-Hive-DML 查询 列别名&amp;运算符</span><br><span class="line">P41041-尚硅谷-Hive-DML 查询 聚合函数&amp;<span class="keyword">Limit</span>&amp;<span class="keyword">Where</span></span><br><span class="line">P42042-尚硅谷-Hive-DML 查询 比较运算符&amp;逻辑运算符</span><br><span class="line">P43043-尚硅谷-Hive-DML 查询 GroupBy &amp; <span class="keyword">Having</span></span><br><span class="line">P44044-尚硅谷-Hive-课程回顾</span><br><span class="line">P45045-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN</span> 内连接</span><br><span class="line">P46046-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN</span> 左外连接</span><br><span class="line">P47047-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN</span> 右外连接</span><br><span class="line">P48048-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN</span> 满外连接</span><br><span class="line">P49049-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN</span> 取左表独有数据</span><br><span class="line">P50050-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN</span> 取右表独有数据</span><br><span class="line">P51051-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN</span> 取左右两表独有数据</span><br><span class="line">P52052-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN</span> 多表连接</span><br><span class="line">P53053-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN</span> 笛卡尔积</span><br><span class="line">P54054-尚硅谷-Hive-DML 查询 排序 <span class="keyword">Order</span> <span class="keyword">By</span></span><br><span class="line">P55055-尚硅谷-Hive-DML 查询 排序 Sort <span class="keyword">By</span></span><br><span class="line">P56056-尚硅谷-Hive-DML 查询 排序 Distribute <span class="keyword">By</span> &amp; <span class="keyword">Cluster</span> <span class="keyword">By</span></span><br><span class="line">P57057-尚硅谷-Hive-DML 查询 排序 <span class="number">4</span>个<span class="keyword">By</span>总结</span><br></pre></td></tr></table></figure>
<h2 id="3-所学内容概述-16">3.所学内容概述</h2>
<h3 id="数据导入">数据导入</h3>
<h3 id="数据导出">数据导出</h3>
<h3 id="查询！">查询！</h3>
<h2 id="4-根据概述分章节描述-14">4.根据概述分章节描述</h2>
<h3 id="数据导入-2">数据导入</h3>
<h4 id="向表中装载数据-Load">向表中装载数据(Load)</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; load data [local] inpath &#x27;数据的 path&#x27; [overwrite] into table </span><br><span class="line">student [partit555555</span><br></pre></td></tr></table></figure>
<p>案例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; create table student(id string, name string) row format </span><br><span class="line">delimited fields terminated by &#x27;,&#x27;;  //创建一张表</span><br><span class="line">hive(default)&gt; lcoal data local inpath &#x27;./student.txt&#x27; into table default.student;</span><br></pre></td></tr></table></figure>
<h4 id="通过查询语句向表中插入数据（Insert）"><strong>通过查询语句向表中插入数据（Insert</strong>）</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive(default)&gt; insert overwrite table student1</span><br><span class="line">			 &gt; select * from student;</span><br></pre></td></tr></table></figure>
<h4 id="查询语句中创建表并加载数据As-Select">查询语句中创建表并加载数据As Select</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">create table if not exists student3</span><br><span class="line">as select id, name from student;</span><br></pre></td></tr></table></figure>
<h4 id="创建表时通过Location指定加载数据路径">创建表时通过Location指定加载数据路径</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; create external table if not exists student5(</span><br><span class="line"> id int, name string)</span><br><span class="line"> row format delimited fields terminated by &#x27;,&#x27;</span><br><span class="line"> location &#x27;/student;</span><br></pre></td></tr></table></figure>
<h4 id="Import-数据到指定-Hive-表中"><strong>Import</strong> <strong>数据到指定</strong> <strong>Hive</strong> 表中</h4>
<p>注意：先用 export 导出后，再将数据导入。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; import table student2</span><br><span class="line">from &#x27;/user/hive/warehouse/export/student&#x27;;</span><br></pre></td></tr></table></figure>
<h3 id="数据导出-2">数据导出</h3>
<h4 id="将查询的结果导出到本地">将查询的结果导出到本地</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; insert overwrite local directory &#x27;./student&#x27; //到hive/student文件夹</span><br><span class="line">    &gt; row format delimited fields terminated by &#x27;,&#x27;  //格式化导出 分隔符为，</span><br><span class="line">    &gt; select * from student5; </span><br></pre></td></tr></table></figure>
<p>如果导出到HDFS 就把local 去掉 后面指定 HDFS的路径 可以直接CP 所以不常用</p>
<h4 id="hadoop命令导出到本地">hadoop命令导出到本地</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dfs -get /文件路径 /导出路径</span><br></pre></td></tr></table></figure>
<p>这个比上面的常用</p>
<h4 id="Hive-Shell-命令导出"><strong>Hive Shell</strong> <strong>命令导出</strong></h4>
<p>基本语法：（hive -f/-e 执行语句或者脚本 &gt; file）</p>
<p>缺点：打印出来有表头信息 所以不常用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[atguigu@hadoop102 hive]$ bin/hive -e &#x27;select * from default.student;&#x27; &gt;&gt;</span><br><span class="line">/opt/module/hive/data/export/student4.txt;</span><br></pre></td></tr></table></figure>
<p>**清除表中数据（**Truncate）</p>
<p>只能清除内部表中的数据 外部表不行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; truncate table student;</span><br></pre></td></tr></table></figure>
<h3 id="基本查询">基本查询</h3>
<p>和MySQL语句一样</p>
<p>全表和特定列查询</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from emp;</span><br><span class="line">select empno, ename from emp;</span><br></pre></td></tr></table></figure>
<p>注意:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">注意： （<span class="number">1</span>）<span class="keyword">SQL</span> 语言大小写不敏感。</span><br><span class="line">（<span class="number">2</span>）<span class="keyword">SQL</span> 可以写在一行或者多行</span><br><span class="line">（<span class="number">3</span>）关键字不能被缩写也不能分行</span><br><span class="line">（<span class="number">4</span>）各子句一般要分行写。</span><br><span class="line">（<span class="number">5</span>）使用缩进提高语句的可读性。</span><br></pre></td></tr></table></figure>
<h4 id="列别名">列别名</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select ename AS name, deptno dn from emp;</span><br></pre></td></tr></table></figure>
<p>AS可以不加 改成空格</p>
<h4 id="算数运算符">算数运算符</h4>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220728164250522.png" alt="image-20220728164250522"></p>
<h4 id="常用函数">常用函数</h4>
<p>要通过MR 运行很慢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1）求总行数（count）</span><br><span class="line">hive (default)&gt; select count(*) cnt from emp;</span><br><span class="line">2）求工资的最大值（max）</span><br><span class="line">hive (default)&gt; select max(sal) max_sal from emp;</span><br><span class="line">3）求工资的最小值（min）</span><br><span class="line">hive (default)&gt; select min(sal) min_sal from emp;</span><br><span class="line">4）求工资的总和（sum）</span><br><span class="line">hive (default)&gt; select sum(sal) sum_sal from emp; </span><br><span class="line">5）求工资的平均值（avg）</span><br><span class="line">hive (default)&gt; select avg(sal) avg_sal from emp;</span><br></pre></td></tr></table></figure>
<h4 id="Limit-语句"><strong>Limit</strong> <strong>语句</strong></h4>
<p>限制返回的行数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; select * from emp limit 5; //查询EMP表 返回前5行</span><br></pre></td></tr></table></figure>
<h4 id="Where-语句"><strong>Where</strong> <strong>语句</strong></h4>
<p><strong>使用</strong> <strong>WHERE</strong> <strong>子句，将不满足条件的行过滤掉</strong></p>
<p><strong>WHERE</strong> <strong>子句紧随</strong> <strong>FROM</strong> <strong>子句</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; select * from emp where sal &gt;1000;</span><br><span class="line">--where子句不能用字段别名</span><br><span class="line">--查询出薪水大于1000的所有员工</span><br></pre></td></tr></table></figure>
<h4 id="比较运算符（Between-In-Is-Null）"><strong>比较运算符（<strong><strong>Between/In/ Is Null</strong></strong>）</strong></h4>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220728164848185.png" alt="image-20220728164848185"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220728164905841.png" alt="image-20220728164905841"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">--（1）查询出薪水等于 5000 的所有员工</span><br><span class="line">hive (default)&gt; select * from emp where sal =5000;</span><br><span class="line">--（2）查询工资在 500 到 1000 的员工信息</span><br><span class="line">hive (default)&gt; select * from emp where sal between 500 and 1000;</span><br><span class="line">--（3）查询 comm 为空的所有员工信息</span><br><span class="line">hive (default)&gt; select * from emp where comm is null;</span><br><span class="line">--（4）查询工资是 1500 或 5000 的员工信息</span><br><span class="line">hive (default)&gt; select * from emp where sal IN (1500, 5000);</span><br></pre></td></tr></table></figure>
<h4 id="Like-和-RLike"><strong>Like</strong> <strong>和</strong> <strong>RLike</strong></h4>
<p>Like和mysql中Like匹配一样，%代表零个或者多个字符(任意个字符)  _代表一个字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--（1）查找名字以 A 开头的员工信息</span><br><span class="line">hive (default)&gt; select * from emp where ename LIKE &#x27;A%&#x27;;</span><br><span class="line">--（2）查找名字中第二个字母为 A 的员工信息</span><br><span class="line">hive (default)&gt; select * from emp where ename LIKE &#x27;_A%&#x27;;</span><br></pre></td></tr></table></figure>
<p>Rlike</p>
<p>RLIKE 子句是 Hive 中这个功能的一个扩展，其可以通过 Java 的正则表达式这个更强大的语言来指定匹配条件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">（3）查找名字中带有 A 的员工信息</span><br><span class="line">hive (default)&gt; select * from emp where ename RLIKE &#x27;[A]&#x27;;</span><br></pre></td></tr></table></figure>
<h4 id="逻辑运算符-And-Or-Not">逻辑运算符(And/Or/Not)</h4>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">AND </span> 逻辑并</span><br><span class="line"><span class="keyword">OR </span>  逻辑或</span><br><span class="line">NOT  逻辑否</span><br></pre></td></tr></table></figure>
<h3 id="分组函数">分组函数</h3>
<p>分组函数的语句顺序</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1 SELECT</span><br><span class="line"> ...</span><br><span class="line">2 FROM</span><br><span class="line">...</span><br><span class="line">3 WHERE</span><br><span class="line">...</span><br><span class="line">4 GROUP BY</span><br><span class="line">...</span><br><span class="line">5 HAVING</span><br><span class="line">...</span><br><span class="line">6 ORDER BY</span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="Group-By语句">Group By语句</h4>
<p>计算 emp 表每个部门的平均工资</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select t.deptno, avg(t.sal) avg_sal from emp t group by t.deptno;</span><br></pre></td></tr></table></figure>
<h4 id="Hiving语句">Hiving语句</h4>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">having</span> 与 <span class="keyword">where</span> 不同点</span><br><span class="line">（<span class="number">1</span>）<span class="keyword">where</span> 后面不能写分组函数，而 <span class="keyword">having</span> 后面可以使用分组函数。</span><br><span class="line">（<span class="number">2</span>）<span class="keyword">having</span> 只用于 <span class="keyword">group</span> <span class="keyword">by</span> 分组统计语句。</span><br></pre></td></tr></table></figure>
<p>案例实操</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">求每个部门的平均薪水大于 2000 的部门</span><br><span class="line">hive (default)&gt; select deptno, avg(sal) avg_sal from emp group by deptno having avg_sal &gt; 2000;</span><br></pre></td></tr></table></figure>
<h2 id="7-总结-12">7.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>今天的DML的基本操作部分，查询语句，分组语句和SQL语句基本差不多，前面是有数据的导入和导出，是结合Hadoop以及hive自己的一些功能，可以实现本地文件或者HDFS的上传加载，导入导出。总体来说今天的学习任务不难，之前有SQL的基础，分组这边的语句，之前没学，不是很好理解，算今天的难点吧，今天学习状态还可以，敲了很多SQL语句，也都记住了，算唤醒之前SQL的记忆吧。</p>
<h1 id="7-29-Join语句">7.29 Join语句</h1>
<h2 id="1-头：日期、所学内容出处-17">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web">https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web</a></p>
<h2 id="2-标题-17">2.标题</h2>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">P44044-尚硅谷-Hive-课程回顾</span><br><span class="line">P45045-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN </span>内连接</span><br><span class="line">P46046-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN </span>左外连接</span><br><span class="line">P47047-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN </span>右外连接</span><br><span class="line">P48048-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN </span>满外连接</span><br><span class="line">P49049-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN </span>取左表独有数据</span><br><span class="line">P50050-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN </span>取右表独有数据</span><br><span class="line">P51051-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN </span>取左右两表独有数据</span><br><span class="line">P52052-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN </span>多表连接</span><br><span class="line">P53053-尚硅谷-Hive-DML 查询 <span class="keyword">JOIN </span>笛卡尔积</span><br><span class="line">P54054-尚硅谷-Hive-DML 查询 排序 <span class="keyword">Order </span><span class="keyword">By</span></span><br><span class="line"><span class="keyword"></span>P55055-尚硅谷-Hive-DML 查询 排序 Sort <span class="keyword">By</span></span><br><span class="line"><span class="keyword"></span>P56056-尚硅谷-Hive-DML 查询 排序 <span class="keyword">Distribute </span><span class="keyword">By </span>&amp; Cluster <span class="keyword">By</span></span><br><span class="line"><span class="keyword"></span>P57057-尚硅谷-Hive-DML 查询 排序 <span class="number">4</span>个<span class="keyword">By总结</span></span><br><span class="line"><span class="keyword"></span>P58058-尚硅谷-Hive-分区表 说明</span><br><span class="line">P59059-尚硅谷-Hive-分区表 创建&amp;简单使用</span><br><span class="line">P60060-尚硅谷-Hive-分区表 分区的增删查</span><br><span class="line">P61061-尚硅谷-Hive-分区表 二级分区</span><br><span class="line">P62062-尚硅谷-Hive-分区表 使HDFS数据与分区表产生联系的方式</span><br><span class="line">P63063-尚硅谷-Hive-分区表 load加载数据不指定分区 演示</span><br><span class="line">P64064-尚硅谷-Hive-分区表 动态分区 演示</span><br><span class="line">P65065-尚硅谷-Hive-分区表 动态分区 <span class="number">3</span>.<span class="number">0</span>新特性</span><br><span class="line">P66066-尚硅谷-Hive-分桶表</span><br></pre></td></tr></table></figure>
<h2 id="3-所学内容概述-17">3.所学内容概述</h2>
<h3 id="Join语句">Join语句</h3>
<h4 id="查询多表">查询多表</h4>
<h4 id="排序">排序</h4>
<h2 id="4-根据概述分章节描述-15">4.根据概述分章节描述</h2>
<h3 id="等值于SQL-join">等值于SQL join</h3>
<p>Hive 支持通常的 SQL JOIN 语句。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">truncate</span> <span class="keyword">table</span> emp;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>清除emp表所有行 防止用本地文件往表格内添加信息的时候 变成追加</span><br></pre></td></tr></table></figure>
<h4 id="表的别名">表的别名</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（1）好处</span><br><span class="line">（1）使用别名可以简化查询。</span><br><span class="line">（2）使用表名前缀可以提高执行效率。</span><br></pre></td></tr></table></figure>
<h5 id="合并员工表和部门表">合并员工表和部门表</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; select e.empno, e.ename, d.deptno from emp e join dept d </span><br><span class="line">on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure>
<h3 id="SQL-Joins">SQL Joins</h3>
<p>join有很多种连接方式 都如图了 类似于集合中的交集 并集 差集</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FTRDExODUyNDA1MTE=,size_16,color_FFFFFF,t_70-16590607630123.png" alt="img"></p>
<h4 id="内连接"><strong>内连接</strong></h4>
<p>内连接：只有进行连接的两个表中都存在与连接条件相匹配的数据才会被保留下来。 交集</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; select e.empno, e.ename, d.deptno from emp e inner join dept d </span><br><span class="line">on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure>
<h4 id="左外连接"><strong>左外连接</strong></h4>
<p>左外连接：JOIN 操作符左边表中符合 WHERE 子句的所有记录将会被返回。 返回join左边的表格</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; select e.empno, e.ename, d.deptno from emp e left join </span><br><span class="line">dept d on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure>
<h4 id="右外连接"><strong>右外连接</strong></h4>
<p>右外连接：JOIN 操作符右边表中符合 WHERE 子句的所有记录将会被返回。 返回join右边的表格</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; select e.empno, e.ename, d.deptno from emp e right join </span><br><span class="line">dept d on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure>
<h4 id="满外连接"><strong>满外连接</strong></h4>
<p>满外连接：将会返回所有表中符合 WHERE 语句条件的所有记录。如果任一表的指定字段没有符合条件的值的话，那么就使用 NULL 值替代。 并集！</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; select e.empno, e.ename, d.deptno from emp e full join </span><br><span class="line">dept d on e.deptno = d.deptno;</span><br></pre></td></tr></table></figure>
<h4 id="左连接">左连接</h4>
<p>取左边特有的部分 就是左外连接除去公共部分</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; select e.empno, e.ename, e.deptno,d.dname from emp e left join </span><br><span class="line">              &gt; dept d on e.deptno = d.deptno</span><br><span class="line">              &gt; where d.deptno is null;</span><br></pre></td></tr></table></figure>
<p>右连接和外连接类似</p>
<h4 id="外连接">外连接</h4>
<p>取两边的数据。 两表独有数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; select e.empno, e.ename, e.deptno,d.dname from emp e full join </span><br><span class="line">              &gt; dept d on e.deptno = d.deptno</span><br><span class="line">              &gt; where d.deptno is null or e.deptno is null;</span><br></pre></td></tr></table></figure>
<h3 id="查询多表-2">查询多表</h3>
<p>查询员工姓名(e)、部门名称(d)以及部门所在城市(l)名称；</p>
<p>hive运行总是从左往右</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; SELECT e.ename, d.dname, l.loc_name</span><br><span class="line">              &gt; FROM emp e </span><br><span class="line">              &gt; JOIN dept d</span><br><span class="line">              &gt; ON d.deptno = e.deptno </span><br><span class="line">              &gt; JOIN location l</span><br><span class="line">              &gt; ON d.loc = l.loc;</span><br></pre></td></tr></table></figure>
<h4 id="笛卡尔积">笛卡尔积</h4>
<p>出来的行数相当于两边表格相乘</p>
<p>笛卡尔集会在下面条件下产生</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（1）省略连接条件</span><br><span class="line">（2）连接条件无效</span><br><span class="line">（3）所有表中的所有行互相连接</span><br></pre></td></tr></table></figure>
<p>案例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select empno, dname from emp,dept;</span><br></pre></td></tr></table></figure>
<h3 id="排序-2">排序</h3>
<h4 id="全局排序（order-by）">全局排序（order by）</h4>
<p>Order By：全局排序，只有一个 Reducer</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ASC</span>（ascend）: 升序（默认）</span><br><span class="line"><span class="keyword">DESC</span>（descend）: 降序</span><br></pre></td></tr></table></figure>
<p>案例实操</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">（1）查询员工信息按工资升序排列</span><br><span class="line">hive (default)&gt; select * from emp order by sal;</span><br><span class="line">（2）查询员工信息按工资降序排列</span><br><span class="line">hive (default)&gt; select * from emp order by sal desc;</span><br></pre></td></tr></table></figure>
<h4 id="多个列排序">多个列排序</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt;  select ename, deptno,sal from emp order by deptno,sal;</span><br></pre></td></tr></table></figure>
<p><strong>每个</strong> <strong>Reduce</strong> **内部排序（**Sort By）</p>
<p><code>Sort By：对于大规模的数据集 order by 的效率非常低。在很多情况下，并不需要全局排序，此时可以使用 **sort by**。</code></p>
<p><code>Sort by 为每个 reducer 产生一个排序文件。每个 Reducer 内部进行排序，对全局结果集来说不是排序</code> 区内有序</p>
<p><strong>设置</strong> <strong>reduce</strong> <strong>个数</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; set mapreduce.job.reduces=3;</span><br></pre></td></tr></table></figure>
<p>根据部门编号降序查看员工信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; select * from emp sort by deptno desc;</span><br></pre></td></tr></table></figure>
<h4 id="分区-（-Distribute-By）">分区**（**Distribute By）</h4>
<p>一般和sort by一起排序</p>
<p>Distribute By：</p>
<p>在有些情况下，我们需要控制某个特定行应该到哪个 reducer，通常是为了进行后续的聚集操作。<strong>distribute by</strong> 子句可以做这件事。<strong>distribute by</strong> 类似 MR 中 partition（自定义分区），进行分区，结合 sort by 使用。</p>
<p>在CSDN中有特别讲分区排序</p>
<p><a target="_blank" rel="noopener" href="http://t.csdn.cn/HhwIw">http://t.csdn.cn/HhwIw</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> select * from emp distribute by </span><br><span class="line">deptno sort by empno desc;</span><br></pre></td></tr></table></figure>
<p>部门编号分区 员工编号排序</p>
<p>当 distribute by 和 sorts by 字段相同时，可以使用 cluster by 方式。</p>
<p><code>cluster by 除了具有 distribute by 的功能外还兼具 sort by 的功能。但是排序只能是升序排序，不能指定排序规则为 ASC 或者 DESC</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; select * from emp cluster by deptno;</span><br><span class="line">hive (default)&gt; select * from emp distribute by deptno sort by deptno;</span><br></pre></td></tr></table></figure>
<h4 id="分区表">分区表</h4>
<h2 id="5-BUG点-10">5. BUG点</h2>
<p>难点(关键代码或关键配置，BUG截图+解决方案)</p>
<p>左连接的时候，deptno这列我很多null，但是检查数据源文件这列是有的</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220729094359004.png" alt="image-20220729094359004"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220729094431338.png" alt="image-20220729094431338"></p>
<p>先是怀疑hive建表的时候是不是出现了问题 又建了一遍表格发现还是有问题，查询的时候，最后一行只有null有问题</p>
<p>只能显示30看了自己的源文件，发现30的信息是最全的，每一列都有，就怀疑是源文件内的问题:</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">创建表格的时候分了<span class="number">8</span>列 以空格切割，但是源文件有几行 只有 <span class="number">6</span>列 <span class="number">7</span>列 那它空格切出来 也是<span class="number">6</span>列 <span class="number">7</span>列而且是按顺序。像第四列我是<span class="built_in">int</span>类的 但是有几行没有这一列的数据 就自动算后面的data 类型不统一 就显示了<span class="literal">null</span> 后面数据没有也自然显示<span class="literal">NULL</span></span><br></pre></td></tr></table></figure>
<p>查询hiredate的时候，发现有一行显示的5000 而这一行恰好是没有mgr的那一行。那就是长度问题 导致分隔符切错了。</p>
<p>把源文件emp.txt没数据的地方 输入两个空格 作为分隔就解决了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220729102024370.png" alt="image-20220729102024370"></p>
<h3 id="JVM报错">JVM报错</h3>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/image-20220729150136194.png" alt="image-20220729150136194"></p>
<p>在CSDN解决</p>
<p>Hive命令调用MR任务报错</p>
<p>将 hive 设置成本地模式来执行任务试试,命令如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set hive.exec.mode.local.auto=true;</span><br></pre></td></tr></table></figure>
<p>问题解决，但是只有一次性，hive退出就不行了，把他写到配置文件中</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.exec.mode.local.auto<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>问题永久解决</p>
<h2 id="7-总结-13">7.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>今天的内容主要是Join语句和排序以及分区方面的一小部分内容，join语句和排序比较简单的也容易掌握，今天建表切割方面的原理方面的知识出现了缺陷，解决BUG,补充了知识点。今天的重点和难点在分区，分区能让效率提高很多，还是很重要的，能避免全局扫描，导致运行速度很慢，在公司甚至运行不起来，效率太低了。内容比较多，这部分的原理，只是一知半解，明天再好好回顾一下分区方面的内容。</p>
<h1 id="7-31-函数">7.31 函数</h1>
<h2 id="1-头：日期、所学内容出处-18">1.头：日期、所学内容出处</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web">https://www.bilibili.com/video/BV1WY4y1H7d3?p=28&amp;share_source=copy_web</a></p>
<h2 id="2-标题-18">2.标题</h2>
<figure class="highlight tp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">P</span><span class="number">67067</span>-尚硅谷-Hive-DML 函数 查询系统函数</span><br><span class="line"><span class="keyword">P</span><span class="number">68068</span>-尚硅谷-Hive-DML 函数 NVL</span><br><span class="line"><span class="keyword">P</span><span class="number">69069</span>-尚硅谷-Hive-DML 函数 CASE WHEN THEN <span class="keyword">ELSE</span> <span class="keyword">END</span></span><br><span class="line"><span class="keyword">P</span><span class="number">70070</span>-尚硅谷-Hive-课程回顾</span><br><span class="line"><span class="keyword">P</span><span class="number">71071</span>-尚硅谷-Hive-DML 函数 拼接字符串 函数说明</span><br><span class="line"><span class="keyword">P</span><span class="number">72072</span>-尚硅谷-Hive-DML 函数 拼接字符串 函数使用</span><br><span class="line"><span class="keyword">P</span><span class="number">73073</span>-尚硅谷-Hive-DML 函数 Explode</span><br><span class="line"><span class="keyword">P</span><span class="number">74074</span>-尚硅谷-Hive-DML 函数 行转列&amp;列转行说明</span><br><span class="line"><span class="keyword">P</span><span class="number">75075</span>-尚硅谷-Hive-DML 函数 窗口函数 初体验</span><br><span class="line"><span class="keyword">P</span><span class="number">76076</span>-尚硅谷-Hive-DML 函数 窗口函数 需求二</span><br><span class="line"><span class="keyword">P</span><span class="number">77077</span>-尚硅谷-Hive-DML 函数 窗口函数 需求三</span><br><span class="line"><span class="keyword">P</span><span class="number">78078</span>-尚硅谷-Hive-DML 函数 窗口函数 排序值相同时说明</span><br><span class="line"><span class="keyword">P</span><span class="number">79079</span>-尚硅谷-Hive-DML 函数 窗口函数 需求四</span><br><span class="line"><span class="keyword">P</span><span class="number">80080</span>-尚硅谷-Hive-DML 函数 窗口函数 需求五</span><br><span class="line"><span class="keyword">P</span><span class="number">81081</span>-尚硅谷-Hive-DML 函数 窗口函数 Rank</span><br><span class="line"><span class="keyword">P</span><span class="number">82082</span>-尚硅谷-Hive-DML 函数 其他常用函数 日期函数</span><br><span class="line"><span class="keyword">P</span><span class="number">83083</span>-尚硅谷-Hive-DML 函数 其他常用函数 数据取整函数</span><br><span class="line"><span class="keyword">P</span><span class="number">84084</span>-尚硅谷-Hive-DML 函数 其他常用函数 字符串相关函数</span><br><span class="line"><span class="keyword">P</span><span class="number">85085</span>-尚硅谷-Hive-DML 函数 其他常用函数 集合函数</span><br></pre></td></tr></table></figure>
<h2 id="3-所学内容概述-18">3.所学内容概述</h2>
<h3 id="查询系统函数">查询系统函数</h3>
<h3 id="各种系统函数">各种系统函数</h3>
<h3 id="行转列-列转行">行转列 列转行</h3>
<h3 id="窗口函数">窗口函数</h3>
<h2 id="4-根据概述分章节描述-16">4.根据概述分章节描述</h2>
<h3 id="系统内置函数"><strong>系统内置函数</strong></h3>
<p>Hive中系统自带的函数有很多 有条命令相当于API</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">show funcations; //查看系统自带的函数</span><br><span class="line">desc function uppper;//显示自带函数的用发 可以翻译中文</span><br><span class="line">desc function extended lower; //详细显示用法 这个好用些</span><br></pre></td></tr></table></figure>
<h3 id="常用内置函数">常用内置函数</h3>
<h4 id="空字符串赋值">空字符串赋值</h4>
<p>NVL：给值为 NULL 的数据赋值，它的格式是 NVL( value，default_value)。它的功能是如果 value 为 NULL，则 NVL 函数返回 default_value 的值，否则返回 value 的值。第二个参数可以不填，这样value如果是NULL，返回值也是NULL。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select comm,nvl(comm, -1) from emp; //如果comm为NULL -1代替 </span><br></pre></td></tr></table></figure>
<h3 id="行转列">行转列</h3>
<p>大白话其实就是一列转换为多列</p>
<p>用的到三个函数变形</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CONCAT(string A/col, string B/col…)：返回输入字符串连接后的结果，支持任意个输入字符串;</span><br><span class="line">CONCAT_WS(separator, str1, str2,...)：它是一个特殊形式的 CONCAT()。第一个参数是合并参数间的分隔符。</span><br><span class="line">COLLECT_SET(col)：函数只接受基本数据类型，它的主要作用是将某字段的值进行去重汇总，产生 Array 类型字段。</span><br></pre></td></tr></table></figure>
<p>实例代码不太好懂 都标上注解</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT t1.c_b, CONCAT_WS(&quot;|&quot;,collect_set(t1.name)) --名字去重 并用|分割</span><br><span class="line">FROM (SELECT NAME, --用c_b结果</span><br><span class="line">CONCAT_WS(&#x27;,&#x27;,constellation,blood_type) c_b --合并两条数据并用,隔开 别名c_b</span><br><span class="line">FROM person_info</span><br><span class="line">)t1 --别名t1</span><br><span class="line">GROUP BY t1.c_b --按照t1的c_b查询结果分组</span><br></pre></td></tr></table></figure>
<h3 id="列转行">列转行</h3>
<p>一行转多行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">EXPLODE(col)：将 hive 一列中复杂的 Array 或者 Map 结构拆分成多行。</span><br><span class="line">LATERAL VIEW</span><br><span class="line">用法：LATERAL VIEW udtf(expression) tableAlias AS columnAlias</span><br></pre></td></tr></table></figure>
<p>案例用法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">movie,</span><br><span class="line">category_name</span><br><span class="line">FROM</span><br><span class="line">movie_info</span><br><span class="line">lateral VIEW --使用函数</span><br><span class="line">explode(split(category,&quot;,&quot;)) movie_info_tmp --别名 </span><br><span class="line">AS category_name; --作为category_name 可给上面返回查询</span><br></pre></td></tr></table></figure>
<h3 id="窗口函数-2">窗口函数</h3>
<p>一般情况窗口函数都会搭配over使用 以四个案例来大致了解窗口函数</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">OVER</span><span class="params">()</span></span>：指定分析函数工作的数据窗口大小，这个数据窗口大小可能会随着行的变而变</span><br></pre></td></tr></table></figure>
<h4 id="查询在-2017-年-4-月份购买过的顾客及总人数">查询在 2017 年 4 月份购买过的顾客及总人数</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select name,count(*) over () </span><br><span class="line">from business</span><br><span class="line">where substring(orderdate,1,7) = &#x27;2017-04&#x27; --筛选orderdate这一列前1-7的字符串为2017-04的</span><br><span class="line">group by name; --按照name分组</span><br></pre></td></tr></table></figure>
<h4 id="查询顾客的购买明细及月购买总额">查询顾客的购买明细及月购买总额</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select name,orderdate,cost,sum(cost) --分区内cost的和</span><br><span class="line">over(partition by month(orderdate)) --按照orderdate月份分区</span><br><span class="line">from business;</span><br></pre></td></tr></table></figure>
<h4 id="查看顾客上次的购买时间或者下次购买时间">查看顾客上次的购买时间或者下次购买时间</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select name,orderdate,cost,</span><br><span class="line">lag(orderdate,1,&#x27;1900-01-01&#x27;) over(partition by name order by orderdate ) as time1 --上次购买时间 lag第三个参数是如果 为null 改成1900 01 01</span><br><span class="line">from business;</span><br></pre></td></tr></table></figure>
<h3 id="Rank"><strong>Rank</strong></h3>
<p>案例直观的感受三者的区别</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">RANK</span><span class="params">()</span></span> 排序相同时会重复，总数不会变</span><br><span class="line"><span class="function"><span class="title">DENSE_RANK</span><span class="params">()</span></span> 排序相同时会重复，总数会减少</span><br><span class="line"><span class="function"><span class="title">ROW_NUMBER</span><span class="params">()</span></span> 会根据顺序计算</span><br></pre></td></tr></table></figure>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">rank</span><br><span class="line">宋宋	英语	84	1</span><br><span class="line">大海	英语	84	1</span><br><span class="line">婷婷	英语	78	3</span><br><span class="line">孙悟空	英语	68	4</span><br><span class="line">dense<span class="emphasis">_rank</span></span><br><span class="line"><span class="emphasis">宋宋	英语	84	1</span></span><br><span class="line"><span class="emphasis">大海	英语	84	1</span></span><br><span class="line"><span class="emphasis">婷婷	英语	78	2</span></span><br><span class="line"><span class="emphasis">孙悟空	英语	68	3</span></span><br><span class="line"><span class="emphasis">row_</span>Number</span><br><span class="line">宋宋	英语	84	1</span><br><span class="line">大海	英语	84	2</span><br><span class="line">婷婷	英语	78	3</span><br><span class="line">孙悟空	英语	68	4</span><br></pre></td></tr></table></figure>
<h2 id="6-扩展学习部分-9">6.扩展学习部分</h2>
<p>Hive常用的日期 字符串 集合的方法 以及案例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">常用日期函数</span><br><span class="line">unix_timestamp:返回当前或指定时间的时间戳	</span><br><span class="line">select unix_timestamp();</span><br><span class="line">select unix_timestamp(&quot;2020-10-28&quot;,&#x27;yyyy-MM-dd&#x27;);</span><br><span class="line"></span><br><span class="line">from_unixtime：将时间戳转为日期格式</span><br><span class="line">select from_unixtime(1603843200);</span><br><span class="line"></span><br><span class="line">current_date：当前日期</span><br><span class="line">select current_date;</span><br><span class="line"></span><br><span class="line">current_timestamp：当前的日期加时间</span><br><span class="line">select current_timestamp;</span><br><span class="line"></span><br><span class="line">to_date：抽取日期部分</span><br><span class="line">select to_date(&#x27;2020-10-28 12:12:12&#x27;);</span><br><span class="line"></span><br><span class="line">year：获取年</span><br><span class="line">select year(&#x27;2020-10-28 12:12:12&#x27;);</span><br><span class="line"></span><br><span class="line">month：获取月</span><br><span class="line">select month(&#x27;2020-10-28 12:12:12&#x27;);</span><br><span class="line"></span><br><span class="line">day：获取日</span><br><span class="line">select day(&#x27;2020-10-28 12:12:12&#x27;);</span><br><span class="line"></span><br><span class="line">hour：获取时</span><br><span class="line">select hour(&#x27;2020-10-28 12:12:12&#x27;);</span><br><span class="line"></span><br><span class="line">minute：获取分</span><br><span class="line">select minute(&#x27;2020-10-28 12:12:12&#x27;);</span><br><span class="line"></span><br><span class="line">second：获取秒</span><br><span class="line">select second(&#x27;2020-10-28 12:12:12&#x27;);</span><br><span class="line"></span><br><span class="line">weekofyear：当前时间是一年中的第几周</span><br><span class="line">select weekofyear(&#x27;2020-10-28 12:12:12&#x27;);</span><br><span class="line"></span><br><span class="line">dayofmonth：当前时间是一个月中的第几天</span><br><span class="line">select dayofmonth(&#x27;2020-10-28 12:12:12&#x27;);</span><br><span class="line"></span><br><span class="line">months_between： 两个日期间的月份</span><br><span class="line">select months_between(&#x27;2020-04-01&#x27;,&#x27;2020-10-28&#x27;);</span><br><span class="line"></span><br><span class="line">add_months：日期加减月</span><br><span class="line">select add_months(&#x27;2020-10-28&#x27;,-3);</span><br><span class="line"></span><br><span class="line">datediff：两个日期相差的天数</span><br><span class="line">select datediff(&#x27;2020-11-04&#x27;,&#x27;2020-10-28&#x27;);</span><br><span class="line"></span><br><span class="line">date_add：日期加天数</span><br><span class="line">select date_add(&#x27;2020-10-28&#x27;,4);</span><br><span class="line"></span><br><span class="line">date_sub：日期减天数</span><br><span class="line">select date_sub(&#x27;2020-10-28&#x27;,-4);</span><br><span class="line"></span><br><span class="line">last_day：日期的当月的最后一天</span><br><span class="line">select last_day(&#x27;2020-02-30&#x27;);</span><br><span class="line"></span><br><span class="line">date_format(): 格式化日期</span><br><span class="line">select date_format(&#x27;2020-10-28 12:12:12&#x27;,&#x27;yyyy/MM/dd HH:mm:ss&#x27;);</span><br><span class="line"></span><br><span class="line">常用取整函数</span><br><span class="line">round： 四舍五入</span><br><span class="line">select round(3.14);</span><br><span class="line">select round(3.54);</span><br><span class="line"></span><br><span class="line">ceil：  向上取整</span><br><span class="line">select ceil(3.14);</span><br><span class="line">select ceil(3.54);</span><br><span class="line"></span><br><span class="line">floor： 向下取整</span><br><span class="line">select floor(3.14);</span><br><span class="line">select floor(3.54);</span><br><span class="line"></span><br><span class="line">常用字符串操作函数</span><br><span class="line">upper： 转大写</span><br><span class="line">select upper(&#x27;low&#x27;);</span><br><span class="line"></span><br><span class="line">lower： 转小写</span><br><span class="line">select lower(&#x27;low&#x27;);</span><br><span class="line"></span><br><span class="line">length： 长度</span><br><span class="line">select length(&quot;atguigu&quot;);</span><br><span class="line"></span><br><span class="line">trim：  前后去空格</span><br><span class="line">select trim(&quot; atguigu &quot;);</span><br><span class="line"></span><br><span class="line">lpad： 向左补齐，到指定长度</span><br><span class="line">select lpad(&#x27;atguigu&#x27;,9,&#x27;g&#x27;);</span><br><span class="line"></span><br><span class="line">rpad：  向右补齐，到指定长度</span><br><span class="line">select rpad(&#x27;atguigu&#x27;,9,&#x27;g&#x27;);</span><br><span class="line"></span><br><span class="line">regexp_replace：使用正则表达式匹配目标字符串，匹配成功后替换！</span><br><span class="line">SELECT regexp_replace(&#x27;2020/10/25&#x27;, &#x27;/&#x27;, &#x27;-&#x27;);</span><br><span class="line"></span><br><span class="line">集合操作</span><br><span class="line">size： 集合中元素的个数</span><br><span class="line">select size(friends) from test3;</span><br><span class="line"></span><br><span class="line">map_keys： 返回map中的key</span><br><span class="line">select map_keys(children) from test3;</span><br><span class="line"></span><br><span class="line">map_values: 返回map中的value</span><br><span class="line">select map_values(children) from test3;</span><br><span class="line"></span><br><span class="line">array_contains: 判断array中是否包含某个元素</span><br><span class="line">select array_contains(friends,&#x27;bingbing&#x27;) from test3;</span><br><span class="line"></span><br><span class="line">sort_array： 将array中的元素排序</span><br><span class="line">select sort_array(friends) from test3;</span><br><span class="line"></span><br><span class="line">grouping_set:多维分析</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="7-总结-14">7.总结</h2>
<p>重点是哪些知识比较重要，难点是你在学习过程中觉得比较繁琐,掌握起来有一点</p>
<p>今天的学习任务是Hive的函数部分，其实就是了解Hive中对数据处理的各种方式，有一些处理方式，有点像Java中的几个函数，改了名字。实际作用是差不多的，合理使用函数，对数据处理的效率能提高不少。这些函数对数据的筛选和过滤，利用好分区和分组加排序，能很灵活的对数据处理。今天难度简单吧，基本全部掌握了，列转行这里有些函数没有去尝试过，也没出BUG，学习状态也不错。</p>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>7月笔记</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://u7u7.top/posts/33ff80d0.html">https://u7u7.top/posts/33ff80d0.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>U7's Blog🍋</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2023-03-10</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2023-03-10</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%9C%88%E7%AC%94%E8%AE%B0/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>月笔记</a><a class="post-meta__tags" href="/tags/Scala/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>Scala</a><a class="post-meta__tags" href="/tags/Spark/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>Spark</a><a class="post-meta__tags" href="/tags/SQL/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>SQL</a></div></div><link rel="stylesheet" href="/css/coin.css" media="defer" onload="this.media='all'"/><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">投喂作者</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://u7img.oss-cn-hangzhou.aliyuncs.com/wechat.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://u7img.oss-cn-hangzhou.aliyuncs.com/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></button></div><audio id="coinAudio" src="https://npm.elemecdn.com/akilar-candyassets@1.0.36/audio/aowu.m4a"></audio><script defer="defer" src="/js/coin.js"></script><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/c2f4db5d.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/202211081406572.webp" onerror="onerror=null;src='/assets/r2.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">8月笔记</div></div></a></div><div class="next-post pull-right"><a href="/posts/suanfa.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wallhaven-jx5xyw.webp" onerror="onerror=null;src='/assets/r2.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">算法</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/c2f4db5d.html" title="8月笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/202211081406572.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-03-11</div><div class="title">8月笔记</div></div></a></div><div><a href="/posts/2d36b063.html" title="大数据9月笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/test4.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-03-11</div><div class="title">大数据9月笔记</div></div></a></div><div><a href="/posts/22biji10.html" title="10月笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wallhaven-1kmx19_2560x1440.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-03-11</div><div class="title">10月笔记</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><svg class="meta_icon" style="width:22px;height:22px;position:relative;top:5px"><use xlink:href="#icon-mulu1"></use></svg><span style="font-weight:bold">目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#7-7-linux%E5%85%A5%E9%97%A8-%E5%9F%BA%E7%A1%80"><span class="toc-text">7.7 linux入门 基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0"><span class="toc-text">3.所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux-%E6%96%87%E4%BB%B6%E4%B8%8E%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-text">Linux 文件与目录结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VI-VIM-%E7%BC%96%E8%BE%91%E5%99%A8%EF%BC%88%E9%87%8D%E8%A6%81%EF%BC%89"><span class="toc-text">VI&#x2F;VIM 编辑器（重要）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE"><span class="toc-text">网络配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86"><span class="toc-text">系统管理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0"><span class="toc-text">4、根据概述分章节描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux-%E6%96%87%E4%BB%B6%E4%B8%8E%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84-2"><span class="toc-text">Linux 文件与目录结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VI-VIM-%E7%BC%96%E8%BE%91%E5%99%A8%EF%BC%88%E9%87%8D%E8%A6%81%EF%BC%89-2"><span class="toc-text">VI&#x2F;VIM 编辑器（重要）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E8%88%AC%E6%A8%A1%E5%BC%8F"><span class="toc-text">一般模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%A8%A1%E5%BC%8F"><span class="toc-text">编辑模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E4%BB%A4%E6%A8%A1%E5%BC%8F"><span class="toc-text">指令模式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE-2"><span class="toc-text">网络配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%BB%9C-IP-%E5%92%8C-%E7%BD%91%E5%85%B3"><span class="toc-text">查看网络 IP 和 网关</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E7%BD%91%E7%BB%9Cip%E5%9C%B0%E5%9D%80"><span class="toc-text">配置网络ip地址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9-IP-%E5%9C%B0%E5%9D%80"><span class="toc-text">修改 IP 地址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E4%B8%BB%E6%9C%BA%E5%90%8D%E7%A7%B0"><span class="toc-text">修改主机名称</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E4%BA%86xshell%E5%92%8Cxfip"><span class="toc-text">下载了xshell和xfip</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86-2"><span class="toc-text">系统管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Linux-%E4%B8%AD%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%92%8C%E6%9C%8D%E5%8A%A1"><span class="toc-text">Linux 中的进程和服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#systemctl"><span class="toc-text">systemctl</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%85%B3%E6%9C%BA%E9%87%8D%E5%90%AF%E5%91%BD%E4%BB%A4%E5%A6%82%E4%B8%8B"><span class="toc-text">常用关机重启命令如下</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%80%BB%E7%BB%93"><span class="toc-text">5.总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-8-%E5%AE%9E%E6%93%8D%E7%AF%87-%E6%96%87%E4%BB%B6%E5%92%8C%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86"><span class="toc-text">7.8 实操篇 文件和用户管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84-2"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98-2"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-2"><span class="toc-text">3.所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%AE%E5%8A%A9%E5%91%BD%E4%BB%A4"><span class="toc-text">帮助命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E7%B1%BB"><span class="toc-text">文件目录类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E7%B1%BB"><span class="toc-text">时间日期类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4"><span class="toc-text">用户管理命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E7%BB%84%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4"><span class="toc-text">用户组管理命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E7%B1%BB"><span class="toc-text">文件权限类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2%E6%9F%A5%E6%89%BE%E7%B1%BB"><span class="toc-text">搜索查找类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%8B%E7%BC%A9%E5%92%8C%E8%A7%A3%E5%8E%8B%E7%B1%BB"><span class="toc-text">压缩和解压类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A3%81%E7%9B%98%E6%9F%A5%E7%9C%8B%E5%92%8C%E5%88%86%E5%8C%BA%E7%B1%BB"><span class="toc-text">磁盘查看和分区类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86%E7%B1%BB"><span class="toc-text">进程管理类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0-2"><span class="toc-text">4、根据概述分章节描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%AE%E5%8A%A9%E5%91%BD%E4%BB%A4-2"><span class="toc-text">帮助命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E7%B1%BB-2"><span class="toc-text">文件目录类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#pwd"><span class="toc-text">pwd</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ls"><span class="toc-text">ls</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#cd"><span class="toc-text">cd</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-text">基本用法</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-%E5%88%A0%E9%99%A4-%E6%9F%A5%E6%89%BE%E6%96%87%E4%BB%B6%E4%BB%A5%E5%8F%8A%E7%9B%AE%E5%BD%95"><span class="toc-text">创建 删除 查找文件以及目录</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA"><span class="toc-text">创建</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A0%E9%99%A4"><span class="toc-text">删除</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6"><span class="toc-text">创建文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6"><span class="toc-text">删除文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6"><span class="toc-text">复制文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E6%96%87%E4%BB%B6"><span class="toc-text">移动文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6"><span class="toc-text">查看文件</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-text">输出重定向</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#echo"><span class="toc-text">echo</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#tail"><span class="toc-text">tail</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BD%AF%E9%93%BE%E6%8E%A5"><span class="toc-text">软链接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%8E%86%E5%8F%B2%E5%91%BD%E4%BB%A4"><span class="toc-text">查看历史命令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E7%B1%BB-2"><span class="toc-text">时间日期类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4-2"><span class="toc-text">用户管理命令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A9%E7%94%A8sudo%E5%91%BD%E4%BB%A4%E7%BB%99%E7%94%A8%E6%88%B7root%E6%9D%83%E9%99%90"><span class="toc-text">利用sudo命令给用户root权限</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E7%B1%BB-2"><span class="toc-text">文件权限类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#rew%E5%9C%A8%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E7%9A%84%E8%A7%A3%E9%87%8A"><span class="toc-text">rew在文件和目录的解释</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2%E6%9F%A5%E6%89%BE%E7%B1%BB-2"><span class="toc-text">搜索查找类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%8B%E7%BC%A9%E5%92%8C%E8%A7%A3%E5%8E%8B%E7%B1%BB-2"><span class="toc-text">压缩和解压类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%80%E5%B8%B8%E7%94%A8%E7%9A%84%E6%89%93%E5%8C%85tar"><span class="toc-text">最常用的打包tar</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A3%81%E7%9B%98%E6%9F%A5%E7%9C%8B%E5%92%8C%E5%88%86%E5%8C%BA%E7%B1%BB-2"><span class="toc-text">磁盘查看和分区类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA"><span class="toc-text">磁盘分区</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86%E7%B1%BB-2"><span class="toc-text">进程管理类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ps-%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E7%B3%BB%E7%BB%9F%E8%BF%9B%E7%A8%8B%E7%8A%B6%E6%80%81"><span class="toc-text">ps 查看当前系统进程状态</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%88%E6%AD%A2%E8%BF%9B%E7%A8%8B"><span class="toc-text">终止进程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pstree%E6%9F%A5%E7%9C%8B%E8%BF%9B%E7%A8%8B%E6%A0%91"><span class="toc-text">pstree查看进程树</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-BUG%E7%82%B9"><span class="toc-text">5. BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0%E9%83%A8%E5%88%86"><span class="toc-text">6.扩展学习部分</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AC%E9%93%BE%E6%8E%A5"><span class="toc-text">硬链接</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%80%BB%E7%BB%93"><span class="toc-text">7.总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-9-%E6%89%A9%E5%B1%95%E7%AF%87-Shell%E7%BC%96%E7%A8%8B"><span class="toc-text">7.9 扩展篇 Shell编程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84-3"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98-3"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-3"><span class="toc-text">3.所学内容概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0"><span class="toc-text">4.根据概述分章节描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AF%E4%BB%B6%E5%8C%85%E7%AE%A1%E7%90%86"><span class="toc-text">软件包管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Shell"><span class="toc-text">Shell</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-text">概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Shell%E8%84%9A%E6%9C%AC"><span class="toc-text">Shell脚本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-text">变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD"><span class="toc-text">条件判断</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="toc-text">流程控制</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#if%E8%AF%AD%E5%8F%A5"><span class="toc-text">if语句</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#case"><span class="toc-text">case</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#for%E5%BE%AA%E7%8E%AF"><span class="toc-text">for循环</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#while%E5%BE%AA%E7%8E%AF"><span class="toc-text">while循环</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#read%E8%AF%BB%E5%8F%96%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BE%93%E5%85%A5"><span class="toc-text">read读取控制台输入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-text">函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%80%BB%E7%BB%93-2"><span class="toc-text">5.总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-11-Scala%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8"><span class="toc-text">7.11 Scala基础入门</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84-4"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98-4"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-4"><span class="toc-text">3.所学内容概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0-2"><span class="toc-text">4.根据概述分章节描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Scala%E6%A6%82%E8%BF%B0"><span class="toc-text">Scala概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Scala%E7%89%B9%E7%82%B9"><span class="toc-text">Scala特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Scala%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-text">Scala环境搭建</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Scala%E5%85%A5%E9%97%A8"><span class="toc-text">Scala入门</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E5%92%8C%E5%B8%B8%E9%87%8F"><span class="toc-text">变量和常量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%87%E8%AF%86%E7%AC%A6%E7%9A%84%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83"><span class="toc-text">标识符的命名规范</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BE%93%E5%87%BA"><span class="toc-text">字符串输出</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-%E9%87%8D%E7%82%B9"><span class="toc-text">数据类型(重点)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%80%BB%E7%BB%93-3"><span class="toc-text">5.总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-13-hadoop%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8"><span class="toc-text">7.13 hadoop基础入门</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84-5"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98-5"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-5"><span class="toc-text">3.所学内容概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0-3"><span class="toc-text">4.根据概述分章节描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hadoop%E6%A6%82%E8%BF%B0"><span class="toc-text">hadoop概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E5%87%86%E5%A4%87"><span class="toc-text">虚拟机环境搭建准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hadoop%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-text">hadoop目录结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hadoop%E8%BF%90%E8%A1%8C%E6%A8%A1%E5%BC%8F"><span class="toc-text">Hadoop运行模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E8%BF%90%E8%A1%8C"><span class="toc-text">本地运行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E8%BF%90%E8%A1%8C%E6%A8%A1%E5%BC%8F"><span class="toc-text">伪分布式运行模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%8E%86%E5%8F%B2%E6%9C%8D%E5%8A%A1%E5%99%A8-%E6%97%A5%E5%BF%97%E8%81%9A%E9%9B%86"><span class="toc-text">配置历史服务器 日志聚集</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0%E9%83%A8%E5%88%86-2"><span class="toc-text">6.扩展学习部分</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%9A%84%E6%8A%80%E6%9C%AF%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E4%BD%93%E7%B3%BB"><span class="toc-text">大数据的技术生态系统体系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%80%BB%E7%BB%93-2"><span class="toc-text">7.总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-14-hadoop%E5%AE%8C%E5%85%A8%E5%88%86%E5%B8%83%E5%BC%8F"><span class="toc-text">7.14 hadoop完全分布式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84-6"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98-6"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-6"><span class="toc-text">3.所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%85%8B%E9%9A%86"><span class="toc-text">准备虚拟机克隆</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E9%9B%86%E7%BE%A4%E5%88%86%E5%8F%91%E8%84%9A%E6%9C%AC"><span class="toc-text">编写集群分发脚本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE"><span class="toc-text">集群配置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0-4"><span class="toc-text">4.根据概述分章节描述.</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%85%8B%E9%9A%86-2"><span class="toc-text">准备虚拟机克隆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E9%9B%86%E7%BE%A4%E5%88%86%E5%8F%91%E9%85%8D%E7%BD%AE"><span class="toc-text">编写集群分发配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#xsync%E9%9B%86%E7%BE%A4%E5%88%86%E5%8F%91%E8%84%9A%E6%9C%AC"><span class="toc-text">xsync集群分发脚本</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE-2"><span class="toc-text">集群配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-text">核心配置文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HDFS%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-text">HDFS配置文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#YARN%E9%85%8D%E7%BD%AE"><span class="toc-text">YARN配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MapReduce%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-text">MapReduce配置文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8%E9%9B%86%E7%BE%A4%E4%B8%8A%E5%88%86%E5%8F%91%E9%85%8D%E7%BD%AE%E5%A5%BD%E7%9A%84Hadoop%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-text">在集群上分发配置好的Hadoop配置文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E7%BE%A4%E5%8D%95%E7%82%B9%E5%90%AF%E5%8A%A8"><span class="toc-text">集群单点启动</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SSh%E6%97%A0%E5%AF%86%E7%99%BB%E5%BD%95%E9%85%8D%E7%BD%AE"><span class="toc-text">SSh无密登录配置</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BE%A4%E8%B5%B7%E9%9B%86%E7%BE%A4"><span class="toc-text">群起集群</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E7%BE%A4%E5%9F%BA%E6%9C%AC%E6%B5%8B%E8%AF%95"><span class="toc-text">集群基本测试</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E7%BE%A4%E5%90%AF%E5%8A%A8-%E5%81%9C%E6%AD%A2%E6%96%B9%E5%BC%8F%E6%80%BB%E7%BB%93"><span class="toc-text">集群启动&#x2F;停止方式总结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E7%BE%A4%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5"><span class="toc-text">集群时间同步</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E6%9C%BA%E5%99%A8%E9%85%8D%E7%BD%AE%EF%BC%88%E5%BF%85%E9%A1%BBroot%EF%BC%89"><span class="toc-text">其他机器配置（必须root）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-BUG%E7%82%B9-2"><span class="toc-text">5. BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%80%BB%E7%BB%93"><span class="toc-text">6.总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-16-HDFS"><span class="toc-text">7.16 HDFS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84-7"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98-7"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-7"><span class="toc-text">3.所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HDFS%E6%A6%82%E8%BF%B0"><span class="toc-text">HDFS概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HDFS%E7%9A%84shell%E6%93%8D%E4%BD%9C"><span class="toc-text">HDFS的shell操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HDFS%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-text">HDFS客户端环境准备</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HDFS%E7%9A%84API%E6%93%8D%E4%BD%9C"><span class="toc-text">HDFS的API操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HDFS%E7%9A%84I-O%E6%B5%81%E6%93%8D%E4%BD%9C"><span class="toc-text">HDFS的I&#x2F;O流操作</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0-5"><span class="toc-text">4.根据概述分章节描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HDFS%E6%A6%82%E8%BF%B0-2"><span class="toc-text">HDFS概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E7%82%B9"><span class="toc-text">优点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9"><span class="toc-text">缺点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HDFS%E7%BB%84%E6%88%90%E6%9E%B6%E6%9E%84"><span class="toc-text">HDFS组成架构</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HDFS%E7%9A%84Shell%E6%93%8D%E4%BD%9C%EF%BC%88%E5%BC%80%E5%8F%91%E9%87%8D%E7%82%B9%EF%BC%89"><span class="toc-text">HDFS的Shell操作（开发重点）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HDFS%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87-2"><span class="toc-text">HDFS客户端环境准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HDFS%E7%9A%84API%E6%93%8D%E4%BD%9C-2"><span class="toc-text">HDFS的API操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-text">文件下载</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HDFS%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4"><span class="toc-text">HDFS文件删除</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HDFS%E6%96%87%E4%BB%B6%E5%90%8D%E6%9B%B4%E6%94%B9"><span class="toc-text">HDFS文件名更改</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HDFS%E6%96%87%E4%BB%B6%E8%AF%A6%E6%83%85%E6%9F%A5%E7%9C%8B"><span class="toc-text">HDFS文件详情查看</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%92%8C%E6%96%87%E4%BB%B6%E5%A4%B9%E5%88%A4%E6%96%AD"><span class="toc-text">文件和文件夹判断</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HDFS%E7%9A%84I-O%E6%B5%81%E6%93%8D%E4%BD%9C-2"><span class="toc-text">HDFS的I&#x2F;O流操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-2"><span class="toc-text">文件下载</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%BD%8D%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-text">定位文件读取</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-BUG%E7%82%B9-3"><span class="toc-text">5. BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%80%BB%E7%BB%93-3"><span class="toc-text">7.总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-18-Scala%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1"><span class="toc-text">7.18 Scala函数式编程 面向对象</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84-8"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98-8"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-8"><span class="toc-text">3.所学内容概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0-6"><span class="toc-text">4.根据概述分章节描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%9F%BA%E7%A1%80"><span class="toc-text">函数基础</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">面向对象编程和函数式编程的区别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-text">函数基本语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E9%AB%98%E7%BA%A7"><span class="toc-text">函数高级</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E4%BD%9C%E4%B8%BA%E5%80%BC%E4%BC%A0%E9%80%92"><span class="toc-text">函数作为值传递</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0"><span class="toc-text">匿名函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E6%9F%AF%E9%87%8C%E5%8C%96%E5%92%8C%E9%97%AD%E5%8C%85"><span class="toc-text">函数柯里化和闭包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%92%E5%BD%92-%E9%98%B6%E4%B9%98"><span class="toc-text">递归 阶乘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E6%8A%BD%E8%B1%A1"><span class="toc-text">控制抽象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%83%B0%E6%80%A7%E5%8A%A0%E8%BD%BD"><span class="toc-text">惰性加载</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0%E9%83%A8%E5%88%86-3"><span class="toc-text">6.扩展学习部分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%80%BB%E7%BB%93-4"><span class="toc-text">7.总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-19-Scala%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1"><span class="toc-text">7.19 Scala面向对象</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84-9"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98-9"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-9"><span class="toc-text">3.所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1"><span class="toc-text">类和对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E8%A3%85"><span class="toc-text">封装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%A7%E6%89%BF%E5%92%8C%E5%A4%9A%E6%80%81"><span class="toc-text">继承和多态</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0-7"><span class="toc-text">4.根据概述分章节描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1-2"><span class="toc-text">类和对象</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%81%E8%A3%85-2"><span class="toc-text">封装</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%99%A8"><span class="toc-text">构造器</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%A7%E6%89%BF%E5%92%8C%E5%A4%9A%E6%80%81-2"><span class="toc-text">继承和多态</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%9A%E6%80%81"><span class="toc-text">多态</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%87%8D%E5%86%99"><span class="toc-text">重写</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%BD%E8%B1%A1%E7%B1%BB"><span class="toc-text">抽象类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%B4%E7%94%9F%E5%AF%B9%E8%B1%A1"><span class="toc-text">伴生对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E8%B4%A8"><span class="toc-text">特质</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-BUG%E7%82%B9-4"><span class="toc-text">5. BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0%E9%83%A8%E5%88%86-4"><span class="toc-text">6.扩展学习部分</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E8%B4%A8%E5%8F%A0%E5%8A%A0"><span class="toc-text">特质叠加</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%80%BB%E7%BB%93-5"><span class="toc-text">7.总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-20-%E6%95%B0%E7%BB%84%E5%92%8C%E9%9B%86%E5%90%88"><span class="toc-text">7.20 数组和集合</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84-10"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98-10"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-10"><span class="toc-text">3.所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Scasla%E9%9B%86%E5%90%88%E7%AE%80%E4%BB%8B"><span class="toc-text">Scasla集合简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E7%BB%84"><span class="toc-text">数组</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%97%E8%A1%A8"><span class="toc-text">列表</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#set%E9%9B%86%E5%90%88"><span class="toc-text">set集合</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Map%E9%9B%86%E5%90%88"><span class="toc-text">Map集合</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%83%E7%BB%84"><span class="toc-text">元组</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0-%E6%96%B9%E6%B3%95"><span class="toc-text">常用函数 方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%98%9F%E5%88%97"><span class="toc-text">队列</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B9%B6%E8%A1%8C%E9%9B%86%E5%90%88"><span class="toc-text">并行集合</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D"><span class="toc-text">模式匹配</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-text">异常处理</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0-8"><span class="toc-text">4.根据概述分章节描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Scala%E9%9B%86%E5%90%88%E7%AE%80%E4%BB%8B"><span class="toc-text">Scala集合简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%BB%84-2"><span class="toc-text">数组</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E5%8F%98%E6%95%B0%E7%BB%84%E5%92%8C%E4%B8%8D%E5%8F%AF%E5%8F%98%E6%95%B0%E7%BB%84%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-text">可变数组和不可变数组的转换</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%97%E8%A1%A8List"><span class="toc-text">列表List</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%8F%AF%E5%8F%98List"><span class="toc-text">不可变List</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E5%8F%98ListBuffer"><span class="toc-text">可变ListBuffer</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Set%E9%9B%86%E5%90%88"><span class="toc-text">Set集合</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mutable-Set%E5%8F%AF%E5%8F%98%E9%9B%86%E5%90%88"><span class="toc-text">mutable.Set可变集合</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Map%E9%9B%86%E5%90%88-2"><span class="toc-text">Map集合</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%8F%AF%E5%8F%98Map"><span class="toc-text">不可变Map</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E5%8F%98Map"><span class="toc-text">可变Map</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%83%E7%BB%84-2"><span class="toc-text">元组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-text">集合常用函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%8D%E7%94%9F%E9%9B%86%E5%90%88"><span class="toc-text">衍生集合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E8%AE%A1%E7%AE%97%E7%AE%80%E5%8D%95%E5%87%BD%E6%95%B0"><span class="toc-text">集合计算简单函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E8%AE%A1%E7%AE%97%E9%AB%98%E7%BA%A7%E5%87%BD%E6%95%B0"><span class="toc-text">集合计算高级函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%9F%E5%88%97-2"><span class="toc-text">队列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B6%E8%A1%8C%E9%9B%86%E5%90%88-2"><span class="toc-text">并行集合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86-2"><span class="toc-text">异常处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D-2"><span class="toc-text">模式匹配</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-BUG%E7%82%B9-5"><span class="toc-text">5.BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0%E9%83%A8%E5%88%86-5"><span class="toc-text">6.扩展学习部分</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%B0%E6%95%B0%E6%8E%92%E5%BA%8F"><span class="toc-text">记数排序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%80%BB%E7%BB%93-6"><span class="toc-text">7.总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-21-Spark%E5%85%A5%E9%97%A8"><span class="toc-text">7.21 Spark入门</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84-11"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98-11"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-11"><span class="toc-text">3.所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Spark%E7%9A%84%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B"><span class="toc-text">Spark的快速上手</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Spark%E5%9C%A8Linux%E7%9A%84%E9%83%A8%E7%BD%B2%E9%85%8D%E7%BD%AE"><span class="toc-text">Spark在Linux的部署配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RDD%E7%AE%80%E4%BB%8B-%E5%92%8C-%E9%80%BB%E8%BE%91%E4%BB%A5%E5%8F%8A%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B-%E5%8E%9F%E7%90%86"><span class="toc-text">RDD简介 和 逻辑以及执行过程 原理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0-9"><span class="toc-text">4.根据概述分章节描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Spark%E7%9A%84%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-2"><span class="toc-text">Spark的快速上手</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#WorldCount%E6%A1%88%E4%BE%8B"><span class="toc-text">WorldCount案例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RDD%E7%AE%80%E4%BB%8B"><span class="toc-text">RDD简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E5%8E%9F%E7%90%86"><span class="toc-text">执行原理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E5%90%AF%E5%8A%A8%E7%8E%AF%E5%A2%83"><span class="toc-text">1.启动环境</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-Spark%E9%80%9A%E8%BF%87%E7%94%B3%E8%AF%B7%E8%B5%84%E6%BA%90%E5%88%9B%E5%BB%BA%E8%8A%82%E7%82%B9"><span class="toc-text">2.Spark通过申请资源创建节点</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E6%A0%B9%E6%8D%AE%E9%9C%80%E6%B1%82%E6%A0%B9%E6%8D%AE%E5%88%86%E5%8C%BA%E5%88%92%E5%88%86%E4%BB%BB%E5%8A%A1"><span class="toc-text">3.根据需求根据分区划分任务</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E8%B0%83%E5%BA%A6%E8%8A%82%E7%82%B9%E5%B0%86%E4%BB%BB%E5%8A%A1%E6%A0%B9%E6%8D%AE%E8%AE%A1%E7%AE%97%E8%8A%82%E7%82%B9%E7%8A%B6%E6%80%81%E5%8F%91%E9%80%81%E5%88%B0%E5%AF%B9%E5%BA%94%E7%9A%84%E8%AE%A1%E7%AE%97%E8%8A%82%E7%82%B9%E8%BF%9B%E8%A1%8C%E8%AE%A1%E7%AE%97"><span class="toc-text">4.调度节点将任务根据计算节点状态发送到对应的计算节点进行计算</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RDD%E5%88%9B%E5%BB%BA"><span class="toc-text">RDD创建</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RDD%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6-%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98"><span class="toc-text">RDD读取文件 路径问题</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-BUG%E7%82%B9-6"><span class="toc-text">5.BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0%E9%83%A8%E5%88%86-6"><span class="toc-text">6.扩展学习部分</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux%E4%B8%ADSpark%E9%83%A8%E7%BD%B2"><span class="toc-text">Linux中Spark部署</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%80%BB%E7%BB%93-7"><span class="toc-text">7.总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-22-Spark-RDD%E8%BD%AC%E6%8D%A2%E7%AE%97%E5%AD%90"><span class="toc-text">7.22 Spark-RDD转换算子</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84-12"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98-12"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-12"><span class="toc-text">3.所学内容概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0-10"><span class="toc-text">4.根据概述分章节描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RDD%E5%8D%95Value%E8%BD%AC%E6%8D%A2%E7%AE%97%E5%AD%90"><span class="toc-text">RDD单Value转换算子</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#map"><span class="toc-text">map</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mapPartitions"><span class="toc-text">mapPartitions</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mapPartitionsWithIndex"><span class="toc-text">mapPartitionsWithIndex</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flatMap"><span class="toc-text">flatMap</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#glom"><span class="toc-text">glom</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#groupBy"><span class="toc-text">groupBy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#filter"><span class="toc-text">filter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sample"><span class="toc-text">sample</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#distinct"><span class="toc-text">distinct</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#coaleses-%E5%8F%AF%E5%A2%9E%E5%A4%A7-%E5%8F%AF%E5%87%8F%E5%B0%8F"><span class="toc-text">coaleses(可增大 可减小)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#repartition"><span class="toc-text">repartition</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#coalesce-%E5%92%8C-repartition-%E5%8C%BA%E5%88%AB"><span class="toc-text">coalesce 和 repartition 区别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sortBy"><span class="toc-text">sortBy</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RDD%E5%8F%8CValue%E8%BD%AC%E6%8D%A2%E7%AE%97%E5%AD%90"><span class="toc-text">RDD双Value转换算子</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-text">集合基本操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#partitionBy"><span class="toc-text">partitionBy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#aggregateByKey"><span class="toc-text">aggregateByKey</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-BUG%E7%82%B9-7"><span class="toc-text">5.BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0%E9%83%A8%E5%88%86-7"><span class="toc-text">6.扩展学习部分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%80%BB%E7%BB%93-8"><span class="toc-text">7.总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-23-Spark-RDD%E5%AE%8C%E7%BB%93"><span class="toc-text">7.23 Spark-RDD完结</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84-13"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98-13"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-13"><span class="toc-text">3.所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%8C%E5%8A%A8%E7%AE%97%E5%AD%90"><span class="toc-text">行动算子</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">序列化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB"><span class="toc-text">依赖关系</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-text">持久化</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0-11"><span class="toc-text">4.根据概述分章节描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RDD%E8%A1%8C%E5%8A%A8%E7%AE%97%E5%AD%90"><span class="toc-text">RDD行动算子</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#reduce"><span class="toc-text">reduce</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#collect"><span class="toc-text">collect</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#aggregate-fold"><span class="toc-text">aggregate &amp; fold</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#countByKey-countByValue"><span class="toc-text">countByKey &amp; countByValue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#save%E7%9B%B8%E5%85%B3%E7%AE%97%E5%AD%90"><span class="toc-text">save相关算子</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#foreach"><span class="toc-text">foreach</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RDD%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">RDD序列化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RDD%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB"><span class="toc-text">RDD依赖关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RDD%E7%9A%84%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-text">RDD的持久化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#checkpoint%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">checkpoint的使用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%8C%BA%E5%99%A8"><span class="toc-text">分区器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%AF%E5%8A%A0%E5%99%A8"><span class="toc-text">累加器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-BUG%E7%82%B9-8"><span class="toc-text">5. BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0%E9%83%A8%E5%88%86-8"><span class="toc-text">6.扩展学习部分</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Kryo-%E5%BA%8F%E5%88%97%E5%8C%96%E6%A1%86%E6%9E%B6"><span class="toc-text">Kryo 序列化框架</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RDD-%E4%BB%BB%E5%8A%A1%E5%88%92%E5%88%86"><span class="toc-text">RDD 任务划分</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%80%BB%E7%BB%93-9"><span class="toc-text">7.总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-24-Spark-SQL"><span class="toc-text">7.24 Spark SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84-14"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98-14"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-14"><span class="toc-text">3.所学内容概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0-12"><span class="toc-text">4.根据概述分章节描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SparkSQL%E6%A6%82%E8%BF%B0"><span class="toc-text">SparkSQL概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SparkSQL-%E7%89%B9%E7%82%B9"><span class="toc-text">SparkSQL 特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DataFrame%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">DataFrame是什么</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SparkSQL%E7%9A%84%E6%A0%B8%E5%BF%83%E7%BC%96%E7%A8%8B"><span class="toc-text">SparkSQL的核心编程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DataFrame"><span class="toc-text">DataFrame</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BADataFrame"><span class="toc-text">创建DataFrame</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E4%BB%8ESpark%E6%95%B0%E6%8D%AE%E6%BA%90%E8%BF%9B%E8%A1%8C%E5%88%9B%E5%BB%BA"><span class="toc-text">1.从Spark数据源进行创建</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E7%94%A8SQL%E8%AF%AD%E6%B3%95"><span class="toc-text">2.用SQL语法</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DSL%E8%AF%AD%E6%B3%95"><span class="toc-text">DSL语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDEA%E5%BC%80%E5%8F%91SparkSQL"><span class="toc-text">IDEA开发SparkSQL</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="toc-text">用户自定义函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#UDAF"><span class="toc-text">UDAF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BDMySQL%E6%95%B0%E6%8D%AE"><span class="toc-text">加载MySQL数据</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-BUG%E7%82%B9-9"><span class="toc-text">5. BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-text"></span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RDD%E3%80%81DataFrame%E3%80%81DataSet-%E4%B8%89%E8%80%85%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-text">RDD、DataFrame、DataSet 三者的关系</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DataSet"><span class="toc-text">DataSet</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%80%BB%E7%BB%93-10"><span class="toc-text">7.总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-27-Hive-%E9%85%8D%E7%BD%AE%E4%BB%A5%E5%8F%8ADDL%E8%AF%AD%E5%8F%A5"><span class="toc-text">7.27 Hive 配置以及DDL语句</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84-15"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98-15"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-15"><span class="toc-text">3.所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-18%E9%85%8D%E7%BD%AEHive%E5%9C%A8Centos7"><span class="toc-text">1-18配置Hive在Centos7</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Hive%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">Hive数据类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DDL%E6%93%8D%E4%BD%9C"><span class="toc-text">DDL操作</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0-13"><span class="toc-text">4.根据概述分章节描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hive%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-2"><span class="toc-text">Hive数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">集合数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DDL%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89"><span class="toc-text">DDL数据定义</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">创建数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">查询数据库</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="toc-text">创建表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%80%BB%E7%BB%93-11"><span class="toc-text">7.总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-28-DML%E6%93%8D%E4%BD%9C"><span class="toc-text">7.28 DML操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84-16"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98-16"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-16"><span class="toc-text">3.所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5"><span class="toc-text">数据导入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BA"><span class="toc-text">数据导出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%EF%BC%81"><span class="toc-text">查询！</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0-14"><span class="toc-text">4.根据概述分章节描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5-2"><span class="toc-text">数据导入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%91%E8%A1%A8%E4%B8%AD%E8%A3%85%E8%BD%BD%E6%95%B0%E6%8D%AE-Load"><span class="toc-text">向表中装载数据(Load)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E5%90%91%E8%A1%A8%E4%B8%AD%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE%EF%BC%88Insert%EF%BC%89"><span class="toc-text">通过查询语句向表中插入数据（Insert）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E4%B8%AD%E5%88%9B%E5%BB%BA%E8%A1%A8%E5%B9%B6%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AEAs-Select"><span class="toc-text">查询语句中创建表并加载数据As Select</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%97%B6%E9%80%9A%E8%BF%87Location%E6%8C%87%E5%AE%9A%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%E8%B7%AF%E5%BE%84"><span class="toc-text">创建表时通过Location指定加载数据路径</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Import-%E6%95%B0%E6%8D%AE%E5%88%B0%E6%8C%87%E5%AE%9A-Hive-%E8%A1%A8%E4%B8%AD"><span class="toc-text">Import 数据到指定 Hive 表中</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BA-2"><span class="toc-text">数据导出</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%86%E6%9F%A5%E8%AF%A2%E7%9A%84%E7%BB%93%E6%9E%9C%E5%AF%BC%E5%87%BA%E5%88%B0%E6%9C%AC%E5%9C%B0"><span class="toc-text">将查询的结果导出到本地</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#hadoop%E5%91%BD%E4%BB%A4%E5%AF%BC%E5%87%BA%E5%88%B0%E6%9C%AC%E5%9C%B0"><span class="toc-text">hadoop命令导出到本地</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hive-Shell-%E5%91%BD%E4%BB%A4%E5%AF%BC%E5%87%BA"><span class="toc-text">Hive Shell 命令导出</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2"><span class="toc-text">基本查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%97%E5%88%AB%E5%90%8D"><span class="toc-text">列别名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%95%B0%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-text">算数运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-text">常用函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Limit-%E8%AF%AD%E5%8F%A5"><span class="toc-text">Limit 语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Where-%E8%AF%AD%E5%8F%A5"><span class="toc-text">Where 语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6%EF%BC%88Between-In-Is-Null%EF%BC%89"><span class="toc-text">比较运算符（Between&#x2F;In&#x2F; Is Null）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Like-%E5%92%8C-RLike"><span class="toc-text">Like 和 RLike</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-And-Or-Not"><span class="toc-text">逻辑运算符(And&#x2F;Or&#x2F;Not)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0"><span class="toc-text">分组函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Group-By%E8%AF%AD%E5%8F%A5"><span class="toc-text">Group By语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hiving%E8%AF%AD%E5%8F%A5"><span class="toc-text">Hiving语句</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%80%BB%E7%BB%93-12"><span class="toc-text">7.总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-29-Join%E8%AF%AD%E5%8F%A5"><span class="toc-text">7.29 Join语句</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84-17"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98-17"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-17"><span class="toc-text">3.所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Join%E8%AF%AD%E5%8F%A5"><span class="toc-text">Join语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E5%A4%9A%E8%A1%A8"><span class="toc-text">查询多表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F"><span class="toc-text">排序</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0-15"><span class="toc-text">4.根据概述分章节描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%89%E5%80%BC%E4%BA%8ESQL-join"><span class="toc-text">等值于SQL join</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A8%E7%9A%84%E5%88%AB%E5%90%8D"><span class="toc-text">表的别名</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%88%E5%B9%B6%E5%91%98%E5%B7%A5%E8%A1%A8%E5%92%8C%E9%83%A8%E9%97%A8%E8%A1%A8"><span class="toc-text">合并员工表和部门表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-Joins"><span class="toc-text">SQL Joins</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5"><span class="toc-text">内连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A6%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-text">左外连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%B3%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-text">右外连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BB%A1%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-text">满外连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A6%E8%BF%9E%E6%8E%A5"><span class="toc-text">左连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-text">外连接</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E5%A4%9A%E8%A1%A8-2"><span class="toc-text">查询多表</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF"><span class="toc-text">笛卡尔积</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F-2"><span class="toc-text">排序</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E6%8E%92%E5%BA%8F%EF%BC%88order-by%EF%BC%89"><span class="toc-text">全局排序（order by）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E4%B8%AA%E5%88%97%E6%8E%92%E5%BA%8F"><span class="toc-text">多个列排序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E5%8C%BA-%EF%BC%88-Distribute-By%EF%BC%89"><span class="toc-text">分区**（**Distribute By）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E5%8C%BA%E8%A1%A8"><span class="toc-text">分区表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-BUG%E7%82%B9-10"><span class="toc-text">5. BUG点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JVM%E6%8A%A5%E9%94%99"><span class="toc-text">JVM报错</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%80%BB%E7%BB%93-13"><span class="toc-text">7.总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-31-%E5%87%BD%E6%95%B0"><span class="toc-text">7.31 函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A4%B4%EF%BC%9A%E6%97%A5%E6%9C%9F%E3%80%81%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E5%87%BA%E5%A4%84-18"><span class="toc-text">1.头：日期、所学内容出处</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%A0%87%E9%A2%98-18"><span class="toc-text">2.标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-18"><span class="toc-text">3.所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E7%B3%BB%E7%BB%9F%E5%87%BD%E6%95%B0"><span class="toc-text">查询系统函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%84%E7%A7%8D%E7%B3%BB%E7%BB%9F%E5%87%BD%E6%95%B0"><span class="toc-text">各种系统函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%8C%E8%BD%AC%E5%88%97-%E5%88%97%E8%BD%AC%E8%A1%8C"><span class="toc-text">行转列 列转行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0"><span class="toc-text">窗口函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A0%B9%E6%8D%AE%E6%A6%82%E8%BF%B0%E5%88%86%E7%AB%A0%E8%8A%82%E6%8F%8F%E8%BF%B0-16"><span class="toc-text">4.根据概述分章节描述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0"><span class="toc-text">系统内置函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0"><span class="toc-text">常用内置函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A9%BA%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%B5%8B%E5%80%BC"><span class="toc-text">空字符串赋值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%8C%E8%BD%AC%E5%88%97"><span class="toc-text">行转列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%97%E8%BD%AC%E8%A1%8C"><span class="toc-text">列转行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0-2"><span class="toc-text">窗口函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E5%9C%A8-2017-%E5%B9%B4-4-%E6%9C%88%E4%BB%BD%E8%B4%AD%E4%B9%B0%E8%BF%87%E7%9A%84%E9%A1%BE%E5%AE%A2%E5%8F%8A%E6%80%BB%E4%BA%BA%E6%95%B0"><span class="toc-text">查询在 2017 年 4 月份购买过的顾客及总人数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E9%A1%BE%E5%AE%A2%E7%9A%84%E8%B4%AD%E4%B9%B0%E6%98%8E%E7%BB%86%E5%8F%8A%E6%9C%88%E8%B4%AD%E4%B9%B0%E6%80%BB%E9%A2%9D"><span class="toc-text">查询顾客的购买明细及月购买总额</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E9%A1%BE%E5%AE%A2%E4%B8%8A%E6%AC%A1%E7%9A%84%E8%B4%AD%E4%B9%B0%E6%97%B6%E9%97%B4%E6%88%96%E8%80%85%E4%B8%8B%E6%AC%A1%E8%B4%AD%E4%B9%B0%E6%97%B6%E9%97%B4"><span class="toc-text">查看顾客上次的购买时间或者下次购买时间</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rank"><span class="toc-text">Rank</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0%E9%83%A8%E5%88%86-9"><span class="toc-text">6.扩展学习部分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%80%BB%E7%BB%93-14"><span class="toc-text">7.总结</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-color: transparent;"><div id="footer-wrap"><div id="ft"><div class="ft-item-1"><div class="t-top"><div class="t-t-l"><p class="ft-t t-l-t">格言🧬</p><div class="bg-ad"><div>再看看那个光点，它就在这里，这是家园，这是我们 —— 你所爱的每一个人，你认识的一个人，你听说过的每一个人，曾经有过的每一个人，都在它上面度过他们的一生✨</div><div class="btn-xz-box"><a class="btn-xz" target="_blank" rel="noopener" href="https://stellarium.org/">点击开启星辰之旅</a></div></div></div><div class="t-t-r"><p class="ft-t t-l-t">猜你想看💡</p><ul class="ft-links"><li><a href="/posts/eec9786.html">魔改指南</a><a href="/box/nav/">网址导航</a></li><li><a href="/social/link/">我的朋友</a><a href="/comments/">留点什么</a></li><li><a href="/personal/about/">关于作者</a><a href="/archives/">文章归档</a></li><li><a href="/categories/">文章分类</a><a href="/tags/">文章标签</a></li><li><a href="/box/Gallery/">我的画廊</a><a href="/personal/bb/">我的唠叨</a></li><li><a href="/site/time/">建设进程</a><a href="/site/census/">网站统计</a></li></ul></div></div></div><div class="ft-item-2"><p class="ft-t">推荐友链⌛</p><div class="ft-img-group"><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div></div></div></div><div class="copyright"><span><b>&copy;2022-2023</b></span><span><b>&nbsp;&nbsp;By U7's Blog🍋</b></span></div><div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" title="博客框架为Hexo_v6.3.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Frame-Hexo-blue.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" title="主题版本Butterfly_v4.3.1"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Theme-Butterfly-6513df.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" title="本站采用多线部署，主线路托管于Vercel"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Hosted-Vercel-brightgreen.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://user.51.la/" style="margin-inline:5px" title="本站数据分析得益于51la技术支持"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Analytics-51la-3db1eb.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=20226665" style="margin-inline:5px" title="本站已加入萌ICP豪华套餐，萌ICP备20226665号"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/萌ICP备-20226665-fe1384.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://bitiful.dogecast.com/buckets" style="margin-inline:5px" title="本网站经Service Worker分流至缤纷云对象存储"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Bucket-缤纷云-9c62da.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://www.netdun.net/" style="margin-inline:5px" title="本站使用网盾星球提供CDN加速与防护"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/CDN-网盾星球-fff2cc.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="本网站源码由Github提供存储仓库"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Source-Github-d021d6.svg" alt=""/></a></p></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><a class="icon-V hidden" onclick="switchNightMode()" title="浅色和深色模式转换"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button><button class="share" type="button" title="右键模式" onclick="changeMouseMode()"><i class="fas fa-mouse"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog right_side"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button class="share" type="button" title="分享链接" onclick="share()"><i class="fas fa-share-nodes"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i><span id="percent">0<span>%</span></span></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>复制</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.baidu.com/s?wd=&quot;+window.getSelection().toString());window.location.reload();"><i class="fa fa-search"></i><span>百度搜索</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());window.location.reload();"><i class="fa fa-link"></i><span>转到链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste()"><i class="fa fa-copy"></i><span>粘贴</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-post"><a class="rightMenu-item" href="#post-comment"><i class="fas fa-comment"></i><span>空降评论</span></a><a class="rightMenu-item" href="javascript:rmf.copyWordsLink()"><i class="fa fa-link"></i><span>复制本文地址</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-to"><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>新窗口打开</span></a><a class="rightMenu-item" id="menu-too" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>转到链接</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>保存图片</span></a><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>在新窗口打开</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制图片链接</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:randomPost()"><i class="fa fa-paper-plane"></i><span>随便逛逛</span></a><a class="rightMenu-item" href="javascript:switchNightMode();"><i class="fa fa-moon"></i><span>昼夜切换</span></a><a class="rightMenu-item" href="/personal/about/"><i class="fa fa-info-circle"></i><span>关于博客</span></a><a class="rightMenu-item" href="javascript:toggleWinbox();"><i class="fas fa-cog"></i><span>美化设置</span></a><a class="rightMenu-item" href="javascript:rmf.fullScreen();"><i class="fas fa-expand"></i><span>切换全屏</span></a><a class="rightMenu-item" href="javascript:window.print();"><i class="fa-solid fa-print"></i><span>打印页面</span></a></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.umd.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script async="async">var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())
setTimeout(function(){preloader.endLoading();}, 5000);
document.getElementById('loading-box').addEventListener('click',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: '',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: '',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.staticfile.org/twikoo/1.6.8/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script src="https://cdn.staticfile.org/jquery/3.6.3/jquery.min.js"></script><script async src="https://cdn1.tianli0.top/npm/vue@2.6.14/dist/vue.min.js"></script><script async src="https://cdn1.tianli0.top/npm/element-ui@2.15.6/lib/index.js"></script><script async src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script><script defer type="text/javascript" src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://cdn1.tianli0.top/gh/nextapps-de/winbox/dist/winbox.bundle.min.js"></script><script async src="//at.alicdn.com/t/c/font_3586335_hsivh70x0fm.js"></script><script async src="//at.alicdn.com/t/c/font_3636804_gr02jmjr3y9.js"></script><script async src="//at.alicdn.com/t/c/font_3612150_kfv55xn3u2g.js"></script><script async src="https://cdn.wpon.cn/2022-sucai/Gold-ingot.js"></script><canvas id="universe"></canvas><canvas id="snow"></canvas><script defer src="/js/fomal.js"></script><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdn1.tianli0.top/npm/js-heo@1.0.12/metingjs/Meting.min.js"></script><script src="https://lib.baomitu.com/pjax/0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show","#web_bg",".js-pjax","#bibi","body > title","#app","#tag-echarts","#posts-echart","#categories-echarts"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --> <script data-pjax>if(document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/工作室月笔记/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍡 U7の月学习笔记 (3)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/大数据训练/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍼 U7の大数据训练笔记 (2)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/前后端项目/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍉 U7の项目笔记 (3)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/工作室月总结/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍨 U7の月总结 (4)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/算法/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍟 U7の算法学习笔记 (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/演示/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍥 U7の案例演示笔记 (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><a class="magnet_link_more"  href="https://u7u7.top/categories/" style="flex:1;text-align: center;margin-bottom: 10px;">查看更多...</a></div></div>';
    console.log('已挂载magnet')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script><style>#catalog_magnet{flex-wrap: wrap;display: flex;width:100%;justify-content:space-between;padding: 10px 10px 0 10px;align-content: flex-start;}.magnet_item{flex-basis: calc(33.333333333333336% - 5px);background: #e9e9e9;margin-bottom: 10px;border-radius: 8px;transition: all 0.2s ease-in-out;}.magnet_item:hover{background: var(--text-bg-hover)}.magnet_link_more{color:#555}.magnet_link{color:black}.magnet_link:hover{color:white}@media screen and (max-width: 600px) {.magnet_item {flex-basis: 100%;}}.magnet_link_context{display:flex;padding: 10px;font-size:16px;transition: all 0.2s ease-in-out;}.magnet_link_context:hover{padding: 10px 20px;}</style>
    <style></style><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/adf5c49.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/test5.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-11</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/adf5c49.html&quot;);" href="javascript:void(0);" alt="">Vue笔记</a><div class="blog-slider__text">SpringBoot项目</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/adf5c49.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/a1e1aa91.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wallhaven-28mkg9_2560x1440.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/a1e1aa91.html&quot;);" href="javascript:void(0);" alt="">瑞吉外卖</a><div class="blog-slider__text">SpringBoot项目</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/a1e1aa91.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/ea7374cf.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wallhaven-6oe337.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/ea7374cf.html&quot;);" href="javascript:void(0);" alt="">瑞吉外卖优化</a><div class="blog-slider__text">缓存优化以及部署</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/ea7374cf.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/dashuju.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wallhaven-pk6y2p.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/dashuju.html&quot;);" href="javascript:void(0);" alt="">GZ-07 综合分析</a><div class="blog-slider__text">大数据7月样题——电商综合分析</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/dashuju.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/suanfa.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wallhaven-jx5xyw.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/suanfa.html&quot;);" href="javascript:void(0);" alt="">算法</a><div class="blog-slider__text">力扣算法刷题</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/suanfa.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wallhaven-o59q2m.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt="">Markdown语法与外挂标签写法汇总</a><div class="blog-slider__text">🥧本文汇总Markdown格式以及外挂标签在网页端的渲染效果，可作为文档进行查询</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('gitZone');
      var item_html = '<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 320px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('已挂载gitcalendar')
      }

    if( document.getElementById('gitZone') && (location.pathname ==='/site/census/'|| '/site/census/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("/api?null",['#d9e0df', '#c6e0dc', '#a8dcd4', '#9adcd2', '#89ded1', '#77e0d0', '#5fdecb', '#47dcc6', '#39dcc3', '#1fdabe', '#00dab9'],'null')
    }
  </script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>