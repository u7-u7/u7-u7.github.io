<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><div id="myscoll"></div><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>å¤§æ•°æ®23å¹´3æœˆç¬”è®° | U7's BlogğŸ‹</title><meta name="keywords" content="æœˆç¬”è®°,Scala,Spark,Hive,SQL,å¤§æ•°æ®,Vue"><meta name="author" content="U7's BlogğŸ‹"><meta name="copyright" content="U7's BlogğŸ‹"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="Sparkå¤§æ•°æ®å¤ä¹ ä»¥åŠVueå­¦ä¹ â€”â€”â€”â€”SparkSQL,DSLé£æ ¼,ä¸ƒæœˆä»»åŠ¡ä¹¦"><meta property="og:type" content="article"><meta property="og:title" content="å¤§æ•°æ®23å¹´3æœˆç¬”è®°"><meta property="og:url" content="https://u7u7.top/posts/23biji03.html"><meta property="og:site_name" content="U7&#39;s BlogğŸ‹"><meta property="og:description" content="Sparkå¤§æ•°æ®å¤ä¹ ä»¥åŠVueå­¦ä¹ â€”â€”â€”â€”SparkSQL,DSLé£æ ¼,ä¸ƒæœˆä»»åŠ¡ä¹¦"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-9mvd9k.webp"><meta property="article:published_time" content="2023-03-31T08:30:25.000Z"><meta property="article:modified_time" content="2023-03-31T13:30:25.000Z"><meta property="article:author" content="U7&#39;s BlogğŸ‹"><meta property="article:tag" content="æœˆç¬”è®°"><meta property="article:tag" content="Scala"><meta property="article:tag" content="Spark"><meta property="article:tag" content="Hive"><meta property="article:tag" content="SQL"><meta property="article:tag" content="å¤§æ•°æ®"><meta property="article:tag" content="Vue"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-9mvd9k.webp"><link rel="shortcut icon" href="/"><link rel="canonical" href="https://u7u7.top/posts/23biji03"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!0,languages:{hits_empty:"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},translate:void 0,noticeOutdate:{limitDay:365,position:"top",messagePrev:"It has been",messageNext:"days since the last update, the content of the article may be outdated."},highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:230},copy:{success:"å¤åˆ¶æˆåŠŸ",error:"å¤åˆ¶é”™è¯¯",noSupport:"æµè§ˆå™¨ä¸æ”¯æŒ"},relativeDate:{homepage:!0,post:!0},runtime:"",date_suffix:{just:"åˆšåˆš",min:"åˆ†é’Ÿå‰",hour:"å°æ—¶å‰",day:"å¤©å‰",month:"ä¸ªæœˆå‰"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.js",css:"https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"å¤§æ•°æ®23å¹´3æœˆç¬”è®°",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-03-31 21:30:25"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const a=864e5*o,n={value:t,expiry:(new Date).getTime()+a};localStorage.setItem(e,JSON.stringify(n))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise(((t,o)=>{const a=document.createElement("script");a.src=e,a.async=!0,a.onerror=o,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)})),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","ffffff")};const t=saveToLocal.get("theme"),o=(new Date).getHours();void 0===t?o<=6||o>=18?activateDarkMode():activateLightMode():"light"===t?activateLightMode():activateDarkMode();const a=saveToLocal.get("aside-status");void 0!==a&&("hide"===a?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="https://cdn1.tianli0.top/npm/element-ui@2.15.6/packages/theme-chalk/lib/index.css"><style id="themeColor"></style><style id="rightSide"></style><style id="transPercent"></style><style id="blurNum"></style><style id="settingStyle"></style><span id="fps"></span><style id="defineBg"></style><style id="menu_shadow"></style><svg aria-hidden="true" style="position:absolute;overflow:hidden;width:0;height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248 626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload='this.media="all"'><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload='this.media="screen"'><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload='this.media="all"'><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="U7's BlogğŸ‹" type="application/atom+xml"></head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/chengguo.jpg" onerror='onerror=null,src="/assets/r1.jpg"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">21</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">6</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-home"></use></svg> <span class="menu_word" style="font-size:17px">é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon--article"></use></svg> <span class="menu_word" style="font-size:17px">æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-guidang1"></use></svg> <span class="menu_word" style="font-size:17px">å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-sekuaibiaoqian"></use></svg> <span class="menu_word" style="font-size:17px">æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-fenlei"></use></svg> <span class="menu_word" style="font-size:17px">åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-pinweishenghuo"></use></svg> <span class="menu_word" style="font-size:17px">ä¼‘é—²</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-yinle"></use></svg> <span class="menu_word" style="font-size:17px">å…«éŸ³ç›’</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-dianying1"></use></svg> <span class="menu_word" style="font-size:17px">å½±é™¢</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-youxishoubing"></use></svg> <span class="menu_word" style="font-size:17px">æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-xiangzi"></use></svg> <span class="menu_word" style="font-size:17px">å…«å®ç®±</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-tubiaozhizuomoban"></use></svg> <span class="menu_word" style="font-size:17px">ç”»å»Š</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-nvwumao"></use></svg> <span class="menu_word" style="font-size:17px">åŠ¨ç”»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-zhifengche"></use></svg> <span class="menu_word" style="font-size:17px">ç½‘å€å¯¼èˆª</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-shejiaoxinxi"></use></svg> <span class="menu_word" style="font-size:17px">ç¤¾äº¤</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-pengyouquan"></use></svg> <span class="menu_word" style="font-size:17px">æœ‹å‹åœˆ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-liuyan"></use></svg> <span class="menu_word" style="font-size:17px">ç•™è¨€æ¿</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-lianjie"></use></svg> <span class="menu_word" style="font-size:17px">å‹äººå¸</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-wangye"></use></svg> <span class="menu_word" style="font-size:17px">ç½‘ç«™</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon--tongjibiao"></use></svg> <span class="menu_word" style="font-size:17px">ç½‘ç«™ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-shujutongji1"></use></svg> <span class="menu_word" style="font-size:17px">æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-xianxingshalou"></use></svg> <span class="menu_word" style="font-size:17px">æ—§æ—¶å…‰</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">U7's BlogğŸ‹</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-home"></use></svg> <span class="menu_word" style="font-size:17px">é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon--article"></use></svg> <span class="menu_word" style="font-size:17px">æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-guidang1"></use></svg> <span class="menu_word" style="font-size:17px">å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-sekuaibiaoqian"></use></svg> <span class="menu_word" style="font-size:17px">æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-fenlei"></use></svg> <span class="menu_word" style="font-size:17px">åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-pinweishenghuo"></use></svg> <span class="menu_word" style="font-size:17px">ä¼‘é—²</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-yinle"></use></svg> <span class="menu_word" style="font-size:17px">å…«éŸ³ç›’</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-dianying1"></use></svg> <span class="menu_word" style="font-size:17px">å½±é™¢</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-youxishoubing"></use></svg> <span class="menu_word" style="font-size:17px">æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-xiangzi"></use></svg> <span class="menu_word" style="font-size:17px">å…«å®ç®±</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-tubiaozhizuomoban"></use></svg> <span class="menu_word" style="font-size:17px">ç”»å»Š</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-nvwumao"></use></svg> <span class="menu_word" style="font-size:17px">åŠ¨ç”»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-zhifengche"></use></svg> <span class="menu_word" style="font-size:17px">ç½‘å€å¯¼èˆª</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-shejiaoxinxi"></use></svg> <span class="menu_word" style="font-size:17px">ç¤¾äº¤</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-pengyouquan"></use></svg> <span class="menu_word" style="font-size:17px">æœ‹å‹åœˆ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-liuyan"></use></svg> <span class="menu_word" style="font-size:17px">ç•™è¨€æ¿</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-lianjie"></use></svg> <span class="menu_word" style="font-size:17px">å‹äººå¸</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-wangye"></use></svg> <span class="menu_word" style="font-size:17px">ç½‘ç«™</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon--tongjibiao"></use></svg> <span class="menu_word" style="font-size:17px">ç½‘ç«™ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-shujutongji1"></use></svg> <span class="menu_word" style="font-size:17px">æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.3em;height:1.3em;vertical-align:-.15em;fill:currentColor;overflow:hidden"><use xlink:href="#icon-xianxingshalou"></use></svg> <span class="menu_word" style="font-size:17px">æ—§æ—¶å…‰</span></a></li></ul></div></div><center id="name-container"><a id="page-name" href="javascript:scrollToTop()">PAGE_NAME</a></center><div id="nav-right"><div id="search-button"><a class="search faa-parent animated-hover" title="æ£€ç´¢ç«™å†…ä»»ä½•ä½ æƒ³è¦çš„ä¿¡æ¯"><svg class="faa-tada icon" style="height:24px;width:24px;fill:currentColor;position:relative;top:6px" aria-hidden="true"><use xlink:href="#icon-valentine_-search-love-find-heart"></use></svg> <span>æœç´¢</span></a></div><a class="meihua faa-parent animated-hover" onclick="toggleWinbox()" title="ç¾åŒ–è®¾ç½®-è‡ªå®šä¹‰ä½ çš„é£æ ¼" id="meihua-button"><svg class="faa-tada icon" style="height:26px;width:26px;fill:currentColor;position:relative;top:8px" aria-hidden="true"><use xlink:href="#icon-tupian1"></use></svg></a><a class="sun_moon faa-parent animated-hover" onclick="switchNightMode()" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢" id="nightmode-button"><svg class="faa-tada" style="height:25px;width:25px;fill:currentColor;position:relative;top:7px" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><div id="toggle-menu"><a><i class="fas fa-bars fa-fw"></i></a></div></div></div></nav><div id="post-info"><h1 class="post-title">å¤§æ•°æ®23å¹´3æœˆç¬”è®°</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><svg class="meta_icon post-meta-icon" style="width:30px;height:30px;position:relative;top:10px"><use xlink:href="#icon-rili"></use></svg><span class="post-meta-label">å‘è¡¨äº</span> <time class="post-meta-date-created" datetime="2023-03-31T08:30:25.000Z" title="å‘è¡¨äº 2023-03-31 16:30:25">2023-03-31</time><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-gengxin1"></use></svg><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-03-31T13:30:25.000Z" title="æ›´æ–°äº 2023-03-31 21:30:25">2023-03-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-biaoqian"></use></svg><a class="post-meta-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E8%AE%AD%E7%BB%83/">å¤§æ•°æ®è®­ç»ƒ</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:8px"><use xlink:href="#icon-charuword"></use></svg><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">1.6w</span><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:20px;height:20px;position:relative;top:5px"><use xlink:href="#icon-shizhong"></use></svg><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>66åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="å¤§æ•°æ®23å¹´3æœˆç¬”è®°"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:5px"><use xlink:href="#icon-eye"></use></svg><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s58 18 88 18 58-18 88-18 58 18 88 18v44h-352Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="DSLä»£ç é£æ ¼ä½¿ç”¨">DSLä»£ç é£æ ¼ä½¿ç”¨</h1><h2 id="å­¦ä¹ æ—¥æœŸ-3-2">å­¦ä¹ æ—¥æœŸ: 3.2</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><p>çœ‹å°ç™½å­¦è‹‘çš„è§£æ³•ï¼Œå‘ç°DSLæ˜¯èƒ½è§£å†³å¾ˆå¤šsqlè¯­å¥ç¹çéœ€è¦å†™å­—æ®µåçš„ä»£ç ã€‚å­¦ä¹ äº†sparkçš„sqlæ–¹æ³•</p><h3 id="sparksqlå¸¸ç”¨æ–¹æ³•">sparksqlå¸¸ç”¨æ–¹æ³•</h3><h4 id="withColumn">withColumn</h4><p>è‡ªå·±ä½¿ç”¨ä¸€èˆ¬åªç”¨åˆ°ä¸¤ç§ç”¨æ³•</p><ul><li>æ·»åŠ åˆ—</li><li>ä¿®æ”¹åˆ—</li></ul><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">withColumn(<span class="string">&quot;åˆ—å&quot;</span>,<span class="string">&quot;æ•°æ®&quot;</span>)</span><br></pre></td></tr></table></figure><p>å¦‚ä¸Šå¦‚æœåˆ—åå­˜åœ¨ï¼Œåˆ™æ˜¯å¯¹è¯¥åˆ—ä¿®æ”¹ã€‚å¦‚æœåˆ—åä¸å­˜åœ¨ï¼Œåˆ™æ˜¯æ·»åŠ æ–°åˆ—</p><h4 id="drop">drop</h4><p>ä½¿ç”¨è¿‡ä¸€æ¬¡ï¼Œåˆ é™¤ä¸€åˆ—</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop(<span class="string">&quot;etl_date&quot;</span>)</span><br></pre></td></tr></table></figure><h4 id="lit">lit</h4><p>åˆ›å»ºä¸€ä¸ªå¸¸é‡åˆ— å¦‚ä¸‹litä»£è¡¨æ•°æ®ä¸ºå¸¸é‡ç»“åˆwithColumnä½¿ç”¨</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">withColumn(<span class="string">&quot;etl_date&quot;</span>,lit(<span class="string">&quot;20230302&quot;</span>))</span><br></pre></td></tr></table></figure><h4 id="col">col</h4><p>colä¸­é€‰ä¸­ä¸ºåˆ—çš„æ•°æ®,å¦‚ä¸‹colå†…çš„å­—æ®µè¡¨ç¤ºè¯¥åˆ— oerate_timeåˆ—</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">withColumn(<span class="string">&quot;operate_time&quot;</span>, coalesce(col(<span class="string">&quot;operate_time&quot;</span>), col(<span class="string">&quot;create_time&quot;</span>)))</span><br></pre></td></tr></table></figure><h4 id="coalesce">coalesce</h4><p>è¯¥å‡½æ•°å’Œmysqlå’Œhiveçš„ç”¨æ³•ä¸€æ ·ï¼Œè¿”å›ç¬¬ä¸€ä¸ªä¸ä¸ºnullçš„å€¼</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">coalesce(col(<span class="string">&quot;operate_time&quot;</span>), col(<span class="string">&quot;create_time&quot;</span>))</span><br><span class="line"><span class="comment">//å¦‚æœoperate_timeä¸ºnull å–create_timeä¸ºå€¼</span></span><br></pre></td></tr></table></figure><h4 id="createOrReplaceTempView">createOrReplaceTempView</h4><p>æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªä¸´æ—¶è¡¨å’Œ<code>with as ä¸´æ—¶è¡¨å</code>å·®ä¸å¤š</p><ul><li>å¦‚æœä¸¤æ¬¡å»ºç«‹çš„ä¸´æ—¶è¡¨åå­—ä¸€æ ·ç¬¬ä¸€æ¬¡çš„ä¼šè¢«ç¬¬äºŒæ¬¡çš„æ•°æ®è¦†ç›–</li></ul><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spark.sql(<span class="string">&quot;select * from ods.user_info&quot;</span>).createOrReplaceTempView(<span class="string">&quot;tempTable&quot;</span>)</span><br></pre></td></tr></table></figure><h4 id="partitionBy">partitionBy</h4><p>è®¾ç½®åˆ†åŒºå­—æ®µ,å¦‚æœè¡¨ä¸­æœ‰è¯¥å­—æ®µè‡ªåŠ¨è®¾ç½®ä¸ºåˆ†åŒº</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">partitionBy(<span class="string">&quot;etl_date&quot;</span>)</span><br></pre></td></tr></table></figure><h4 id="write">write</h4><p>å†™å…¥è¡¨çš„æ–¹æ³•ï¼Œå°†df.wirteå¼€å§‹å†™å…¥è¡¨ï¼Œä¿®æ”¹å‚æ•°å³å¯</p><h4 id="mode">mode</h4><p>ä¿®æ”¹å†™å…¥è¡¨çš„å½¢å¼</p><p>â€œoverwriteâ€ â€œappendâ€</p><h4 id="saveAsTable">saveAsTable</h4><blockquote><p>ä¿å­˜DataFrameæ•°æ®åˆ°æŒ‡å®šhiveè¡¨ä¸­ã€‚åˆ†ä¸¤ç§æƒ…å†µï¼š<code>è¡¨å·²ç»å­˜åœ¨</code>å’Œ<code>è¡¨ä¸å­˜åœ¨</code></p><ol><li><p>å¦‚æœè¡¨ä¸å­˜åœ¨ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ›å»ºè¡¨ç»“æ„ã€‚</p></li><li><p>å¦‚æœè¡¨å·²ç»å­˜åœ¨ï¼Œåˆ™æ­¤å‡½æ•°çš„è¡Œä¸ºå–å†³äºç”±modeå‡½æ•°æŒ‡å®šçš„ä¿å­˜æ¨¡å¼ï¼ˆé»˜è®¤æƒ…å†µä¸‹æŠ›å‡ºå¼‚å¸¸ï¼‰ã€‚<br><code>a.mode=Overwriteæ—¶</code>ï¼Œ</p><ol><li>å½“dataframeçš„schemaä¸å·²å­˜åœ¨çš„schemaä¸ªæ•°ç›¸åŒï¼šDataFrameä¸­çš„åˆ—é¡ºåºä¸éœ€è¦ä¸ç°æœ‰è¡¨çš„åˆ—é¡ºåºç›¸åŒï¼Œä¸insertIntoä¸åŒï¼ŒsaveAsTableå°†ä½¿ç”¨åˆ—åç§°æŸ¥æ‰¾æ­£ç¡®çš„åˆ—ä½ç½®ã€‚ï¼ˆä¸insertIntoåŒºåˆ«ç‚¹ï¼‰</li><li>å½“dataframeçš„schemaä¸å·²å­˜åœ¨çš„schemaä¸ªæ•°ä¸åŒï¼šä¼šæ’‡å¼ƒåŸæœ‰çš„schemaï¼ŒæŒ‰ç…§dataframeçš„schemaé‡æ–°åˆ›å»ºå¹¶æ’å…¥ã€‚</li></ol><p><code>b.mode=Appendæ—¶</code>ï¼Œ</p><ol><li>å½“dataframeçš„schemaä¸å·²å­˜åœ¨çš„schemaä¸ªæ•°ç›¸åŒï¼šDataFrameä¸­çš„åˆ—é¡ºåºä¸éœ€è¦ä¸ç°æœ‰è¡¨çš„åˆ—é¡ºåºç›¸åŒã€‚</li><li>å½“dataframeçš„schemaä¸å·²å­˜åœ¨çš„schemaä¸ªæ•°ä¸åŒï¼šä¼šæŠ¥é”™ã€‚</li></ol></li></ol></blockquote><h4 id="insertInto">insertInto</h4><blockquote><p>ä¿å­˜<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=DataFrame&amp;spm=1001.2101.3001.7020">DataFrame</a>æ•°æ®åˆ°æŒ‡å®šhiveè¡¨ä¸­ï¼Œä½†è¦æ±‚æ»¡è¶³ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p><ol><li>æŒ‡å®šçš„hiveè¡¨æ˜¯å­˜åœ¨çš„;</li><li>DataFrameçš„schemaç»“æ„é¡ºåºä¸æŒ‡å®šHiveè¡¨çš„schemaç»“æ„é¡ºåºæ˜¯ä¸€è‡´çš„ã€‚</li></ol></blockquote><h2 id="æ—¥æ€»ç»“">æ—¥æ€»ç»“</h2><blockquote><p>ä»Šå¤©çœ‹å°ç™½çš„ä¸ƒæœˆæ¸…æ´—ç­”æ¡ˆï¼Œè‡ªå·±è±ç„¶å¼€æœ—äº†ï¼Œå¯ä»¥ä¸å…¨ä½¿ç”¨çº¯sqlå†™æ¸…æ´—çš„ä»£ç äº†ï¼Œä¹‹å‰è‡ªå·±çº¯sqlå†™å®Œä¸ƒæœˆçš„æ¸…æ´—éƒ¨åˆ†ä»£ç é‡æ˜¯ååˆ†å·¨å¤§çš„ï¼Œè€Œä¸”éœ€è¦å†™å­—æ®µï¼Œå­—æ®µåè¿˜è¦ä¸€ä¸€å¯¹é½ï¼Œä¸ç„¶æ— æ³•åŠ å…¥è¡¨ä¸­ï¼Œä»Šå¤©çš„ä»»åŠ¡æŠŠdslé£æ ¼çš„ä»£ç ä¸­æ•°æ®æ¸…æ´—å¸¸ç”¨çš„ä»£ç éƒ½ç†è§£ï¼Œå°±èŠ±äº†ä¸å°‘çš„æ—¶é—´ã€‚æ˜å¤©è‡ªå·±å†™å†™è¯•ã€‚ä¸ƒæœˆçš„æ¸…æ´—çº¯sqlçš„æ— æ³•åœ¨è§„å®šæ—¶é—´å®Œæˆçš„ï¼Œå¿…é¡»ç»“åˆDSLã€‚</p></blockquote><h1 id="ä½¿ç”¨æœ¬åœ°VMé•œåƒ">ä½¿ç”¨æœ¬åœ°VMé•œåƒ</h1><h2 id="å­¦ä¹ æ—¥æœŸ-3-3">å­¦ä¹ æ—¥æœŸ: 3.3</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-2">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><p>å°å¼æœºå®‰è£…VMï¼Œå¹¶å¯¼å…¥é•œåƒï¼Œsshé¡ºåˆ©è¿æ¥</p><h3 id="ä½¿ç”¨asbruä¸­sftp">ä½¿ç”¨asbruä¸­sftp</h3><p>ä½¿ç”¨sftpå¯¼å‡ºæ–‡ä»¶åˆ°æœ¬åœ°ï¼Œget éœ€è¦çš„æ–‡ä»¶ å¯¼å…¥æœ¬åœ°çš„åœ°å€</p><h2 id="BUGç‚¹">BUGç‚¹</h2><p>ä¸€ç›´æŠ¥é”™ï¼Œçœ‹æŠ¥é”™ä¿¡æ¯å¤§è‡´åŸå› æ˜¯æ²¡æœ‰ä¸€ä¸ªä»€ä¹ˆjaråŒ…ï¼Œæœ¬åœ°çš„é•œåƒå¥½åƒä½¿ç”¨çš„å¹¶ä¸æ˜¯mysqlè¿˜æ˜¯org.mariadbåº“ï¼Œä½†æ˜¯æ”¯æŒçš„ä¸Šmysqlï¼Œå°±ä¸å»æåŸç†äº†ï¼ŒæŠŠè¿æ¥jaråŒ…æ”¾å…¥sparkçš„jarsç›®å½•ä¸‹ï¼Œä¿®æ”¹driverä¸ºorg.mariadb.jdbc.Driver,BUGé¡ºåˆ©è§£å†³</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230303142630541.png" alt="image-20230303142630541"></p><h2 id="æ—¥æ€»ç»“-2">æ—¥æ€»ç»“</h2><blockquote><p>ä»Šå¤©å¤§é‡çš„æ—¶é—´åœ¨å®‰è£…æœ¬åœ°è™šæ‹Ÿæœºï¼Œh3cæœåŠ¡å™¨åäº†ï¼Œå°±åªèƒ½åœ¨æœ¬åœ°å®‰è£…äº†ï¼Œä¸Šåˆè£…å¥½äº†è™šæ‹Ÿæœºï¼Œä¸‹åˆä½¿ç”¨çš„æ—¶å€™å‡ºäº†BUGï¼Œå·®ä¸å¤šåˆ°æ™šä¸Šæ‰è§£å†³ï¼Œç„¶åè¿›å»æŠŠç¯å¢ƒå’Œsqlæ–‡ä»¶å¯¼å…¥äº†ä¸€ä¸‹ï¼Œä»Šå¤©çš„ä»»åŠ¡å°±å®Œæˆäº†ï¼Œæœ¬æ¥æƒ³ä»Šå¤©ä½¿ç”¨æ–°æ–¹æ³•åšä¸ƒæœˆçš„æ•°æ®æ¸…æ´—çš„ï¼Œåªèƒ½æ”¾åˆ°æ˜å¤©äº†ã€‚</p></blockquote><h1 id="SQLç»“åˆDSLè¡¨æ¸…æ´—">SQLç»“åˆDSLè¡¨æ¸…æ´—</h1><h2 id="å­¦ä¹ æ—¥æœŸ-3-4">å­¦ä¹ æ—¥æœŸ: 3.4</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-3">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><p>å› ä¸ºå¯¹æ¸…æ´—éƒ¨åˆ†ä¸­userè¡¨æ˜¯æœ€éš¾çš„ï¼Œåé¢çš„è¡¨çš„æ“ä½œæ¨¡ä»¿ç€userå°±èƒ½å†™å®Œæ‰€ä»¥åªæ”¾userè¡¨çš„ä»£ç äº†</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">odsClearUser</span></span>(sparkSession: <span class="type">SparkSession</span>,odsName:<span class="type">String</span>,dwdName:<span class="type">String</span>): <span class="type">Unit</span> =&#123;</span><br><span class="line">  <span class="comment">//åˆ›å»ºdf åŠ å…¥éœ€è¦çš„æ–°çš„å››åˆ— åªå»æ˜¨å¤©çš„æ•°æ®</span></span><br><span class="line">  <span class="keyword">val</span> ods_user_info_df: <span class="type">DataFrame</span> = sparkSession.sql(</span><br><span class="line">    <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">      |select *,</span></span><br><span class="line"><span class="string">      |&#x27;user1&#x27; as dwd_insert_user,date_format(current_timestamp(),&quot;</span>yyyy-<span class="type">MM</span>-dd <span class="type">HH</span>:mm:<span class="string">ss&quot;) as dwd_insert_time,</span></span><br><span class="line"><span class="string">      |&#x27;user1&#x27; as dwd_modify_user,date_format(current_timestamp(),&quot;</span>yyyy-<span class="type">MM</span>-dd <span class="type">HH</span>:mm:<span class="string">ss&quot;) as dwd_modify_time</span></span><br><span class="line"><span class="string">      |from <span class="subst">$odsName</span></span></span><br><span class="line"><span class="string">      |where</span></span><br><span class="line"><span class="string">      |etl_date = <span class="subst">$date</span></span></span><br><span class="line"><span class="string">      |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">    <span class="comment">// å¦‚æœoperate_timeä¸ºnull ä½¿ç”¨create_timeçš„å€¼</span></span><br><span class="line">    .withColumn(<span class="string">&quot;operate_time&quot;</span>, coalesce(col(<span class="string">&quot;operate_time&quot;</span>), col(<span class="string">&quot;create_time&quot;</span>)))</span><br><span class="line">    <span class="comment">//åˆ é™¤åˆ†odsçš„åˆ†åŒºåˆ— å†åŠ å…¥ ç›®çš„æ˜¯ä¸ºäº†å’Œdwdè¡¨åˆå¹¶ å¹¶åŠ ä»¥å¤„ç†</span></span><br><span class="line">    .drop(<span class="string">&quot;etl_date&quot;</span>)</span><br><span class="line">    .withColumn(<span class="string">&quot;etl_date&quot;</span>,lit(date))</span><br><span class="line">  <span class="comment">//å»ºç«‹ä¸´æ—¶è¡¨</span></span><br><span class="line">  ods_user_info_df.createOrReplaceTempView(<span class="string">&quot;ods_data&quot;</span>)</span><br><span class="line">  <span class="comment">//æŸ¥çœ‹è¡¨æ•°æ®</span></span><br><span class="line">  ods_user_info_df.show()</span><br><span class="line">  <span class="comment">//æå–dwdè¡¨åŸæœ‰çš„æ•°æ®å¹¶å»ºç«‹ä¸´æ—¶è¡¨</span></span><br><span class="line">  sparkSession.sql(</span><br><span class="line">    <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">      |select * from $dwdName</span></span><br><span class="line"><span class="string">      |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">    <span class="comment">// å¦‚æœoperate_timeä¸ºnull ä½¿ç”¨create_timeçš„å€¼</span></span><br><span class="line">    .withColumn(<span class="string">&quot;operate_time&quot;</span>, coalesce(col(<span class="string">&quot;operate_time&quot;</span>), col(<span class="string">&quot;create_time&quot;</span>)))</span><br><span class="line">  .createOrReplaceTempView(<span class="string">&quot;dwd_data&quot;</span>)</span><br><span class="line">  <span class="comment">//åˆå¹¶åçš„è¡¨ å»ºç«‹ä¸´æ—¶è¡¨</span></span><br><span class="line">  sparkSession.sql(</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">      |select *</span></span><br><span class="line"><span class="string">      |from ods_data</span></span><br><span class="line"><span class="string">      |union</span></span><br><span class="line"><span class="string">      |select *</span></span><br><span class="line"><span class="string">      |from dwd_data</span></span><br><span class="line"><span class="string">      |&quot;&quot;&quot;</span>.stripMargin).createOrReplaceTempView(<span class="string">&quot;unionTable&quot;</span>)</span><br><span class="line">  <span class="comment">//æ·»åŠ row_numberåˆ— æ ¹æ®operate_timeæ’åº</span></span><br><span class="line">  sparkSession.sql(</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">      |select *,row_number() over(partition by id order by operate_time desc) as _row_number</span></span><br><span class="line"><span class="string">      |from unionTable</span></span><br><span class="line"><span class="string">      |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line">    <span class="comment">//åªå»_row_numberä¸º1çš„</span></span><br><span class="line">    .where(<span class="string">&quot;_row_number=1&quot;</span>)</span><br><span class="line">    <span class="comment">//åˆ é™¤æ’é¡ºåºçš„è¿™åˆ—</span></span><br><span class="line">    .drop(<span class="string">&quot;_row_number&quot;</span>)</span><br><span class="line">    <span class="comment">//ä¿®æ”¹dwd_modify_timeä¸ºå½“å‰æ—¶é—´</span></span><br><span class="line">    <span class="comment">/*TODO ï¼å› ä¸ºåœ¨ç¬¬ä¸€æ­¥å–odsæ•°æ®çš„æ—¶å€™æ·»åŠ çš„dwd_insert_time  dwd_modify_time</span></span><br><span class="line"><span class="comment">        éƒ½æ˜¯å½“å‰æ—¶é—´ æ‰€ä»¥é¢˜ç›®è¦æ±‚çš„dwd_modify_timeéƒ½æ˜¯è¦æœ€æ–°å€¼çš„ç›´æ¥ä¿®æ”¹åˆå¹¶åçš„å°±åˆ°è¾¾äº†é¢˜ç›®è¦æ±‚*/</span></span><br><span class="line">    .withColumn(<span class="string">&quot;dwd_modify_time&quot;</span>, date_format(current_timestamp(), <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>))</span><br><span class="line">    <span class="comment">//å…ˆæ”¾å…¥ä¸´æ—¶è¡¨ é˜²æ­¢dwdè¡¨åˆè¯»å–åˆå†™å…¥çš„æŠ¥é”™</span></span><br><span class="line">    .write.mode(<span class="string">&quot;overwrite&quot;</span>).partitionBy(<span class="string">&quot;etl_date&quot;</span>).saveAsTable(<span class="string">&quot;tempTable&quot;</span>) <span class="comment">//å»ºç«‹ä¸´æ—¶è¡¨</span></span><br><span class="line">  <span class="comment">//å°†ä¸´æ—¶è¡¨çš„å†…å®¹è¦†ç›–å†™å…¥dwdä¸­çš„è¡¨</span></span><br><span class="line">  sparkSession.table(<span class="string">&quot;tempTable&quot;</span>)</span><br><span class="line">    .write.mode(<span class="string">&quot;overwrite&quot;</span>).partitionBy(<span class="string">&quot;etl_date&quot;</span>)</span><br><span class="line">    .saveAsTable(dwdName)</span><br><span class="line">  <span class="comment">//åˆ é™¤ä¸´æ—¶è¡¨</span></span><br><span class="line">  sparkSession.sql(<span class="string">&quot;drop table tempTable&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="BUGç‚¹-2">BUGç‚¹</h2><h3 id="BUG1">BUG1</h3><p>æ— æ³•å°†æ•°æ®å¯¼å…¥è¯¥è¡¨</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/882B269A391DAC0CD10A39ECC347D2D6.jpg" alt="img"></p><blockquote><p>å†™è¿›dwdçš„dim_user_infoçš„æ—¶å€™,å°±ä¼šä¸€ç›´æŠ¥è¿™ä¸ªé”™è¯¯,æˆ‘ç›´æ¥ä»odsæŠ½å–å‰20è¡Œæ•°æ®çš„æ—¶å€™,å†™å…¥æ–¹æ³•ä¹Ÿæ˜¯è¿™æ ·å°±æ˜¯æ­£å¸¸çš„ã€‚ æ‰¾äº†ä¸€ä¸Šåˆçš„åŸå› æ²¡è§£å†³ï¼Œæ²¡åŠæ³•åªèƒ½é—®å°ç™½çš„è€å¸ˆäº†ã€‚åŸå› æ˜¯:è¢«å†™å…¥çš„è¡¨ï¼Œæ­£åœ¨è¢«è¯»å–ï¼Œæ‰€ä»¥ä¸èƒ½å†™å…¥ã€‚å…ˆæŠŠæ•°æ®å†™åˆ°ä¸€ä¸ªä¸­é—´è¡¨ï¼Œå†è¯»å–ä¸­é—´è¡¨å†™å…¥ç›®æ ‡è¡¨ ã€‚è§£å†³åŠæ³•æ˜¯å…ˆç›´æ¥å†™å…¥saveAsTableä¸€ä¸ªä¸´æ—¶è¡¨ï¼Œé€šè¿‡spark.tableè¯»å–è¯¥è¡¨æ•°æ®å¯¼å…¥dwdå±‚çš„è¡¨ä¸­ï¼Œå†åˆ é™¤è¡¨</p></blockquote><h3 id="BUG2">BUG2</h3><p>æ•°æ®å¯¼å…¥æ— æ³•æŸ¥è¯¢ï¼Œä¹‹å‰å°±æœ‰è¿™æ ·çš„æƒ…å†µ ï¼Œå‘ç°é™¤äº†decimalç±»å‹çš„ï¼Œå…¶ä»–éƒ½èƒ½æ­£å¸¸æŸ¥è¯¢ï¼Œæœç´¢ä»¥å è¯´æ˜¯hiveå’Œsparkç±»å‹éœ€è¦ä¸€è‡´æ€§</p><p>è§£å†³åŠæ³•:</p><p>åˆ›å»ºsparkçš„df æ—¶å€™åŠ å…¥é…ç½®</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config(<span class="string">&quot;spark.sql.parquet.writeLegacyFormat&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230304145810981.png" alt="image-20230304145810981"></p><h2 id="æ—¥æ€»ç»“-3">æ—¥æ€»ç»“</h2><blockquote><p>ä»Šå¤©çš„ä»»åŠ¡æ˜¯ä½¿ç”¨DSLç»“åˆSQLé£æ ¼çš„sparkä»£ç ï¼Œå®Œæˆä»»åŠ¡7ä¸­çš„æ•°æ®æ¸…æ´—éƒ¨åˆ†ã€‚å‚è€ƒäº†åˆ«äººçš„æ€è·¯ï¼Œç»“åˆè‡ªå·±çš„æƒ³æ³•å°†ä»£ç ä¼˜åŒ–ï¼Œå†™äº†èƒ½ä½¿ç”¨çš„æ–¹æ³•ï¼Œå°†è¡¨åå°è£…ä¸ºå‚æ•°ï¼Œèƒ½ç›´æ¥ä½¿ç”¨ï¼Œå¦‚æœéœ€è¦çš„å…³é”®å­—ä¸ä¸€æ ·ï¼Œåªè¦å¤åˆ¶æ–¹æ³•ç•¥å¾®ä¿®æ”¹ä¸€ä¸‹å°±å¥½äº†ï¼Œ ä¸Šåˆè§£å†³BUGæµªè´¹äº†å¾ˆå¤šæ—¶é—´ï¼Œåœ¨æ™šä¸Šæ‰å®Œæˆä¸€æ¬¡æˆåŠŸçš„æ¸…æ´—ã€‚</p></blockquote><h1 id="7æœˆä»»åŠ¡1æŒ‡æ ‡è®¡ç®—">7æœˆä»»åŠ¡1æŒ‡æ ‡è®¡ç®—</h1><h2 id="å­¦ä¹ æ—¥æœŸ-3-6">å­¦ä¹ æ—¥æœŸ: 3.6</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-4">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><p>æŒ‡æ ‡è®¡ç®—3é¢˜</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> gz07.real.subject1</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.<span class="type">SparkSession</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">dataMath</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> spark: <span class="type">SparkSession</span> = <span class="type">SparkSession</span>.builder().master(<span class="string">&quot;local[*]&quot;</span>).appName(<span class="string">&quot;subject1Extract&quot;</span>)</span><br><span class="line">      .enableHiveSupport()</span><br><span class="line">      .config(<span class="string">&quot;hive.exec.dynamic.partition&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;hive.exec.dynamic.partition.mode&quot;</span>, <span class="string">&quot;nonstrict&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;spark.sql.parquet.writeLegacyFormat&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .getOrCreate()</span><br><span class="line">    <span class="keyword">import</span> spark.sql</span><br><span class="line">    <span class="comment">//TODO T1</span></span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        |with t1 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |province_id,final_total_amount,</span></span><br><span class="line"><span class="string">        |date_format(operate_time,&#x27;yyyy&#x27;) as year,</span></span><br><span class="line"><span class="string">        |date_format(operate_time,&#x27;MM&#x27;) as month</span></span><br><span class="line"><span class="string">        |from dwd.fact_order_info</span></span><br><span class="line"><span class="string">        |),t2 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |province_id as provinceid,sum(final_total_amount) as totalconsumption,</span></span><br><span class="line"><span class="string">        |count(1) as totalorder,</span></span><br><span class="line"><span class="string">        |year,month</span></span><br><span class="line"><span class="string">        |from t1</span></span><br><span class="line"><span class="string">        |group by province_id,year,month)</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |t2.provinceid,</span></span><br><span class="line"><span class="string">        |bp.name as provincename,</span></span><br><span class="line"><span class="string">        |br.id as regionid,</span></span><br><span class="line"><span class="string">        |br.region_name as regionname,</span></span><br><span class="line"><span class="string">        |totalconsumption,</span></span><br><span class="line"><span class="string">        |totalorder,</span></span><br><span class="line"><span class="string">        |t2.year,</span></span><br><span class="line"><span class="string">        |t2.month</span></span><br><span class="line"><span class="string">        |from t2</span></span><br><span class="line"><span class="string">        |left join dwd.dim_province bp on t2.provinceid = bp.id</span></span><br><span class="line"><span class="string">        |left join dwd.dim_region br on br.id = bp.region_id</span></span><br><span class="line"><span class="string">        |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin).write.mode(<span class="string">&quot;overwrite&quot;</span>)</span><br><span class="line">      .saveAsTable(<span class="string">&quot;dws.provinceeverymonth&quot;</span>)</span><br><span class="line">    <span class="comment">//TODO T2</span></span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |province_id as provinceid,</span></span><br><span class="line"><span class="string">        |dp.name as provincename,</span></span><br><span class="line"><span class="string">        |avg(final_total_amount) as provinceavgconsumption</span></span><br><span class="line"><span class="string">        |from dwd.fact_order_info foi</span></span><br><span class="line"><span class="string">        |left join dwd.dim_province dp on dp.id =  foi.province_id</span></span><br><span class="line"><span class="string">        |group by province_id,dp.name</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin).createOrReplaceTempView(<span class="string">&quot;everyProvince&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> d: java.math.<span class="type">BigDecimal</span> = sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |select avg(provinceavgconsumption)</span></span><br><span class="line"><span class="string">        |from</span></span><br><span class="line"><span class="string">        |everyProvince</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin).first().getDecimal(<span class="number">0</span>)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        |with t1 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |provinceid,</span></span><br><span class="line"><span class="string">        |provincename,</span></span><br><span class="line"><span class="string">        |provinceavgconsumption,</span></span><br><span class="line"><span class="string">        |$d as allprovinceavgconsumption</span></span><br><span class="line"><span class="string">        |from everyProvince)</span></span><br><span class="line"><span class="string">        |select t1.*,</span></span><br><span class="line"><span class="string">        |(case</span></span><br><span class="line"><span class="string">        |         when t1.provinceavgconsumption &gt; t1.allprovinceavgconsumption then &#x27;é«˜&#x27;</span></span><br><span class="line"><span class="string">        |         when t1.provinceavgconsumption = t1.allprovinceavgconsumption then &#x27;ç›¸åŒ&#x27;</span></span><br><span class="line"><span class="string">        |         when t1.provinceavgconsumption &lt; t1.allprovinceavgconsumption then &#x27;ä½&#x27;</span></span><br><span class="line"><span class="string">        |     end) as comparison</span></span><br><span class="line"><span class="string">        |from t1</span></span><br><span class="line"><span class="string">        |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin).write.mode(<span class="string">&quot;overwrite&quot;</span>).saveAsTable(<span class="string">&quot;dws.provinceavgcmp&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO T3</span></span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        |with t1 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |user_id as userid,</span></span><br><span class="line"><span class="string">        |cast(date_format(operate_time,&#x27;yyyyMMdd&#x27;) as int) as day,</span></span><br><span class="line"><span class="string">        |final_total_amount as consumption</span></span><br><span class="line"><span class="string">        |from</span></span><br><span class="line"><span class="string">        |dwd.fact_order_info), t2 as (</span></span><br><span class="line"><span class="string">        |select userid,day,sum(consumption) as totalconsumption,count(1) as totalorder</span></span><br><span class="line"><span class="string">        |from t1</span></span><br><span class="line"><span class="string">        |group by userid,day</span></span><br><span class="line"><span class="string">        |)</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |a.userid,</span></span><br><span class="line"><span class="string">        |dui.name,</span></span><br><span class="line"><span class="string">        |concat(a.day,&#x27;_&#x27;,b.day) as day,</span></span><br><span class="line"><span class="string">        |a.totalconsumption+b.totalconsumption as totalconsumption,</span></span><br><span class="line"><span class="string">        |a.totalorder+b.totalorder as totalorder</span></span><br><span class="line"><span class="string">        |from</span></span><br><span class="line"><span class="string">        |t2 a</span></span><br><span class="line"><span class="string">        |left join dwd.dim_user_info dui on dui.id = a.userid</span></span><br><span class="line"><span class="string">        |left join t2 b on a.userid = b.userid</span></span><br><span class="line"><span class="string">        |where</span></span><br><span class="line"><span class="string">        |a.day + 1=b.day</span></span><br><span class="line"><span class="string">        |and</span></span><br><span class="line"><span class="string">        |a.totalconsumption&lt;b.totalconsumption</span></span><br><span class="line"><span class="string">        |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin).write.mode(<span class="string">&quot;overwrite&quot;</span>)</span><br><span class="line">      .saveAsTable(<span class="string">&quot;dws.usercontinueorder&quot;</span>)</span><br><span class="line"></span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |with t1 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |user_id as userid,</span></span><br><span class="line"><span class="string">        |cast(date_format(operate_time,&#x27;yyyyMMdd&#x27;) as int) as day,</span></span><br><span class="line"><span class="string">        |final_total_amount as consumption</span></span><br><span class="line"><span class="string">        |from</span></span><br><span class="line"><span class="string">        |dwd.fact_order_info)</span></span><br><span class="line"><span class="string">        |select userid,day,sum(consumption) as totalconsumption,count(1) as totalorder</span></span><br><span class="line"><span class="string">        |from t1</span></span><br><span class="line"><span class="string">        |group by userid,day</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line">    spark.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="BUGç‚¹-3">BUGç‚¹</h2><p>BUGæ²¡æœ‰æˆªå›¾,å°±æ˜¯åœ¨ç”¨sparkæäº¤jaråŒ…çš„æ—¶å€™ï¼Œè·‘èµ·æ¥ï¼Œæ²¡æœ‰æŠ¥é”™ï¼Œä½†æ˜¯ä¼šè«åå…¶å¦™çš„è¢«æ€æ­»ã€‚ä¹Ÿæ²¡æ‰¾åˆ°åŸå› ï¼Œæ•´äº†ä¸€ä¸Šåˆæœ‰æ—¶å€™å¥½ï¼Œæœ‰æ—¶å€™å°±ä¸è¡Œã€‚è¯•ç€é‡å¯äº†hadoopå’Œhiveçš„å…ƒæ•°æ®ï¼Œå°±å¾ˆé•¿ä¸€æ®µæ—¶é—´æ²¡æœ‰å†æŠ¥é”™äº†ï¼Œä¼°è®¡æ˜¯sparkä¸­æˆ‘å­˜äº†ä¸´æ—¶è¡¨ï¼Œsparkæ²¡æ€æ­»ï¼Œå¯¼è‡´ç¼“å­˜å¤šäº†ï¼Œè¶…å‡ºå†…å­˜ï¼Œå°±è‡ªåŠ¨æ€æ­»äº†ã€‚</p><h2 id="æ—¥æ€»ç»“-4">æ—¥æ€»ç»“</h2><blockquote><p>ä»Šå¤©çš„ä»»åŠ¡å…¶å®ä¸»è¦æ˜¯ä¸ºäº†ç†Ÿæ‚‰7æœˆä»½çš„è¡¨ç»“æ„ï¼Œæ¯ä¸ªå­—æ®µä»£è¡¨ä»€ä¹ˆï¼Œä»¥åŠå¤šè¡¨è¿æ¥çš„å…¬å…±å­—æ®µï¼Œé€‰æ‹©å»åšäº†æŒ‡æ ‡è®¡ç®—ï¼Œè®¤ä¸ºéš¾åº¦ä¸€èˆ¬ï¼Œ7æœˆä»½çš„è¡¨å…¶å®æ˜¯æ¯”4æœˆå¥½ä¸€ç‚¹çš„ï¼Œè®¢å•è¡¨é‡Œé¢å°±æœ‰çœä»½idï¼Œåœ¨æ±‚çœä»½æˆ–è€…åœ°åŒºçš„è®¢å•é‡‘é¢çš„æ—¶å€™ä¼šæ–¹ä¾¿å¾ˆå¤š,å°±ä¸éœ€è¦åƒ4æœˆä»½ä¸€æ ·ï¼Œè®¢å•è¡¨è¿æ¥userè¡¨å†é€šè¿‡useræ‰¾provinceå’Œregionã€‚æ€»å¾—æ¥è¯´ç†æ¸…æ¥šè¡¨ç»“æ„ï¼ŒæŒ‡æ ‡è®¡ç®—éƒ¨åˆ†è¿˜æ˜¯å¾ˆç®€å•çš„ã€‚</p></blockquote><h1 id="7æœˆä»»åŠ¡3">7æœˆä»»åŠ¡3</h1><h2 id="å­¦ä¹ æ—¥æœŸ-3-7">å­¦ä¹ æ—¥æœŸ: 3.7</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-5">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><p>å®Œæ•´ç‰ˆä¸ƒæœˆä»»åŠ¡ä¹¦ 2å°æ—¶40åˆ†é’Ÿå®Œæˆ</p><h3 id="æŠ½å–">æŠ½å–</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> gz07.real.subject3</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.<span class="type">SparkSession</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.<span class="type">Timestamp</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">dataExtract</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> spark: <span class="type">SparkSession</span> = <span class="type">SparkSession</span>.builder().master(<span class="string">&quot;local[*]&quot;</span>).appName(<span class="string">&quot;t1&quot;</span>)</span><br><span class="line">      .enableHiveSupport()</span><br><span class="line">      .config(<span class="string">&quot;hive.exec.dynamic.partition&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;hive.exec.dynamic.partition.mode&quot;</span>, <span class="string">&quot;nonstrict&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;spark.sql.parquet.writeLegacyFormat&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .getOrCreate()</span><br><span class="line">    <span class="keyword">import</span> spark.sql</span><br><span class="line">    <span class="keyword">val</span> date = <span class="string">&quot;20230306&quot;</span></span><br><span class="line">    <span class="keyword">val</span> maxUserTime: <span class="type">Timestamp</span> = sql(<span class="string">&quot;select greatest(max(create_time),max(operate_time)) from ods.user_info&quot;</span>).first().getTimestamp(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">val</span> maxOrderTime: <span class="type">Timestamp</span> = sql(<span class="string">&quot;select greatest(max(create_time),max(operate_time)) from ods.order_info&quot;</span>).first().getTimestamp(<span class="number">0</span>)</span><br><span class="line">    mysqlTempTable(spark,<span class="string">&quot;user_info&quot;</span>)</span><br><span class="line">    mysqlTempTable(spark,<span class="string">&quot;sku_info&quot;</span>)</span><br><span class="line">    mysqlTempTable(spark,<span class="string">&quot;base_province&quot;</span>)</span><br><span class="line">    mysqlTempTable(spark,<span class="string">&quot;base_region&quot;</span>)</span><br><span class="line">    mysqlTempTable(spark,<span class="string">&quot;order_info&quot;</span>)</span><br><span class="line">    mysqlTempTable(spark,<span class="string">&quot;order_detail&quot;</span>)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        |insert into table ods.user_info partition (etl_date=$date)</span></span><br><span class="line"><span class="string">        |select * from mysql_user_info</span></span><br><span class="line"><span class="string">        |where</span></span><br><span class="line"><span class="string">        |create_time &gt; &#x27;$maxUserTime&#x27; or operate_time &gt; &#x27;$maxUserTime&#x27;</span></span><br><span class="line"><span class="string">        |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        |insert into table ods.sku_info partition (etl_date=$date)</span></span><br><span class="line"><span class="string">        |select * from mysql_sku_info</span></span><br><span class="line"><span class="string">        |where</span></span><br><span class="line"><span class="string">        |create_time &gt;</span></span><br><span class="line"><span class="string">        |(select max(create_time) from ods.sku_info)</span></span><br><span class="line"><span class="string">        |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">         |insert into table ods.base_province partition (etl_date=$date)</span></span><br><span class="line"><span class="string">         |select *,</span></span><br><span class="line"><span class="string">         |current_timestamp()</span></span><br><span class="line"><span class="string">         |from mysql_base_province</span></span><br><span class="line"><span class="string">         |where</span></span><br><span class="line"><span class="string">         |id &gt;</span></span><br><span class="line"><span class="string">         |(select max(id) from ods.base_province)</span></span><br><span class="line"><span class="string">         |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line"></span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">         |insert into table ods.base_region partition (etl_date=$date)</span></span><br><span class="line"><span class="string">         |select *,</span></span><br><span class="line"><span class="string">         |current_timestamp()</span></span><br><span class="line"><span class="string">         |from mysql_base_region</span></span><br><span class="line"><span class="string">         |where</span></span><br><span class="line"><span class="string">         |id &gt;</span></span><br><span class="line"><span class="string">         |(select max(id) from ods.base_region)</span></span><br><span class="line"><span class="string">         |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">         |insert into table ods.order_info partition (etl_date=$date)</span></span><br><span class="line"><span class="string">         |select * from mysql_order_info</span></span><br><span class="line"><span class="string">         |where</span></span><br><span class="line"><span class="string">         |create_time &gt; &#x27;$maxOrderTime&#x27; or operate_time &gt; &#x27;$maxOrderTime&#x27;</span></span><br><span class="line"><span class="string">         |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">         |insert into table ods.order_detail partition (etl_date=$date)</span></span><br><span class="line"><span class="string">         |select * from mysql_order_detail</span></span><br><span class="line"><span class="string">         |where</span></span><br><span class="line"><span class="string">         |create_time &gt;</span></span><br><span class="line"><span class="string">         |(select max(create_time) from ods.order_detail)</span></span><br><span class="line"><span class="string">         |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mysqlTempTable</span></span>(sparkSession: <span class="type">SparkSession</span>,mysqlName:<span class="type">String</span>): <span class="type">Unit</span> = &#123;</span><br><span class="line">      <span class="keyword">val</span> url = <span class="string">&quot;jdbc:mysql://172.16.42.128/dspub?useSSL = false&quot;</span></span><br><span class="line">      <span class="keyword">val</span> driver = <span class="string">&quot;org.mariadb.jdbc.Driver&quot;</span></span><br><span class="line">      <span class="keyword">val</span> user = <span class="string">&quot;root&quot;</span></span><br><span class="line">      <span class="keyword">val</span> password = <span class="string">&quot;admin&quot;</span></span><br><span class="line">      sparkSession.read.format(<span class="string">&quot;jdbc&quot;</span>)</span><br><span class="line">        .option(<span class="string">&quot;url&quot;</span>, url)</span><br><span class="line">        .option(<span class="string">&quot;driver&quot;</span>, driver)</span><br><span class="line">        .option(<span class="string">&quot;user&quot;</span>, user)</span><br><span class="line">        .option(<span class="string">&quot;password&quot;</span>, password)</span><br><span class="line">        .option(<span class="string">&quot;dbtable&quot;</span>, mysqlName).load().createTempView(<span class="string">s&quot;mysql_<span class="subst">$mysqlName</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¸…æ´—">æ¸…æ´—</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> gz07.real.subject3</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.<span class="type">SparkSession</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.functions._</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">dataClear</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> spark: <span class="type">SparkSession</span> = <span class="type">SparkSession</span>.builder().master(<span class="string">&quot;local[*]&quot;</span>).appName(<span class="string">&quot;t2&quot;</span>)</span><br><span class="line">      .enableHiveSupport()</span><br><span class="line">      .config(<span class="string">&quot;hive.exec.dynamic.partition&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;hive.exec.dynamic.partition.mode&quot;</span>, <span class="string">&quot;nonstrict&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;spark.sql.parquet.writeLegacyFormat&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .getOrCreate()</span><br><span class="line">    <span class="keyword">import</span> spark.sql</span><br><span class="line">    <span class="keyword">val</span> date = <span class="string">&quot;20230306&quot;</span></span><br><span class="line">    odsUserClear(spark,<span class="string">&quot;ods.user_info&quot;</span>,<span class="string">&quot;dwd.dim_user_info&quot;</span>)</span><br><span class="line">    odsSkuClear(spark,<span class="string">&quot;ods.sku_info&quot;</span>,<span class="string">&quot;dwd.dim_sku_info&quot;</span>)</span><br><span class="line">    odsSkuClear(spark,<span class="string">&quot;ods.base_province&quot;</span>,<span class="string">&quot;dwd.dim_province&quot;</span>)</span><br><span class="line">    odsSkuClear(spark,<span class="string">&quot;ods.base_region&quot;</span>,<span class="string">&quot;dwd.dim_region&quot;</span>)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        |select *,</span></span><br><span class="line"><span class="string">        |&#x27;user1&#x27; as dwd_insert_user,date_format(current_timestamp(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;) as dwd_insert_time,</span></span><br><span class="line"><span class="string">        |&#x27;user1&#x27; as dwd_modify_user,date_format(current_timestamp(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;) as dwd_modify_time</span></span><br><span class="line"><span class="string">        |from ods.order_info</span></span><br><span class="line"><span class="string">        |where etl_date=$date</span></span><br><span class="line"><span class="string">        |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">      .withColumn(<span class="string">&quot;operate_time&quot;</span>,coalesce(col(<span class="string">&quot;operate_time&quot;</span>),col(<span class="string">&quot;create_time&quot;</span>)))</span><br><span class="line">      .withColumn(<span class="string">&quot;etl_date&quot;</span>,date_format(col(<span class="string">&quot;create_time&quot;</span>),<span class="string">&quot;yyyyMMdd&quot;</span>))</span><br><span class="line">      .write.mode(<span class="string">&quot;overwrite&quot;</span>).partitionBy(<span class="string">&quot;etl_date&quot;</span>).saveAsTable(<span class="string">&quot;dwd.fact_order_info&quot;</span>)</span><br><span class="line"></span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">         |select *,</span></span><br><span class="line"><span class="string">         |&#x27;user1&#x27; as dwd_insert_user,date_format(current_timestamp(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;) as dwd_insert_time,</span></span><br><span class="line"><span class="string">         |&#x27;user1&#x27; as dwd_modify_user,date_format(current_timestamp(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;) as dwd_modify_time</span></span><br><span class="line"><span class="string">         |from ods.order_detail</span></span><br><span class="line"><span class="string">         |where etl_date=$date</span></span><br><span class="line"><span class="string">         |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">      .withColumn(<span class="string">&quot;etl_date&quot;</span>, date_format(col(<span class="string">&quot;create_time&quot;</span>), <span class="string">&quot;yyyyMMdd&quot;</span>))</span><br><span class="line">      .write.mode(<span class="string">&quot;overwrite&quot;</span>).partitionBy(<span class="string">&quot;etl_date&quot;</span>).saveAsTable(<span class="string">&quot;dwd.fact_order_detail&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">odsUserClear</span></span>(sparkSession: <span class="type">SparkSession</span>,odsName:<span class="type">String</span>,dwdName:<span class="type">String</span>): <span class="type">Unit</span> = &#123;</span><br><span class="line">      sparkSession.sql(</span><br><span class="line">        <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">          |select *,</span></span><br><span class="line"><span class="string">          |&#x27;user1&#x27; as dwd_insert_user,date_format(current_timestamp(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;) as dwd_insert_time,</span></span><br><span class="line"><span class="string">          |&#x27;user1&#x27; as dwd_modify_user,date_format(current_timestamp(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;) as dwd_modify_time</span></span><br><span class="line"><span class="string">          |from $odsName</span></span><br><span class="line"><span class="string">          |where etl_date = $date</span></span><br><span class="line"><span class="string">          |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">        .drop(<span class="string">&quot;etl_date&quot;</span>)</span><br><span class="line">        .withColumn(<span class="string">&quot;etl_date&quot;</span>,lit(date))</span><br><span class="line">        .createOrReplaceTempView(<span class="string">&quot;ods_data&quot;</span>)</span><br><span class="line">      sparkSession.sql(</span><br><span class="line">        <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">          |select * from $dwdName</span></span><br><span class="line"><span class="string">          |where etl_date = $date</span></span><br><span class="line"><span class="string">          |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">        .createOrReplaceTempView(<span class="string">&quot;dwd_data&quot;</span>)</span><br><span class="line">      sparkSession.sql(</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">          |select * from ods_data</span></span><br><span class="line"><span class="string">          |union</span></span><br><span class="line"><span class="string">          |select * from dwd_data</span></span><br><span class="line"><span class="string">          |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line">        .withColumn(<span class="string">&quot;operate_time&quot;</span>,coalesce(col(<span class="string">&quot;operate_time&quot;</span>),col(<span class="string">&quot;create_time&quot;</span>)))</span><br><span class="line">        .createOrReplaceTempView(<span class="string">&quot;union_data&quot;</span>)</span><br><span class="line">      sparkSession.sql(</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">          |select *,row_number() over(partition by id order by operate_time desc) as time_rank</span></span><br><span class="line"><span class="string">          |from union_data</span></span><br><span class="line"><span class="string">          |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line">        .where(<span class="string">&quot;time_rank=1&quot;</span>)</span><br><span class="line">        .drop(<span class="string">&quot;time_rank&quot;</span>)</span><br><span class="line">        .withColumn(<span class="string">&quot;dwd_modify_time&quot;</span>,date_format(current_timestamp(),<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>))</span><br><span class="line">        .write.mode(<span class="string">&quot;overwrite&quot;</span>).partitionBy(<span class="string">&quot;etl_date&quot;</span>).saveAsTable(<span class="string">&quot;temptable&quot;</span>)</span><br><span class="line">      sparkSession.table(<span class="string">&quot;temptable&quot;</span>)</span><br><span class="line">        .write.mode(<span class="string">&quot;overwrite&quot;</span>).partitionBy(<span class="string">&quot;etl_date&quot;</span>)</span><br><span class="line">        .saveAsTable(dwdName)</span><br><span class="line">      sparkSession.sql(<span class="string">&quot;drop table temptable&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">odsSkuClear</span></span>(sparkSession: <span class="type">SparkSession</span>, odsName: <span class="type">String</span>, dwdName: <span class="type">String</span>): <span class="type">Unit</span> = &#123;</span><br><span class="line">      sparkSession.sql(</span><br><span class="line">        <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">           |select *,</span></span><br><span class="line"><span class="string">           |&#x27;user1&#x27; as dwd_insert_user,date_format(current_timestamp(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;) as dwd_insert_time,</span></span><br><span class="line"><span class="string">           |&#x27;user1&#x27; as dwd_modify_user,date_format(current_timestamp(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;) as dwd_modify_time</span></span><br><span class="line"><span class="string">           |from $odsName</span></span><br><span class="line"><span class="string">           |where etl_date = $date</span></span><br><span class="line"><span class="string">           |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">        .drop(<span class="string">&quot;etl_date&quot;</span>)</span><br><span class="line">        .withColumn(<span class="string">&quot;etl_date&quot;</span>, lit(date))</span><br><span class="line">        .createOrReplaceTempView(<span class="string">&quot;ods_data&quot;</span>)</span><br><span class="line">      sparkSession.sql(</span><br><span class="line">        <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">           |select * from $dwdName</span></span><br><span class="line"><span class="string">           |where etl_date = $date</span></span><br><span class="line"><span class="string">           |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">        .createOrReplaceTempView(<span class="string">&quot;dwd_data&quot;</span>)</span><br><span class="line">      sparkSession.sql(</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">          |select * from ods_data</span></span><br><span class="line"><span class="string">          |union</span></span><br><span class="line"><span class="string">          |select * from dwd_data</span></span><br><span class="line"><span class="string">          |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line">        .createOrReplaceTempView(<span class="string">&quot;union_data&quot;</span>)</span><br><span class="line">      sparkSession.sql(</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">          |select *,row_number() over(partition by id order by create_time desc) as time_rank</span></span><br><span class="line"><span class="string">          |from union_data</span></span><br><span class="line"><span class="string">          |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line">        .where(<span class="string">&quot;time_rank=1&quot;</span>)</span><br><span class="line">        .drop(<span class="string">&quot;time_rank&quot;</span>)</span><br><span class="line">        .withColumn(<span class="string">&quot;dwd_modify_time&quot;</span>, date_format(current_timestamp(), <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>))</span><br><span class="line">        .write.mode(<span class="string">&quot;overwrite&quot;</span>).partitionBy(<span class="string">&quot;etl_date&quot;</span>).saveAsTable(<span class="string">&quot;temptable&quot;</span>)</span><br><span class="line">      sparkSession.table(<span class="string">&quot;temptable&quot;</span>)</span><br><span class="line">        .write.mode(<span class="string">&quot;overwrite&quot;</span>).partitionBy(<span class="string">&quot;etl_date&quot;</span>)</span><br><span class="line">        .saveAsTable(dwdName)</span><br><span class="line">      sparkSession.sql(<span class="string">&quot;drop table temptable&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æŒ‡æ ‡è®¡ç®—">æŒ‡æ ‡è®¡ç®—</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> gz07.real.subject3</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.&#123;<span class="type">DataFrame</span>, <span class="type">SparkSession</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">dataMath</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> spark: <span class="type">SparkSession</span> = <span class="type">SparkSession</span>.builder().master(<span class="string">&quot;local[*]&quot;</span>).appName(<span class="string">&quot;t3&quot;</span>)</span><br><span class="line">      .enableHiveSupport()</span><br><span class="line">      .config(<span class="string">&quot;hive.exec.dynamic.partition&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;hive.exec.dynamic.partition.mode&quot;</span>, <span class="string">&quot;nonstrict&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;spark.sql.parquet.writeLegacyFormat&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .getOrCreate()</span><br><span class="line">    <span class="keyword">import</span> spark.sql</span><br><span class="line">    <span class="keyword">val</span> t1: <span class="type">DataFrame</span> = sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |with t1 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |province_id,</span></span><br><span class="line"><span class="string">        |final_total_amount,</span></span><br><span class="line"><span class="string">        |substring(etl_date,1,4) as year,</span></span><br><span class="line"><span class="string">        |substring(etl_date,5,2) as month</span></span><br><span class="line"><span class="string">        |from dwd.fact_order_info foi), t2 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |province_id,</span></span><br><span class="line"><span class="string">        |sum(final_total_amount) as total_amount,</span></span><br><span class="line"><span class="string">        |count(1) as total_count,</span></span><br><span class="line"><span class="string">        |year,</span></span><br><span class="line"><span class="string">        |month</span></span><br><span class="line"><span class="string">        |from t1</span></span><br><span class="line"><span class="string">        |group by province_id,year,month)</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |province_id,</span></span><br><span class="line"><span class="string">        |dp.name as province_name,</span></span><br><span class="line"><span class="string">        |dr.id as region_id,</span></span><br><span class="line"><span class="string">        |dr.region_name as region_name,</span></span><br><span class="line"><span class="string">        |total_amount,</span></span><br><span class="line"><span class="string">        |total_count,</span></span><br><span class="line"><span class="string">        |row_number() over(partition by year,month,dr.id order by total_amount desc) as sequence,</span></span><br><span class="line"><span class="string">        |year,month</span></span><br><span class="line"><span class="string">        |from t2</span></span><br><span class="line"><span class="string">        |left join dwd.dim_province dp on dp.id = t2.province_id</span></span><br><span class="line"><span class="string">        |left join dwd.dim_region dr on dr.id = dp.region_id</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line">    t1.show()</span><br><span class="line">    t1.write.mode(<span class="string">&quot;overwrite&quot;</span>)</span><br><span class="line">      .saveAsTable(<span class="string">&quot;dws.province_consumption_day_aggr&quot;</span>)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |with t1 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |region_id,</span></span><br><span class="line"><span class="string">        |sum(total_amount)/sum(total_count) as regionavgconsumption</span></span><br><span class="line"><span class="string">        |from dws.province_consumption_day_aggr</span></span><br><span class="line"><span class="string">        |group by region_id), t2 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |province_id as provinceid,</span></span><br><span class="line"><span class="string">        |province_name as provincename,</span></span><br><span class="line"><span class="string">        |total_amount/total_count as provinceavgconsumption,</span></span><br><span class="line"><span class="string">        |t1.region_id as regionid,</span></span><br><span class="line"><span class="string">        |region_name as regionname,</span></span><br><span class="line"><span class="string">        |t1.regionavgconsumption as regionavgconsumption</span></span><br><span class="line"><span class="string">        |from dws.province_consumption_day_aggr pcda</span></span><br><span class="line"><span class="string">        |left join t1 on pcda.region_id = t1.region_id)</span></span><br><span class="line"><span class="string">        |select t2.*,</span></span><br><span class="line"><span class="string">        |case</span></span><br><span class="line"><span class="string">        |   when provinceavgconsumption&gt;regionavgconsumption then &#x27;é«˜&#x27;</span></span><br><span class="line"><span class="string">        |   when provinceavgconsumption=regionavgconsumption then &#x27;ç›¸åŒ&#x27;</span></span><br><span class="line"><span class="string">        |   when provinceavgconsumption&lt;regionavgconsumption then &#x27;ä½&#x27; end</span></span><br><span class="line"><span class="string">        |from t2</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin).createOrReplaceTempView(<span class="string">&quot;t2TableTemp&quot;</span>)</span><br><span class="line">    mysqlTempTable(spark,<span class="string">&quot;provinceavgcmpregion&quot;</span>)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |insert overwrite table mysql_provinceavgcmpregion</span></span><br><span class="line"><span class="string">        |select * from t2TableTemp</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line"></span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |region_id,</span></span><br><span class="line"><span class="string">        |region_name,</span></span><br><span class="line"><span class="string">        |province_id,</span></span><br><span class="line"><span class="string">        |province_name,</span></span><br><span class="line"><span class="string">        |total_amount,</span></span><br><span class="line"><span class="string">        |row_number() over(partition by region_id order by total_amount desc) as threeprovince</span></span><br><span class="line"><span class="string">        |from dws.province_consumption_day_aggr</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin).where(<span class="string">&quot;threeprovince&lt;=3&quot;</span>).drop(<span class="string">&quot;threeprovince&quot;</span>).createOrReplaceTempView(<span class="string">&quot;t3Temp&quot;</span>)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |region_id,</span></span><br><span class="line"><span class="string">        |region_name,</span></span><br><span class="line"><span class="string">        |concat_ws(&#x27;,&#x27;,collect_set(cast(province_id as string))) as provinceids,</span></span><br><span class="line"><span class="string">        |concat_ws(&#x27;,&#x27;,collect_set(province_name)) as provincenames,</span></span><br><span class="line"><span class="string">        |concat_ws(&#x27;,&#x27;,collect_set(cast(total_amount as string))) as provinceamount</span></span><br><span class="line"><span class="string">        |from</span></span><br><span class="line"><span class="string">        |t3Temp</span></span><br><span class="line"><span class="string">        |group by region_id,region_name</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin).createOrReplaceTempView(<span class="string">&quot;t333&quot;</span>)</span><br><span class="line">    mysqlTempTable(spark,<span class="string">&quot;regiontopthree&quot;</span>)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |insert overwrite table mysql_regiontopthree</span></span><br><span class="line"><span class="string">        |select * from t333</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mysqlTempTable</span></span>(sparkSession: <span class="type">SparkSession</span>, mysqlName: <span class="type">String</span>): <span class="type">Unit</span> = &#123;</span><br><span class="line">      <span class="keyword">val</span> url = <span class="string">&quot;jdbc:mysql://172.16.42.128/shtd_result?useSSL = false&quot;</span></span><br><span class="line">      <span class="keyword">val</span> driver = <span class="string">&quot;org.mariadb.jdbc.Driver&quot;</span></span><br><span class="line">      <span class="keyword">val</span> user = <span class="string">&quot;root&quot;</span></span><br><span class="line">      <span class="keyword">val</span> password = <span class="string">&quot;admin&quot;</span></span><br><span class="line">      sparkSession.read.format(<span class="string">&quot;jdbc&quot;</span>)</span><br><span class="line">        .option(<span class="string">&quot;url&quot;</span>, url)</span><br><span class="line">        .option(<span class="string">&quot;driver&quot;</span>, driver)</span><br><span class="line">        .option(<span class="string">&quot;user&quot;</span>, user)</span><br><span class="line">        .option(<span class="string">&quot;password&quot;</span>, password)</span><br><span class="line">        .option(<span class="string">&quot;dbtable&quot;</span>, mysqlName).load().createTempView(<span class="string">s&quot;mysql_<span class="subst">$mysqlName</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="BUGç‚¹-4">BUGç‚¹</h2><p>æŒ‡æ ‡è®¡ç®—æœ€åä¸€é¢˜çš„æ—¶å€™ï¼Œæ˜¯ä¹‹å‰æ²¡æ€ä¹ˆåšè¿‡çš„ç±»å‹ï¼Œæ˜¯åˆ—è½¬è¡Œï¼Œæƒ³èµ·æ¥äº†collect_setå’Œconcat_wsä¸¤ä¸ªæ–¹æ³•èƒ½å®ç°ä»»åŠ¡ç›®æ ‡ï¼Œä½†æ˜¯æŠ¥é”™äº†ï¼Œçœ‹æŠ¥é”™ä¿¡æ¯ï¼Œæ˜ç™½äº†ä¼¼ä¹æ˜¯province_idçš„ç±»å‹ä¸å¯¹éœ€è¦æ˜¯array<string>æˆ–è€…æ˜¯stringï¼Œå°±å»ç”¨cast (xxx as string)è½¬æ¢æˆstringå†æ”¾è¿›å»ï¼Œé—®é¢˜è§£å†³ã€‚</string></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230307184042519.png" alt="image-20230307184042519"></p><h2 id="æ‰©å±•å­¦ä¹ ">æ‰©å±•å­¦ä¹ </h2><p>æƒ³å¾—åˆ°è¿™æ ·çš„è¡¨</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230307191546184.png" alt="image-20230307191546184"></p><p>å¤šè¡Œå˜ä¸€è¡Œ æœ‰å…¬å…±åˆ—</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDA4MDQ0NQ==,size_16,color_FFFFFF,t_70.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>1).å…ˆä½¿ç”¨collect_setå‡½æ•°ä½¿å¤šè¡Œæˆä¸ºä¸€è¡Œæ•°ç»„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select name,collect_set(subject)  res1 ,</span><br><span class="line">    &gt; collect_set(cast(score as string)) res2 </span><br><span class="line">    &gt; from stu group by name;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/202106191527505.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>2). åŠ ä¸Šconcat_wså‡½æ•°å¯ä»¥å–å‡ºæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ çš„å€¼åœ¨ç”¨åˆ†éš”ç¬¦è¿æ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select name,concat_ws(&#x27;@&#x27;,collect_set(subject))  res1 ,</span><br><span class="line">    &gt; concat_ws(&#x27;-&#x27;,collect_set(cast(score as string))) res2 </span><br><span class="line">    &gt; from stu group by name;</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/20210619152910469.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hive&gt;select substr(&#x27;qwertyuio&#x27;,0,4)</span><br><span class="line">--qwerã€</span><br><span class="line">å¯¹å­—ç¬¦ä¸²çš„ </span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä»å“ªä¸ªä½ç½®å¼€å§‹</span><br><span class="line">ç¬¬äºŒä¸ªå‚æ•°æ˜¯å–å‡ ä½æ•° </span><br></pre></td></tr></table></figure><h2 id="æ—¥æ€»ç»“-5">æ—¥æ€»ç»“</h2><blockquote><p>ä»Šå¤©åšé¢˜çš„çŠ¶æ€æä½³ï¼Œåº”è¯¥æ˜¯å‰å‡ å¤©éƒ½åœ¨ç ”ç©¶ä¸ƒæœˆä»»åŠ¡7ï¼Œå› æ­¤å‰é¢çš„æŠ½å–å’Œæ¸…æ´—åªèŠ±äº†å¤§æ¦‚1å°æ—¶20åˆ†é’Ÿï¼Œå‰©ä¸‹æ—¶é—´åœ¨åšæŒ‡æ ‡è®¡ç®—ï¼ŒæŒ‡æ ‡è®¡ç®—å·²ç»ç†Ÿæ‚‰è¡¨ç»“æ„äº†è€Œä¸”è¿æ¥çš„è¡¨ä¸æ˜¯å¾ˆå¤šå°±ä¸€ä¸¤ä¸ªï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºéš¾åº¦ä¸€èˆ¬ï¼Œæœ€åä¸€é¢˜åªæ˜¯åˆšå¼€å§‹è¢«å“åˆ°äº†ï¼Œå…¶å®åªè¦ä½¿ç”¨ä¸¤ä¸ªå‡½æ•°å†ç»“åˆåˆ†ç»„å°±èƒ½å¾ˆé¡ºåˆ©çš„è§£å†³ï¼Œæ•´ä½“åšä¸‹æ¥ï¼Œå°†è¿‘å¿«3ä¸ªå°æ—¶äº†ï¼Œè¿˜æ˜¯æ¯”å››æœˆä»½éš¾å¾ˆå¤šçš„ã€‚è¿‡ç¨‹ä¸­ä¹Ÿæ˜¯å‡ºç°äº†å‡ æ¬¡å°é”™è¯¯ï¼Œä¹Ÿæ²¡æµªè´¹å¤šå°‘æ—¶é—´åœ¨ä¿®æ”¹ä¸Šã€‚</p></blockquote><h1 id="7æœˆä»»åŠ¡4-æŒ‡æ ‡è®¡ç®—">7æœˆä»»åŠ¡4 æŒ‡æ ‡è®¡ç®—</h1><h2 id="å­¦ä¹ æ—¥æœŸ-3-9">å­¦ä¹ æ—¥æœŸ: 3.9</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-6">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><p>å…¶ä»–å‡ é¢˜æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œåœ¨ç¬¬äºŒé¢˜çš„æ—¶å€™çŠ¯äº†éš¾ã€‚</p><h3 id="t1">t1</h3><p>ç®€å•çš„è¡¨è¿æ¥å’Œåˆ†ç»„ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//TODO t1</span></span><br><span class="line">sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |with t1 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |final_total_amount,</span></span><br><span class="line"><span class="string">    |province_id,</span></span><br><span class="line"><span class="string">    |substring(etl_date,4,0) as year,</span></span><br><span class="line"><span class="string">    |substring(etl_date,5,2) as month</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |dwd.fact_order_info),</span></span><br><span class="line"><span class="string">    |t2 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |province_id,</span></span><br><span class="line"><span class="string">    |sum(t1.final_total_amount) as total_amount,</span></span><br><span class="line"><span class="string">    |count(1) as total_count,</span></span><br><span class="line"><span class="string">    |year,month</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t1</span></span><br><span class="line"><span class="string">    |group by province_id,year,month)</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |t2.province_id as province_id,</span></span><br><span class="line"><span class="string">    |dp.name as province_name,</span></span><br><span class="line"><span class="string">    |dr.id  as region_id,</span></span><br><span class="line"><span class="string">    |dr.region_name as region_name,</span></span><br><span class="line"><span class="string">    |t2.total_amount,</span></span><br><span class="line"><span class="string">    |t2.total_count,</span></span><br><span class="line"><span class="string">    |row_number() over(partition by year,month,region_id order by total_amount desc) as sequence,</span></span><br><span class="line"><span class="string">    |year,month</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t2</span></span><br><span class="line"><span class="string">    |left join dwd.dim_province dp on dp.id = t2.province_id</span></span><br><span class="line"><span class="string">    |left join dwd.dim_region dr on dr.id = dp.region_id</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin).write.mode(<span class="string">&quot;overwrite&quot;</span>)</span><br><span class="line">  .saveAsTable(<span class="string">&quot;dws.province_consumption_day_aggr&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="t2">t2</h3><p>ä»»åŠ¡å¦‚ä¸‹</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230313082722921.png" alt="image-20230313082722921"></p><blockquote><p>æœ€å¼€å§‹çš„æƒ³æ³•æ˜¯å°†é”€å”®é‡å’Œé”€å”®é¢å‰åçš„è¡¨éƒ½å…ˆæŸ¥æ‰¾å‡ºæ¥ï¼Œç„¶åç»“åˆï¼Œç»“åˆä»¥åæ’åºå³å¯ã€‚</p></blockquote><ul><li>ç»“æœå¦‚ä¸‹ï¼Œæ²¡æœ‰è¾¾åˆ°è‡ªå·±çš„è¦æ±‚ï¼Œä¸æ˜¯ç›´æ¥åˆå¹¶ï¼Œè€Œæ˜¯å‡ºç°äº†ç¬›å¡å°”ç§¯ï¼Œé”€å”®é‡è¡¨å’Œé”€å”®é¢è¡¨çš„æ•°æ®æ˜¯ç›´æ¥ç›¸ä¹˜äº†ã€‚</li></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230313082922761.png" alt="image-20230313082922761"></p><ul><li>åˆæƒ³åˆ°ä¸€ç§æ–¹æ³•ï¼Œå°†ä¸¤ä¸ªè¡¨éƒ½å¤šå‡ºä¸€è¡Œæ ¹æ® å„è‡ªéœ€è¦é™åºæ’åºçš„æ•°æ®ï¼Œåˆ—å‡ºæ’åï¼Œæ ¹æ®æ’åè¿›è¡Œjoinï¼Œè¿™æ ·å°±èƒ½è¾¾åˆ°ä¸¤ä¸ªè¡¨çš„è¿æ¥ï¼Œç„¶åä½¿ç”¨dropåˆ é™¤å·¦è¾¹çš„æ’åºä¿¡æ¯ã€‚å®ç°ä»£ç å¦‚ä¸‹</li></ul><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//TODO t2</span></span><br><span class="line">sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |with t1 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |sku_id,sku_name,order_price,cast(sum(sku_num) as int) as skuSum,</span></span><br><span class="line"><span class="string">    |cast(sum(sku_num)*order_price as int) as skuOrderSum</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |dwd.fact_order_detail</span></span><br><span class="line"><span class="string">    |group by sku_id,sku_name,order_price),</span></span><br><span class="line"><span class="string">    |t2 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |t1.sku_id as topquantityid,</span></span><br><span class="line"><span class="string">    |t1.sku_name as topquantityname,</span></span><br><span class="line"><span class="string">    |t1.skuSum as topquantity,</span></span><br><span class="line"><span class="string">    |row_number() over(order by t1.skuSum desc,t1.sku_id) as topTenQuantity</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t1</span></span><br><span class="line"><span class="string">    |limit 10),</span></span><br><span class="line"><span class="string">    |t3 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |t1.sku_id as toppriceid,</span></span><br><span class="line"><span class="string">    |t1.sku_name as toppricename,</span></span><br><span class="line"><span class="string">    |t1.skuOrderSum as topprice,</span></span><br><span class="line"><span class="string">    |row_number() over(order by t1.skuOrderSum desc) as sequence</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t1</span></span><br><span class="line"><span class="string">    |limit 10)</span></span><br><span class="line"><span class="string">    |select topquantityid,</span></span><br><span class="line"><span class="string">    |topquantityname,</span></span><br><span class="line"><span class="string">    |topquantity,</span></span><br><span class="line"><span class="string">    |t3.*</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t2</span></span><br><span class="line"><span class="string">    |left join t3 on t2.topTenQuantity=t3.sequence</span></span><br><span class="line"><span class="string">    |order by t3.sequence</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin).createOrReplaceTempView(<span class="string">&quot;t2&quot;</span>)</span><br><span class="line">mysqlTempTable(spark,<span class="string">&quot;topten&quot;</span>)</span><br><span class="line">sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |insert overwrite table mysql_topten</span></span><br><span class="line"><span class="string">    |select * from t2</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin)</span><br></pre></td></tr></table></figure><blockquote><p>åŠ å…¥MySQLè¡¨ ä»¥åŠå®Œæˆä»»åŠ¡</p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230313091804187.png" alt="image-20230313091804187"></p><p>###t3</p><p>è¿™ä¸ªæ˜¯è¦æ±‚æ±‚ä¸­ä½æ•°çš„ä¹‹å‰æ²¡æœ‰ä½¿ç”¨è¿‡ï¼Œä½†æ˜¯é¢˜ç›®æä¾›äº†å‡½æ•°æ–¹æ³•ã€‚</p><blockquote><p>percentile(col,doule) è¯¥æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åˆ—ï¼Œåˆ—çš„è¦æ±‚æ˜¯æ•´æ•°bigintæˆ–è€…array(doule),å› ä¸ºæ˜¯ä¸­ä½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯0.5ï¼Œå¦‚æœè¦3/4çš„å€¼çš„è¯å°±æ˜¯0.75,ä»¥æ­¤ç±»æ¨</p></blockquote><p>é—®é¢˜å°±ä¸ä¼šå¾ˆéš¾äº†ï¼Œæ±‚ä¸¤ä¸ªè¡¨ä¸€ä¸ªçœä»½ä¸­ä½æ•°ï¼Œä¸€ä¸ªåœ°åŒºä¸­ä½æ•°ï¼Œjoinå³å¯</p><ul><li>ä»£ç å®ç°å¦‚ä¸‹</li></ul><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//TODO t3</span></span><br><span class="line">sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |with t1 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |foi.province_id as provinceid,</span></span><br><span class="line"><span class="string">    |dp.name as provincename,</span></span><br><span class="line"><span class="string">    |dr.id as regionid,</span></span><br><span class="line"><span class="string">    |percentile(cast(final_total_amount as bigint),0.5) as provincemedian</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |dwd.fact_order_info foi</span></span><br><span class="line"><span class="string">    |left join dwd.dim_province dp on dp.id = foi.province_id</span></span><br><span class="line"><span class="string">    |left join dwd.dim_region dr on dr.id = dp.region_id</span></span><br><span class="line"><span class="string">    |group by foi.province_id,dp.name,dr.id),</span></span><br><span class="line"><span class="string">    |t2 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |dr.id as regionid,</span></span><br><span class="line"><span class="string">    |dr.region_name as regionname,</span></span><br><span class="line"><span class="string">    |percentile(cast(final_total_amount as bigint),0.5) as regionmedian</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |dwd.fact_order_info foi</span></span><br><span class="line"><span class="string">    |left join dwd.dim_province dp on dp.id = foi.province_id</span></span><br><span class="line"><span class="string">    |left join dwd.dim_region dr on dr.id = dp.region_id</span></span><br><span class="line"><span class="string">    |group by dr.id,region_name</span></span><br><span class="line"><span class="string">    |)</span></span><br><span class="line"><span class="string">    |select t1.provinceid,t1.provincename,t2.regionid,t2.regionname,</span></span><br><span class="line"><span class="string">    |t1.provincemedian,t2.regionmedian</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t1</span></span><br><span class="line"><span class="string">    |left join t2 on t1.regionid = t2.regionid</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin).createOrReplaceTempView(<span class="string">&quot;t3&quot;</span>)</span><br><span class="line">mysqlTempTable(spark, <span class="string">&quot;nationmedian&quot;</span>)</span><br><span class="line">sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |insert overwrite table mysql_nationmedian</span></span><br><span class="line"><span class="string">    |select * from t3</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>mysqlæ‰§è¡Œå‘½ä»¤ä»¥åŠç»“æœ</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230313100851640.png" alt="image-20230313100851640"></p><h2 id="BUGç‚¹-5">BUGç‚¹</h2><p>æƒ³å°†ä¸¤ä¸ªè¡¨ç»™åˆå¹¶èµ·æ¥ï¼Œå°±æƒ³åˆ°äº†ä¹‹å‰ä½¿ç”¨è¿‡çš„select t1.x,t2.x from t2,t3æŠ¥äº†é”™è¯¯ï¼Œçœ‹æŠ¥é”™ä¿¡æ¯æ˜¯hiveä¸æ”¯æŒç¬›å¡å°”ç§¯çš„ä½¿ç”¨ï¼Œåœ¨hiveä¸­å¼€å¯ç¬›å¡å°”ç§¯å°±èƒ½è§£å†³æŠ¥é”™ã€‚å¼€å¯æ–¹æ³•å¦‚ä¸‹åœ¨æˆªå›¾æœ€åä¸¤è¡Œã€‚å¦‚æœæ”¾åœ¨sparkä¸­æäº¤çš„è¯ï¼Œè¿˜æ˜¯ä¼šæŠ¥é”™ã€‚æŠ¥é”™ä¿¡æ¯æ˜¯crossJoinä¹Ÿæ˜¯ç¬›å¡å°”ï¼Œéœ€è¦ç”¨å¦‚ä¸‹çš„ä»£ç è§£å†³</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spark.conf.set(<span class="string">&quot;spark.sql.crossJoin.enabled&quot;</span>,<span class="string">&quot;true&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230313081819796.png" alt="image-20230313081819796"></p><h2 id="æ—¥æ€»ç»“-6">æ—¥æ€»ç»“</h2><blockquote><p>ä»Šå¤©å®Œæˆäº†ä»»åŠ¡4çš„æŒ‡æ ‡è®¡ç®—éƒ¨åˆ†ï¼Œä¸ŠåˆèŠ±æ—¶é—´å’Œå°ç™½è€å¸ˆä»¥åŠæ±Ÿè‹çœç¬¬ä¸€çš„æœ‹å‹æ¢è®¨äº†ä¸€ä¸‹ï¼Œå¯¹é¢˜ç›®æ¨¡ç³Šä¸æ¸…çš„è¦æ±‚çš„çœ‹æ³•ï¼Œæ¸…æ´—éƒ¨åˆ†å¯¹dwdè¡¨æ˜¯overwriteè¿˜æ˜¯appendç­‰ã€‚æ”¹å¤©ä¼šå…·ä½“åˆ—å‡ºæ¥ï¼Œè¿˜æœ‰æœ€åæŒ‡æ ‡è®¡ç®—å¯¹orderè¡¨è¦ä¸è¦å–æœ€æ–°åˆ†åŒºçš„çœ‹æ³•è¿˜æ²¡è®¨è®ºå‡ºç»“æœã€‚ç„¶åå°±æ˜¯ä»»åŠ¡å››ï¼Œä¸€è·¯ä¸Šé™¤äº†ç¬¬äºŒé¢˜å‡ºäº†ç‚¹é—®é¢˜ï¼Œè¿˜æ˜¯é¡ºåˆ©çš„ï¼Œè€Œä¸”ç¬¬äºŒé¢˜ä¹Ÿé¡ºåˆ©è§£å†³äº†é—®é¢˜ï¼Œä»Šå¤©å­¦ä¹ çŠ¶æ€ä¹Ÿä¸é”™ï¼Œåšé¢˜é¡ºåˆ©ã€‚</p></blockquote><h1 id="7æœˆä»»åŠ¡ä¹¦è®¨è®º">7æœˆä»»åŠ¡ä¹¦è®¨è®º</h1><h2 id="å­¦ä¹ æ—¥æœŸ-3-10">å­¦ä¹ æ—¥æœŸ: 3.10</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-7">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><p>é—®é¢˜ç–‘æƒ‘ç‚¹å¦‚ä¸‹:</p><p>###ã€€é—®é¢˜ä¸€</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230313102707184.png" alt="image-20230313102707184"></p><blockquote><p>å› ä¸ºæˆ‘ä»¬æ˜¯ä¸çŸ¥é“dwdè¡¨ä¸­çš„æ•°æ®ä»¥åŠåˆ†åŒºæ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œåªèƒ½æ¨æµ‹ã€‚æ ¹æ®ä¸šåŠ¡ç†è§£ï¼Œå¯ä»¥è®¤ä¸ºodsçš„æ•°æ®æ˜¯æ¯”èµ›æ—¥æœŸçš„æ˜¨å¤©çš„ï¼Œè€Œdwdçš„æ•°æ®æ˜¯æ˜¨å¤©ä¹‹å‰çš„ï¼Œä¹Ÿå°±æ˜¯å‰å¤©æˆ–è€…æ›´æ—©çš„ï¼Œé¢˜ç›®è¦æ±‚odså–æ˜¨å¤©çš„åˆ†åŒºï¼Œdwdå–æœ€æ–°çš„åˆ†åŒºï¼Œå‡è®¾è¿™ä¸ªæœ€æ–°çš„åˆ†åŒºå°±æ˜¯å‰å¤©çš„ï¼Œé‚£å’Œodsé€šè¿‡idå»é‡ä»¥åçš„æ•°æ®å†æ”¾å…¥dwdçš„æ—¶å€™ï¼Œæ˜¯appendè¿˜æ˜¯overwriteï¼Œè¿˜æ˜¯è¯´appendç„¶åå°†é‡å¤çš„idåˆ é™¤äº†ã€‚</p><p>ç»è¿‡è®¨è®ºè®¤ä¸ºç›´æ¥appendçš„å°±å¥½äº†ï¼Œè™½ç„¶ä¼šæœ‰é‡å¤çš„idä½†æ˜¯åˆ†åŒºæ˜¯ä¸ä¸€æ ·çš„ã€‚å¦‚æœæ˜¯çœŸå®çš„ä¸šåŠ¡ä¸Šçš„è¯ï¼Œå…¶å®æ˜¯åº”è¯¥å¯¹è¡¨çš„idå»é‡çš„ï¼Œå› ä¸ºuseridæ˜¯ä¸»é”®æ˜¯å”¯ä¸€å€¼ã€‚</p></blockquote><h3 id="é—®é¢˜äºŒ-æœªè§£å†³">é—®é¢˜äºŒ(æœªè§£å†³)</h3><p>åœ¨æŒ‡æ ‡è®¡ç®—ä¸­éƒ½ä¼šæœ‰è¿™ä¹ˆä¸€å¥è¯ï¼Œä»¥å‰æ²¡æœ‰æ³¨æ„ï¼Œçœ‹åˆ°ä»¥åå‘ç°æ˜¯è¦å–åˆ†åŒºçš„ï¼Œä½†æ˜¯æˆ‘åˆå»çœ‹äº†å°ç™½çš„ä»£ç ï¼Œå‘ç°ä»–å¹¶æ²¡æœ‰å¯¹orderè¡¨å–æœ€æ–°åˆ†åŒºã€‚</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230313104805961.png" alt="image-20230313104805961"></p><blockquote><p>å°ç™½ç»™æˆ‘çš„è§£é‡Šæ˜¯orderè¡¨æ˜¯äº‹å®è¡¨ä¸æ˜¯ç»´è¡¨æ‰€ä»¥ä¸å–åˆ†åŒºï¼Œé—®äº†ç¦å»ºæ¯”èµ›çš„æœ‹å‹ï¼Œä»–ä¹Ÿè¯´ä¸ç”¨å–ï¼Œä½†æ˜¯æ±Ÿè‹ç¬¬ä¸€è¯´ä»–æ¯”èµ›çš„æ—¶å€™orderå–äº†æœ€æ–°çš„åˆ†åŒºï¼Œä¸€æ—¶é—´ä¸çŸ¥é“å¬å“ªä¸ªçš„ï¼Œæˆ‘è‡ªå·±è®¤ä¸ºè¡¨çš„ç¡®æ˜¯æœ‰ç»´è¡¨å’Œäº‹å®è¡¨çš„åŒºåˆ«ï¼Œæ‰€ä»¥é¢˜ç›®è¦æ±‚ç»´è¡¨ï¼Œorderçš„ç¡®æ˜¯ä¸ç”¨å–æœ€æ–°åˆ†åŒºçš„ã€‚ä½†æ˜¯æ±Ÿè‹ç¬¬ä¸€è¯´ä»–æ¯”èµ›çš„æ—¶å€™å–çš„ï¼Œç»“æœæ˜¯å…¨å¯¹çš„ã€‚â€¦ç­‰åé¢é—®å››åˆçš„è€å¸ˆå§ã€‚</p></blockquote><h2 id="æ‰©å±•å­¦ä¹ -2">æ‰©å±•å­¦ä¹ </h2><p>å°†7æœˆä»»åŠ¡ä¹¦ç»¼åˆåˆ†æéƒ¨åˆ†éƒ½ä½¿ç”¨chatgptï¼Œå°†é—®é¢˜å›ç­”å®Œæ•´å¹¶åšäº†æ€»ç»“ã€‚æ€»ç»“å®Œä»¥åå‘ç°ä¹Ÿå°±6ä¸ªé—®é¢˜ï¼Œæ¯å¤©èƒŒä¸€ä¸‹è®°ä¸€ä¸‹ï¼Œæ¯”èµ›å‰åº”è¯¥éƒ½èƒ½è®°ä½äº†ã€‚</p><h2 id="æ—¥æ€»ç»“-7">æ—¥æ€»ç»“</h2><blockquote><p>å¯¹ä»»åŠ¡ä¹¦ç–‘æƒ‘ç‚¹è¿›è¡Œè®¨è®ºï¼Œç»“åˆå¤§å®¶çœ‹æ³•ï¼Œæ‰¾åˆ°æœ€åˆç†çš„è§£å†³åŠæ³•ï¼Œä»¥åŠé¢˜ç›®ç†è§£ã€‚æ¯”è¾ƒçªå‡ºçš„å…¶å®å°±æˆ‘åˆ—å‡ºæ¥çš„ä¸¤ä¸ªé—®é¢˜ï¼Œå…¶ä»–çš„å¤§å®¶çš„ç†è§£éƒ½åŸºæœ¬ä¸€è‡´ã€‚æ€»ç»“å·®ä¸å¤šéƒ½å†™ä¸Šé¢äº†ã€‚ç„¶åå°±æ˜¯7æœˆä»»åŠ¡ä¹¦ç»¼åˆåˆ†æéƒ¨åˆ†éƒ½ä½¿ç”¨chatgptï¼Œå°†é—®é¢˜å›ç­”å®Œæ•´å¹¶åšäº†æ€»ç»“ã€‚æ€»ç»“å®Œä»¥åå‘ç°ä¹Ÿå°±6ä¸ªé—®é¢˜ï¼Œæ¯å¤©èƒŒä¸€ä¸‹è®°ä¸€ä¸‹ï¼Œæ¯”èµ›å‰åº”è¯¥éƒ½èƒ½è®°ä½äº†ã€‚</p></blockquote><h1 id="7æœˆä»»åŠ¡ä¹¦5-æŒ‡æ ‡è®¡ç®—">7æœˆä»»åŠ¡ä¹¦5 æŒ‡æ ‡è®¡ç®—</h1><h2 id="å­¦ä¹ æ—¥æœŸ-3-13">å­¦ä¹ æ—¥æœŸ: 3.13</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-8">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><h3 id="ç¬¬ä¸€é¢˜">ç¬¬ä¸€é¢˜</h3><p>å…¶ä»–å¾ˆå¤šä»»åŠ¡ä¹¦éƒ½æœ‰è¿™é¢˜ï¼Œå°±ä¸ç»†è¯´äº†</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |with t1 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |final_total_amount,</span></span><br><span class="line"><span class="string">    |province_id,</span></span><br><span class="line"><span class="string">    |substring(etl_date,4,0) as year,</span></span><br><span class="line"><span class="string">    |substring(etl_date,5,2) as month</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |dwd.fact_order_info),</span></span><br><span class="line"><span class="string">    |t2 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |province_id,</span></span><br><span class="line"><span class="string">    |sum(t1.final_total_amount) as total_amount,</span></span><br><span class="line"><span class="string">    |count(1) as total_count,</span></span><br><span class="line"><span class="string">    |year,month</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t1</span></span><br><span class="line"><span class="string">    |group by province_id,year,month)</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |t2.province_id as province_id,</span></span><br><span class="line"><span class="string">    |dp.name as province_name,</span></span><br><span class="line"><span class="string">    |dr.id  as region_id,</span></span><br><span class="line"><span class="string">    |dr.region_name as region_name,</span></span><br><span class="line"><span class="string">    |t2.total_amount,</span></span><br><span class="line"><span class="string">    |t2.total_count,</span></span><br><span class="line"><span class="string">    |row_number() over(partition by year,month,region_id order by total_amount desc) as sequence,</span></span><br><span class="line"><span class="string">    |year,month</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t2</span></span><br><span class="line"><span class="string">    |left join dwd.dim_province dp on dp.id = t2.province_id</span></span><br><span class="line"><span class="string">    |left join dwd.dim_region dr on dr.id = dp.region_id</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin).write.mode(<span class="string">&quot;overwrite&quot;</span>)</span><br><span class="line">  .saveAsTable(<span class="string">&quot;dws.province_consumption_day_aggr&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="ç¬¬äºŒé¢˜">ç¬¬äºŒé¢˜</h3><blockquote><p>è®¡ç®—è¿ç»­ä¸¤å¤©ä¸‹å•çš„ç”¨æˆ·ä¸å·²ä¸‹å•ç”¨æˆ·çš„å æ¯”ï¼Œå°†ç»“æœå­˜å…¥MySQLæ•°æ®åº“shtd_resultçš„userrepurchasedrateè¡¨ä¸­</p></blockquote><p>åˆ†æé¢˜ç›®è¦æ±‚ï¼Œæ±‚å‡ºä¸‹å•ç”¨æˆ·ï¼Œå’Œè¿ç»­ä¸¤å¤©ä¸‹å•çš„ç”¨æˆ·ï¼Œç„¶åå æ¯”ï¼Œä¹Ÿå°±æ˜¯ä¸€è¡Œå³å¯ï¼Œé‚£å°±å¯ä»¥ä½¿ç”¨dslçš„getLongè·å–æ•°é‡ï¼Œå†æœ€åå¯¼å…¥è¡¨çš„æ—¶å€™ä½¿ç”¨å¸¸é‡å€¼å°±è¡Œäº†ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> l1: <span class="type">Long</span> = sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |select count(*) from dwd.fact_order_info</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin).first().getLong(<span class="number">0</span>) <span class="comment">//å·²ä¸‹å•äººæ•°</span></span><br><span class="line">println(l1+<span class="string">&quot;*******************************************************************&quot;</span>)</span><br><span class="line"><span class="keyword">val</span> l2: <span class="type">Long</span> = sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |with t1 as(</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |user_id as userid,</span></span><br><span class="line"><span class="string">    |cast(date_format(create_time,&#x27;yyyyMMdd&#x27;) as int) as day,</span></span><br><span class="line"><span class="string">    |final_total_amount</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |dwd.fact_order_info a),</span></span><br><span class="line"><span class="string">    |t2 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |userid,day,sum(final_total_amount) as sumorder</span></span><br><span class="line"><span class="string">    |from t1</span></span><br><span class="line"><span class="string">    |group by userid,day</span></span><br><span class="line"><span class="string">    |),t3 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |a.userid,</span></span><br><span class="line"><span class="string">    |concat(a.day,&#x27;_&#x27;,b.day),</span></span><br><span class="line"><span class="string">    |a.sumorder</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t2 a</span></span><br><span class="line"><span class="string">    |left join t2 b on a.userid=b.userid</span></span><br><span class="line"><span class="string">    |where</span></span><br><span class="line"><span class="string">    |a.day+1=b.day</span></span><br><span class="line"><span class="string">    |and</span></span><br><span class="line"><span class="string">    |a.sumorder&lt;b.sumorder</span></span><br><span class="line"><span class="string">    |)</span></span><br><span class="line"><span class="string">    |select count(*)</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t3</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin).first().getLong(<span class="number">0</span>) <span class="comment">//è¿ç»­ä¸¤å¤©çš„äººæ•°</span></span><br><span class="line">print(l2+<span class="string">&quot;*******************************************************************&quot;</span>)</span><br><span class="line">sql(</span><br><span class="line">  <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    |select $l1 as purchaseduser,</span></span><br><span class="line"><span class="string">    |$l2 as repurchaseduser,</span></span><br><span class="line"><span class="string">    |concat(round($l2/$l1,3)*100,&#x27;%&#x27;) as repurchaserate</span></span><br><span class="line"><span class="string">    |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin).show() <span class="comment">//ç›´æ¥æŸ¥ ä¿ç•™ä¸‰ä½å°æ•°ç„¶åä¹˜100åŠ %å°±æ˜¯ç™¾åˆ†æ¯”</span></span><br></pre></td></tr></table></figure><h3 id="ç¬¬ä¸‰é¢˜">ç¬¬ä¸‰é¢˜</h3><blockquote><p>ç¬¬ä¸‰é¢˜æ¯”è¾ƒéš¾ï¼Œè¡Œè½¬åˆ—ï¼Œéœ€è¦ç”¨scalaä¸­æŸ¯é‡ŒåŒ–å‡½æ•°ï¼Œå› ä¸ºscalaå­¦çš„ä¸æ˜¯å¾ˆæ·±å…¥ï¼Œæ‰€ä»¥è¿™é¢˜å¦‚æœè‡ªå·±åšçš„è¯ï¼Œåº”è¯¥æ˜¯ç”¨unionæˆ–è€…joinæ¥å®ç°äº†ã€‚é—®äº†æœ‹å‹æ˜ç™½ä»£ç ç”¨æ³•ï¼Œå®ç°äº†åŠŸèƒ½ï¼ŒfoldLeftå…¶å®è¿˜ä¸æ˜¯å¾ˆç†è§£ã€‚</p></blockquote><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> data = sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |b.name,count(*) as con</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |dwd.fact_order_info a</span></span><br><span class="line"><span class="string">    |join dwd.dim_province b on a.province_id=b.id</span></span><br><span class="line"><span class="string">    |group by b.name</span></span><br><span class="line"><span class="string">    |order by con desc</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line">  .rdd.map(x =&gt; (x.getString(<span class="number">0</span>),x.getLong(<span class="number">1</span>)))</span><br><span class="line">  .collect().toList</span><br><span class="line">print(data)</span><br><span class="line"><span class="keyword">import</span> spark.implicits._</span><br><span class="line"><span class="keyword">val</span> dum: <span class="type">DataFrame</span> = <span class="type">Seq</span>(<span class="string">&quot;1&quot;</span>).toDF(<span class="string">&quot;dum&quot;</span>)</span><br><span class="line">data.foldLeft(dum)((dum,d) =&gt; dum.withColumn(d._1,lit(d._2)))</span><br><span class="line">  .drop(<span class="string">&quot;dum&quot;</span>)</span><br><span class="line">  .show(<span class="literal">false</span>)</span><br></pre></td></tr></table></figure><h2 id="BUGç‚¹-6">BUGç‚¹</h2><p>ä¿®äº†ä¸ªhexoåšå®¢çš„bug,é—®é¢˜ç‚¹åœ¨æˆ‘æ–‡ç« h1æ ‡ç­¾ï¼Œç‚¹å‡»å·¥ä½œå°ä¼šæŠ¥é”™ï¼Œè€Œä¸”æ— æ³•è·³è½¬ã€‚æŸ¥çœ‹åšå®¢æºä»£ç å‘ç°åœ¨main.jså’Œutil.jsä¸­æœ‰ä½¿ç”¨ï¼Œä¸€ç›´æ·±æ‹”æºç ï¼Œå‘ç°æ˜¯hexo-renderer-markdown-itè¿™ä¸ªæ’ä»¶çš„é—®é¢˜ï¼Œå› ä¸ºseoæ ‡é¢˜å°±æ˜¯h1æ ‡ç­¾ï¼Œæ‰€ä»¥æºç ä¸­è·³è½¬ç‰¹æ„ä»h2å¼€å§‹çš„ï¼Œæºç æ”¹ä¸äº†å°±åªèƒ½æ”¹é…ç½®è¦†ç›–ï¼Œåœ¨_config.ymlä¸­åŠ å…¥,é—®é¢˜é¡ºåˆ©è§£å†³ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">markdown:</span></span><br><span class="line">  <span class="attr">anchors:</span></span><br><span class="line">    <span class="attr">level:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230314143507008.png" alt="image-20230314143507008"></p><h2 id="æ—¥æ€»ç»“-8">æ—¥æ€»ç»“</h2><blockquote><p>ä»Šå¤©çš„ä»»åŠ¡æ˜¯ä»»åŠ¡ä¹¦5çš„æŒ‡æ ‡è®¡ç®—ï¼Œä»»åŠ¡5çš„æŒ‡æ ‡è®¡ç®—å’Œä¹‹å‰çš„å¾ˆä¸åŒï¼Œä¹‹å‰çš„éƒ½æ˜¯åˆ†ç»„å®Œäº†ç„¶åè°ƒç”¨å‡½æ•°ï¼Œä»»åŠ¡5åé¢çš„ä¸¤é¢˜å°±æ˜¯æ¯”è¾ƒæ–°é¢–çš„ï¼Œä¸€é¢˜æ˜¯å•è¡Œçš„ï¼Œå¦å¤–ä¸€é¢˜åˆ—è½¬è¡Œå°±æ¯”è¾ƒéš¾äº†ï¼Œéœ€è¦ç”¨scalaå‡½æ•°æŸ¯é‡ŒåŒ–ã€‚è§£å†³äº†ä¹‹å‰åšå®¢ç‚¹å‡»è·³è½¬çš„BUGã€‚æ–°ç‰ˆåšå®¢é“¾æ¥https://u7u7.top</p></blockquote><h1 id="ä»»åŠ¡4ä¿®æ”¹">ä»»åŠ¡4ä¿®æ”¹</h1><h2 id="å­¦ä¹ æ—¥æœŸ-3-14">å­¦ä¹ æ—¥æœŸ: 3.14</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-9">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><blockquote><p>åˆšå¼€å§‹çš„é¢˜ç›®ç†è§£éƒ½æ˜¯ä½¿ç”¨detailå•†å“è¡¨ï¼Œä½†æ˜¯å¿˜è®°äº†è®¢å•é¢ï¼Œåº”è¯¥æ˜¯ç®—æœ€ç»ˆè®¢å•ï¼Œä¹Ÿå°±æ˜¯infoè¡¨ä¸­çš„final_total_amountï¼Œæ‰€ä»¥ä¹‹å‰çš„ä»£ç æ˜¯æœ‰ç–‘é—®çš„ï¼Œè€Œä¸”å› ä¸ºä¸¤ä¸ªè¡¨order_idæ˜¯ä¸ç›¸åŒçš„ï¼Œè®¨è®ºè¿‡åé€‰æ‹©ä½¿ç”¨joinï¼Œç”¨ä¸¤ä¸ªè¡¨éƒ½æœ‰çš„idï¼Œä¿®æ”¹ä»¥åå¦‚ä¸‹:</p></blockquote><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//TODO t2</span></span><br><span class="line">sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |with t1 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |sku_id,sku_name,</span></span><br><span class="line"><span class="string">    |cast(sum(sku_num) as int) as skuSum,</span></span><br><span class="line"><span class="string">    |sum(final_total_amount) as topprice</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |dwd.fact_order_detail fod</span></span><br><span class="line"><span class="string">	|join dwd.fact_order_info foi on foi.id=fod.order_id  </span></span><br><span class="line"><span class="string">    |group by sku_id,sku_name),</span></span><br><span class="line"><span class="string">    |t2 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |t1.sku_id as topquantityid,</span></span><br><span class="line"><span class="string">    |t1.sku_name as topquantityname,</span></span><br><span class="line"><span class="string">    |t1.skuSum as topquantity,</span></span><br><span class="line"><span class="string">    |row_number() over(order by t1.skuSum desc,t1.sku_id) as topTenQuantity</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t1</span></span><br><span class="line"><span class="string">    |limit 10),</span></span><br><span class="line"><span class="string">    |t3 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |t1.sku_id as toppriceid,</span></span><br><span class="line"><span class="string">    |t1.sku_name as toppricename,</span></span><br><span class="line"><span class="string">    |t1.topprice as topprice,</span></span><br><span class="line"><span class="string">    |row_number() over(order by t1.skuOrderSum desc) as sequence</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t1</span></span><br><span class="line"><span class="string">    |limit 10)</span></span><br><span class="line"><span class="string">    |select topquantityid,</span></span><br><span class="line"><span class="string">    |topquantityname,</span></span><br><span class="line"><span class="string">    |topquantity,</span></span><br><span class="line"><span class="string">    |t3.*</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t2</span></span><br><span class="line"><span class="string">    |left join t3 on t2.topTenQuantity=t3.sequence</span></span><br><span class="line"><span class="string">    |order by t3.sequence</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin).createOrReplaceTempView(<span class="string">&quot;t2&quot;</span>)</span><br><span class="line">mysqlTempTable(spark,<span class="string">&quot;topten&quot;</span>)</span><br><span class="line">sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |insert overwrite table mysql_topten</span></span><br><span class="line"><span class="string">    |select * from t2</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin)</span><br></pre></td></tr></table></figure><h2 id="æ—¥æ€»ç»“-9">æ—¥æ€»ç»“</h2><blockquote><p>æ˜å¤©å¼€å§‹æ¯å¤©éƒ½æ˜¯è¦å»åšå‡ é“ç®—æ³•é¢˜äº†ï¼Œè“æ¡¥æ¯ç®—æ³•æ¯”èµ›å¿«å¼€å§‹äº†ï¼Œæœ€è¿‘ä¸€äº›ç®—æ³•ä½¿ç”¨å·²ç»æœ‰ç‚¹ç”Ÿç–äº†ï¼Œä»Šå¤©è®¨è®ºçš„æ—¶å€™åˆè§£å†³äº†ä¸€ä¸ªä»»åŠ¡ä¸æ¸…æ™°çš„è¦æ±‚ï¼Œä»Šå¤©ä¸»è¦æ˜¯å¤ä¹ äº†ä¸€ä¸‹javaç®—æ³•å’Œè§£å†³å¤§æ•°æ®çš„é—®é¢˜ä»¥åŠèƒŒäº†ä¸€ä¸‹ç»¼åˆåˆ†æã€‚</p></blockquote><h1 id="ä»»åŠ¡5ä»¥åŠç®—æ³•">ä»»åŠ¡5ä»¥åŠç®—æ³•</h1><h2 id="å­¦ä¹ æ—¥æœŸ-3-15">å­¦ä¹ æ—¥æœŸ: 3.15</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-10">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><h3 id="ç¼–å·2120">ç¼–å·2120</h3><p>é¢˜ç›®ä¸éš¾ï¼Œæ‰¾åˆ°è§„å¾‹å°±è¡Œäº†ã€‚</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/202303151845716.png" alt="image-20230315093825402"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">Scanner</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">    <span class="comment">//åœ¨æ­¤è¾“å…¥æ‚¨çš„ä»£ç ...</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">Ax</span> <span class="operator">=</span> scan.nextLine();</span><br><span class="line">    <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> Integer.parseInt(Ax.substring(<span class="number">1</span>));</span><br><span class="line">    <span class="type">int</span>[] a = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">6</span>]; <span class="comment">//A9è¶…å‡º æ‰€ä»¥è®¾ç½®6ä¸ª</span></span><br><span class="line">    <span class="type">int</span>[] b = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">5</span>];</span><br><span class="line">    <span class="type">int</span> <span class="variable">aNumOne</span> <span class="operator">=</span> <span class="number">1189</span>; <span class="comment">//å®šä¹‰åˆå§‹å€¼</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">bNumOne</span> <span class="operator">=</span> <span class="number">841</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;<span class="number">6</span>;i++)&#123;</span><br><span class="line">        a[i] = aNumOne;</span><br><span class="line">        aNumOne = aNumOne / <span class="number">2</span>; <span class="comment">//å–æ•´æ·»åŠ </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>;j&lt;<span class="number">5</span>;j++)&#123;</span><br><span class="line">        b[j] = bNumOne;</span><br><span class="line">        bNumOne = bNumOne / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(num%<span class="number">2</span>==<span class="number">0</span>)&#123;</span><br><span class="line">        System.out.println(a[num/<span class="number">2</span>]);<span class="comment">//å¶æ•°æŒ‰ç´¢å¼•å–æ•°ç»„</span></span><br><span class="line">        System.out.println(b[num/<span class="number">2</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        System.out.println(b[(num-<span class="number">1</span>)/<span class="number">2</span>]);<span class="comment">//å¥‡æ•°æ•°å‰åå–å¤´</span></span><br><span class="line">        System.out.println(a[(num+<span class="number">1</span>)/<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    scan.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="BUGç‚¹-7">BUGç‚¹</h2><p>ä»»åŠ¡ä¹¦5ç¬¬ä¸‰é¢˜ï¼Œæ˜¯ä½¿ç”¨rddç®—å­å®ç°çš„ï¼Œåœ¨ideaä¸­èƒ½æ‰“å°ï¼Œèƒ½showï¼Œéƒ½æ˜¯è›®æ­£å¸¸çš„ï¼Œä½†æ˜¯æ”¾åˆ°æœåŠ¡å™¨sparkæäº¤ï¼Œå°±æŠ¥å¾ˆå¤šé”™è¯¯ï¼Œè€Œä¸”æ‰¾ä¸åˆ°å…³é”®ä¿¡æ¯ï¼Œå›åˆ°IDEAçš„æ—¶å€™ï¼Œå‘ç°æœ€ä¸Šé¢æ˜¯æœ‰æŠ¥é”™ä¿¡æ¯çš„ï¼Œä»£ç å´èƒ½æ­£å¸¸æ‰§è¡Œã€‚æäº†ä¸€ä¸‹åˆæ²¡è§£å†³ï¼Œæ¨æµ‹æ˜¯å› ä¸ºç¯å¢ƒä½¿ç”¨çš„æ˜¯mariadbçš„é—®é¢˜ï¼Œå› ä¸ºIDEAä¸­å‡ºç°å¾ˆå¤šè¿™ä¸ªæŠ¥é”™ï¼ŒSparkæ— æ³•æ˜¾ç¤ºçš„åŸå› ï¼Œåº”è¯¥æ˜¯mariadbçš„æŠ¥é”™æ²¡æœ‰è¿‡æ»¤ï¼Œå¯¼è‡´ä¸€æŠ¥é”™å°±è‡ªåŠ¨æ€æ­»è‡ªå·±çš„è¿›ç¨‹ã€‚</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/202303151832559.png" alt="image-20230315183251364"></p><h2 id="æ‰©å±•å­¦ä¹ -3">æ‰©å±•å­¦ä¹ </h2><ul><li>ç ”ç©¶äº†ä¸€ä¸‹è‡ªå·±åšå®¢æ’ä»¶çš„æºä»£ç ï¼Œå¹¶å®‰è£…äº†çœ‹æ¿å¨˜åœ¨åšå®¢ä¸­ï¼Œè‡ªå·±è‡ªå®šä¹‰äº†ä½ç½®ä»¥åŠå¤§å°ï¼Œå†™ymlé…ç½®ä¸­</li><li>å…¶ä»–çš„live2dæœ‰äº›æ¯”è¾ƒåƒæ€§èƒ½ï¼Œè‡ªå·±çš„æ²¡æœ‰ä¹°äº‘æœåŠ¡å™¨æ‰€ä»¥åªèƒ½æ‰¾ä¸€ä¸ªèµ„æºå ç”¨ä¸å¤§çš„æ¨¡å‹:ymlä»£ç å¦‚ä¸‹</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">live2d:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">#å¼€å…³æ’ä»¶ç‰ˆçœ‹æ¿å¨˜</span></span><br><span class="line">  <span class="attr">scriptFrom:</span> <span class="string">local</span> <span class="comment"># é»˜è®¤</span></span><br><span class="line">  <span class="attr">pluginRootPath:</span> <span class="string">live2dw/</span> <span class="comment"># æ’ä»¶åœ¨ç«™ç‚¹ä¸Šçš„æ ¹ç›®å½•(ç›¸å¯¹è·¯å¾„)</span></span><br><span class="line">  <span class="attr">pluginJsPath:</span> <span class="string">lib/</span> <span class="comment"># è„šæœ¬æ–‡ä»¶ç›¸å¯¹ä¸æ’ä»¶æ ¹ç›®å½•è·¯å¾„</span></span><br><span class="line">  <span class="attr">pluginModelPath:</span> <span class="string">assets/</span> <span class="comment"># æ¨¡å‹æ–‡ä»¶ç›¸å¯¹ä¸æ’ä»¶æ ¹ç›®å½•è·¯å¾„</span></span><br><span class="line">  <span class="attr">model:</span></span><br><span class="line">    <span class="attr">use:</span> <span class="string">live2d-widget-model-koharu</span> <span class="comment"># npm-module package name</span></span><br><span class="line">  <span class="attr">display:</span></span><br><span class="line">    <span class="attr">position:</span> <span class="string">left</span> <span class="comment">#æ§åˆ¶çœ‹æ¿å¨˜ä½ç½®</span></span><br><span class="line">    <span class="attr">width:</span> <span class="number">150</span> <span class="comment">#æ§åˆ¶çœ‹æ¿å¨˜å¤§å°</span></span><br><span class="line">    <span class="attr">height:</span> <span class="number">300</span> <span class="comment">#æ§åˆ¶çœ‹æ¿å¨˜å¤§å°</span></span><br><span class="line">  <span class="attr">mobile:</span></span><br><span class="line">    <span class="attr">show:</span> <span class="literal">true</span> <span class="comment"># æ‰‹æœºä¸­æ˜¯å¦å±•ç¤º</span></span><br></pre></td></tr></table></figure><blockquote><p>æ•ˆæœå¦‚ä¸‹:</p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/202303151856028.png" alt="image-20230315185643870"></p><h2 id="æ—¥æ€»ç»“-10">æ—¥æ€»ç»“</h2><blockquote><p>ä»Šå¤©ä¸‹åˆæ˜¯å¤§æ•°æ®å­¦ä¹ ï¼Œå¯æƒœä¸€ç›´åœ¨è§£å†³BUGï¼Œè€Œä¸”æ²¡è§£å†³å®Œã€‚ç­‰åé¢æœåŠ¡å™¨æ¥äº†å†æµ‹è¯•ä¸€ä¸‹å§ï¼Œæˆ‘æ€€ç–‘æ˜¯å°ç™½æœåŠ¡å™¨çš„é—®é¢˜ï¼ŒçœŸè¦æ”¹èµ·æ¥è‚¯å®šä¼šèŠ±è´¹å¤§é‡çš„æ—¶é—´å’Œç²¾åŠ›ï¼Œæ‰€ä»¥æ‰“ç®—å…ˆæ”¾ä¸€æ”¾ã€‚ä¸Šåˆæ”¹äº†åšå®¢å­¦ä¹ äº†ä¸€ä¸‹Vueï¼Œvueæ²¡çœ‹å‡ é›†æ—¶é—´ä¸æ˜¯å¾ˆå……è£•ï¼Œå°±æ²¡æœ‰è®°ç¬”è®°ã€‚åšäº†ä¸€é“ç®€å•çš„ç®—æ³•é¢˜ï¼Œåšç¬¬äºŒé¢˜çš„æ—¶å€™ï¼Œéš¾åº¦ä¸Šå»äº†ï¼Œä¸€ä¸­åˆæ²¡åšå®Œï¼Œä¸‹åˆè¦å¤§æ•°æ®äº†ï¼Œå°±å…ˆæ”¾æ˜å¤©å¼„äº†ã€‚ä»Šå¤©å­¦ä¹ çŠ¶æ€ä¸€èˆ¬ã€‚</p></blockquote><h1 id="Vue-TodoListæ¡ˆä¾‹å®Œå–„">Vue TodoListæ¡ˆä¾‹å®Œå–„</h1><h2 id="å­¦ä¹ æ—¥æœŸ-3-17">å­¦ä¹ æ—¥æœŸ: 3.17</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-11">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><h3 id="å…¨å±€äº‹ä»¶æ€»çº¿ï¼ˆGlobalEventBusï¼‰">å…¨å±€äº‹ä»¶æ€»çº¿ï¼ˆGlobalEventBusï¼‰</h3><ol><li><p>ä¸€ç§ç»„ä»¶é—´é€šä¿¡çš„æ–¹å¼ï¼Œé€‚ç”¨äº<span style="color:red">ä»»æ„ç»„ä»¶é—´é€šä¿¡</span>ã€‚</p></li><li><p>å®‰è£…å…¨å±€äº‹ä»¶æ€»çº¿ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">	......</span><br><span class="line">	<span class="title function_">beforeCreate</span>(<span class="params"></span>) &#123;</span><br><span class="line">		<span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$bus</span> = <span class="variable language_">this</span> <span class="comment">//å®‰è£…å…¨å±€äº‹ä»¶æ€»çº¿ï¼Œ$buså°±æ˜¯å½“å‰åº”ç”¨çš„vm</span></span><br><span class="line">	&#125;,</span><br><span class="line">    ......</span><br><span class="line">&#125;) </span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨äº‹ä»¶æ€»çº¿ï¼š</p><ol><li><p>æ¥æ”¶æ•°æ®ï¼šAç»„ä»¶æƒ³æ¥æ”¶æ•°æ®ï¼Œåˆ™åœ¨Aç»„ä»¶ä¸­ç»™$busç»‘å®šè‡ªå®šä¹‰äº‹ä»¶ï¼Œäº‹ä»¶çš„<span style="color:red">å›è°ƒç•™åœ¨Aç»„ä»¶è‡ªèº«ã€‚</span></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">methods</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="title function_">demo</span>(<span class="params">data</span>)&#123;......&#125;</span><br><span class="line">&#125;</span><br><span class="line">......</span><br><span class="line"><span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">$bus</span>.$on(<span class="string">&#x27;xxxx&#x27;</span>,<span class="variable language_">this</span>.<span class="property">demo</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æä¾›æ•°æ®ï¼š<code>this.$bus.$emit('xxxx',æ•°æ®)</code></p></li></ol></li><li><p>æœ€å¥½åœ¨beforeDestroyé’©å­ä¸­ï¼Œç”¨$offå»è§£ç»‘<span style="color:red">å½“å‰ç»„ä»¶æ‰€ç”¨åˆ°çš„</span>äº‹ä»¶ã€‚</p></li></ol><h3 id="æ¶ˆæ¯è®¢é˜…ä¸å‘å¸ƒï¼ˆpubsubï¼‰">æ¶ˆæ¯è®¢é˜…ä¸å‘å¸ƒï¼ˆpubsubï¼‰</h3><ol><li><p>ä¸€ç§ç»„ä»¶é—´é€šä¿¡çš„æ–¹å¼ï¼Œé€‚ç”¨äº<span style="color:red">ä»»æ„ç»„ä»¶é—´é€šä¿¡</span>ã€‚</p></li><li><p>ä½¿ç”¨æ­¥éª¤ï¼š</p><ol><li><p>å®‰è£…pubsubï¼š<code>npm i pubsub-js</code></p></li><li><p>å¼•å…¥: <code>import pubsub from 'pubsub-js'</code></p></li><li><p>æ¥æ”¶æ•°æ®ï¼šAç»„ä»¶æƒ³æ¥æ”¶æ•°æ®ï¼Œåˆ™åœ¨Aç»„ä»¶ä¸­è®¢é˜…æ¶ˆæ¯ï¼Œè®¢é˜…çš„<span style="color:red">å›è°ƒç•™åœ¨Aç»„ä»¶è‡ªèº«ã€‚</span></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">methods</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="title function_">demo</span>(<span class="params">data</span>)&#123;......&#125;</span><br><span class="line">&#125;</span><br><span class="line">......</span><br><span class="line"><span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">pid</span> = pubsub.<span class="title function_">subscribe</span>(<span class="string">&#x27;xxx&#x27;</span>,<span class="variable language_">this</span>.<span class="property">demo</span>) <span class="comment">//è®¢é˜…æ¶ˆæ¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æä¾›æ•°æ®ï¼š<code>pubsub.publish('xxx',æ•°æ®)</code></p></li><li><p>æœ€å¥½åœ¨beforeDestroyé’©å­ä¸­ï¼Œç”¨<code>PubSub.unsubscribe(pid)</code>å»<span style="color:red">å–æ¶ˆè®¢é˜…ã€‚</span></p></li></ol></li></ol><h3 id="nextTick">nextTick</h3><ol><li>è¯­æ³•ï¼š<code>this.$nextTick(å›è°ƒå‡½æ•°)</code></li><li>ä½œç”¨ï¼šåœ¨ä¸‹ä¸€æ¬¡ DOM æ›´æ–°ç»“æŸåæ‰§è¡Œå…¶æŒ‡å®šçš„å›è°ƒã€‚</li><li>ä»€ä¹ˆæ—¶å€™ç”¨ï¼šå½“æ”¹å˜æ•°æ®åï¼Œè¦åŸºäºæ›´æ–°åçš„æ–°DOMè¿›è¡ŒæŸäº›æ“ä½œæ—¶ï¼Œè¦åœ¨nextTickæ‰€æŒ‡å®šçš„å›è°ƒå‡½æ•°ä¸­æ‰§è¡Œã€‚</li></ol><h2 id="æ‰©å±•å­¦ä¹ -4">æ‰©å±•å­¦ä¹ </h2><p>åŠ›æ‰£ç®—æ³•ç»ƒä¹  ä¸¤ä¸ªä¸€èˆ¬éš¾åº¦ æš´åŠ›åšçš„å‡ºæ¥ ç®—æ³•ä¼˜è§£ç†è§£äº†å¾ˆä¹… ä¸¤é¢˜åšäº†ä¸€ä¸‹åˆ</p><h2 id="æ—¥æ€»ç»“-11">æ—¥æ€»ç»“</h2><blockquote><p>ä»Šå¤©çš„å­¦ä¹ å†…å®¹ä¸æ˜¯å¾ˆéš¾ï¼Œè¿˜æ˜¯å¯¹æ¡ˆä¾‹çš„ä¼˜åŒ–ã€‚é‡ç‚¹åœ¨å…¨å±€äº‹ä»¶æ€»çº¿ï¼Œå®ƒå’Œæ¶ˆæ¯è®¢é˜…æ‰€å®ç°çš„åŠŸèƒ½å·®ä¸å¤šçš„ï¼Œä½†æ˜¯è¿˜æ˜¯å…¨å±€äº‹ä»¶æ¯”è¾ƒæ–¹ä¾¿è€Œä¸”ä¸ä¾é ç¬¬ä¸‰æ–¹æ’ä»¶ã€‚ç„¶åæ˜¯å¯¹æ–‡æœ¬æ¡†ç‚¹å‡»ç¼–è¾‘æŒ‰é’®åï¼Œå¯¹æ–‡æœ¬æ¡†çš„èšç„¦ï¼Œä¼šå‘ç°æ˜¯å®ç°åŠŸèƒ½ä¸Šå…ˆåé€»è¾‘é¡ºåºçš„é—®é¢˜å¯¼è‡´æ— æ³•å®ç°çš„ï¼Œæˆ‘æƒ³åˆ°çš„æ˜¯ç”¨ä¸€ä¸ªsetTimeoutå‡½æ•°å»¶æ—¶æ‰§è¡Œï¼Œä¹Ÿèƒ½å®ç°ï¼Œä½†æ˜¯åŠŸèƒ½å®ç”¨æ€§ä¸å¼ºå°±æ˜¯äº†ï¼ŒnextTickå°±èƒ½å¾ˆå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨ä¸‹ä¸€æ¬¡DOMæ›´æ–°ç»“æŸåæ‰§è¡Œï¼Œå­¦ä¹ çŠ¶æ€è¿˜ä¸é”™ã€‚</p></blockquote><h1 id="Vuex">Vuex</h1><h2 id="å­¦ä¹ æ—¥æœŸ-3-20">å­¦ä¹ æ—¥æœŸ: 3.20</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-12">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><h3 id="1-æ¦‚å¿µ">1.æ¦‚å¿µ</h3><p>â€‹ åœ¨Vueä¸­å®ç°é›†ä¸­å¼çŠ¶æ€ï¼ˆæ•°æ®ï¼‰ç®¡ç†çš„ä¸€ä¸ªVueæ’ä»¶ï¼Œå¯¹vueåº”ç”¨ä¸­å¤šä¸ªç»„ä»¶çš„å…±äº«çŠ¶æ€è¿›è¡Œé›†ä¸­å¼çš„ç®¡ç†ï¼ˆè¯»/å†™ï¼‰ï¼Œä¹Ÿæ˜¯ä¸€ç§ç»„ä»¶é—´é€šä¿¡çš„æ–¹å¼ï¼Œä¸”é€‚ç”¨äºä»»æ„ç»„ä»¶é—´é€šä¿¡ã€‚</p><h3 id="2-ä½¿ç”¨æƒ…å†µ">2.ä½¿ç”¨æƒ…å†µ</h3><p>â€‹ å¤šä¸ªç»„ä»¶éœ€è¦å…±äº«æ•°æ®æ—¶</p><h3 id="3-æ­å»ºvuexç¯å¢ƒ">3.æ­å»ºvuexç¯å¢ƒ</h3><ol><li><p>åˆ›å»ºæ–‡ä»¶ï¼š<code>src/store/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¼•å…¥Vueæ ¸å¿ƒåº“</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="comment">//å¼•å…¥Vuex</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="comment">//åº”ç”¨Vuexæ’ä»¶</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‡†å¤‡actionså¯¹è±¡â€”â€”å“åº”ç»„ä»¶ä¸­ç”¨æˆ·çš„åŠ¨ä½œ</span></span><br><span class="line"><span class="keyword">const</span> actions = &#123;&#125;</span><br><span class="line"><span class="comment">//å‡†å¤‡mutationså¯¹è±¡â€”â€”ä¿®æ”¹stateä¸­çš„æ•°æ®</span></span><br><span class="line"><span class="keyword">const</span> mutations = &#123;&#125;</span><br><span class="line"><span class="comment">//å‡†å¤‡stateå¯¹è±¡â€”â€”ä¿å­˜å…·ä½“çš„æ•°æ®</span></span><br><span class="line"><span class="keyword">const</span> state = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºå¹¶æš´éœ²store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">   actions,</span><br><span class="line">   mutations,</span><br><span class="line">   state</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>åœ¨<code>main.js</code>ä¸­åˆ›å»ºvmæ—¶ä¼ å…¥<code>store</code>é…ç½®é¡¹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line"><span class="comment">//å¼•å…¥store</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line">......</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºvm</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">   <span class="attr">el</span>:<span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">   <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>),</span><br><span class="line">   store</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ol><h3 id="4-åŸºæœ¬ä½¿ç”¨">4.åŸºæœ¬ä½¿ç”¨</h3><ol><li><p>åˆå§‹åŒ–æ•°æ®ã€é…ç½®<code>actions</code>ã€é…ç½®<code>mutations</code>ï¼Œæ“ä½œæ–‡ä»¶<code>store.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¼•å…¥Vueæ ¸å¿ƒåº“</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="comment">//å¼•å…¥Vuex</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="comment">//å¼•ç”¨Vuex</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">    <span class="comment">//å“åº”ç»„ä»¶ä¸­åŠ çš„åŠ¨ä½œ</span></span><br><span class="line">   <span class="title function_">jia</span>(<span class="params">context,value</span>)&#123;</span><br><span class="line">      <span class="comment">// console.log(&#x27;actionsä¸­çš„jiaè¢«è°ƒç”¨äº†&#x27;,miniStore,value)</span></span><br><span class="line">      context.<span class="title function_">commit</span>(<span class="string">&#x27;JIA&#x27;</span>,value)</span><br><span class="line">   &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">    <span class="comment">//æ‰§è¡ŒåŠ </span></span><br><span class="line">   <span class="title function_">JIA</span>(<span class="params">state,value</span>)&#123;</span><br><span class="line">      <span class="comment">// console.log(&#x27;mutationsä¸­çš„JIAè¢«è°ƒç”¨äº†&#x27;,state,value)</span></span><br><span class="line">      state.<span class="property">sum</span> += value</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆå§‹åŒ–æ•°æ®</span></span><br><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">   <span class="attr">sum</span>:<span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºå¹¶æš´éœ²store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">   actions,</span><br><span class="line">   mutations,</span><br><span class="line">   state,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>ç»„ä»¶ä¸­è¯»å–vuexä¸­çš„æ•°æ®ï¼š<code>$store.state.sum</code></p></li><li><p>ç»„ä»¶ä¸­ä¿®æ”¹vuexä¸­çš„æ•°æ®ï¼š<code>$store.dispatch('actionä¸­çš„æ–¹æ³•å',æ•°æ®)</code> æˆ– <code>$store.commit('mutationsä¸­çš„æ–¹æ³•å',æ•°æ®)</code></p><blockquote><p>å¤‡æ³¨ï¼šè‹¥æ²¡æœ‰ç½‘ç»œè¯·æ±‚æˆ–å…¶ä»–ä¸šåŠ¡é€»è¾‘ï¼Œç»„ä»¶ä¸­ä¹Ÿå¯ä»¥è¶Šè¿‡actionsï¼Œå³ä¸å†™<code>dispatch</code>ï¼Œç›´æ¥ç¼–å†™<code>commit</code></p></blockquote></li></ol><h3 id="5-gettersçš„ä½¿ç”¨">5.gettersçš„ä½¿ç”¨</h3><ol><li><p>æ¦‚å¿µï¼šå½“stateä¸­çš„æ•°æ®éœ€è¦ç»è¿‡åŠ å·¥åå†ä½¿ç”¨æ—¶ï¼Œå¯ä»¥ä½¿ç”¨gettersåŠ å·¥ã€‚</p></li><li><p>åœ¨<code>store.js</code>ä¸­è¿½åŠ <code>getters</code>é…ç½®</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line">   <span class="title function_">bigSum</span>(<span class="params">state</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> state.<span class="property">sum</span> * <span class="number">10</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºå¹¶æš´éœ²store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">   ......</span><br><span class="line">   getters</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>ç»„ä»¶ä¸­è¯»å–æ•°æ®ï¼š<code>$store.getters.bigSum</code></p></li></ol><h3 id="6-å››ä¸ªmapæ–¹æ³•çš„ä½¿ç”¨">6.å››ä¸ªmapæ–¹æ³•çš„ä½¿ç”¨</h3><ol><li><p><strong>mapStateæ–¹æ³•ï¼š</strong>ç”¨äºå¸®åŠ©æˆ‘ä»¬æ˜ å°„<code>state</code>ä¸­çš„æ•°æ®ä¸ºè®¡ç®—å±æ€§</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="comment">//å€ŸåŠ©mapStateç”Ÿæˆè®¡ç®—å±æ€§ï¼šsumã€schoolã€subjectï¼ˆå¯¹è±¡å†™æ³•ï¼‰</span></span><br><span class="line">     ...<span class="title function_">mapState</span>(&#123;<span class="attr">sum</span>:<span class="string">&#x27;sum&#x27;</span>,<span class="attr">school</span>:<span class="string">&#x27;school&#x27;</span>,<span class="attr">subject</span>:<span class="string">&#x27;subject&#x27;</span>&#125;),</span><br><span class="line">         </span><br><span class="line">    <span class="comment">//å€ŸåŠ©mapStateç”Ÿæˆè®¡ç®—å±æ€§ï¼šsumã€schoolã€subjectï¼ˆæ•°ç»„å†™æ³•ï¼‰</span></span><br><span class="line">    ...<span class="title function_">mapState</span>([<span class="string">&#x27;sum&#x27;</span>,<span class="string">&#x27;school&#x27;</span>,<span class="string">&#x27;subject&#x27;</span>]),</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></li><li><p><strong>mapGettersæ–¹æ³•ï¼š</strong>ç”¨äºå¸®åŠ©æˆ‘ä»¬æ˜ å°„<code>getters</code>ä¸­çš„æ•°æ®ä¸ºè®¡ç®—å±æ€§</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="comment">//å€ŸåŠ©mapGettersç”Ÿæˆè®¡ç®—å±æ€§ï¼šbigSumï¼ˆå¯¹è±¡å†™æ³•ï¼‰</span></span><br><span class="line">    ...<span class="title function_">mapGetters</span>(&#123;<span class="attr">bigSum</span>:<span class="string">&#x27;bigSum&#x27;</span>&#125;),</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å€ŸåŠ©mapGettersç”Ÿæˆè®¡ç®—å±æ€§ï¼šbigSumï¼ˆæ•°ç»„å†™æ³•ï¼‰</span></span><br><span class="line">    ...<span class="title function_">mapGetters</span>([<span class="string">&#x27;bigSum&#x27;</span>])</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></li><li><p><strong>mapActionsæ–¹æ³•ï¼š</strong>ç”¨äºå¸®åŠ©æˆ‘ä»¬ç”Ÿæˆä¸<code>actions</code>å¯¹è¯çš„æ–¹æ³•ï¼Œå³ï¼šåŒ…å«<code>$store.dispatch(xxx)</code>çš„å‡½æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>:&#123;</span><br><span class="line">    <span class="comment">//é mapActionsç”Ÿæˆï¼šincrementOddã€incrementWaitï¼ˆå¯¹è±¡å½¢å¼ï¼‰</span></span><br><span class="line">    ...<span class="title function_">mapActions</span>(&#123;<span class="attr">incrementOdd</span>:<span class="string">&#x27;jiaOdd&#x27;</span>,<span class="attr">incrementWait</span>:<span class="string">&#x27;jiaWait&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é mapActionsç”Ÿæˆï¼šincrementOddã€incrementWaitï¼ˆæ•°ç»„å½¢å¼ï¼‰</span></span><br><span class="line">    ...<span class="title function_">mapActions</span>([<span class="string">&#x27;jiaOdd&#x27;</span>,<span class="string">&#x27;jiaWait&#x27;</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>mapMutationsæ–¹æ³•ï¼š</strong>ç”¨äºå¸®åŠ©æˆ‘ä»¬ç”Ÿæˆä¸<code>mutations</code>å¯¹è¯çš„æ–¹æ³•ï¼Œå³ï¼šåŒ…å«<code>$store.commit(xxx)</code>çš„å‡½æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>:&#123;</span><br><span class="line">    <span class="comment">//é mapActionsç”Ÿæˆï¼šincrementã€decrementï¼ˆå¯¹è±¡å½¢å¼ï¼‰</span></span><br><span class="line">    ...<span class="title function_">mapMutations</span>(&#123;<span class="attr">increment</span>:<span class="string">&#x27;JIA&#x27;</span>,<span class="attr">decrement</span>:<span class="string">&#x27;JIAN&#x27;</span>&#125;),</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//é mapMutationsç”Ÿæˆï¼šJIAã€JIANï¼ˆå¯¹è±¡å½¢å¼ï¼‰</span></span><br><span class="line">    ...<span class="title function_">mapMutations</span>([<span class="string">&#x27;JIA&#x27;</span>,<span class="string">&#x27;JIAN&#x27;</span>]),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><blockquote><p>å¤‡æ³¨ï¼šmapActionsä¸mapMutationsä½¿ç”¨æ—¶ï¼Œè‹¥éœ€è¦ä¼ é€’å‚æ•°éœ€è¦ï¼šåœ¨æ¨¡æ¿ä¸­ç»‘å®šäº‹ä»¶æ—¶ä¼ é€’å¥½å‚æ•°ï¼Œå¦åˆ™å‚æ•°æ˜¯äº‹ä»¶å¯¹è±¡ã€‚</p></blockquote><h2 id="æ‰©å±•å­¦ä¹ -5">æ‰©å±•å­¦ä¹ </h2><h3 id="æ¨¡å—åŒ–-å‘½åç©ºé—´">æ¨¡å—åŒ–+å‘½åç©ºé—´</h3><ol><li><p>ç›®çš„ï¼šè®©ä»£ç æ›´å¥½ç»´æŠ¤ï¼Œè®©å¤šç§æ•°æ®åˆ†ç±»æ›´åŠ æ˜ç¡®ã€‚</p></li><li><p>ä¿®æ”¹<code>store.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> countAbout = &#123;</span><br><span class="line">  <span class="attr">namespaced</span>:<span class="literal">true</span>,<span class="comment">//å¼€å¯å‘½åç©ºé—´</span></span><br><span class="line">  <span class="attr">state</span>:&#123;<span class="attr">x</span>:<span class="number">1</span>&#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123; ... &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123; ... &#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="title function_">bigSum</span>(<span class="params">state</span>)&#123;</span><br><span class="line">       <span class="keyword">return</span> state.<span class="property">sum</span> * <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> personAbout = &#123;</span><br><span class="line">  <span class="attr">namespaced</span>:<span class="literal">true</span>,<span class="comment">//å¼€å¯å‘½åç©ºé—´</span></span><br><span class="line">  <span class="attr">state</span>:&#123; ... &#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123; ... &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">modules</span>: &#123;</span><br><span class="line">    countAbout,</span><br><span class="line">    personAbout</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>å¼€å¯å‘½åç©ºé—´åï¼Œç»„ä»¶ä¸­è¯»å–stateæ•°æ®ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ–¹å¼ä¸€ï¼šè‡ªå·±ç›´æ¥è¯»å–</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">state</span>.<span class="property">personAbout</span>.<span class="property">list</span></span><br><span class="line"><span class="comment">//æ–¹å¼äºŒï¼šå€ŸåŠ©mapStateè¯»å–ï¼š</span></span><br><span class="line">...<span class="title function_">mapState</span>(<span class="string">&#x27;countAbout&#x27;</span>,[<span class="string">&#x27;sum&#x27;</span>,<span class="string">&#x27;school&#x27;</span>,<span class="string">&#x27;subject&#x27;</span>]),</span><br></pre></td></tr></table></figure></li><li><p>å¼€å¯å‘½åç©ºé—´åï¼Œç»„ä»¶ä¸­è¯»å–gettersæ•°æ®ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ–¹å¼ä¸€ï¼šè‡ªå·±ç›´æ¥è¯»å–</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">getters</span>[<span class="string">&#x27;personAbout/firstPersonName&#x27;</span>]</span><br><span class="line"><span class="comment">//æ–¹å¼äºŒï¼šå€ŸåŠ©mapGettersè¯»å–ï¼š</span></span><br><span class="line">...<span class="title function_">mapGetters</span>(<span class="string">&#x27;countAbout&#x27;</span>,[<span class="string">&#x27;bigSum&#x27;</span>])</span><br></pre></td></tr></table></figure></li><li><p>å¼€å¯å‘½åç©ºé—´åï¼Œç»„ä»¶ä¸­è°ƒç”¨dispatch</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ–¹å¼ä¸€ï¼šè‡ªå·±ç›´æ¥dispatch</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;personAbout/addPersonWang&#x27;</span>,person)</span><br><span class="line"><span class="comment">//æ–¹å¼äºŒï¼šå€ŸåŠ©mapActionsï¼š</span></span><br><span class="line">...<span class="title function_">mapActions</span>(<span class="string">&#x27;countAbout&#x27;</span>,&#123;<span class="attr">incrementOdd</span>:<span class="string">&#x27;jiaOdd&#x27;</span>,<span class="attr">incrementWait</span>:<span class="string">&#x27;jiaWait&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure></li><li><p>å¼€å¯å‘½åç©ºé—´åï¼Œç»„ä»¶ä¸­è°ƒç”¨commit</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ–¹å¼ä¸€ï¼šè‡ªå·±ç›´æ¥commit</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">commit</span>(<span class="string">&#x27;personAbout/ADD_PERSON&#x27;</span>,person)</span><br><span class="line"><span class="comment">//æ–¹å¼äºŒï¼šå€ŸåŠ©mapMutationsï¼š</span></span><br><span class="line">...<span class="title function_">mapMutations</span>(<span class="string">&#x27;countAbout&#x27;</span>,&#123;<span class="attr">increment</span>:<span class="string">&#x27;JIA&#x27;</span>,<span class="attr">decrement</span>:<span class="string">&#x27;JIAN&#x27;</span>&#125;),</span><br></pre></td></tr></table></figure></li></ol><h2 id="æ—¥æ€»ç»“-12">æ—¥æ€»ç»“</h2><blockquote><p>ä»Šå¤©çš„å­¦ä¹ å†…å®¹æ˜¯vuexï¼Œæ„Ÿè§‰å®ƒçš„åŠŸèƒ½å°±æ˜¯åƒæ˜¯ä¸€ä¸ªJavaä¸­çš„staticï¼Œè®¾ç½®å…¨å±€å˜é‡æˆ–è€…å…¨å±€æ–¹æ³•ï¼Œæ¯”ä¹‹å‰çš„ç»„ä»¶é—´é€šè®¯éƒ½å¥½ç”¨ï¼Œæµç¨‹æ¢³ç†æ˜ç™½æŒæ¡èµ·æ¥ä¹Ÿä¸éš¾ï¼Œæœ‰å¤æ‚è®¡ç®—é€»è¾‘çš„éœ€è¦æ”¾Mutationsä¸­ï¼Œæ™®é€šçš„å°±æ”¾actionsä¸­å°±è¡Œï¼Œæ‰€æœ‰å¯ä»¥ä½¿ç”¨è®¡ç®—å±æ€§çš„ï¼Œéƒ½å¯ä»¥ç”¨mapstateï¼Œæ¨¡å—åŒ–æ˜¯ç®—æ‰©å±•äº†ï¼Œä¹Ÿä¸ç®—å¾ˆéš¾ï¼Œä»¥åä¸ºäº†è§„èŒƒæ€§ä»¥åŠä»£ç å¯è¯»æ€§ï¼Œä¼°è®¡è¿˜æ˜¯ä½¿ç”¨vuexæ¨¡å—åŒ–çš„æ¯”è¾ƒå¤šã€‚</p></blockquote><h1 id="mysqlæ•°æ®å¯¼å…¥">mysqlæ•°æ®å¯¼å…¥</h1><h2 id="å­¦ä¹ æ—¥æœŸ-3-22">å­¦ä¹ æ—¥æœŸ: 3.22</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-13">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><h3 id="å°†å°ç™½æ ·é¢˜æ•°æ®å¯¼å…¥">å°†å°ç™½æ ·é¢˜æ•°æ®å¯¼å…¥</h3><p>source /opt/ds_db01.sqlï¼Œå‘ç°æœ‰ä¸‰ä¸ªè¡¨æŠ¥é”™äº†ï¼Œè§£å†³äº†æŒºä¹…çš„bugï¼Œå› ä¸ºsqlæ–‡ä»¶æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥å¯¼å…¥æˆ–è€…ä¿®æ”¹çš„æ—¶å€™ä¼šå¾ˆå¡ï¼Œè€Œä¸”è¿Ÿè¿Ÿä¸èƒ½æˆåŠŸã€‚æ‰“å¼€ä»¥åï¼Œæ…¢æ…¢æ‰¾åˆ›å»ºè¡¨è¯­å¥ï¼Œå†æ…¢æ…¢ä¿®æ”¹ã€‚</p><h2 id="BUGç‚¹-8">BUGç‚¹</h2><blockquote><p>å¯¼å…¥æ•°æ®çš„æ—¶å€™å‡ºç°çš„bugï¼Œå¯¼å…¥å°ç™½æ ·é¢˜çš„æ—¶å€™ï¼Œå‘ç°åªæœ‰20è¡¨ï¼Œç¼ºå¤±äº†ä¸‰ä¸ªè¡¨ï¼Œæ‰“å¼€sqlçš„æºæ–‡ä»¶ï¼Œå•ç‹¬åˆ›è¡¨ï¼Œå‘ç°å‡ºç°äº†æŠ¥é”™ã€‚æœç´¢ä»¥åå‘ç°æ˜¯timestampç±»å‹çš„ä¸èƒ½è¶…è¿‡ä¸¤ä¸ªdefaultï¼ŒåŸå› æ˜¯å½“ä½ ç»™ä¸€ä¸ªtimestampè®¾ç½®ä¸ºon updatecurrent_timestampçš„æ—¶å€™ï¼Œå…¶ä»–çš„timestampå­—æ®µéœ€è¦æ˜¾å¼è®¾å®šdefaultå€¼ã€‚å¦‚æœä½ æœ‰ä¸¤ä¸ªtimestampå­—æ®µï¼Œä½†æ˜¯åªæŠŠç¬¬ä¸€ä¸ªè®¾å®šä¸ºcurrent_timestampè€Œç¬¬äºŒä¸ªæ²¡æœ‰è®¾å®šé»˜è®¤å€¼ï¼Œ<a target="_blank" rel="noopener" href="http://lib.csdn.net/base/mysql">MySQL</a>èƒ½æˆåŠŸå»ºè¡¨,ä½†æ˜¯åè¿‡æ¥å°±ä¸è¡Œ,éœ€è¦æŠŠä¹‹å‰çš„æ”¹æˆdatetimeï¼Œåé¢nullçš„éƒ½åˆ é™¤ï¼ŒBUGå°±è§£å†³äº†ã€‚</p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/202303221756608.png" alt="image-20230322175615853"></p><h2 id="æ—¥æ€»ç»“-13">æ—¥æ€»ç»“</h2><blockquote><p>ä»Šå¤©ä¸Šåˆå…ˆæ˜¯åšäº†å‡ é“è“æ¡¥æ¯çš„é¢˜ç›®ï¼Œæœ‰é“å¡«ç©ºé¢˜ï¼Œæ˜¯ç›´æ¥æ‹¿è‰ç¨¿çº¸æ¨ç®—çš„ã€‚ä¸‹åˆçš„æ—¶å€™çœ‹äº†ä¸€ä¸‹å°ç™½çš„æ ·é¢˜ï¼Œå‘ç°ä¹‹å‰çš„sqlæ–‡ä»¶æ˜¯æœ‰ç‚¹å°bugçš„ï¼Œæ— æ³•å¯¼å…¥ï¼Œæœ‰ä¸¤ä¸ªè¡¨æ˜¯æœ‰bugçš„ï¼Œä¸€ä¸‹åˆè§£å†³äº†bugï¼Œç„¶ååˆ†æäº†ä¸€ä¸‹ä»»åŠ¡ä¹¦ï¼Œæ™šä¸Šå°†å¹³æ—¶è®­ç»ƒçš„è®¡åˆ’è§„åˆ’äº†ä¸€ä¸‹ã€‚</p></blockquote><h1 id="æµ‹è¯•æ–°é•œåƒè¿æ¥">æµ‹è¯•æ–°é•œåƒè¿æ¥</h1><h2 id="å­¦ä¹ æ—¥æœŸ-3-23">å­¦ä¹ æ—¥æœŸ: 3.23</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-14">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><p>ä¸‹è½½é•œåƒå¯¼å…¥VMï¼Œå¯åŠ¨hadoopé›†ç¾¤ä»¥åŠhiveå…ƒæ•°æ®ï¼Œä¸€åˆ‡é¡ºåˆ©ã€‚</p><h2 id="BUGç‚¹-9">BUGç‚¹</h2><p>ä»Šå¤©ä½¿ç”¨IDEAæµ‹è¯•è¿æ¥çš„æ—¶å€™æŠ¥é”™äº†ï¼Œä¹‹å‰å‡ºç°è¿‡è¿™ç§æŠ¥é”™ä¹Ÿæ²¡æ‰¾åˆ°åŸå› ï¼Œæˆ‘è®¤ä¸ºå°±æ˜¯mariadbçš„é—®é¢˜ã€‚é‡æ–°æ”¾å…¥é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹hostsä¸­çš„ipæ˜ å°„éƒ½ä¸è¡Œï¼Œå°±ç®—äº†ï¼Œæœ‰æ—¶å€™å°±æ˜¯ä¼šçªç„¶åä¸€ä¸‹ï¼Œè¿™å‡ å¤©éƒ½æ²¡å…³æœºä»€ä¹ˆéƒ½æ²¡å¹²ï¼Œç›´æ¥åœ¨sparkä¸­è·‘ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œè€Œä¸”æ¯”ideaè¦å¿«å¾ˆå¤šã€‚</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230323095003966.png" alt="image-20230323095003966"></p><h2 id="æ‰©å±•å­¦ä¹ -6">æ‰©å±•å­¦ä¹ </h2><h3 id="ç¼–å·468">ç¼–å·468</h3><p>å›æ–‡æ—¥æœŸ</p><blockquote><p>é¢˜ç›®å¾ˆæ¸…æ™°æ˜äº†ï¼Œä½†æ˜¯éœ€è¦è®¨è®ºçš„ç‰¹æ®Šæ¡ä»¶æ¯”è¾ƒå¤šã€‚å°±æ˜¯æ—¥æœŸè§„èŒƒæ€§ï¼Œæ¯ä¸ªæœˆæ¯ä¸ªå¤©æ•°ä¸ä¸€æ ·ï¼Œè¿˜æœ‰æ—¥æœŸå¼€å¤´ä¸ä¸º0ï¼Œå­¦ä»½12æœˆä»¥å†…ï¼Œä¸å¯ä¸º0ï¼Œç­‰ç­‰ã€‚åœ¨æˆ‘æœ€åˆçš„ç‰ˆæœ¬éƒ½æ˜¯æœ‰ä¸€æ¡ä¸€æ¡ifè§„èŒƒå‡ºæ¥çš„ã€‚åæ¥ä¼˜åŒ–ç®—æ³•çš„æ—¶å€™ï¼Œå‘ç°æœ‰äº›æµ‹è¯•ç‚¹ï¼Œè“æ¡¥æ¯æ˜¯æ²¡æœ‰è®¾ç½®ä¸€äº›ç‰¹æ®Šæ£€æŸ¥ç‚¹çš„æ‰€ä»¥åƒ30å¤©å’Œ28 29è¿™ç§ç‰¹æ®Šæœˆã€‚æ‰€ä»¥åé¢é—°æœˆå’Œ2æœˆéƒ½æ²¡ç”¨æ·»åŠ åˆ¤æ–­è¯­å¥ï¼Œä½†æ˜¯ä¹Ÿé¡ºåˆ©é€šè¿‡äº†ï¼Œè€—æ—¶æœ‰ç‚¹ä¹…ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="comment">// 1:æ— éœ€package</span></span><br><span class="line"><span class="comment">// 2: ç±»åå¿…é¡»Main, ä¸å¯ä¿®æ”¹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="comment">//åœ¨æ­¤è¾“å…¥æ‚¨çš„ä»£ç ...</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> scan.nextInt();</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> N+<span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">99999999</span>;</span><br><span class="line">        <span class="keyword">while</span>(i&lt;=<span class="number">99999999</span>)&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">num</span> <span class="operator">=</span> i+<span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">yearage</span>  <span class="operator">=</span> i/<span class="number">1000000</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">fanzhuanyearage</span> <span class="operator">=</span> yearage/<span class="number">10</span>+yearage%<span class="number">10</span>*<span class="number">10</span>;<span class="comment">//åè½¬day</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">yearlaster</span>  <span class="operator">=</span> i%<span class="number">1000000</span>/<span class="number">10000</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">fanzhuanyearlaster</span>  <span class="operator">=</span> yearlaster/<span class="number">10</span>+yearlaster%<span class="number">10</span>*<span class="number">10</span>; <span class="comment">//åè½¬month</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">month</span> <span class="operator">=</span> i%<span class="number">10000</span>/<span class="number">100</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">day</span>   <span class="operator">=</span> i%<span class="number">100</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">lastday</span> <span class="operator">=</span> i%<span class="number">10</span>; <span class="comment">//æœ€åä¸€å¤©ä¸èƒ½ä¸º0 å› ä¸ºåè½¬ä»¥åé¦–ä¸ä¸º0</span></span><br><span class="line">            <span class="keyword">if</span>(month &lt;= <span class="number">12</span> &amp;&amp;  day &lt;= <span class="number">31</span> &amp;&amp;  lastday != <span class="number">0</span> &amp;&amp; fanzhuanyearage&lt;=<span class="number">31</span> &amp;&amp; fanzhuanyearlaster&lt;=<span class="number">12</span> &amp;&amp; fanzhuanyearlaster != <span class="number">0</span>)&#123;</span><br><span class="line">              <span class="keyword">if</span>(huiwen(num))&#123;</span><br><span class="line">                 <span class="comment">//è®¾ç½®å›æ–‡ ä¸ºç¬¬ä¸€ä¸ª  </span></span><br><span class="line">                <span class="keyword">if</span>(res &gt; Integer.parseInt(num))&#123;</span><br><span class="line">                    res = Integer.parseInt(num);</span><br><span class="line">                    System.out.println(num);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//å¦‚æœä¸ºABå›æ–‡ç›´æ¥åœæ­¢</span></span><br><span class="line">                <span class="keyword">if</span>(ABhuiwen(num))&#123;</span><br><span class="line">                    System.out.println(num);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        scan.close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ¤æ–­é—°å¹´</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">ruiyear</span><span class="params">(String num)</span>&#123;</span><br><span class="line">      <span class="type">int</span> <span class="variable">year</span> <span class="operator">=</span> Integer.parseInt(num);</span><br><span class="line">      <span class="keyword">return</span> (year % <span class="number">4</span> == <span class="number">0</span> &amp;&amp; year % <span class="number">100</span> != <span class="number">0</span>) || year % <span class="number">400</span> == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ¤æ–­å›æ–‡æ•°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">huiwen</span><span class="params">(String num)</span>&#123;</span><br><span class="line">      <span class="type">char</span>[] c  = num.toCharArray();</span><br><span class="line">      <span class="keyword">return</span> c[<span class="number">0</span>] == c[<span class="number">7</span>] &amp;&amp; c[<span class="number">1</span>] == c[<span class="number">6</span>] &amp;&amp; c[<span class="number">2</span>] == c[<span class="number">5</span>] &amp;&amp; c[<span class="number">3</span>] == c[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ¤æ–­ABå›æ–‡æ•°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">ABhuiwen</span><span class="params">(String num)</span>&#123;</span><br><span class="line">      <span class="type">char</span>[] c  = num.toCharArray();</span><br><span class="line">      <span class="keyword">return</span> c[<span class="number">0</span>] == c[<span class="number">2</span>] &amp;&amp; c[<span class="number">2</span>] == c[<span class="number">5</span>] &amp;&amp; c[<span class="number">5</span>] == c[<span class="number">7</span>] &amp;&amp; c[<span class="number">1</span>] == c[<span class="number">3</span>] &amp;&amp; c[<span class="number">3</span>] == c[<span class="number">4</span>] &amp;&amp; c[<span class="number">4</span>] == c[<span class="number">6</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ—¥æ€»ç»“-14">æ—¥æ€»ç»“</h2><blockquote><p>ä»Šå¤©çš„ä¸»è¦ä»»åŠ¡æ˜¯è®¾ç½®å¤§æ•°æ®çš„å­¦ä¹ è®¡åˆ’ï¼Œå¹³æ—¶ç»ƒä¹ çš„è®¡åˆ’ï¼Œç„¶åå¯¼å…¥äº†æ•°æ®åº“ï¼Œç„¶åå¯¼å…¥äº†æ–°çš„é•œåƒï¼Œå‘ç°é‡Œé¢æ˜¯è‡ªå¸¦æ•°æ®çš„ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œsoftwareçš„å®‰è£…ä½ç½®éƒ½æ”¹å˜äº†ï¼Œåœ¨IDEAä¸­éœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚hive hdfs å’Œcoreï¼Œyarnæ˜¯ä¸éœ€è¦çš„ï¼Œ æ™šä¸Šåšäº†ç®—æ³•é¢˜ï¼Œåšé¢˜è¿˜æ˜¯å¾ˆé¡ºåˆ©çš„ï¼Œä½†æ˜¯æœ‰ä¸ªä»»åŠ¡ç‚¹ä¸€ç›´æ— æ³•é€šè¿‡ï¼Œä¼˜åŒ–äº†ç®—æ³•ï¼ŒèŠ‚çœäº†ä¸å¿…è¦çš„ç©ºé—´ã€‚</p></blockquote><h1 id="Sparkæ¶æ„ä»¥åŠé›†ç¾¤æ­å»º">Sparkæ¶æ„ä»¥åŠé›†ç¾¤æ­å»º</h1><h2 id="å­¦ä¹ æ—¥æœŸ-3-24">å­¦ä¹ æ—¥æœŸ: 3.24</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-15">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><h3 id="Sparkç†è®º">Sparkç†è®º</h3><p>Sparkèµ„æºè°ƒåº¦ç­–ç•¥ï¼Œä¹‹å‰sparkå†…å­˜çˆ†ç‚¸è¿‡ã€‚çœ‹å†…å®¹æ˜¯æœ‰è°ƒä¼˜ç­–ç•¥çš„ï¼Œä¸»è¦åŸå› æ˜¯CPUèµ„æºå ç”¨æ»¡äº†ï¼Œç”µè„‘çš„i5 3ä»£å¤ªåƒå®äº†ï¼Œä¹‹å‰ä¹Ÿä½¿ç”¨è¿‡sparkçš„è°ƒåº¦ç¨‹åºï¼Œè¿˜æ˜¯çˆ†äº†ï¼Œæœ€åæ˜¯é€šè¿‡é‡å¯hadoopæœåŠ¡æˆåŠŸçš„ã€‚</p><h2 id="BUGç‚¹-10">BUGç‚¹</h2><p>æŠ¥é”™ä¿¡æ¯ä¸ºæˆªå›¾ï¼Œä½†æ˜¯è®°ä½äº†ã€‚java.sql.SQLException: null, message from server: â€œHost â€˜XXXâ€˜ is not allowed to connectå¼‚å¸¸ã€‚æ˜¯mysqlæ‹’ç»äº†æˆ‘çš„è¯¥ç½‘æ®µçš„é“¾æ¥ï¼Œæ˜¯å› ä¸ºmysqlä¸­rootç”¨æˆ·åªå…è®¸æœ¬åœ°è¿æ¥å’Œ å›ç¯åœ°å€ï¼Œä¹‹å‰IDEAæ— æ³•ç›´æ¥è¿è¡Œçš„BUGä¹Ÿç®—æ˜¯è§£å†³äº†ã€‚</p><p>è§£å†³æ­¥éª¤ï¼š</p><blockquote><p>use mysql;<br>select user,host from user;<br>update user set host = â€˜%â€™ where user = â€˜rootâ€™;<br>flush privileges; --åˆ·æ–°æƒé™</p></blockquote><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230324103006317.png" alt="image-20230324103006317"></p><h2 id="æ—¥æ€»ç»“-15">æ—¥æ€»ç»“</h2><blockquote><p>ä»Šå¤©çš„ä»»åŠ¡æ˜¯çœ‹å°ç™½çš„sparkæ•™ç¨‹ï¼ŒåŸºç¡€éƒ¨åˆ†ï¼Œè‡ªå·±åŸºæœ¬éƒ½å­¦è¿‡ï¼Œå°±å½“è¿‡äº†ä¸€éï¼Œåœ¨ch02å¼€å‘å’Œéƒ¨ç½²çš„å®æˆ˜éƒ¨åˆ†ï¼Œæˆ‘å°±ç›´æ¥æŠŠæ ·é¢˜æ•°æ®ä»mysqlå¯¼å…¥hiveä¸­å»äº†ï¼Œå½“å®æ“ï¼Œç”¨savetableï¼Œå¯ä»¥ç›´æ¥è‡ªåŠ¨åˆ›å»ºè¡¨ï¼Œå¾€hiveä¸­åŠ å…¥äº†éƒ¨åˆ†å‡æ•°æ®ï¼ŒåŸºç¡€éƒ¨åˆ†æ„Ÿè§‰åªæœ‰èµ„æºè°ƒåº¦é‚£è¾¹æ˜¯æœ‰ç‚¹ç”¨çš„ï¼Œå…¶ä»–éƒ½æ˜¯å‘å±•å²ã€‚</p></blockquote><h1 id="Sparkæ ¸å¿ƒç¼–ç¨‹RDD">Sparkæ ¸å¿ƒç¼–ç¨‹RDD</h1><h2 id="å­¦ä¹ æ—¥æœŸ-3-25">å­¦ä¹ æ—¥æœŸ: 3.25</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-16">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><h3 id="Sparké›†åˆæ–¹æ³•">Sparké›†åˆæ–¹æ³•</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ„é€ è¿™ä¸¤ä¸ªRDD å……å½“å‡æ•°æ®</span></span><br><span class="line"><span class="keyword">val</span> rdd1 = sc.parallelize(<span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>))</span><br><span class="line">rdd1.collect</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> rdd2 = sc.parallelize(<span class="type">List</span>(<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>))</span><br><span class="line">rdd2.collect</span><br></pre></td></tr></table></figure><h4 id="union-otherDataset">union(otherDataset)</h4><p>åˆå¹¶ä¸¤ä¸ªrddï¼Œå¹¶é›†ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> rdd3 = rdd1.union(rdd2)</span><br><span class="line">rdd3.collect</span><br></pre></td></tr></table></figure><h4 id="intersection-otherDataset">intersection(otherDataset)</h4><p>äº¤é›†ã€‚åªä¿ç•™åœ¨ä¸¤ä¸ªrddä¸­éƒ½æœ‰çš„å…ƒç´ ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> rdd4 = rdd1.intersection(rdd2)</span><br><span class="line">rdd4.collect</span><br></pre></td></tr></table></figure><h4 id="subtractè½¬æ¢">subtractè½¬æ¢</h4><p>å·®é›†ã€‚åªä¿ç•™åœ¨ç¬¬ä¸€ä¸ªrddä¸­æœ‰è€Œåœ¨ç¬¬äºŒä¸ªrddä¸­æ²¡æœ‰çš„å…ƒç´ ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> rdd5 = rdd1.subtract(rdd2)</span><br><span class="line">rdd5.collect</span><br></pre></td></tr></table></figure><h4 id="cartesian-otherDataset">cartesian(otherDataset)</h4><p>ä¸¤ä¸ªrddçš„ç¬›å¡å°”é›†ã€‚</p><p>å½“åœ¨ç±»å‹ä¸ºTå’ŒUçš„RDDä¸Šè°ƒç”¨æ—¶ï¼Œè¿”å›ä¸€ä¸ª(T, U)å¯¹(æ‰€æœ‰å…ƒç´ å¯¹)çš„RDDã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> rdd6 = rdd1.cartesian(rdd2)</span><br><span class="line">rdd6.collect</span><br></pre></td></tr></table></figure><h2 id="BUGç‚¹-11">BUGç‚¹</h2><p>å­¦ä¹ é¡ºåˆ©æ²¡BUG</p><h2 id="æ‰©å±•å­¦ä¹ -7">æ‰©å±•å­¦ä¹ </h2><p>å­¦ä¹ äº†actionéƒ¨åˆ†å¯¹è¡¨è½¬æ¢æˆrddä»¥åçš„æ“ä½œå‡½æ•°è¿˜æ˜¯æœ‰å¾ˆå¤šå€¼å¾—å­¦ä¹ </p><h3 id="actionæ“ä½œå‡½æ•°">actionæ“ä½œå‡½æ•°</h3><ul><li><p>reduce(func)</p><p>ä½¿ç”¨å‡½æ•°func(æ¥å—ä¸¤ä¸ªå‚æ•°å¹¶è¿”å›ä¸€ä¸ªå‚æ•°)èšåˆæ•°æ®é›†çš„å…ƒç´ ã€‚è¿™ä¸ªå‡½æ•°åº”è¯¥æ˜¯äº¤æ¢å¾‹å’Œç»“åˆå¾‹ï¼Œè¿™æ ·æ‰èƒ½å¹¶è¡Œåœ°æ­£ç¡®åœ°è®¡ç®—å®ƒã€‚</p></li><li><p>collect()</p><p>å°†RDDæ“ä½œçš„æ‰€æœ‰ç»“æœè¿”å›ç»™é©±åŠ¨ç¨‹åºã€‚è¿™é€šå¸¸å¯¹äº§ç”Ÿè¶³å¤Ÿå°çš„æ•°æ®é›†çš„æ“ä½œå¾ˆæœ‰ç”¨ã€‚</p></li><li><p>count()</p><p>è¿™ä¼šè¿”å›æ•°æ®é›†ä¸­çš„å…ƒç´ æ•°é‡æˆ–RDDæ“ä½œçš„ç»“æœè¾“å‡ºã€‚</p></li><li><p>first()</p><p>è¿”å›æ•°æ®é›†çš„ç¬¬ä¸€ä¸ªå…ƒç´ æˆ–RDDæ“ä½œäº§ç”Ÿçš„ç»“æœè¾“å‡ºã€‚å®ƒçš„å·¥ä½œåŸç†ç±»ä¼¼äºtake(1)å‡½æ•°ã€‚</p></li><li><p>take(n)</p><p>è¿”å›RDDçš„å‰nä¸ªå…ƒç´ ã€‚å®ƒé¦–å…ˆæ‰«æä¸€ä¸ªåˆ†åŒºï¼Œç„¶åä½¿ç”¨è¯¥åˆ†åŒºçš„ç»“æœæ¥ä¼°è®¡æ»¡è¶³è¯¥é™åˆ¶æ‰€éœ€çš„å…¶ä»–åˆ†åŒºçš„æ•°é‡ã€‚è¿™ä¸ªæ–¹æ³•åº”è¯¥åªåœ¨é¢„æœŸå¾—åˆ°çš„æ•°ç»„å¾ˆå°çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œå› ä¸ºæ‰€æœ‰çš„æ•°æ®éƒ½åŠ è½½åˆ°é©±åŠ¨ç¨‹åºçš„å†…å­˜ä¸­ã€‚</p></li><li><p>top(n)</p><p>æŒ‰ç…§æŒ‡å®šçš„éšå¼æ’åº[T]ä»è¿™ä¸ªRDDä¸­å–å‡ºæœ€å¤§çš„kä¸ªå…ƒç´ ï¼Œå¹¶ç»´æŠ¤æ’åºã€‚è¿™ä¸takeOrderedç›¸åã€‚è¿™ä¸ªæ–¹æ³•åº”è¯¥åªåœ¨é¢„æœŸå¾—åˆ°çš„æ•°ç»„å¾ˆå°çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œå› ä¸ºæ‰€æœ‰çš„æ•°æ®éƒ½åŠ è½½åˆ°é©±åŠ¨ç¨‹åºçš„å†…å­˜ä¸­ã€‚</p></li><li><p>takeOrdered(n)</p><p>è¿”å›RDDçš„å‰nä¸ªï¼ˆæœ€å°çš„ï¼‰å…ƒç´ ï¼Œå¹¶ç»´æŠ¤æ’åºã€‚è¿™å’Œtopæ˜¯ç›¸åçš„ã€‚è¿™ä¸ªæ–¹æ³•åº”è¯¥åªåœ¨é¢„æœŸå¾—åˆ°çš„æ•°ç»„å¾ˆå°çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œå› ä¸ºæ‰€æœ‰çš„æ•°æ®éƒ½åŠ è½½åˆ°é©±åŠ¨ç¨‹åºçš„å†…å­˜ä¸­ã€‚</p></li><li><p>saveAsTextFile(path)</p><p>å°†æ•°æ®é›†çš„å…ƒç´ ä½œä¸ºæ–‡æœ¬æ–‡ä»¶(æˆ–æ–‡æœ¬æ–‡ä»¶é›†)å†™å…¥æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€HDFSæˆ–ä»»ä½•å…¶ä»–hadoopæ”¯æŒçš„æ–‡ä»¶ç³»ç»Ÿçš„ç»™å®šç›®å½•ä¸­ã€‚Sparkå°†å¯¹æ¯ä¸ªå…ƒç´ è°ƒç”¨toStringï¼Œå°†å…¶è½¬æ¢ä¸ºæ–‡ä»¶ä¸­çš„ä¸€è¡Œæ–‡æœ¬ã€‚</p></li><li><p>countByKey()</p><p>ä»…åœ¨ç±»å‹(K, V)çš„RDDsä¸Šå¯ç”¨ã€‚è¿”å›(K, Int)å¯¹çš„hashmapå’Œæ¯ä¸ªé”®çš„è®¡æ•°ã€‚</p></li><li><p>foreach(func)</p><p>åœ¨æ•°æ®é›†çš„æ¯ä¸ªå…ƒç´ ä¸Šè¿è¡Œå‡½æ•°funcã€‚</p></li></ul><h2 id="æ—¥æ€»ç»“-16">æ—¥æ€»ç»“</h2><blockquote><p>å¤ä¹ ä½¿ç”¨äº†sparkä¸­çš„RDDç¼–ç¨‹ï¼Œé›†åˆéƒ¨åˆ†æ„Ÿè§‰å¯¹å¤§æ•°æ®å¤„ç†è¡¨æ•°æ®çš„æ—¶å€™è¿˜æ˜¯æœ‰å¸®åŠ©çš„ï¼Œç„¶åè‡ªå·±çœ‹äº†ä»¥å‰å­¦æœŸscalaæ—¶å€™ï¼Œä¸­sparkçš„RDDå’Œscalaä¸­çš„æ–¹æ³•ï¼Œç»“åˆå°ç™½ä¹¦è‹‘è¿˜æ˜¯æœ‰å¾ˆå¤šå¯¹äºRDDæ–¹æ³•çš„æå‡å’Œç†è§£çš„ï¼Œä½¿ç”¨sqlç¼–ç¨‹ï¼Œå’ŒRDDä¸€èµ·ä½¿ç”¨å¹¶ç‹¬ç«‹å®Œæˆäº†RDDçš„æ¡ˆä¾‹ã€‚</p></blockquote><h1 id="SparkSQLç¼–ç¨‹">SparkSQLç¼–ç¨‹</h1><h2 id="å­¦ä¹ æ—¥æœŸ-3-27-3-28">å­¦ä¹ æ—¥æœŸ: 3.27-3.28</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-17">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><blockquote><p>å› ä¸º27å·sqléƒ¨åˆ†åŸºç¡€æ‰€å­¦çš„å†…å®¹æ¯”è¾ƒç®€å•æ²¡ä»€ä¹ˆå¯ä»¥å€¼å¾—è®°å¾—ï¼Œ28å·å­¦ä¹ çš„sqlé«˜çº§æœ‰äº›éœ€è¦è®°ç¬”è®°çš„éƒ¨åˆ†ï¼Œå› æ­¤å°†ä¸¤å¤©çš„æ‰€å­¦å†…å®¹æ”¾åˆ°ä¸€èµ·ã€‚</p></blockquote><h3 id="Spark-SQLå†…ç½®å‡½æ•°">Spark SQLå†…ç½®å‡½æ•°</h3><p>SQLå‡½æ•°å¤§è‡´åˆ†ä¸ºå››ç±»:</p><ul><li>æ ‡é‡å‡½æ•°ï¼šæ¯ä¸€è¡Œè¿”å›å•ä¸ªçš„å€¼ã€‚</li><li>èšåˆå‡½æ•°ï¼šæ¯ä¸€ç»„è¡Œè¿”å›å•ä¸ªçš„å€¼ã€‚</li><li>çª—å£å‡½æ•°ï¼šæ¯ä¸€ç»„è¡Œè¿”å›å¤šä¸ªå€¼ã€‚</li><li>ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼ˆUDFï¼‰ï¼šåŒ…æ‹¬è‡ªå®šä¹‰çš„æ ‡é‡å‡½æ•°æˆ–èšåˆå‡½æ•°ã€‚</li></ul><p>æ ‡é‡å’Œèšåˆå‡½æ•°åœ¨sparkçš„å†…ç½®æ–¹æ³•åŒ…ä¸­ï¼Œä½¿ç”¨éœ€è¦å¯¼å…¥åŒ…</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.functions._ <span class="comment">//(_é€šé…ï¼Œå°†functionsæ‰€æœ‰æ–¹æ³•éƒ½å¯¼å…¥)</span></span><br></pre></td></tr></table></figure><p>å¸¸ç”¨çš„å†…ç½®å‡½æ•°è‡ªå·±åŸºæœ¬éƒ½ä½¿ç”¨è¿‡ï¼Œå°±å…ˆä¸ä¸€ä¸€åˆ—å‡ºæ¥äº†ï¼Œæ‰¾ä¸ªæ—¶é—´å…¨éƒ¨æ¢³ç†ä¸€ä¸‹ã€‚</p><h3 id="Spark-SQLèšåˆå‡½æ•°">Spark SQLèšåˆå‡½æ•°</h3><p>è¿™éƒ¨åˆ†åŸºæœ¬æ˜¯å’Œsqlä¸­çš„ä½¿ç”¨æ˜¯ä¸€æ ·çš„ï¼Œå‚æ•°ä¹Ÿä¸€æ ·ï¼Œå°±æ˜¯åˆ†ç»„èšåˆçš„å‡½æ•°ï¼ŒDSLé£æ ¼é€šè¿‡groupBy(col)è¿›è¡Œåˆ†ç»„ã€‚</p><table><thead><tr><th style="text-align:center">èšåˆå‡½æ•°</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">count(col)</td><td style="text-align:center">è¿”å›æ¯ç»„ä¸­æˆå‘˜æ•°é‡</td></tr><tr><td style="text-align:center">countDistinct(col)</td><td style="text-align:center">è¿”å›æ¯ç»„ä¸­æˆå‘˜å”¯ä¸€æ•°é‡</td></tr><tr><td style="text-align:center">approx_count_distinct(col)</td><td style="text-align:center">è¿”å›æ¯ç»„ä¸­æˆå‘˜å”¯ä¸€è¿‘ä¼¼æ•°é‡</td></tr><tr><td style="text-align:center">min(col)</td><td style="text-align:center">è¿”å›æ¯ç»„ä¸­ç»™å®šåˆ—çš„æœ€å°å€¼</td></tr><tr><td style="text-align:center">max(col)</td><td style="text-align:center">è¿”å›æ¯ç»„ä¸­ç»™å®šåˆ—çš„æœ€å¤§å€¼</td></tr><tr><td style="text-align:center">sum(col)</td><td style="text-align:center">è¿”å›æ¯ç»„ä¸­ç»™å®šåˆ—çš„å€¼çš„å’Œ</td></tr><tr><td style="text-align:center">sumDistinct(col)</td><td style="text-align:center">è¿”å›æ¯ç»„ä¸­ç»™å®šåˆ—çš„å”¯ä¸€å€¼çš„å’Œ</td></tr><tr><td style="text-align:center">avg(col)</td><td style="text-align:center">è¿”å›æ¯ç»„ä¸­ç»™å®šåˆ—çš„å€¼çš„å¹³å‡</td></tr><tr><td style="text-align:center">skewness(col)</td><td style="text-align:center">è¿”å›æ¯ç»„ä¸­ç»™å®šåˆ—çš„å€¼çš„åˆ†å¸ƒçš„åæ–œåº¦</td></tr><tr><td style="text-align:center">kurtosis(col)</td><td style="text-align:center">è¿”å›æ¯ç»„ä¸­ç»™å®šåˆ—çš„å€¼çš„åˆ†å¸ƒçš„å³°åº¦</td></tr><tr><td style="text-align:center">variance(col)</td><td style="text-align:center">è¿”å›æ¯ç»„ä¸­ç»™å®šåˆ—çš„å€¼çš„æ— åæ–¹å·®</td></tr><tr><td style="text-align:center">stddev(col)</td><td style="text-align:center">è¿”å›æ¯ç»„ä¸­ç»™å®šåˆ—çš„å€¼çš„æ ‡å‡†å·®</td></tr><tr><td style="text-align:center">collect_list(col)</td><td style="text-align:center">è¿”å›æ¯ç»„ä¸­ç»™å®šåˆ—çš„å€¼çš„é›†åˆã€‚è¿”å›çš„é›†åˆå¯èƒ½åŒ…å«é‡å¤çš„å€¼</td></tr><tr><td style="text-align:center">collect_set(col)</td><td style="text-align:center">è¿”å›æ¯ç»„ä¸­ç»™å®šåˆ—çš„å”¯ä¸€å€¼çš„é›†åˆ</td></tr></tbody></table><h3 id="æ•°æ®ç¼ºå¤±å€¼å¤„ç†">æ•°æ®ç¼ºå¤±å€¼å¤„ç†</h3><p>æ¯”å¦‚dfè¡¨å¦‚ä¸‹:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230328195221944.png" alt="image-20230328195221944"></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ds1.na.drop().show() <span class="comment">//åˆ é™¤ç¼ºå¤±å€¼çš„è¡Œ æœ‰nullçš„éƒ½åˆ é™¤</span></span><br><span class="line">ds1.na.drop(minNonNulls=<span class="number">2</span>).show() <span class="comment">//åˆ é™¤ç¼ºå¤±å€¼æœ‰ä¸¤ä¸ªåŠä»¥ä¸Šçš„è¡Œ</span></span><br><span class="line">ds1.na.fill(<span class="string">&quot;ä¸è¯¦&quot;</span>).show() <span class="comment">//å°†æ‰€æœ‰nullå€¼å¡«å……ä¸ºä¸è¯¦</span></span><br><span class="line">ds1.na.fill(<span class="type">Map</span>(<span class="string">&quot;dynasty&quot;</span>-&gt;<span class="string">&quot;--&quot;</span>, <span class="string">&quot;dob&quot;</span>-&gt;<span class="string">&quot;ä¸è¯¦&quot;</span>)).show() <span class="comment">//dynastyåˆ—å¡«å……ä¸º-- dobä¸ºä¸è¯¦</span></span><br></pre></td></tr></table></figure><p>æ–°æ•°æ®å¦‚ä¸‹ï¼ŒéªŒè¯å»é‡å‡½æ•°<br><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/ch04_null_06.png" alt="img"></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ds1.dropDuplicates().show() <span class="comment">//å®Œå…¨é‡å¤çš„è¡Œåˆ é™¤ æ³¨æ„ç¬¬2å’Œ4ä¸ä¸€æ ·ï¼Œä¸€ä¸ªæ¸…æœä¸€ä¸ªæ¸…ä»£</span></span><br><span class="line">ds1.dropDuplicates(<span class="string">&quot;name&quot;</span>).show() <span class="comment">//åˆ é™¤æŒ‡å®šçš„åˆ—é‡å¤çš„è¡Œï¼ˆåŸºäºä¸€ä¸ªåˆ—çš„å­é›†åˆ é™¤é‡å¤ï¼‰</span></span><br><span class="line">ds1.dropDuplicates(<span class="type">Array</span>(<span class="string">&quot;dynasty&quot;</span>,<span class="string">&quot;dob&quot;</span>)).show() <span class="comment">//åˆ é™¤dynastyå’Œdobéƒ½é‡å¤çš„è¡Œ</span></span><br></pre></td></tr></table></figure><h2 id="BUGç‚¹-12">BUGç‚¹</h2><p>å®‰è£…ä½¿ç”¨Vue3ä¸­çš„viteåˆå§‹åŒ–vueé¡¹ç›®ç»“æŸä»¥åï¼Œéœ€è¦npm iè£…æ’ä»¶çš„æ—¶å€™æŠ¥é”™äº†ï¼Œåˆ†ææŠ¥é”™ä¿¡æ¯æ˜¯npmç‰ˆæœ¬å¤ªä½äº†ï¼Œæœ‰äº›æ’ä»¶è£…ä¸äº†ï¼Œå› ä¸ºviteæ˜¯æ¯”è¾ƒæ–°çš„æ„å»ºé¡¹ç›®çš„ä¸€ç§æ–¹å¼ï¼Œæ¯”è¾ƒè½»é‡åŒ–å¤§å°æ¯”è¾ƒå°ï¼Œé€Ÿåº¦ä¹Ÿå¿«äº†ä¸æ­¢ä¸€å€ï¼Œåœ¨é¡¹ç›®è¶Šå¤§ä¸­å’Œå¸¸è§„åˆå§‹åŒ–çš„å·®è·è¶Šæ˜æ˜¾ã€‚</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230328200035204.png" alt="image-20230328200035204"></p><h2 id="æ‰©å±•å­¦ä¹ -8">æ‰©å±•å­¦ä¹ </h2><h3 id="è“æ¡¥æ¯-123">è“æ¡¥æ¯ 123</h3><p>è¿™é¢˜ä¸»è¦ç”¨åˆ°äºŒåˆ†ä»¥åŠæ•°æ®ç´¯åŠ ï¼Œéš¾åº¦ä¸€èˆ¬ï¼Œæ˜å¤©æ‰“ç®—ä¼˜åŒ–ä¼˜åŒ–ç®—æ³•å†ç ”ç©¶ç ”ç©¶ã€‚</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230328202738987.png" alt="image-20230328202738987"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     a[i] = a[i-1] + i  å‰iä¸ªåŒºé—´çš„ä¸ªæ•°ä¹‹å’Œ</span></span><br><span class="line"><span class="comment">     s[i] = s[i-1] + i  içš„å‰ç¼€å’Œ</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">maxLen</span> <span class="operator">=</span> <span class="number">1414215</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span>[] a = <span class="keyword">new</span> <span class="title class_">long</span>[maxLen];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span>[] s = <span class="keyword">new</span> <span class="title class_">long</span>[maxLen];</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="comment">//åœ¨æ­¤è¾“å…¥æ‚¨çš„ä»£ç ...\</span></span><br><span class="line">        a[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; maxLen; i++) &#123;</span><br><span class="line">            a[i] = a[i-<span class="number">1</span>] + i;</span><br><span class="line">        &#125;</span><br><span class="line">        s[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; maxLen; i++) &#123;</span><br><span class="line">            s[i] = s[i-<span class="number">1</span>] + a[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> scan.nextInt();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">l</span> <span class="operator">=</span> scan.nextLong();</span><br><span class="line">            <span class="type">long</span> <span class="variable">r</span> <span class="operator">=</span> scan.nextLong();</span><br><span class="line">            System.out.println(preSum(r) - preSum(l-<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        scan.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">long</span> <span class="title function_">preSum</span><span class="params">(<span class="type">long</span> num)</span> &#123;</span><br><span class="line">        <span class="comment">//æ‰¾åˆ°numå¤„åœ¨å“ªä¸ªåŒºé—´</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> <span class="number">0</span>,r = maxLen;</span><br><span class="line">        <span class="type">int</span> mid;</span><br><span class="line">        <span class="keyword">while</span> (l&lt;r)&#123;</span><br><span class="line">            mid = (l+r+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (a[mid] &gt; num)&#123;</span><br><span class="line">                r = mid - <span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> l = mid ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s[l] + a[(<span class="type">int</span>) (num - a[l])];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ—¥æ€»ç»“-17">æ—¥æ€»ç»“</h2><h3 id="27æ—¥">27æ—¥</h3><blockquote><p>ä»Šå¤©å­¦ä¹ æ—¶é—´åªæœ‰ä¸Šåˆéƒ¨åˆ†ï¼Œè¿˜å¥½è¿™ä¸ªæ—¶é—´å­¦ä¹ çš„å†…å®¹ä¸æ˜¯å¾ˆéš¾ï¼ŒSparkSQLè‡ªå·±å·²ç»æ˜¯éå¸¸ç†Ÿæ‚‰äº†ï¼Œå¯¹DFçš„åˆ›å»ºä»¥åŠæ“ä½œï¼ŒåŸºç¡€éƒ¨åˆ†æ²¡ä»€ä¹ˆéš¾åº¦ï¼Œæ¡ˆä¾‹ä¹Ÿæ²¡æœ‰å¿…è¦å»åšäº†ã€‚ä»Šå¤©çš„å­¦ä¹ çŠ¶æ€ä¹Ÿè¿˜å¯ä»¥ï¼Œæ˜å¤©å­¦é«˜çº§éƒ¨åˆ†çœ‹èƒ½ä¸èƒ½å­¦ä¹ åˆ°æœ‰ç”¨çš„ä¸œè¥¿</p></blockquote><h3 id="28æ—¥">28æ—¥</h3><blockquote><p>å¤§æ•°æ®è®­ç»ƒéƒ¨åˆ†:ä»Šå¤©ä¸Šåˆå­¦ä¹ çš„å¤§æ•°æ®,SparkSQLé«˜çº§éƒ¨åˆ†æ‰€èƒ½å­¦åˆ°çš„ä¸œè¥¿è¿˜æ˜¯å¬è¿‡çš„ï¼Œæ¯”å¦‚è‡ªå®šä¹‰sqlå‡½æ•°ï¼Œä»¥åŠå¦‚ä½•å¤„ç†å­—æ®µä¸ºnullçš„æ•°æ®ï¼Œåˆ é™¤æˆ–è€…æ›¿æ¢ï¼Œè¿˜æœ‰å»é‡ç›¸åŒçš„æ•°æ®ï¼Œéƒ½æ˜¯æœ‰æ–¹æ³•çš„ã€‚åŸºæœ¬è¿™ä¸€ç« çš„å†…å®¹å°±æ˜¯å¯¹sqlä¸­é«˜çº§çš„å‡½æ•°çš„è®²è§£ä»¥åŠå¦‚ä½•ä½¿ç”¨,å¤§åŠéƒ¨åˆ†æ˜¯å¯¹dslé£æ ¼çš„è®²è§£ï¼Œå› ä¸ºä¹‹å‰å­¦è¿‡ä¸€æ®µæ—¶é—´äº†ï¼Œå‰å‡ å¤©ä¹Ÿç€é‡å¤ä¹ äº†ï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†å¯¹è‡ªå·±æ²¡ä»€ä¹ˆéš¾åº¦ã€‚</p></blockquote><h1 id="Vueè·¯ç”±-é‡ç‚¹">Vueè·¯ç”±(é‡ç‚¹)</h1><h2 id="å­¦ä¹ æ—¥æœŸï¼š3-29">å­¦ä¹ æ—¥æœŸï¼š3.29</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-18">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><ol><li>ç†è§£ï¼š ä¸€ä¸ªè·¯ç”±ï¼ˆrouteï¼‰å°±æ˜¯ä¸€ç»„æ˜ å°„å…³ç³»ï¼ˆkey - valueï¼‰ï¼Œå¤šä¸ªè·¯ç”±éœ€è¦è·¯ç”±å™¨ï¼ˆrouterï¼‰è¿›è¡Œç®¡ç†ã€‚</li><li>å‰ç«¯è·¯ç”±ï¼škeyæ˜¯è·¯å¾„ï¼Œvalueæ˜¯ç»„ä»¶ã€‚</li></ol><h3 id="1-åŸºæœ¬ä½¿ç”¨">1.åŸºæœ¬ä½¿ç”¨</h3><ol><li><p>å®‰è£…vue-routerï¼Œå‘½ä»¤ï¼š<code>npm i vue-router</code></p></li><li><p>åº”ç”¨æ’ä»¶ï¼š<code>Vue.use(VueRouter)</code></p></li><li><p>ç¼–å†™routeré…ç½®é¡¹:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¼•å…¥VueRouter</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">VueRouter</span> <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="comment">//å¼•å…¥Luyou ç»„ä»¶</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">About</span> <span class="keyword">from</span> <span class="string">&#x27;../components/About&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;../components/Home&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºrouterå®ä¾‹å¯¹è±¡ï¼Œå»ç®¡ç†ä¸€ç»„ä¸€ç»„çš„è·¯ç”±è§„åˆ™</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">VueRouter</span>(&#123;</span><br><span class="line">	<span class="attr">routes</span>:[</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">path</span>:<span class="string">&#x27;/about&#x27;</span>,</span><br><span class="line">			<span class="attr">component</span>:<span class="title class_">About</span></span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">path</span>:<span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line">			<span class="attr">component</span>:<span class="title class_">Home</span></span><br><span class="line">		&#125;</span><br><span class="line">	]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//æš´éœ²router</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure></li><li><p>å®ç°åˆ‡æ¢ï¼ˆactive-classå¯é…ç½®é«˜äº®æ ·å¼ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link active-class=&quot;active&quot; to=&quot;/about&quot;&gt;About&lt;/router-link&gt;</span><br></pre></td></tr></table></figure></li><li><p>æŒ‡å®šå±•ç¤ºä½ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-view&gt;&lt;/router-view&gt;</span><br></pre></td></tr></table></figure></li></ol><h3 id="2-å‡ ä¸ªæ³¨æ„ç‚¹">2.å‡ ä¸ªæ³¨æ„ç‚¹</h3><ol><li>è·¯ç”±ç»„ä»¶é€šå¸¸å­˜æ”¾åœ¨<code>pages</code>æ–‡ä»¶å¤¹ï¼Œä¸€èˆ¬ç»„ä»¶é€šå¸¸å­˜æ”¾åœ¨<code>components</code>æ–‡ä»¶å¤¹ã€‚</li><li>é€šè¿‡åˆ‡æ¢ï¼Œâ€œéšè—â€äº†çš„è·¯ç”±ç»„ä»¶ï¼Œé»˜è®¤æ˜¯è¢«é”€æ¯æ‰çš„ï¼Œéœ€è¦çš„æ—¶å€™å†å»æŒ‚è½½ã€‚</li><li>æ¯ä¸ªç»„ä»¶éƒ½æœ‰è‡ªå·±çš„<code>$route</code>å±æ€§ï¼Œé‡Œé¢å­˜å‚¨ç€è‡ªå·±çš„è·¯ç”±ä¿¡æ¯ã€‚</li><li>æ•´ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ªrouterï¼Œå¯ä»¥é€šè¿‡ç»„ä»¶çš„<code>$router</code>å±æ€§è·å–åˆ°ã€‚</li></ol><h3 id="3-å¤šçº§è·¯ç”±ï¼ˆå¤šçº§è·¯ç”±ï¼‰">3.å¤šçº§è·¯ç”±ï¼ˆå¤šçº§è·¯ç”±ï¼‰</h3><ol><li><p>é…ç½®è·¯ç”±è§„åˆ™ï¼Œä½¿ç”¨childrené…ç½®é¡¹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">routes</span>:[</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="attr">path</span>:<span class="string">&#x27;/about&#x27;</span>,</span><br><span class="line">		<span class="attr">component</span>:<span class="title class_">About</span>,</span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="attr">path</span>:<span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line">		<span class="attr">component</span>:<span class="title class_">Home</span>,</span><br><span class="line">		<span class="attr">children</span>:[ <span class="comment">//é€šè¿‡childrené…ç½®å­çº§è·¯ç”±</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="attr">path</span>:<span class="string">&#x27;news&#x27;</span>, <span class="comment">//æ­¤å¤„ä¸€å®šä¸è¦å†™ï¼š/news</span></span><br><span class="line">				<span class="attr">component</span>:<span class="title class_">News</span></span><br><span class="line">			&#125;,</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="attr">path</span>:<span class="string">&#x27;message&#x27;</span>,<span class="comment">//æ­¤å¤„ä¸€å®šä¸è¦å†™ï¼š/message</span></span><br><span class="line">				<span class="attr">component</span>:<span class="title class_">Message</span></span><br><span class="line">			&#125;</span><br><span class="line">		]</span><br><span class="line">	&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure></li><li><p>è·³è½¬ï¼ˆè¦å†™å®Œæ•´è·¯å¾„ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link to=&quot;/home/news&quot;&gt;News&lt;/router-link&gt;</span><br></pre></td></tr></table></figure></li></ol><h3 id="4-è·¯ç”±çš„queryå‚æ•°">4.è·¯ç”±çš„queryå‚æ•°</h3><ol><li><p>ä¼ é€’å‚æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- è·³è½¬å¹¶æºå¸¦queryå‚æ•°ï¼Œtoçš„å­—ç¬¦ä¸²å†™æ³• --&gt;</span><br><span class="line">&lt;router-link :to=&quot;/home/message/detail?id=666&amp;title=ä½ å¥½&quot;&gt;è·³è½¬&lt;/router-link&gt;</span><br><span class="line">				</span><br><span class="line">&lt;!-- è·³è½¬å¹¶æºå¸¦queryå‚æ•°ï¼Œtoçš„å¯¹è±¡å†™æ³• --&gt;</span><br><span class="line">&lt;router-link </span><br><span class="line">	:to=&quot;&#123;</span><br><span class="line">		path:&#x27;/home/message/detail&#x27;,</span><br><span class="line">		query:&#123;</span><br><span class="line">		   id:666,</span><br><span class="line">            title:&#x27;ä½ å¥½&#x27;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;&quot;</span><br><span class="line">&gt;è·³è½¬&lt;/router-link&gt;</span><br></pre></td></tr></table></figure></li><li><p>æ¥æ”¶å‚æ•°ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$route.<span class="property">query</span>.<span class="property">id</span></span><br><span class="line">$route.<span class="property">query</span>.<span class="property">title</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="5-å‘½åè·¯ç”±">5.å‘½åè·¯ç”±</h3><ol><li><p>ä½œç”¨ï¼šå¯ä»¥ç®€åŒ–è·¯ç”±çš„è·³è½¬ã€‚</p></li><li><p>å¦‚ä½•ä½¿ç”¨</p><ol><li><p>ç»™è·¯ç”±å‘½åï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">path</span>:<span class="string">&#x27;/demo&#x27;</span>,</span><br><span class="line">	<span class="attr">component</span>:<span class="title class_">Demo</span>,</span><br><span class="line">	<span class="attr">children</span>:[</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">path</span>:<span class="string">&#x27;test&#x27;</span>,</span><br><span class="line">			<span class="attr">component</span>:<span class="title class_">Test</span>,</span><br><span class="line">			<span class="attr">children</span>:[</span><br><span class="line">				&#123;</span><br><span class="line">                      <span class="attr">name</span>:<span class="string">&#x27;hello&#x27;</span> <span class="comment">//ç»™è·¯ç”±å‘½å</span></span><br><span class="line">					<span class="attr">path</span>:<span class="string">&#x27;welcome&#x27;</span>,</span><br><span class="line">					<span class="attr">component</span>:<span class="title class_">Hello</span>,</span><br><span class="line">				&#125;</span><br><span class="line">			]</span><br><span class="line">		&#125;</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ç®€åŒ–è·³è½¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--ç®€åŒ–å‰ï¼Œéœ€è¦å†™å®Œæ•´çš„è·¯å¾„ --&gt;</span><br><span class="line">&lt;router-link to=&quot;/demo/test/welcome&quot;&gt;è·³è½¬&lt;/router-link&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--ç®€åŒ–åï¼Œç›´æ¥é€šè¿‡åå­—è·³è½¬ --&gt;</span><br><span class="line">&lt;router-link :to=&quot;&#123;name:&#x27;hello&#x27;&#125;&quot;&gt;è·³è½¬&lt;/router-link&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--ç®€åŒ–å†™æ³•é…åˆä¼ é€’å‚æ•° --&gt;</span><br><span class="line">&lt;router-link </span><br><span class="line">	:to=&quot;&#123;</span><br><span class="line">		name:&#x27;hello&#x27;,</span><br><span class="line">		query:&#123;</span><br><span class="line">		   id:666,</span><br><span class="line">            title:&#x27;ä½ å¥½&#x27;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;&quot;</span><br><span class="line">&gt;è·³è½¬&lt;/router-link&gt;</span><br></pre></td></tr></table></figure></li></ol></li></ol><h3 id="6-è·¯ç”±çš„paramså‚æ•°">6.è·¯ç”±çš„paramså‚æ•°</h3><ol><li><p>é…ç½®è·¯ç”±ï¼Œå£°æ˜æ¥æ”¶paramså‚æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">path</span>:<span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line">	<span class="attr">component</span>:<span class="title class_">Home</span>,</span><br><span class="line">	<span class="attr">children</span>:[</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">path</span>:<span class="string">&#x27;news&#x27;</span>,</span><br><span class="line">			<span class="attr">component</span>:<span class="title class_">News</span></span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">component</span>:<span class="title class_">Message</span>,</span><br><span class="line">			<span class="attr">children</span>:[</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="attr">name</span>:<span class="string">&#x27;xiangqing&#x27;</span>,</span><br><span class="line">					<span class="attr">path</span>:<span class="string">&#x27;detail/:id/:title&#x27;</span>, <span class="comment">//ä½¿ç”¨å ä½ç¬¦å£°æ˜æ¥æ”¶paramså‚æ•°</span></span><br><span class="line">					<span class="attr">component</span>:<span class="title class_">Detail</span></span><br><span class="line">				&#125;</span><br><span class="line">			]</span><br><span class="line">		&#125;</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä¼ é€’å‚æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- è·³è½¬å¹¶æºå¸¦paramså‚æ•°ï¼Œtoçš„å­—ç¬¦ä¸²å†™æ³• --&gt;</span><br><span class="line">&lt;router-link :to=&quot;/home/message/detail/666/ä½ å¥½&quot;&gt;è·³è½¬&lt;/router-link&gt;</span><br><span class="line">				</span><br><span class="line">&lt;!-- è·³è½¬å¹¶æºå¸¦paramså‚æ•°ï¼Œtoçš„å¯¹è±¡å†™æ³• --&gt;</span><br><span class="line">&lt;router-link </span><br><span class="line">	:to=&quot;&#123;</span><br><span class="line">		name:&#x27;xiangqing&#x27;,</span><br><span class="line">		params:&#123;</span><br><span class="line">		   id:666,</span><br><span class="line">            title:&#x27;ä½ å¥½&#x27;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;&quot;</span><br><span class="line">&gt;è·³è½¬&lt;/router-link&gt;</span><br></pre></td></tr></table></figure><blockquote><p>ç‰¹åˆ«æ³¨æ„ï¼šè·¯ç”±æºå¸¦paramså‚æ•°æ—¶ï¼Œè‹¥ä½¿ç”¨toçš„å¯¹è±¡å†™æ³•ï¼Œåˆ™ä¸èƒ½ä½¿ç”¨pathé…ç½®é¡¹ï¼Œå¿…é¡»ä½¿ç”¨nameé…ç½®ï¼</p></blockquote></li><li><p>æ¥æ”¶å‚æ•°ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$route.<span class="property">params</span>.<span class="property">id</span></span><br><span class="line">$route.<span class="property">params</span>.<span class="property">title</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="7-è·¯ç”±çš„propsé…ç½®">7.è·¯ç”±çš„propsé…ç½®</h3><p>â€‹ ä½œç”¨ï¼šè®©è·¯ç”±ç»„ä»¶æ›´æ–¹ä¾¿çš„æ”¶åˆ°å‚æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">name</span>:<span class="string">&#x27;xiangqing&#x27;</span>,</span><br><span class="line">	<span class="attr">path</span>:<span class="string">&#x27;detail/:id&#x27;</span>,</span><br><span class="line">	<span class="attr">component</span>:<span class="title class_">Detail</span>,</span><br><span class="line"></span><br><span class="line">	<span class="comment">//ç¬¬ä¸€ç§å†™æ³•ï¼špropså€¼ä¸ºå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸­æ‰€æœ‰çš„key-valueçš„ç»„åˆæœ€ç»ˆéƒ½ä¼šé€šè¿‡propsä¼ ç»™Detailç»„ä»¶</span></span><br><span class="line">	<span class="comment">// props:&#123;a:900&#125;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//ç¬¬äºŒç§å†™æ³•ï¼špropså€¼ä¸ºå¸ƒå°”å€¼ï¼Œå¸ƒå°”å€¼ä¸ºtrueï¼Œåˆ™æŠŠè·¯ç”±æ”¶åˆ°çš„æ‰€æœ‰paramså‚æ•°é€šè¿‡propsä¼ ç»™Detailç»„ä»¶</span></span><br><span class="line">	<span class="comment">// props:true</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//ç¬¬ä¸‰ç§å†™æ³•ï¼špropså€¼ä¸ºå‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›çš„å¯¹è±¡ä¸­æ¯ä¸€ç»„key-valueéƒ½ä¼šé€šè¿‡propsä¼ ç»™Detailç»„ä»¶</span></span><br><span class="line">	<span class="title function_">props</span>(<span class="params">route</span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			<span class="attr">id</span>:route.<span class="property">query</span>.<span class="property">id</span>,</span><br><span class="line">			<span class="attr">title</span>:route.<span class="property">query</span>.<span class="property">title</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="8-router-link-çš„replaceå±æ€§">8.<code>&lt;router-link&gt;</code>çš„replaceå±æ€§</h3><ol><li>ä½œç”¨ï¼šæ§åˆ¶è·¯ç”±è·³è½¬æ—¶æ“ä½œæµè§ˆå™¨å†å²è®°å½•çš„æ¨¡å¼</li><li>æµè§ˆå™¨çš„å†å²è®°å½•æœ‰ä¸¤ç§å†™å…¥æ–¹å¼ï¼šåˆ†åˆ«ä¸º<code>push</code>å’Œ<code>replace</code>ï¼Œ<code>push</code>æ˜¯è¿½åŠ å†å²è®°å½•ï¼Œ<code>replace</code>æ˜¯æ›¿æ¢å½“å‰è®°å½•ã€‚è·¯ç”±è·³è½¬æ—¶å€™é»˜è®¤ä¸º<code>push</code></li><li>å¦‚ä½•å¼€å¯<code>replace</code>æ¨¡å¼ï¼š<code>&lt;router-link replace .......&gt;News&lt;/router-link&gt;</code></li></ol><h3 id="9-ç¼–ç¨‹å¼è·¯ç”±å¯¼èˆª">9.ç¼–ç¨‹å¼è·¯ç”±å¯¼èˆª</h3><ol><li><p>ä½œç”¨ï¼šä¸å€ŸåŠ©<code>&lt;router-link&gt;</code> å®ç°è·¯ç”±è·³è½¬ï¼Œè®©è·¯ç”±è·³è½¬æ›´åŠ çµæ´»</p></li><li><p>å…·ä½“ç¼–ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//$routerçš„ä¸¤ä¸ªAPI</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">	<span class="attr">name</span>:<span class="string">&#x27;xiangqing&#x27;</span>,</span><br><span class="line">		<span class="attr">params</span>:&#123;</span><br><span class="line">			<span class="attr">id</span>:xxx,</span><br><span class="line">			<span class="attr">title</span>:xxx</span><br><span class="line">		&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">replace</span>(&#123;</span><br><span class="line">	<span class="attr">name</span>:<span class="string">&#x27;xiangqing&#x27;</span>,</span><br><span class="line">		<span class="attr">params</span>:&#123;</span><br><span class="line">			<span class="attr">id</span>:xxx,</span><br><span class="line">			<span class="attr">title</span>:xxx</span><br><span class="line">		&#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">forward</span>() <span class="comment">//å‰è¿›</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">back</span>() <span class="comment">//åé€€</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">go</span>() <span class="comment">//å¯å‰è¿›ä¹Ÿå¯åé€€</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="10-ç¼“å­˜è·¯ç”±ç»„ä»¶">10.ç¼“å­˜è·¯ç”±ç»„ä»¶</h3><ol><li><p>ä½œç”¨ï¼šè®©ä¸å±•ç¤ºçš„è·¯ç”±ç»„ä»¶ä¿æŒæŒ‚è½½ï¼Œä¸è¢«é”€æ¯ã€‚</p></li><li><p>å…·ä½“ç¼–ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;keep-alive include=&quot;News&quot;&gt; </span><br><span class="line">    &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">&lt;/keep-alive&gt;</span><br></pre></td></tr></table></figure></li></ol><h3 id="11-ä¸¤ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸé’©å­">11.ä¸¤ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸé’©å­</h3><ol><li>ä½œç”¨ï¼šè·¯ç”±ç»„ä»¶æ‰€ç‹¬æœ‰çš„ä¸¤ä¸ªé’©å­ï¼Œç”¨äºæ•è·è·¯ç”±ç»„ä»¶çš„æ¿€æ´»çŠ¶æ€ã€‚</li><li>å…·ä½“åå­—ï¼š<ol><li><code>activated</code>è·¯ç”±ç»„ä»¶è¢«æ¿€æ´»æ—¶è§¦å‘ã€‚</li><li><code>deactivated</code>è·¯ç”±ç»„ä»¶å¤±æ´»æ—¶è§¦å‘ã€‚</li></ol></li></ol><h3 id="12-è·¯ç”±å®ˆå«">12.è·¯ç”±å®ˆå«</h3><ol><li><p>ä½œç”¨ï¼šå¯¹è·¯ç”±è¿›è¡Œæƒé™æ§åˆ¶</p></li><li><p>åˆ†ç±»ï¼šå…¨å±€å®ˆå«ã€ç‹¬äº«å®ˆå«ã€ç»„ä»¶å†…å®ˆå«</p></li><li><p>å…¨å±€å®ˆå«:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å…¨å±€å‰ç½®å®ˆå«ï¼šåˆå§‹åŒ–æ—¶æ‰§è¡Œã€æ¯æ¬¡è·¯ç”±åˆ‡æ¢å‰æ‰§è¡Œ</span></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to,<span class="keyword">from</span>,next</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;beforeEach&#x27;</span>,to,<span class="keyword">from</span>)</span><br><span class="line">	<span class="keyword">if</span>(to.<span class="property">meta</span>.<span class="property">isAuth</span>)&#123; <span class="comment">//åˆ¤æ–­å½“å‰è·¯ç”±æ˜¯å¦éœ€è¦è¿›è¡Œæƒé™æ§åˆ¶</span></span><br><span class="line">		<span class="keyword">if</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;school&#x27;</span>) === <span class="string">&#x27;atguigu&#x27;</span>)&#123; <span class="comment">//æƒé™æ§åˆ¶çš„å…·ä½“è§„åˆ™</span></span><br><span class="line">			<span class="title function_">next</span>() <span class="comment">//æ”¾è¡Œ</span></span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="title function_">alert</span>(<span class="string">&#x27;æš‚æ— æƒé™æŸ¥çœ‹&#x27;</span>)</span><br><span class="line">			<span class="comment">// next(&#123;name:&#x27;guanyu&#x27;&#125;)</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="title function_">next</span>() <span class="comment">//æ”¾è¡Œ</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…¨å±€åç½®å®ˆå«ï¼šåˆå§‹åŒ–æ—¶æ‰§è¡Œã€æ¯æ¬¡è·¯ç”±åˆ‡æ¢åæ‰§è¡Œ</span></span><br><span class="line">router.<span class="title function_">afterEach</span>(<span class="function">(<span class="params">to,<span class="keyword">from</span></span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;afterEach&#x27;</span>,to,<span class="keyword">from</span>)</span><br><span class="line">	<span class="keyword">if</span>(to.<span class="property">meta</span>.<span class="property">title</span>)&#123; </span><br><span class="line">		<span class="variable language_">document</span>.<span class="property">title</span> = to.<span class="property">meta</span>.<span class="property">title</span> <span class="comment">//ä¿®æ”¹ç½‘é¡µçš„title</span></span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="variable language_">document</span>.<span class="property">title</span> = <span class="string">&#x27;vue_test&#x27;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>ç‹¬äº«å®ˆå«:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">beforeEnter</span>(<span class="params">to,<span class="keyword">from</span>,next</span>)&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;beforeEnter&#x27;</span>,to,<span class="keyword">from</span>)</span><br><span class="line">	<span class="keyword">if</span>(to.<span class="property">meta</span>.<span class="property">isAuth</span>)&#123; <span class="comment">//åˆ¤æ–­å½“å‰è·¯ç”±æ˜¯å¦éœ€è¦è¿›è¡Œæƒé™æ§åˆ¶</span></span><br><span class="line">		<span class="keyword">if</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;school&#x27;</span>) === <span class="string">&#x27;atguigu&#x27;</span>)&#123;</span><br><span class="line">			<span class="title function_">next</span>()</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="title function_">alert</span>(<span class="string">&#x27;æš‚æ— æƒé™æŸ¥çœ‹&#x27;</span>)</span><br><span class="line">			<span class="comment">// next(&#123;name:&#x27;guanyu&#x27;&#125;)</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="title function_">next</span>()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ç»„ä»¶å†…å®ˆå«ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿›å…¥å®ˆå«ï¼šé€šè¿‡è·¯ç”±è§„åˆ™ï¼Œè¿›å…¥è¯¥ç»„ä»¶æ—¶è¢«è°ƒç”¨</span></span><br><span class="line">beforeRouteEnter (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">//ç¦»å¼€å®ˆå«ï¼šé€šè¿‡è·¯ç”±è§„åˆ™ï¼Œç¦»å¼€è¯¥ç»„ä»¶æ—¶è¢«è°ƒç”¨</span></span><br><span class="line">beforeRouteLeave (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="13-è·¯ç”±å™¨çš„ä¸¤ç§å·¥ä½œæ¨¡å¼">13.è·¯ç”±å™¨çš„ä¸¤ç§å·¥ä½œæ¨¡å¼</h3><ol><li>å¯¹äºä¸€ä¸ªurlæ¥è¯´ï¼Œä»€ä¹ˆæ˜¯hashå€¼ï¼Ÿâ€”â€” #åŠå…¶åé¢çš„å†…å®¹å°±æ˜¯hashå€¼ã€‚</li><li>hashå€¼ä¸ä¼šåŒ…å«åœ¨ HTTP è¯·æ±‚ä¸­ï¼Œå³ï¼šhashå€¼ä¸ä¼šå¸¦ç»™æœåŠ¡å™¨ã€‚</li><li>hashæ¨¡å¼ï¼š<ol><li>åœ°å€ä¸­æ°¸è¿œå¸¦ç€#å·ï¼Œä¸ç¾è§‚ ã€‚</li><li>è‹¥ä»¥åå°†åœ°å€é€šè¿‡ç¬¬ä¸‰æ–¹æ‰‹æœºappåˆ†äº«ï¼Œè‹¥appæ ¡éªŒä¸¥æ ¼ï¼Œåˆ™åœ°å€ä¼šè¢«æ ‡è®°ä¸ºä¸åˆæ³•ã€‚</li><li>å…¼å®¹æ€§è¾ƒå¥½ã€‚</li></ol></li><li>historyæ¨¡å¼ï¼š<ol><li>åœ°å€å¹²å‡€ï¼Œç¾è§‚ ã€‚</li><li>å…¼å®¹æ€§å’Œhashæ¨¡å¼ç›¸æ¯”ç•¥å·®ã€‚</li><li>åº”ç”¨éƒ¨ç½²ä¸Šçº¿æ—¶éœ€è¦åç«¯äººå‘˜æ”¯æŒï¼Œè§£å†³åˆ·æ–°é¡µé¢æœåŠ¡ç«¯404çš„é—®é¢˜ã€‚</li></ol></li></ol><h2 id="æ€»ç»“">æ€»ç»“</h2><blockquote><p>è¿™ä¸¤å¤©æŠŠVueçš„é‡ä¸­ä¹‹é‡çš„è·¯ç”±å­¦å®Œäº†ï¼ŒåŸºæœ¬éƒ½æ˜¯æŒæ¡äº†ï¼Œå†…å®¹è¿˜æ˜¯æŒºå¤šçš„ï¼Œä½†æ˜¯æˆ‘è§‰å¾—ä¸æ˜¯å¾ˆéš¾ï¼Œä¹‹å‰ç»™é‡‘å¸ˆé™„å°æ¸²æŸ“çš„æ—¶å€™ï¼Œä¸»è¦æ¥è§¦çš„å°±æ˜¯è·¯ç”±ï¼Œæ‰€ä»¥æŒæ¡å°±æ²¡ä»€ä¹ˆéš¾åº¦ï¼Œæˆ‘çš„ç†è§£å°±æ˜¯é€šè¿‡è·¯ç”±å®ç°è·³è½¬ä¸åŒçš„ç»„ä»¶ï¼Œä¸ç”¨åˆ·æ–°é¡µé¢ï¼Œç„¶åå°±æ˜¯ç¼“å­˜ä»¥åŠå®ˆå«ï¼Œä¹Ÿæ˜¯æ¯”è¾ƒç®€å•ï¼Œå°±å‡ ä¸ªæ–¹æ³•å‡ ä¸ªå‚æ•°ï¼Œ</p></blockquote><h1 id="Vue3-é‡ç‚¹">Vue3(é‡ç‚¹)</h1><h2 id="å­¦ä¹ æ—¥æœŸï¼š3-30-3-31">å­¦ä¹ æ—¥æœŸï¼š3.30-3.31</h2><h2 id="æ‰€å­¦å†…å®¹æ¦‚è¿°-19">æ‰€å­¦å†…å®¹æ¦‚è¿°</h2><h3 id="åˆ›å»ºVue3-0">åˆ›å»ºVue3.0</h3><h4 id="vue-cliåˆ›å»º">vue-cliåˆ›å»º</h4><p>å’Œvue2ä¸€æ ·äº†é‚£å°±</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## æŸ¥çœ‹@vue/cliç‰ˆæœ¬ï¼Œç¡®ä¿@vue/cliç‰ˆæœ¬åœ¨4.5.0ä»¥ä¸Š</span></span><br><span class="line">vue --version</span><br><span class="line"><span class="comment">## å®‰è£…æˆ–è€…å‡çº§ä½ çš„@vue/cli</span></span><br><span class="line">npm install -g @vue/cli</span><br><span class="line"><span class="comment">## åˆ›å»º</span></span><br><span class="line">vue create vue_test</span><br><span class="line"><span class="comment">## å¯åŠ¨</span></span><br><span class="line"><span class="built_in">cd</span> vue_test</span><br><span class="line">npm run serve</span><br></pre></td></tr></table></figure><h4 id="viteåˆ›å»º-æ¨è">viteåˆ›å»º(æ¨è)</h4><p>è¿™ç§åˆ›å»ºçš„æ–¹å¼è¿è¡Œå’Œæ‰“åŒ…éƒ½ä¼šé«˜æ•ˆå¾ˆå¤šï¼Œç«¯å£å·å’Œæ™®é€šçš„ä¸ä¸€æ ·é»˜è®¤æ˜¯3000</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## åˆ›å»ºå·¥ç¨‹</span></span><br><span class="line">npm init vite-app &lt;project-name&gt;</span><br><span class="line"><span class="comment">## è¿›å…¥å·¥ç¨‹ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> &lt;project-name&gt;</span><br><span class="line"><span class="comment">## å®‰è£…ä¾èµ–</span></span><br><span class="line">npm install</span><br><span class="line"><span class="comment">## è¿è¡Œ</span></span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h3 id="Composition-API-é‡ç‚¹">Composition API(é‡ç‚¹)</h3><p>è¿™æ˜¯Vue3çš„é‡ä¸­ä¹‹é‡,å› ä¸ºå†…å®¹æ¯”è¾ƒå¤šï¼Œæ”¾ç½‘ç«™ä¸Šå»äº†ã€‚<a href="https://u7u7.top/posts/adf5c49.html%E4%B8%8B%E9%9D%A2vue3%E9%83%A8%E5%88%86">https://u7u7.top/posts/adf5c49.htmlä¸‹é¢vue3éƒ¨åˆ†</a></p><h2 id="æ€»ç»“-2">æ€»ç»“</h2><blockquote><p>èŠ±äº†ä¸¤ä¸‰å¤©çš„æ—¶é—´æŠŠVue3åŸºç¡€ç»™å­¦ä¹ äº†ï¼ŒVue3ç»™æˆ‘æœ€ç›´è§‚çš„æ”¹å˜å°±æ˜¯ä½¿ç”¨äº†composition APIæŠŠsetupä½œä¸ºèˆå°ï¼Œå°†åŸæ¥çš„vue2é‚£ç§æ•°æ®ä»¥åŠæ–¹æ³•åœ¨ä¸åŒç”Ÿå‘½å‘¨æœŸåœ°æ–¹ï¼Œä½¿ç”¨ä¸åŒçš„æ–¹æ³•ï¼Œéƒ½æ”¾åœ¨äº†setupä¸­ï¼Œæœ€ååªè¦returnå°±è¡Œäº†ï¼Œå’Œjavaå’Œpythonä¸­æ‰€å®šä¹‰çš„æ–¹æ³•ä¸€æ ·ï¼Œé‡Œé¢æœ‰å±æ€§ä»¥åŠä¸€äº›æ–¹æ³•ã€‚è€Œä¸”ä»£ç çœ‹èµ·æ¥èˆ’æœå¾ˆå¤šï¼Œå¯è¯»æ€§å¯¹æˆ‘è€Œè¨€å¼ºäº†ï¼Œä¸Šæ‰‹è¿˜æ˜¯è›®å¿«çš„ï¼Œä¹Ÿæ²¡ä»€ä¹ˆéš¾ç‚¹ï¼Œç”Ÿå‘½å‘¨æœŸéƒ¨åˆ†ä¹Ÿéå¸¸çš„çŸ¥åè§æ„ï¼Œæˆ‘è§‰å¾—vue3çš„setupè¿™æ ·çš„å†™æ³•è¿˜æ˜¯å¾ˆé€‚åˆæˆ‘çš„ã€‚è€Œä¸”åŸæœ¬Vue2ä¸­çš„è¯­æ³•åœ¨vue3ä¸­éƒ½æ˜¯å¯ä»¥ä½¿ç”¨çš„ï¼Œè™½ç„¶å®˜æ–¹ä¸å»ºè®®è¿™ä¹ˆåšï¼Œä½†æ˜¯ä¹Ÿèƒ½å†™èƒ½ç”¨ï¼Œå¦‚æœå’ŒVue3æœ‰å†²çªçš„åœ°æ–¹ï¼Œä¼šä»¥Vue3ä¸ºä¸»ï¼Œå› ä¸ºè‡ªå·±æ˜¯ä½¿ç”¨viteåˆ›å»ºçš„vue3å·¥ç¨‹ï¼Œnpm run devè·‘èµ·æ¥çœŸçš„æ¯”serveå¿«äº†å¾ˆå¤šï¼Œæ‰“åŒ…ä¹Ÿå¿«äº†ä¸å°‘ã€‚æˆ‘è§‰å¾—Vue3çš„æ ¸å¿ƒåº”è¯¥æ˜¯å“åº”å¼proxyï¼Œå±æ€§å€¼çš„è¯»å†™ã€å±æ€§çš„æ·»åŠ ã€å±æ€§çš„åˆ é™¤éƒ½å¯ä»¥é€šè¿‡proxyå®Œæˆï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºè¯¥ç‚¹ä¸ºæ ¸å¿ƒéƒ¨åˆ†ï¼Œè€Œä¸”åŸºæœ¬APIéƒ½ç¦»ä¸å¼€proxyã€‚</p></blockquote></article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>å¤§æ•°æ®23å¹´3æœˆç¬”è®°</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://u7u7.top/posts/23biji03.html">https://u7u7.top/posts/23biji03.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>ä½œè€…</h><div class="post-copyright-cc-info"><h>U7's BlogğŸ‹</h></div></div><div class="post-copyright-c"><h>å‘å¸ƒäº</h><div class="post-copyright-cc-info"><h>2023-03-31</h></div></div><div class="post-copyright-u"><h>æ›´æ–°äº</h><div class="post-copyright-cc-info"><h>2023-03-31</h></div></div><div class="post-copyright-c"><h>è®¸å¯åè®®</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%9C%88%E7%AC%94%E8%AE%B0/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>æœˆç¬”è®°</a><a class="post-meta__tags" href="/tags/Scala/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>Scala</a><a class="post-meta__tags" href="/tags/Spark/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>Spark</a><a class="post-meta__tags" href="/tags/Hive/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>Hive</a><a class="post-meta__tags" href="/tags/SQL/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>SQL</a><a class="post-meta__tags" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>å¤§æ•°æ®</a><a class="post-meta__tags" href="/tags/Vue/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>Vue</a></div></div><link rel="stylesheet" href="/css/coin.css" media="defer" onload='this.media="all"'><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">æŠ•å–‚ä½œè€…</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://u7img.oss-cn-hangzhou.aliyuncs.com/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wechat.jpg" alt="å¾®ä¿¡"></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="https://u7img.oss-cn-hangzhou.aliyuncs.com/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/alipay.jpg" alt="æ”¯ä»˜å®"></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li></ul></div></button></div><audio id="coinAudio" src="https://npm.elemecdn.com/akilar-candyassets@1.0.36/audio/aowu.m4a"></audio><script defer src="/js/coin.js"></script><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/23biji04.html"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-1ko2rv.webp" onerror='onerror=null,src="/assets/r2.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">å¤§æ•°æ®23å¹´4æœˆç¬”è®°</div></div></a></div><div class="next-post pull-right"><a href="/posts/23biji02.html"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-v97pzl.webp" onerror='onerror=null,src="/assets/r2.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">å¤§æ•°æ®23å¹´2æœˆç¬”è®°</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/posts/23biji02.html" title="å¤§æ•°æ®23å¹´2æœˆç¬”è®°"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-v97pzl.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-03-29</div><div class="title">å¤§æ•°æ®23å¹´2æœˆç¬”è®°</div></div></a></div><div><a href="/posts/23biji04.html" title="å¤§æ•°æ®23å¹´4æœˆç¬”è®°"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-1ko2rv.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-04-05</div><div class="title">å¤§æ•°æ®23å¹´4æœˆç¬”è®°</div></div></a></div><div><a href="/posts/23biji05.html" title="ä¸­è½¯æ¯23å¹´5æœˆç¬”è®°"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-573239.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-05-26</div><div class="title">ä¸­è½¯æ¯23å¹´5æœˆç¬”è®°</div></div></a></div><div><a href="/posts/2d36b063.html" title="å¤§æ•°æ®22å¹´9æœˆç¬”è®°"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/test4.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-03-11</div><div class="title">å¤§æ•°æ®22å¹´9æœˆç¬”è®°</div></div></a></div><div><a href="/posts/c2f4db5d.html" title="8æœˆç¬”è®°"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/202211081406572.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-03-11</div><div class="title">8æœˆç¬”è®°</div></div></a></div><div><a href="/posts/33ff80d0.html" title="7æœˆç¬”è®°"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/202211081127417.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-03-10</div><div class="title">7æœˆç¬”è®°</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><svg class="meta_icon" style="width:22px;height:22px;position:relative;top:5px"><use xlink:href="#icon-mulu1"></use></svg><span style="font-weight:700">ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#DSL%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC%E4%BD%BF%E7%94%A8"><span class="toc-text">DSLä»£ç é£æ ¼ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-2"><span class="toc-text">å­¦ä¹ æ—¥æœŸ: 3.2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sparksql%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-text">sparksqlå¸¸ç”¨æ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#withColumn"><span class="toc-text">withColumn</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#drop"><span class="toc-text">drop</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lit"><span class="toc-text">lit</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#col"><span class="toc-text">col</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#coalesce"><span class="toc-text">coalesce</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#createOrReplaceTempView"><span class="toc-text">createOrReplaceTempView</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#partitionBy"><span class="toc-text">partitionBy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#write"><span class="toc-text">write</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mode"><span class="toc-text">mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#saveAsTable"><span class="toc-text">saveAsTable</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#insertInto"><span class="toc-text">insertInto</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93"><span class="toc-text">æ—¥æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%9C%AC%E5%9C%B0VM%E9%95%9C%E5%83%8F"><span class="toc-text">ä½¿ç”¨æœ¬åœ°VMé•œåƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-3"><span class="toc-text">å­¦ä¹ æ—¥æœŸ: 3.3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-2"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8asbru%E4%B8%ADsftp"><span class="toc-text">ä½¿ç”¨asbruä¸­sftp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9"><span class="toc-text">BUGç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-2"><span class="toc-text">æ—¥æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL%E7%BB%93%E5%90%88DSL%E8%A1%A8%E6%B8%85%E6%B4%97"><span class="toc-text">SQLç»“åˆDSLè¡¨æ¸…æ´—</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-4"><span class="toc-text">å­¦ä¹ æ—¥æœŸ: 3.4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-3"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-2"><span class="toc-text">BUGç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BUG1"><span class="toc-text">BUG1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BUG2"><span class="toc-text">BUG2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-3"><span class="toc-text">æ—¥æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7%E6%9C%88%E4%BB%BB%E5%8A%A11%E6%8C%87%E6%A0%87%E8%AE%A1%E7%AE%97"><span class="toc-text">7æœˆä»»åŠ¡1æŒ‡æ ‡è®¡ç®—</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-6"><span class="toc-text">å­¦ä¹ æ—¥æœŸ: 3.6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-4"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-3"><span class="toc-text">BUGç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-4"><span class="toc-text">æ—¥æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7%E6%9C%88%E4%BB%BB%E5%8A%A13"><span class="toc-text">7æœˆä»»åŠ¡3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-7"><span class="toc-text">å­¦ä¹ æ—¥æœŸ: 3.7</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-5"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%BD%E5%8F%96"><span class="toc-text">æŠ½å–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%85%E6%B4%97"><span class="toc-text">æ¸…æ´—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E6%A0%87%E8%AE%A1%E7%AE%97"><span class="toc-text">æŒ‡æ ‡è®¡ç®—</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-4"><span class="toc-text">BUGç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0"><span class="toc-text">æ‰©å±•å­¦ä¹ </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-5"><span class="toc-text">æ—¥æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7%E6%9C%88%E4%BB%BB%E5%8A%A14-%E6%8C%87%E6%A0%87%E8%AE%A1%E7%AE%97"><span class="toc-text">7æœˆä»»åŠ¡4 æŒ‡æ ‡è®¡ç®—</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-9"><span class="toc-text">å­¦ä¹ æ—¥æœŸ: 3.9</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-6"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#t1"><span class="toc-text">t1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#t2"><span class="toc-text">t2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-5"><span class="toc-text">BUGç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-6"><span class="toc-text">æ—¥æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7%E6%9C%88%E4%BB%BB%E5%8A%A1%E4%B9%A6%E8%AE%A8%E8%AE%BA"><span class="toc-text">7æœˆä»»åŠ¡ä¹¦è®¨è®º</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-10"><span class="toc-text">å­¦ä¹ æ—¥æœŸ: 3.10</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-7"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E4%BA%8C-%E6%9C%AA%E8%A7%A3%E5%86%B3"><span class="toc-text">é—®é¢˜äºŒ(æœªè§£å†³)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0-2"><span class="toc-text">æ‰©å±•å­¦ä¹ </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-7"><span class="toc-text">æ—¥æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7%E6%9C%88%E4%BB%BB%E5%8A%A1%E4%B9%A65-%E6%8C%87%E6%A0%87%E8%AE%A1%E7%AE%97"><span class="toc-text">7æœˆä»»åŠ¡ä¹¦5 æŒ‡æ ‡è®¡ç®—</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-13"><span class="toc-text">å­¦ä¹ æ—¥æœŸ: 3.13</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-8"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%A2%98"><span class="toc-text">ç¬¬ä¸€é¢˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%A2%98"><span class="toc-text">ç¬¬äºŒé¢˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E9%A2%98"><span class="toc-text">ç¬¬ä¸‰é¢˜</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-6"><span class="toc-text">BUGç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-8"><span class="toc-text">æ—¥æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A14%E4%BF%AE%E6%94%B9"><span class="toc-text">ä»»åŠ¡4ä¿®æ”¹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-14"><span class="toc-text">å­¦ä¹ æ—¥æœŸ: 3.14</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-9"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-9"><span class="toc-text">æ—¥æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A15%E4%BB%A5%E5%8F%8A%E7%AE%97%E6%B3%95"><span class="toc-text">ä»»åŠ¡5ä»¥åŠç®—æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-15"><span class="toc-text">å­¦ä¹ æ—¥æœŸ: 3.15</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-10"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%8F%B72120"><span class="toc-text">ç¼–å·2120</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-7"><span class="toc-text">BUGç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0-3"><span class="toc-text">æ‰©å±•å­¦ä¹ </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-10"><span class="toc-text">æ—¥æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vue-TodoList%E6%A1%88%E4%BE%8B%E5%AE%8C%E5%96%84"><span class="toc-text">Vue TodoListæ¡ˆä¾‹å®Œå–„</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-17"><span class="toc-text">å­¦ä¹ æ—¥æœŸ: 3.17</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-11"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E4%BA%8B%E4%BB%B6%E6%80%BB%E7%BA%BF%EF%BC%88GlobalEventBus%EF%BC%89"><span class="toc-text">å…¨å±€äº‹ä»¶æ€»çº¿ï¼ˆGlobalEventBusï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E8%AE%A2%E9%98%85%E4%B8%8E%E5%8F%91%E5%B8%83%EF%BC%88pubsub%EF%BC%89"><span class="toc-text">æ¶ˆæ¯è®¢é˜…ä¸å‘å¸ƒï¼ˆpubsubï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nextTick"><span class="toc-text">nextTick</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0-4"><span class="toc-text">æ‰©å±•å­¦ä¹ </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-11"><span class="toc-text">æ—¥æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vuex"><span class="toc-text">Vuex</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-20"><span class="toc-text">å­¦ä¹ æ—¥æœŸ: 3.20</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-12"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%A6%82%E5%BF%B5"><span class="toc-text">1.æ¦‚å¿µ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5"><span class="toc-text">2.ä½¿ç”¨æƒ…å†µ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%90%AD%E5%BB%BAvuex%E7%8E%AF%E5%A2%83"><span class="toc-text">3.æ­å»ºvuexç¯å¢ƒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-text">4.åŸºæœ¬ä½¿ç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-getters%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">5.gettersçš„ä½¿ç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%9B%9B%E4%B8%AAmap%E6%96%B9%E6%B3%95%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">6.å››ä¸ªmapæ–¹æ³•çš„ä½¿ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0-5"><span class="toc-text">æ‰©å±•å­¦ä¹ </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E5%8C%96-%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4"><span class="toc-text">æ¨¡å—åŒ–+å‘½åç©ºé—´</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-12"><span class="toc-text">æ—¥æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#mysql%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5"><span class="toc-text">mysqlæ•°æ®å¯¼å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-22"><span class="toc-text">å­¦ä¹ æ—¥æœŸ: 3.22</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-13"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%B0%8F%E7%99%BD%E6%A0%B7%E9%A2%98%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5"><span class="toc-text">å°†å°ç™½æ ·é¢˜æ•°æ®å¯¼å…¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-8"><span class="toc-text">BUGç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-13"><span class="toc-text">æ—¥æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E6%96%B0%E9%95%9C%E5%83%8F%E8%BF%9E%E6%8E%A5"><span class="toc-text">æµ‹è¯•æ–°é•œåƒè¿æ¥</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-23"><span class="toc-text">å­¦ä¹ æ—¥æœŸ: 3.23</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-14"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-9"><span class="toc-text">BUGç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0-6"><span class="toc-text">æ‰©å±•å­¦ä¹ </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%8F%B7468"><span class="toc-text">ç¼–å·468</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-14"><span class="toc-text">æ—¥æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spark%E6%9E%B6%E6%9E%84%E4%BB%A5%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA"><span class="toc-text">Sparkæ¶æ„ä»¥åŠé›†ç¾¤æ­å»º</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-24"><span class="toc-text">å­¦ä¹ æ—¥æœŸ: 3.24</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-15"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Spark%E7%90%86%E8%AE%BA"><span class="toc-text">Sparkç†è®º</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-10"><span class="toc-text">BUGç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-15"><span class="toc-text">æ—¥æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spark%E6%A0%B8%E5%BF%83%E7%BC%96%E7%A8%8BRDD"><span class="toc-text">Sparkæ ¸å¿ƒç¼–ç¨‹RDD</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-25"><span class="toc-text">å­¦ä¹ æ—¥æœŸ: 3.25</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-16"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Spark%E9%9B%86%E5%90%88%E6%96%B9%E6%B3%95"><span class="toc-text">Sparké›†åˆæ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#union-otherDataset"><span class="toc-text">union(otherDataset)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#intersection-otherDataset"><span class="toc-text">intersection(otherDataset)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#subtract%E8%BD%AC%E6%8D%A2"><span class="toc-text">subtractè½¬æ¢</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#cartesian-otherDataset"><span class="toc-text">cartesian(otherDataset)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-11"><span class="toc-text">BUGç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0-7"><span class="toc-text">æ‰©å±•å­¦ä¹ </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#action%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0"><span class="toc-text">actionæ“ä½œå‡½æ•°</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-16"><span class="toc-text">æ—¥æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SparkSQL%E7%BC%96%E7%A8%8B"><span class="toc-text">SparkSQLç¼–ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-27-3-28"><span class="toc-text">å­¦ä¹ æ—¥æœŸ: 3.27-3.28</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-17"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Spark-SQL%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0"><span class="toc-text">Spark SQLå†…ç½®å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spark-SQL%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-text">Spark SQLèšåˆå‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BC%BA%E5%A4%B1%E5%80%BC%E5%A4%84%E7%90%86"><span class="toc-text">æ•°æ®ç¼ºå¤±å€¼å¤„ç†</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-12"><span class="toc-text">BUGç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0-8"><span class="toc-text">æ‰©å±•å­¦ä¹ </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%93%9D%E6%A1%A5%E6%9D%AF-123"><span class="toc-text">è“æ¡¥æ¯ 123</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-17"><span class="toc-text">æ—¥æ€»ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#27%E6%97%A5"><span class="toc-text">27æ—¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#28%E6%97%A5"><span class="toc-text">28æ—¥</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vue%E8%B7%AF%E7%94%B1-%E9%87%8D%E7%82%B9"><span class="toc-text">Vueè·¯ç”±(é‡ç‚¹)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F%EF%BC%9A3-29"><span class="toc-text">å­¦ä¹ æ—¥æœŸï¼š3.29</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-18"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-text">1.åŸºæœ¬ä½¿ç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%87%A0%E4%B8%AA%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="toc-text">2.å‡ ä¸ªæ³¨æ„ç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%A4%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%EF%BC%88%E5%A4%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%EF%BC%89"><span class="toc-text">3.å¤šçº§è·¯ç”±ï¼ˆå¤šçº§è·¯ç”±ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%B7%AF%E7%94%B1%E7%9A%84query%E5%8F%82%E6%95%B0"><span class="toc-text">4.è·¯ç”±çš„queryå‚æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%91%BD%E5%90%8D%E8%B7%AF%E7%94%B1"><span class="toc-text">5.å‘½åè·¯ç”±</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%B7%AF%E7%94%B1%E7%9A%84params%E5%8F%82%E6%95%B0"><span class="toc-text">6.è·¯ç”±çš„paramså‚æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E8%B7%AF%E7%94%B1%E7%9A%84props%E9%85%8D%E7%BD%AE"><span class="toc-text">7.è·¯ç”±çš„propsé…ç½®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-router-link-%E7%9A%84replace%E5%B1%9E%E6%80%A7"><span class="toc-text">8.&lt;router-link&gt;çš„replaceå±æ€§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E7%BC%96%E7%A8%8B%E5%BC%8F%E8%B7%AF%E7%94%B1%E5%AF%BC%E8%88%AA"><span class="toc-text">9.ç¼–ç¨‹å¼è·¯ç”±å¯¼èˆª</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E7%BC%93%E5%AD%98%E8%B7%AF%E7%94%B1%E7%BB%84%E4%BB%B6"><span class="toc-text">10.ç¼“å­˜è·¯ç”±ç»„ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E4%B8%A4%E4%B8%AA%E6%96%B0%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%92%A9%E5%AD%90"><span class="toc-text">11.ä¸¤ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸé’©å­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E8%B7%AF%E7%94%B1%E5%AE%88%E5%8D%AB"><span class="toc-text">12.è·¯ç”±å®ˆå«</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E4%B8%A4%E7%A7%8D%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F"><span class="toc-text">13.è·¯ç”±å™¨çš„ä¸¤ç§å·¥ä½œæ¨¡å¼</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vue3-%E9%87%8D%E7%82%B9"><span class="toc-text">Vue3(é‡ç‚¹)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F%EF%BC%9A3-30-3-31"><span class="toc-text">å­¦ä¹ æ—¥æœŸï¼š3.30-3.31</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-19"><span class="toc-text">æ‰€å­¦å†…å®¹æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAVue3-0"><span class="toc-text">åˆ›å»ºVue3.0</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#vue-cli%E5%88%9B%E5%BB%BA"><span class="toc-text">vue-cliåˆ›å»º</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#vite%E5%88%9B%E5%BB%BA-%E6%8E%A8%E8%8D%90"><span class="toc-text">viteåˆ›å»º(æ¨è)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Composition-API-%E9%87%8D%E7%82%B9"><span class="toc-text">Composition API(é‡ç‚¹)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-2"><span class="toc-text">æ€»ç»“</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-color:transparent"><div id="footer-wrap"><div id="ft"><div class="ft-item-1"><div class="t-top"><div class="t-t-l"><p class="ft-t t-l-t">æ ¼è¨€ğŸ§¬</p><div class="bg-ad"><div>å†çœ‹çœ‹é‚£ä¸ªå…‰ç‚¹ï¼Œå®ƒå°±åœ¨è¿™é‡Œï¼Œè¿™æ˜¯å®¶å›­ï¼Œè¿™æ˜¯æˆ‘ä»¬ â€”â€” ä½ æ‰€çˆ±çš„æ¯ä¸€ä¸ªäººï¼Œä½ è®¤è¯†çš„ä¸€ä¸ªäººï¼Œä½ å¬è¯´è¿‡çš„æ¯ä¸€ä¸ªäººï¼Œæ›¾ç»æœ‰è¿‡çš„æ¯ä¸€ä¸ªäººï¼Œéƒ½åœ¨å®ƒä¸Šé¢åº¦è¿‡ä»–ä»¬çš„ä¸€ç”Ÿâœ¨</div><div class="btn-xz-box"><a class="btn-xz" target="_blank" rel="noopener" href="https://stellarium.org/">ç‚¹å‡»å¼€å¯æ˜Ÿè¾°ä¹‹æ—…</a></div></div></div><div class="t-t-r"><p class="ft-t t-l-t">çŒœä½ æƒ³çœ‹ğŸ’¡</p><ul class="ft-links"><li><a href="/comments/">ç•™ç‚¹ä»€ä¹ˆ</a><a href="/archives/">æ–‡ç« å½’æ¡£</a></li><li><a href="/categories/">æ–‡ç« åˆ†ç±»</a><a href="/tags/">æ–‡ç« æ ‡ç­¾</a></li><li><a href="/box/Gallery/">æˆ‘çš„ç”»å»Š</a><a href="/personal/bb/">æˆ‘çš„å” å¨</a></li><li><a href="/site/time/">å»ºè®¾è¿›ç¨‹</a><a href="/site/census/">ç½‘ç«™ç»Ÿè®¡</a></li></ul></div></div></div><div class="ft-item-2"><p class="ft-t">æ¨èå‹é“¾âŒ›</p><div class="ft-img-group"><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""></a></div><div class="img-group-item"><a href="javascript:void(0)" title="å¹¿å‘Šä½æ‹›ç§Ÿ"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""></a></div></div></div></div><div class="copyright"><span><b>&copy;2022-2023</b></span><span><b>&nbsp;&nbsp;By U7's BlogğŸ‹</b></span></div><div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" title="åšå®¢æ¡†æ¶ä¸ºHexo_v6.3.0"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Frame-Hexo-blue.svg" alt=""></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" title="ä¸»é¢˜ç‰ˆæœ¬Butterfly_v4.3.1"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Theme-Butterfly-6513df.svg" alt=""></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œä¸»çº¿è·¯æ‰˜ç®¡äºVercel"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Hosted-Vercel-brightgreen.svg" alt=""></a><a class="github-badge" target="_blank" href="https://user.51.la/" style="margin-inline:5px" title="æœ¬ç«™æ•°æ®åˆ†æå¾—ç›Šäº51laæŠ€æœ¯æ”¯æŒ"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Analytics-51la-3db1eb.svg" alt=""></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=20230913" style="margin-inline:5px" title="æœ¬ç«™å·²åŠ å…¥èŒICPè±ªåå¥—é¤ï¼ŒèŒICPå¤‡20230913å·"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/202303221541743.svg" alt=""></a><a class="github-badge" target="_blank" href="https://bitiful.dogecast.com/buckets" style="margin-inline:5px" title="æœ¬ç½‘ç«™ç»Service Workeråˆ†æµè‡³ç¼¤çº·äº‘å¯¹è±¡å­˜å‚¨"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Bucket-ç¼¤çº·äº‘-9c62da.svg" alt=""></a><a class="github-badge" target="_blank" href="https://www.netdun.net/" style="margin-inline:5px" title="æœ¬ç«™ä½¿ç”¨ç½‘ç›¾æ˜Ÿçƒæä¾›CDNåŠ é€Ÿä¸é˜²æŠ¤"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/CDN-ç½‘ç›¾æ˜Ÿçƒ-fff2cc.svg" alt=""></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="æœ¬ç½‘ç«™æºç ç”±Githubæä¾›å­˜å‚¨ä»“åº“"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Source-Github-d021d6.svg" alt=""></a></p></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><a class="icon-V hidden" onclick="switchNightMode()" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button><button class="share" type="button" title="å³é”®æ¨¡å¼" onclick="changeMouseMode()"><i class="fas fa-mouse"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog right_side"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button class="share" type="button" title="åˆ†äº«é“¾æ¥" onclick="share()"><i class="fas fa-share-nodes"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i><span id="percent">0<span>%</span></span></button><button id="go-down" type="button" title="ç›´è¾¾åº•éƒ¨" onclick="btf.scrollToDest(document.body.scrollHeight,500)"><i class="fas fa-arrow-down"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>å¤åˆ¶</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.baidu.com/s?wd=&quot;+window.getSelection().toString());window.location.reload();"><i class="fa fa-search"></i><span>ç™¾åº¦æœç´¢</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());window.location.reload();"><i class="fa fa-link"></i><span>è½¬åˆ°é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste()"><i class="fa fa-copy"></i><span>ç²˜è´´</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-post"><a class="rightMenu-item" href="#post-comment"><i class="fas fa-comment"></i><span>ç©ºé™è¯„è®º</span></a><a class="rightMenu-item" href="javascript:rmf.copyWordsLink()"><i class="fa fa-link"></i><span>å¤åˆ¶æœ¬æ–‡åœ°å€</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-to"><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>æ–°çª—å£æ‰“å¼€</span></a><a class="rightMenu-item" id="menu-too" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>è½¬åˆ°é“¾æ¥</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>å¤åˆ¶é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>ä¿å­˜å›¾ç‰‡</span></a><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>åœ¨æ–°çª—å£æ‰“å¼€</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>å¤åˆ¶å›¾ç‰‡é“¾æ¥</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:randomPost()"><i class="fa fa-paper-plane"></i><span>éšä¾¿é€›é€›</span></a><a class="rightMenu-item" href="javascript:switchNightMode();"><i class="fa fa-moon"></i><span>æ˜¼å¤œåˆ‡æ¢</span></a><a class="rightMenu-item" href="/personal/about/"><i class="fa fa-info-circle"></i><span>å…³äºåšå®¢</span></a><a class="rightMenu-item" href="javascript:toggleWinbox();"><i class="fas fa-cog"></i><span>ç¾åŒ–è®¾ç½®</span></a><a class="rightMenu-item" href="javascript:rmf.fullScreen();"><i class="fas fa-expand"></i><span>åˆ‡æ¢å…¨å±</span></a><a class="rightMenu-item" href="javascript:window.print();"><i class="fa-solid fa-print"></i><span>æ‰“å°é¡µé¢</span></a></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.umd.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script async>var preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",preloader.endLoading()),setTimeout((function(){preloader.endLoading()}),5e3),document.getElementById("loading-box").addEventListener("click",(()=>{preloader.endLoading()}))</script><div class="js-pjax"><script>if(window.MathJax)MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset();else{window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],tags:"ams"},chtml:{scale:1.2},options:{renderActions:{findScript:[10,t=>{for(const e of document.querySelectorAll('script[type^="math/tex"]')){const a=!!e.type.match(/; *mode=display/),n=new t.options.MathItem(e.textContent,t.inputJax[0],a),s=document.createTextNode("");e.parentNode.replaceChild(s,e),n.start={node:s,delim:"",n:0},n.end={node:s,delim:"",n:0},t.math.push(n)}},""],insertScript:[200,()=>{document.querySelectorAll("mjx-container:not([display])").forEach((t=>{const e=t.parentNode;"li"===e.nodeName.toLowerCase()?e.parentNode.classList.add("has-jax"):e.classList.add("has-jax")}))},"",!1]}}};const t=document.createElement("script");t.src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js",t.id="MathJax-script",t.async=!0,document.head.appendChild(t)}</script><script>(()=>{const t=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://u7-cc.u7u7.top/",region:"",onCommentLoaded:function(){btf.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null)),GLOBAL_CONFIG_SITE.isPost&&(()=>{const t=document.getElementById("twikoo-count");t&&twikoo.getCommentsCount({envId:"https://u7-cc.u7u7.top/",region:"",urls:[window.location.pathname],includeReply:!1}).then((function(o){t.innerText=o[0].count})).catch((function(t){console.error(t)}))})()},o=()=>{"object"!=typeof twikoo?getScript("https://cdn.staticfile.org/twikoo/1.6.8/twikoo.all.min.js").then(t):setTimeout(t,0)};btf.loadComment(document.getElementById("twikoo-wrap"),o)})()</script></div><script src="https://cdn.staticfile.org/jquery/3.6.3/jquery.min.js"></script><script async src="https://cdn1.tianli0.top/npm/vue@2.6.14/dist/vue.min.js"></script><script async src="https://cdn1.tianli0.top/npm/element-ui@2.15.6/lib/index.js"></script><script async src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script><script defer src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://cdn1.tianli0.top/gh/nextapps-de/winbox/dist/winbox.bundle.min.js"></script><script async src="//at.alicdn.com/t/c/font_3586335_hsivh70x0fm.js"></script><script async src="//at.alicdn.com/t/c/font_3636804_gr02jmjr3y9.js"></script><script async src="//at.alicdn.com/t/c/font_3612150_kfv55xn3u2g.js"></script><script async src="https://cdn.wpon.cn/2022-sucai/Gold-ingot.js"></script><canvas id="universe"></canvas><canvas id="snow"></canvas><script defer src="/js/fomal.js"></script><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdn1.tianli0.top/npm/js-heo@1.0.12/metingjs/Meting.min.js"></script><script src="https://lib.baomitu.com/pjax/0.2.8/pjax.min.js"></script><script>let pjaxSelectors=["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show","#web_bg",".js-pjax","#bibi","body > title","#app","#tag-echarts","#posts-echart","#categories-echarts"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(window.tocScrollFn&&window.removeEventListener("scroll",window.tocScrollFn),window.scrollCollect&&window.removeEventListener("scroll",scrollCollect),"object"==typeof preloader&&preloader.initLoading(),document.getElementById("rightside").style.cssText="opacity: ''; transform: ''",window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),"object"==typeof disqusjs&&disqusjs.destroy()})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)})),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll(),"object"==typeof preloader&&preloader.endLoading()})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404.html")}))</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script data-pjax>if(document.getElementById("recent-posts")&&"/"===location.pathname){var parent=document.getElementById("recent-posts"),child='<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/å·¥ä½œå®¤æœˆç¬”è®°/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ¡ U7ã®æœˆå­¦ä¹ ç¬”è®° (5)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/å¤§æ•°æ®è®­ç»ƒ/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ¼ U7ã®å¤§æ•°æ®è®­ç»ƒç¬”è®° (5)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/å‰åç«¯é¡¹ç›®/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ‰ U7ã®é¡¹ç›®ç¬”è®° (4)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/å·¥ä½œå®¤æœˆæ€»ç»“/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ¨ U7ã®æœˆæ€»ç»“ (4)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/ç®—æ³•/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸŸ U7ã®ç®—æ³•å­¦ä¹ ç¬”è®° (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/æ¼”ç¤º/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">ğŸ¥ U7ã®æ¡ˆä¾‹æ¼”ç¤ºç¬”è®° (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><a class="magnet_link_more"  href="https://u7u7.top/categories/" style="flex:1;text-align: center;margin-bottom: 10px;">æŸ¥çœ‹æ›´å¤š...</a></div></div>';console.log("å·²æŒ‚è½½magnet"),parent.insertAdjacentHTML("afterbegin",child)}</script><style>#catalog_magnet{flex-wrap:wrap;display:flex;width:100%;justify-content:space-between;padding:10px 10px 0 10px;align-content:flex-start}.magnet_item{flex-basis:calc(33.333333333333336% - 5px);background:#e9e9e9;margin-bottom:10px;border-radius:8px;transition:all .2s ease-in-out}.magnet_item:hover{background:var(--text-bg-hover)}.magnet_link_more{color:#555}.magnet_link{color:#000}.magnet_link:hover{color:#fff}@media screen and (max-width:600px){.magnet_item{flex-basis:100%}}.magnet_link_context{display:flex;padding:10px;font-size:16px;transition:all .2s ease-in-out}.magnet_link_context:hover{padding:10px 20px}</style><style></style><script data-pjax>function butterfly_swiper_injector_config(){var a=document.getElementById("recent-posts");console.log("å·²æŒ‚è½½butterfly_swiper"),a.insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/adf5c49.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/test5.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-11</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/adf5c49.html&quot;);" href="javascript:void(0);" alt="">Vueç¬”è®°</a><div class="blog-slider__text">Vueå‰ç«¯å­¦ä¹ ç¬”è®°</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/adf5c49.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/23biji05.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-573239.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-04</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/23biji05.html&quot;);" href="javascript:void(0);" alt="">ä¸­è½¯æ¯23å¹´5æœˆç¬”è®°</a><div class="blog-slider__text">ä¸­è½¯æ¯è®¾è®¡æ¯æ—¥ç¬”è®°ä»¥åŠæ€»ç»“</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/23biji05.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/23biji04.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-1ko2rv.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-05</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/23biji04.html&quot;);" href="javascript:void(0);" alt="">å¤§æ•°æ®23å¹´4æœˆç¬”è®°</a><div class="blog-slider__text">Sparkå¤§æ•°æ®å¤‡èµ›â€”â€”â€”â€”SparkSQL,å›½èµ›ä»»åŠ¡ä¹¦è®­ç»ƒ</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/23biji04.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/23biji03.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-9mvd9k.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-31</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/23biji03.html&quot;);" href="javascript:void(0);" alt="">å¤§æ•°æ®23å¹´3æœˆç¬”è®°</a><div class="blog-slider__text">Sparkå¤§æ•°æ®å¤ä¹ ä»¥åŠVueå­¦ä¹ â€”â€”â€”â€”SparkSQL,DSLé£æ ¼,ä¸ƒæœˆä»»åŠ¡ä¹¦</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/23biji03.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/23biji02.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-v97pzl.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-29</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/23biji02.html&quot;);" href="javascript:void(0);" alt="">å¤§æ•°æ®23å¹´2æœˆç¬”è®°</a><div class="blog-slider__text">Sparkå¤§æ•°æ®å¤ä¹ â€”â€”â€”â€”hiveSQL,å››æœˆä»»åŠ¡ä¹¦å¤ä¹ </div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/23biji02.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/a1e1aa91.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wallhaven-28mkg9_2560x1440.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/a1e1aa91.html&quot;);" href="javascript:void(0);" alt="">ç‘å‰å¤–å–</a><div class="blog-slider__text">SpringBooté¡¹ç›®</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/a1e1aa91.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/dashuju.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wallhaven-pk6y2p.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/dashuju.html&quot;);" href="javascript:void(0);" alt="">GZ-07 ç»¼åˆåˆ†æ</a><div class="blog-slider__text">å¤§æ•°æ®7æœˆæ ·é¢˜â€”â€”ç”µå•†ç»¼åˆåˆ†æ</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/dashuju.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/suanfa.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wallhaven-jx5xyw.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/suanfa.html&quot;);" href="javascript:void(0);" alt="">ç®—æ³•</a><div class="blog-slider__text">åŠ›æ‰£ç®—æ³•åˆ·é¢˜</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/suanfa.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wallhaven-o59q2m.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt="">Markdownè¯­æ³•ä¸å¤–æŒ‚æ ‡ç­¾å†™æ³•æ±‡æ€»</a><div class="blog-slider__text">ğŸ¥§æœ¬æ–‡æ±‡æ€»Markdownæ ¼å¼ä»¥åŠå¤–æŒ‚æ ‡ç­¾åœ¨ç½‘é¡µç«¯çš„æ¸²æŸ“æ•ˆæœï¼Œå¯ä½œä¸ºæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt="">è¯¦æƒ…       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>')}for(var elist="undefined".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_swiper_injector_config()</script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><div class="js-pjax"><script async>for(var arr=document.getElementsByClassName("recent-post-item"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration","2s"),arr[i].setAttribute("data-wow-delay","200ms"),arr[i].setAttribute("data-wow-offset","30"),arr[i].setAttribute("data-wow-iteration","1")</script><script async>for(var arr=document.getElementsByClassName("card-widget"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration","2s"),arr[i].setAttribute("data-wow-delay","200ms"),arr[i].setAttribute("data-wow-offset","30"),arr[i].setAttribute("data-wow-iteration","1")</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>function gitcalendar_injector_config(){document.getElementById("gitZone").insertAdjacentHTML("afterbegin",'<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 320px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>'),console.log("å·²æŒ‚è½½gitcalendar")}document.getElementById("gitZone")&&"/site/census/"===location.pathname&&(gitcalendar_injector_config(),GitCalendarInit("/api?null",["#d9e0df","#c6e0dc","#a8dcd4","#9adcd2","#89ded1","#77e0d0","#5fdecb","#47dcc6","#39dcc3","#1fdabe","#00dab9"],"null"))</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/koharu.model.json"},display:{position:"left",width:150,height:300},mobile:{show:!0},log:!1})</script></body></html>