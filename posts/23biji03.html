<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><div id="myscoll"></div><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>大数据23年3月笔记 | u7u7学习小屋</title><meta name="keywords" content="月笔记,Scala,Spark,Hive,SQL,大数据,Vue"><meta name="author" content="u7u7学习小屋"><meta name="copyright" content="u7u7学习小屋"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="Spark大数据复习以及Vue学习————SparkSQL,DSL风格,七月任务书">
<meta property="og:type" content="article">
<meta property="og:title" content="大数据23年3月笔记">
<meta property="og:url" content="https://u7u7.top/posts/23biji03.html">
<meta property="og:site_name" content="u7u7学习小屋">
<meta property="og:description" content="Spark大数据复习以及Vue学习————SparkSQL,DSL风格,七月任务书">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-9mvd9k.webp">
<meta property="article:published_time" content="2023-03-31T08:30:25.000Z">
<meta property="article:modified_time" content="2023-03-31T13:30:25.000Z">
<meta property="article:author" content="u7u7学习小屋">
<meta property="article:tag" content="月笔记">
<meta property="article:tag" content="Scala">
<meta property="article:tag" content="Spark">
<meta property="article:tag" content="Hive">
<meta property="article:tag" content="SQL">
<meta property="article:tag" content="大数据">
<meta property="article:tag" content="Vue">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-9mvd9k.webp"><link rel="shortcut icon" href="/"><link rel="canonical" href="https://u7u7.top/posts/23biji03"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.js',
      css: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '大数据23年3月笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-31 21:30:25'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn1.tianli0.top/npm/element-ui@2.15.6/packages/theme-chalk/lib/index.css"><style id="themeColor"></style><style id="rightSide"></style><style id="transPercent"></style><style id="blurNum"></style><style id="settingStyle"></style><span id="fps"></span><style id="defineBg"></style><style id="menu_shadow"></style><svg aria-hidden="true" style="position:absolute; overflow:hidden; width:0; height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="u7u7学习小屋" type="application/atom+xml">
</head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/chengguo.jpg" onerror="onerror=null;src='/assets/r1.jpg'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">25</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-home"></use></svg><span class="menu_word" style="font-size:17px"> 首页</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--article"></use></svg><span class="menu_word" style="font-size:17px"> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang1">                   </use></svg><span class="menu_word" style="font-size:17px"> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-sekuaibiaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pinweishenghuo"></use></svg><span class="menu_word" style="font-size:17px"> 休闲</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-yinle">                   </use></svg><span class="menu_word" style="font-size:17px"> 八音盒</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-dianying1">                   </use></svg><span class="menu_word" style="font-size:17px"> 影院</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-youxishoubing">                   </use></svg><span class="menu_word" style="font-size:17px"> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> 八宝箱</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiaozhizuomoban">                   </use></svg><span class="menu_word" style="font-size:17px"> 画廊</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-nvwumao">                   </use></svg><span class="menu_word" style="font-size:17px"> 动画</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> 网址导航</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shejiaoxinxi"></use></svg><span class="menu_word" style="font-size:17px"> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pengyouquan">                   </use></svg><span class="menu_word" style="font-size:17px"> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyan">                   </use></svg><span class="menu_word" style="font-size:17px"> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-lianjie">                   </use></svg><span class="menu_word" style="font-size:17px"> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wangye"></use></svg><span class="menu_word" style="font-size:17px"> 网站</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--tongjibiao">                   </use></svg><span class="menu_word" style="font-size:17px"> 网站统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shujutongji1">                   </use></svg><span class="menu_word" style="font-size:17px"> 文章统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xianxingshalou">                   </use></svg><span class="menu_word" style="font-size:17px"> 旧时光</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">u7u7学习小屋</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-home"></use></svg><span class="menu_word" style="font-size:17px"> 首页</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--article"></use></svg><span class="menu_word" style="font-size:17px"> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang1">                   </use></svg><span class="menu_word" style="font-size:17px"> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-sekuaibiaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pinweishenghuo"></use></svg><span class="menu_word" style="font-size:17px"> 休闲</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/life/music/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-yinle">                   </use></svg><span class="menu_word" style="font-size:17px"> 八音盒</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/movies/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-dianying1">                   </use></svg><span class="menu_word" style="font-size:17px"> 影院</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/life/games/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-youxishoubing">                   </use></svg><span class="menu_word" style="font-size:17px"> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> 八宝箱</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/gallery/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-tubiaozhizuomoban">                   </use></svg><span class="menu_word" style="font-size:17px"> 画廊</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/animation/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-nvwumao">                   </use></svg><span class="menu_word" style="font-size:17px"> 动画</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> 网址导航</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shejiaoxinxi"></use></svg><span class="menu_word" style="font-size:17px"> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/social/fcircle/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-pengyouquan">                   </use></svg><span class="menu_word" style="font-size:17px"> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyan">                   </use></svg><span class="menu_word" style="font-size:17px"> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-lianjie">                   </use></svg><span class="menu_word" style="font-size:17px"> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wangye"></use></svg><span class="menu_word" style="font-size:17px"> 网站</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/census/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--tongjibiao">                   </use></svg><span class="menu_word" style="font-size:17px"> 网站统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shujutongji1">                   </use></svg><span class="menu_word" style="font-size:17px"> 文章统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/site/time/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xianxingshalou">                   </use></svg><span class="menu_word" style="font-size:17px"> 旧时光</span></a></li></ul></div></div><center id="name-container"><a id="page-name" href="javascript:scrollToTop()">PAGE_NAME</a></center><div id="nav-right"><div id="search-button"><a class="search faa-parent animated-hover" title="检索站内任何你想要的信息"><svg class="faa-tada icon" style="height:24px;width:24px;fill:currentColor;position:relative;top:6px" aria-hidden="true"><use xlink:href="#icon-valentine_-search-love-find-heart"></use></svg><span> 搜索</span></a></div><a class="meihua faa-parent animated-hover" onclick="toggleWinbox()" title="美化设置-自定义你的风格" id="meihua-button"><svg class="faa-tada icon" style="height:26px;width:26px;fill:currentColor;position:relative;top:8px" aria-hidden="true"><use xlink:href="#icon-tupian1"></use></svg></a><a class="sun_moon faa-parent animated-hover" onclick="switchNightMode()" title="浅色和深色模式转换" id="nightmode-button"><svg class="faa-tada" style="height:25px;width:25px;fill:currentColor;position:relative;top:7px" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon">       </use></svg></a><div id="toggle-menu"><a><i class="fas fa-bars fa-fw"></i></a></div></div></div></nav><div id="post-info"><h1 class="post-title">大数据23年3月笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><svg class="meta_icon post-meta-icon" style="width:30px;height:30px;position:relative;top:10px"><use xlink:href="#icon-rili"></use></svg><span class="post-meta-label">发表于 </span><time class="post-meta-date-created" datetime="2023-03-31T08:30:25.000Z" title="发表于 2023-03-31 16:30:25">2023-03-31</time><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-gengxin1"></use></svg><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-03-31T13:30:25.000Z" title="更新于 2023-03-31 21:30:25">2023-03-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-biaoqian"></use></svg><a class="post-meta-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E8%AE%AD%E7%BB%83/">大数据训练</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:8px"><use xlink:href="#icon-charuword"></use></svg><span class="post-meta-label">字数总计:</span><span class="word-count">1.6w</span><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:20px;height:20px;position:relative;top:5px"><use xlink:href="#icon-shizhong"></use></svg><span class="post-meta-label">阅读时长:</span><span>66分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="大数据23年3月笔记"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:5px"><use xlink:href="#icon-eye"></use></svg><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="DSL代码风格使用">DSL代码风格使用</h1>
<h2 id="学习日期-3-2">学习日期: 3.2</h2>
<h2 id="所学内容概述">所学内容概述</h2>
<p>看小白学苑的解法，发现DSL是能解决很多sql语句繁琐需要写字段名的代码。学习了spark的sql方法</p>
<h3 id="sparksql常用方法">sparksql常用方法</h3>
<h4 id="withColumn">withColumn</h4>
<p>自己使用一般只用到两种用法</p>
<ul>
<li>添加列</li>
<li>修改列</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">withColumn(<span class="string">&quot;列名&quot;</span>,<span class="string">&quot;数据&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>如上如果列名存在，则是对该列修改。如果列名不存在，则是添加新列</p>
<h4 id="drop">drop</h4>
<p>使用过一次，删除一列</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop(<span class="string">&quot;etl_date&quot;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="lit">lit</h4>
<p>创建一个常量列 如下lit代表数据为常量结合withColumn使用</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">withColumn(<span class="string">&quot;etl_date&quot;</span>,lit(<span class="string">&quot;20230302&quot;</span>))</span><br></pre></td></tr></table></figure>
<h4 id="col">col</h4>
<p>col中选中为列的数据,如下col内的字段表示该列 oerate_time列</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">withColumn(<span class="string">&quot;operate_time&quot;</span>, coalesce(col(<span class="string">&quot;operate_time&quot;</span>), col(<span class="string">&quot;create_time&quot;</span>)))</span><br></pre></td></tr></table></figure>
<h4 id="coalesce">coalesce</h4>
<p>该函数和mysql和hive的用法一样，返回第一个不为null的值</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">coalesce(col(<span class="string">&quot;operate_time&quot;</span>), col(<span class="string">&quot;create_time&quot;</span>))</span><br><span class="line"><span class="comment">//如果operate_time为null 取create_time为值</span></span><br></pre></td></tr></table></figure>
<h4 id="createOrReplaceTempView">createOrReplaceTempView</h4>
<p>方法是创建一个临时表和<code>with as 临时表名</code>差不多</p>
<ul>
<li>如果两次建立的临时表名字一样第一次的会被第二次的数据覆盖</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spark.sql(<span class="string">&quot;select * from ods.user_info&quot;</span>).createOrReplaceTempView(<span class="string">&quot;tempTable&quot;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="partitionBy">partitionBy</h4>
<p>设置分区字段,如果表中有该字段自动设置为分区</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">partitionBy(<span class="string">&quot;etl_date&quot;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="write">write</h4>
<p>写入表的方法，将df.wirte开始写入表，修改参数即可</p>
<h4 id="mode">mode</h4>
<p>修改写入表的形式</p>
<p>“overwrite” “append”</p>
<h4 id="saveAsTable">saveAsTable</h4>
<blockquote>
<p>保存DataFrame数据到指定hive表中。分两种情况：<code>表已经存在</code>和<code>表不存在</code></p>
<ol>
<li>
<p>如果表不存在，则会自动创建表结构。</p>
</li>
<li>
<p>如果表已经存在，则此函数的行为取决于由mode函数指定的保存模式（默认情况下抛出异常）。<br>
<code>a.mode=Overwrite时</code>，</p>
<ol>
<li>当dataframe的schema与已存在的schema个数相同：DataFrame中的列顺序不需要与现有表的列顺序相同，与insertInto不同，saveAsTable将使用列名称查找正确的列位置。（与insertInto区别点）</li>
<li>当dataframe的schema与已存在的schema个数不同：会撇弃原有的schema，按照dataframe的schema重新创建并插入。</li>
</ol>
<p><code>b.mode=Append时</code>，</p>
<ol>
<li>当dataframe的schema与已存在的schema个数相同：DataFrame中的列顺序不需要与现有表的列顺序相同。</li>
<li>当dataframe的schema与已存在的schema个数不同：会报错。</li>
</ol>
</li>
</ol>
</blockquote>
<h4 id="insertInto">insertInto</h4>
<blockquote>
<p>保存<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=DataFrame&amp;spm=1001.2101.3001.7020">DataFrame</a>数据到指定hive表中，但要求满足以下两点：</p>
<ol>
<li>指定的hive表是存在的;</li>
<li>DataFrame的schema结构顺序与指定Hive表的schema结构顺序是一致的。</li>
</ol>
</blockquote>
<h2 id="日总结">日总结</h2>
<blockquote>
<p>今天看小白的七月清洗答案，自己豁然开朗了，可以不全使用纯sql写清洗的代码了，之前自己纯sql写完七月的清洗部分代码量是十分巨大的，而且需要写字段，字段名还要一一对齐，不然无法加入表中，今天的任务把dsl风格的代码中数据清洗常用的代码都理解，就花了不少的时间。明天自己写写试。七月的清洗纯sql的无法在规定时间完成的，必须结合DSL。</p>
</blockquote>
<h1 id="使用本地VM镜像">使用本地VM镜像</h1>
<h2 id="学习日期-3-3">学习日期: 3.3</h2>
<h2 id="所学内容概述-2">所学内容概述</h2>
<p>台式机安装VM，并导入镜像，ssh顺利连接</p>
<h3 id="使用asbru中sftp">使用asbru中sftp</h3>
<p>使用sftp导出文件到本地，get 需要的文件 导入本地的地址</p>
<h2 id="BUG点">BUG点</h2>
<p>一直报错，看报错信息大致原因是没有一个什么jar包，本地的镜像好像使用的并不是mysql还是org.mariadb库，但是支持的上mysql，就不去搞原理了，把连接jar包放入spark的jars目录下，修改driver为org.mariadb.jdbc.Driver,BUG顺利解决</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230303142630541.png" alt="image-20230303142630541"></p>
<h2 id="日总结-2">日总结</h2>
<blockquote>
<p>今天大量的时间在安装本地虚拟机，h3c服务器坏了，就只能在本地安装了，上午装好了虚拟机，下午使用的时候出了BUG，差不多到晚上才解决，然后进去把环境和sql文件导入了一下，今天的任务就完成了，本来想今天使用新方法做七月的数据清洗的，只能放到明天了。</p>
</blockquote>
<h1 id="SQL结合DSL表清洗">SQL结合DSL表清洗</h1>
<h2 id="学习日期-3-4">学习日期: 3.4</h2>
<h2 id="所学内容概述-3">所学内容概述</h2>
<p>因为对清洗部分中user表是最难的，后面的表的操作模仿着user就能写完所以只放user表的代码了</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">odsClearUser</span></span>(sparkSession: <span class="type">SparkSession</span>,odsName:<span class="type">String</span>,dwdName:<span class="type">String</span>): <span class="type">Unit</span> =&#123;</span><br><span class="line">  <span class="comment">//创建df 加入需要的新的四列 只去昨天的数据</span></span><br><span class="line">  <span class="keyword">val</span> ods_user_info_df: <span class="type">DataFrame</span> = sparkSession.sql(</span><br><span class="line">    <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">      |select *,</span></span><br><span class="line"><span class="string">      |&#x27;user1&#x27; as dwd_insert_user,date_format(current_timestamp(),&quot;</span>yyyy-<span class="type">MM</span>-dd <span class="type">HH</span>:mm:<span class="string">ss&quot;) as dwd_insert_time,</span></span><br><span class="line"><span class="string">      |&#x27;user1&#x27; as dwd_modify_user,date_format(current_timestamp(),&quot;</span>yyyy-<span class="type">MM</span>-dd <span class="type">HH</span>:mm:<span class="string">ss&quot;) as dwd_modify_time</span></span><br><span class="line"><span class="string">      |from <span class="subst">$odsName</span></span></span><br><span class="line"><span class="string">      |where</span></span><br><span class="line"><span class="string">      |etl_date = <span class="subst">$date</span></span></span><br><span class="line"><span class="string">      |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">    <span class="comment">// 如果operate_time为null 使用create_time的值</span></span><br><span class="line">    .withColumn(<span class="string">&quot;operate_time&quot;</span>, coalesce(col(<span class="string">&quot;operate_time&quot;</span>), col(<span class="string">&quot;create_time&quot;</span>)))</span><br><span class="line">    <span class="comment">//删除分ods的分区列 再加入 目的是为了和dwd表合并 并加以处理</span></span><br><span class="line">    .drop(<span class="string">&quot;etl_date&quot;</span>)</span><br><span class="line">    .withColumn(<span class="string">&quot;etl_date&quot;</span>,lit(date))</span><br><span class="line">  <span class="comment">//建立临时表</span></span><br><span class="line">  ods_user_info_df.createOrReplaceTempView(<span class="string">&quot;ods_data&quot;</span>)</span><br><span class="line">  <span class="comment">//查看表数据</span></span><br><span class="line">  ods_user_info_df.show()</span><br><span class="line">  <span class="comment">//提取dwd表原有的数据并建立临时表</span></span><br><span class="line">  sparkSession.sql(</span><br><span class="line">    <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">      |select * from $dwdName</span></span><br><span class="line"><span class="string">      |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">    <span class="comment">// 如果operate_time为null 使用create_time的值</span></span><br><span class="line">    .withColumn(<span class="string">&quot;operate_time&quot;</span>, coalesce(col(<span class="string">&quot;operate_time&quot;</span>), col(<span class="string">&quot;create_time&quot;</span>)))</span><br><span class="line">  .createOrReplaceTempView(<span class="string">&quot;dwd_data&quot;</span>)</span><br><span class="line">  <span class="comment">//合并后的表 建立临时表</span></span><br><span class="line">  sparkSession.sql(</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">      |select *</span></span><br><span class="line"><span class="string">      |from ods_data</span></span><br><span class="line"><span class="string">      |union</span></span><br><span class="line"><span class="string">      |select *</span></span><br><span class="line"><span class="string">      |from dwd_data</span></span><br><span class="line"><span class="string">      |&quot;&quot;&quot;</span>.stripMargin).createOrReplaceTempView(<span class="string">&quot;unionTable&quot;</span>)</span><br><span class="line">  <span class="comment">//添加row_number列 根据operate_time排序</span></span><br><span class="line">  sparkSession.sql(</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">      |select *,row_number() over(partition by id order by operate_time desc) as _row_number</span></span><br><span class="line"><span class="string">      |from unionTable</span></span><br><span class="line"><span class="string">      |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line">    <span class="comment">//只去_row_number为1的</span></span><br><span class="line">    .where(<span class="string">&quot;_row_number=1&quot;</span>)</span><br><span class="line">    <span class="comment">//删除排顺序的这列</span></span><br><span class="line">    .drop(<span class="string">&quot;_row_number&quot;</span>)</span><br><span class="line">    <span class="comment">//修改dwd_modify_time为当前时间</span></span><br><span class="line">    <span class="comment">/*TODO ！因为在第一步取ods数据的时候添加的dwd_insert_time  dwd_modify_time</span></span><br><span class="line"><span class="comment">        都是当前时间 所以题目要求的dwd_modify_time都是要最新值的直接修改合并后的就到达了题目要求*/</span></span><br><span class="line">    .withColumn(<span class="string">&quot;dwd_modify_time&quot;</span>, date_format(current_timestamp(), <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>))</span><br><span class="line">    <span class="comment">//先放入临时表 防止dwd表又读取又写入的报错</span></span><br><span class="line">    .write.mode(<span class="string">&quot;overwrite&quot;</span>).partitionBy(<span class="string">&quot;etl_date&quot;</span>).saveAsTable(<span class="string">&quot;tempTable&quot;</span>) <span class="comment">//建立临时表</span></span><br><span class="line">  <span class="comment">//将临时表的内容覆盖写入dwd中的表</span></span><br><span class="line">  sparkSession.table(<span class="string">&quot;tempTable&quot;</span>)</span><br><span class="line">    .write.mode(<span class="string">&quot;overwrite&quot;</span>).partitionBy(<span class="string">&quot;etl_date&quot;</span>)</span><br><span class="line">    .saveAsTable(dwdName)</span><br><span class="line">  <span class="comment">//删除临时表</span></span><br><span class="line">  sparkSession.sql(<span class="string">&quot;drop table tempTable&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="BUG点-2">BUG点</h2>
<h3 id="BUG1">BUG1</h3>
<p>无法将数据导入该表</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/882B269A391DAC0CD10A39ECC347D2D6.jpg" alt="img"></p>
<blockquote>
<p>写进dwd的dim_user_info的时候,就会一直报这个错误,我直接从ods抽取前20行数据的时候,写入方法也是这样就是正常的。  找了一上午的原因没解决，没办法只能问小白的老师了。原因是:被写入的表，正在被读取，所以不能写入。先把数据写到一个中间表，再读取中间表写入目标表 。解决办法是先直接写入saveAsTable一个临时表，通过spark.table读取该表数据导入dwd层的表中，再删除表</p>
</blockquote>
<h3 id="BUG2">BUG2</h3>
<p>数据导入无法查询，之前就有这样的情况 ，发现除了decimal类型的，其他都能正常查询，搜索以后  说是hive和spark类型需要一致性</p>
<p>解决办法:</p>
<p>创建spark的df 时候加入配置</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config(<span class="string">&quot;spark.sql.parquet.writeLegacyFormat&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230304145810981.png" alt="image-20230304145810981"></p>
<h2 id="日总结-3">日总结</h2>
<blockquote>
<p>今天的任务是使用DSL结合SQL风格的spark代码，完成任务7中的数据清洗部分。参考了别人的思路，结合自己的想法将代码优化，写了能使用的方法，将表名封装为参数，能直接使用，如果需要的关键字不一样，只要复制方法略微修改一下就好了， 上午解决BUG浪费了很多时间，在晚上才完成一次成功的清洗。</p>
</blockquote>
<h1 id="7月任务1指标计算">7月任务1指标计算</h1>
<h2 id="学习日期-3-6">学习日期: 3.6</h2>
<h2 id="所学内容概述-4">所学内容概述</h2>
<p>指标计算3题</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> gz07.real.subject1</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.<span class="type">SparkSession</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">dataMath</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> spark: <span class="type">SparkSession</span> = <span class="type">SparkSession</span>.builder().master(<span class="string">&quot;local[*]&quot;</span>).appName(<span class="string">&quot;subject1Extract&quot;</span>)</span><br><span class="line">      .enableHiveSupport()</span><br><span class="line">      .config(<span class="string">&quot;hive.exec.dynamic.partition&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;hive.exec.dynamic.partition.mode&quot;</span>, <span class="string">&quot;nonstrict&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;spark.sql.parquet.writeLegacyFormat&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .getOrCreate()</span><br><span class="line">    <span class="keyword">import</span> spark.sql</span><br><span class="line">    <span class="comment">//TODO T1</span></span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        |with t1 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |province_id,final_total_amount,</span></span><br><span class="line"><span class="string">        |date_format(operate_time,&#x27;yyyy&#x27;) as year,</span></span><br><span class="line"><span class="string">        |date_format(operate_time,&#x27;MM&#x27;) as month</span></span><br><span class="line"><span class="string">        |from dwd.fact_order_info</span></span><br><span class="line"><span class="string">        |),t2 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |province_id as provinceid,sum(final_total_amount) as totalconsumption,</span></span><br><span class="line"><span class="string">        |count(1) as totalorder,</span></span><br><span class="line"><span class="string">        |year,month</span></span><br><span class="line"><span class="string">        |from t1</span></span><br><span class="line"><span class="string">        |group by province_id,year,month)</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |t2.provinceid,</span></span><br><span class="line"><span class="string">        |bp.name as provincename,</span></span><br><span class="line"><span class="string">        |br.id as regionid,</span></span><br><span class="line"><span class="string">        |br.region_name as regionname,</span></span><br><span class="line"><span class="string">        |totalconsumption,</span></span><br><span class="line"><span class="string">        |totalorder,</span></span><br><span class="line"><span class="string">        |t2.year,</span></span><br><span class="line"><span class="string">        |t2.month</span></span><br><span class="line"><span class="string">        |from t2</span></span><br><span class="line"><span class="string">        |left join dwd.dim_province bp on t2.provinceid = bp.id</span></span><br><span class="line"><span class="string">        |left join dwd.dim_region br on br.id = bp.region_id</span></span><br><span class="line"><span class="string">        |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin).write.mode(<span class="string">&quot;overwrite&quot;</span>)</span><br><span class="line">      .saveAsTable(<span class="string">&quot;dws.provinceeverymonth&quot;</span>)</span><br><span class="line">    <span class="comment">//TODO T2</span></span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |province_id as provinceid,</span></span><br><span class="line"><span class="string">        |dp.name as provincename,</span></span><br><span class="line"><span class="string">        |avg(final_total_amount) as provinceavgconsumption</span></span><br><span class="line"><span class="string">        |from dwd.fact_order_info foi</span></span><br><span class="line"><span class="string">        |left join dwd.dim_province dp on dp.id =  foi.province_id</span></span><br><span class="line"><span class="string">        |group by province_id,dp.name</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin).createOrReplaceTempView(<span class="string">&quot;everyProvince&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> d: java.math.<span class="type">BigDecimal</span> = sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |select avg(provinceavgconsumption)</span></span><br><span class="line"><span class="string">        |from</span></span><br><span class="line"><span class="string">        |everyProvince</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin).first().getDecimal(<span class="number">0</span>)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        |with t1 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |provinceid,</span></span><br><span class="line"><span class="string">        |provincename,</span></span><br><span class="line"><span class="string">        |provinceavgconsumption,</span></span><br><span class="line"><span class="string">        |$d as allprovinceavgconsumption</span></span><br><span class="line"><span class="string">        |from everyProvince)</span></span><br><span class="line"><span class="string">        |select t1.*,</span></span><br><span class="line"><span class="string">        |(case</span></span><br><span class="line"><span class="string">        |         when t1.provinceavgconsumption &gt; t1.allprovinceavgconsumption then &#x27;高&#x27;</span></span><br><span class="line"><span class="string">        |         when t1.provinceavgconsumption = t1.allprovinceavgconsumption then &#x27;相同&#x27;</span></span><br><span class="line"><span class="string">        |         when t1.provinceavgconsumption &lt; t1.allprovinceavgconsumption then &#x27;低&#x27;</span></span><br><span class="line"><span class="string">        |     end) as comparison</span></span><br><span class="line"><span class="string">        |from t1</span></span><br><span class="line"><span class="string">        |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin).write.mode(<span class="string">&quot;overwrite&quot;</span>).saveAsTable(<span class="string">&quot;dws.provinceavgcmp&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO T3</span></span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        |with t1 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |user_id as userid,</span></span><br><span class="line"><span class="string">        |cast(date_format(operate_time,&#x27;yyyyMMdd&#x27;) as int) as day,</span></span><br><span class="line"><span class="string">        |final_total_amount as consumption</span></span><br><span class="line"><span class="string">        |from</span></span><br><span class="line"><span class="string">        |dwd.fact_order_info), t2 as (</span></span><br><span class="line"><span class="string">        |select userid,day,sum(consumption) as totalconsumption,count(1) as totalorder</span></span><br><span class="line"><span class="string">        |from t1</span></span><br><span class="line"><span class="string">        |group by userid,day</span></span><br><span class="line"><span class="string">        |)</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |a.userid,</span></span><br><span class="line"><span class="string">        |dui.name,</span></span><br><span class="line"><span class="string">        |concat(a.day,&#x27;_&#x27;,b.day) as day,</span></span><br><span class="line"><span class="string">        |a.totalconsumption+b.totalconsumption as totalconsumption,</span></span><br><span class="line"><span class="string">        |a.totalorder+b.totalorder as totalorder</span></span><br><span class="line"><span class="string">        |from</span></span><br><span class="line"><span class="string">        |t2 a</span></span><br><span class="line"><span class="string">        |left join dwd.dim_user_info dui on dui.id = a.userid</span></span><br><span class="line"><span class="string">        |left join t2 b on a.userid = b.userid</span></span><br><span class="line"><span class="string">        |where</span></span><br><span class="line"><span class="string">        |a.day + 1=b.day</span></span><br><span class="line"><span class="string">        |and</span></span><br><span class="line"><span class="string">        |a.totalconsumption&lt;b.totalconsumption</span></span><br><span class="line"><span class="string">        |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin).write.mode(<span class="string">&quot;overwrite&quot;</span>)</span><br><span class="line">      .saveAsTable(<span class="string">&quot;dws.usercontinueorder&quot;</span>)</span><br><span class="line"></span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |with t1 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |user_id as userid,</span></span><br><span class="line"><span class="string">        |cast(date_format(operate_time,&#x27;yyyyMMdd&#x27;) as int) as day,</span></span><br><span class="line"><span class="string">        |final_total_amount as consumption</span></span><br><span class="line"><span class="string">        |from</span></span><br><span class="line"><span class="string">        |dwd.fact_order_info)</span></span><br><span class="line"><span class="string">        |select userid,day,sum(consumption) as totalconsumption,count(1) as totalorder</span></span><br><span class="line"><span class="string">        |from t1</span></span><br><span class="line"><span class="string">        |group by userid,day</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line">    spark.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="BUG点-3">BUG点</h2>
<p>BUG没有截图,就是在用spark提交jar包的时候，跑起来，没有报错，但是会莫名其妙的被杀死。也没找到原因，整了一上午有时候好，有时候就不行。试着重启了hadoop和hive的元数据，就很长一段时间没有再报错了，估计是spark中我存了临时表，spark没杀死，导致缓存多了，超出内存，就自动杀死了。</p>
<h2 id="日总结-4">日总结</h2>
<blockquote>
<p>今天的任务其实主要是为了熟悉7月份的表结构，每个字段代表什么，以及多表连接的公共字段，选择去做了指标计算，认为难度一般，7月份的表其实是比4月好一点的，订单表里面就有省份id，在求省份或者地区的订单金额的时候会方便很多,就不需要像4月份一样，订单表连接user表再通过user找province和region。总得来说理清楚表结构，指标计算部分还是很简单的。</p>
</blockquote>
<h1 id="7月任务3">7月任务3</h1>
<h2 id="学习日期-3-7">学习日期: 3.7</h2>
<h2 id="所学内容概述-5">所学内容概述</h2>
<p>完整版七月任务书 2小时40分钟完成</p>
<h3 id="抽取">抽取</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> gz07.real.subject3</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.<span class="type">SparkSession</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.<span class="type">Timestamp</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">dataExtract</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> spark: <span class="type">SparkSession</span> = <span class="type">SparkSession</span>.builder().master(<span class="string">&quot;local[*]&quot;</span>).appName(<span class="string">&quot;t1&quot;</span>)</span><br><span class="line">      .enableHiveSupport()</span><br><span class="line">      .config(<span class="string">&quot;hive.exec.dynamic.partition&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;hive.exec.dynamic.partition.mode&quot;</span>, <span class="string">&quot;nonstrict&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;spark.sql.parquet.writeLegacyFormat&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .getOrCreate()</span><br><span class="line">    <span class="keyword">import</span> spark.sql</span><br><span class="line">    <span class="keyword">val</span> date = <span class="string">&quot;20230306&quot;</span></span><br><span class="line">    <span class="keyword">val</span> maxUserTime: <span class="type">Timestamp</span> = sql(<span class="string">&quot;select greatest(max(create_time),max(operate_time)) from ods.user_info&quot;</span>).first().getTimestamp(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">val</span> maxOrderTime: <span class="type">Timestamp</span> = sql(<span class="string">&quot;select greatest(max(create_time),max(operate_time)) from ods.order_info&quot;</span>).first().getTimestamp(<span class="number">0</span>)</span><br><span class="line">    mysqlTempTable(spark,<span class="string">&quot;user_info&quot;</span>)</span><br><span class="line">    mysqlTempTable(spark,<span class="string">&quot;sku_info&quot;</span>)</span><br><span class="line">    mysqlTempTable(spark,<span class="string">&quot;base_province&quot;</span>)</span><br><span class="line">    mysqlTempTable(spark,<span class="string">&quot;base_region&quot;</span>)</span><br><span class="line">    mysqlTempTable(spark,<span class="string">&quot;order_info&quot;</span>)</span><br><span class="line">    mysqlTempTable(spark,<span class="string">&quot;order_detail&quot;</span>)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        |insert into table ods.user_info partition (etl_date=$date)</span></span><br><span class="line"><span class="string">        |select * from mysql_user_info</span></span><br><span class="line"><span class="string">        |where</span></span><br><span class="line"><span class="string">        |create_time &gt; &#x27;$maxUserTime&#x27; or operate_time &gt; &#x27;$maxUserTime&#x27;</span></span><br><span class="line"><span class="string">        |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        |insert into table ods.sku_info partition (etl_date=$date)</span></span><br><span class="line"><span class="string">        |select * from mysql_sku_info</span></span><br><span class="line"><span class="string">        |where</span></span><br><span class="line"><span class="string">        |create_time &gt;</span></span><br><span class="line"><span class="string">        |(select max(create_time) from ods.sku_info)</span></span><br><span class="line"><span class="string">        |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">         |insert into table ods.base_province partition (etl_date=$date)</span></span><br><span class="line"><span class="string">         |select *,</span></span><br><span class="line"><span class="string">         |current_timestamp()</span></span><br><span class="line"><span class="string">         |from mysql_base_province</span></span><br><span class="line"><span class="string">         |where</span></span><br><span class="line"><span class="string">         |id &gt;</span></span><br><span class="line"><span class="string">         |(select max(id) from ods.base_province)</span></span><br><span class="line"><span class="string">         |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line"></span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">         |insert into table ods.base_region partition (etl_date=$date)</span></span><br><span class="line"><span class="string">         |select *,</span></span><br><span class="line"><span class="string">         |current_timestamp()</span></span><br><span class="line"><span class="string">         |from mysql_base_region</span></span><br><span class="line"><span class="string">         |where</span></span><br><span class="line"><span class="string">         |id &gt;</span></span><br><span class="line"><span class="string">         |(select max(id) from ods.base_region)</span></span><br><span class="line"><span class="string">         |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">         |insert into table ods.order_info partition (etl_date=$date)</span></span><br><span class="line"><span class="string">         |select * from mysql_order_info</span></span><br><span class="line"><span class="string">         |where</span></span><br><span class="line"><span class="string">         |create_time &gt; &#x27;$maxOrderTime&#x27; or operate_time &gt; &#x27;$maxOrderTime&#x27;</span></span><br><span class="line"><span class="string">         |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">         |insert into table ods.order_detail partition (etl_date=$date)</span></span><br><span class="line"><span class="string">         |select * from mysql_order_detail</span></span><br><span class="line"><span class="string">         |where</span></span><br><span class="line"><span class="string">         |create_time &gt;</span></span><br><span class="line"><span class="string">         |(select max(create_time) from ods.order_detail)</span></span><br><span class="line"><span class="string">         |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mysqlTempTable</span></span>(sparkSession: <span class="type">SparkSession</span>,mysqlName:<span class="type">String</span>): <span class="type">Unit</span> = &#123;</span><br><span class="line">      <span class="keyword">val</span> url = <span class="string">&quot;jdbc:mysql://172.16.42.128/dspub?useSSL = false&quot;</span></span><br><span class="line">      <span class="keyword">val</span> driver = <span class="string">&quot;org.mariadb.jdbc.Driver&quot;</span></span><br><span class="line">      <span class="keyword">val</span> user = <span class="string">&quot;root&quot;</span></span><br><span class="line">      <span class="keyword">val</span> password = <span class="string">&quot;admin&quot;</span></span><br><span class="line">      sparkSession.read.format(<span class="string">&quot;jdbc&quot;</span>)</span><br><span class="line">        .option(<span class="string">&quot;url&quot;</span>, url)</span><br><span class="line">        .option(<span class="string">&quot;driver&quot;</span>, driver)</span><br><span class="line">        .option(<span class="string">&quot;user&quot;</span>, user)</span><br><span class="line">        .option(<span class="string">&quot;password&quot;</span>, password)</span><br><span class="line">        .option(<span class="string">&quot;dbtable&quot;</span>, mysqlName).load().createTempView(<span class="string">s&quot;mysql_<span class="subst">$mysqlName</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="清洗">清洗</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> gz07.real.subject3</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.<span class="type">SparkSession</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.functions._</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">dataClear</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> spark: <span class="type">SparkSession</span> = <span class="type">SparkSession</span>.builder().master(<span class="string">&quot;local[*]&quot;</span>).appName(<span class="string">&quot;t2&quot;</span>)</span><br><span class="line">      .enableHiveSupport()</span><br><span class="line">      .config(<span class="string">&quot;hive.exec.dynamic.partition&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;hive.exec.dynamic.partition.mode&quot;</span>, <span class="string">&quot;nonstrict&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;spark.sql.parquet.writeLegacyFormat&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .getOrCreate()</span><br><span class="line">    <span class="keyword">import</span> spark.sql</span><br><span class="line">    <span class="keyword">val</span> date = <span class="string">&quot;20230306&quot;</span></span><br><span class="line">    odsUserClear(spark,<span class="string">&quot;ods.user_info&quot;</span>,<span class="string">&quot;dwd.dim_user_info&quot;</span>)</span><br><span class="line">    odsSkuClear(spark,<span class="string">&quot;ods.sku_info&quot;</span>,<span class="string">&quot;dwd.dim_sku_info&quot;</span>)</span><br><span class="line">    odsSkuClear(spark,<span class="string">&quot;ods.base_province&quot;</span>,<span class="string">&quot;dwd.dim_province&quot;</span>)</span><br><span class="line">    odsSkuClear(spark,<span class="string">&quot;ods.base_region&quot;</span>,<span class="string">&quot;dwd.dim_region&quot;</span>)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        |select *,</span></span><br><span class="line"><span class="string">        |&#x27;user1&#x27; as dwd_insert_user,date_format(current_timestamp(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;) as dwd_insert_time,</span></span><br><span class="line"><span class="string">        |&#x27;user1&#x27; as dwd_modify_user,date_format(current_timestamp(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;) as dwd_modify_time</span></span><br><span class="line"><span class="string">        |from ods.order_info</span></span><br><span class="line"><span class="string">        |where etl_date=$date</span></span><br><span class="line"><span class="string">        |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">      .withColumn(<span class="string">&quot;operate_time&quot;</span>,coalesce(col(<span class="string">&quot;operate_time&quot;</span>),col(<span class="string">&quot;create_time&quot;</span>)))</span><br><span class="line">      .withColumn(<span class="string">&quot;etl_date&quot;</span>,date_format(col(<span class="string">&quot;create_time&quot;</span>),<span class="string">&quot;yyyyMMdd&quot;</span>))</span><br><span class="line">      .write.mode(<span class="string">&quot;overwrite&quot;</span>).partitionBy(<span class="string">&quot;etl_date&quot;</span>).saveAsTable(<span class="string">&quot;dwd.fact_order_info&quot;</span>)</span><br><span class="line"></span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">         |select *,</span></span><br><span class="line"><span class="string">         |&#x27;user1&#x27; as dwd_insert_user,date_format(current_timestamp(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;) as dwd_insert_time,</span></span><br><span class="line"><span class="string">         |&#x27;user1&#x27; as dwd_modify_user,date_format(current_timestamp(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;) as dwd_modify_time</span></span><br><span class="line"><span class="string">         |from ods.order_detail</span></span><br><span class="line"><span class="string">         |where etl_date=$date</span></span><br><span class="line"><span class="string">         |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">      .withColumn(<span class="string">&quot;etl_date&quot;</span>, date_format(col(<span class="string">&quot;create_time&quot;</span>), <span class="string">&quot;yyyyMMdd&quot;</span>))</span><br><span class="line">      .write.mode(<span class="string">&quot;overwrite&quot;</span>).partitionBy(<span class="string">&quot;etl_date&quot;</span>).saveAsTable(<span class="string">&quot;dwd.fact_order_detail&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">odsUserClear</span></span>(sparkSession: <span class="type">SparkSession</span>,odsName:<span class="type">String</span>,dwdName:<span class="type">String</span>): <span class="type">Unit</span> = &#123;</span><br><span class="line">      sparkSession.sql(</span><br><span class="line">        <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">          |select *,</span></span><br><span class="line"><span class="string">          |&#x27;user1&#x27; as dwd_insert_user,date_format(current_timestamp(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;) as dwd_insert_time,</span></span><br><span class="line"><span class="string">          |&#x27;user1&#x27; as dwd_modify_user,date_format(current_timestamp(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;) as dwd_modify_time</span></span><br><span class="line"><span class="string">          |from $odsName</span></span><br><span class="line"><span class="string">          |where etl_date = $date</span></span><br><span class="line"><span class="string">          |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">        .drop(<span class="string">&quot;etl_date&quot;</span>)</span><br><span class="line">        .withColumn(<span class="string">&quot;etl_date&quot;</span>,lit(date))</span><br><span class="line">        .createOrReplaceTempView(<span class="string">&quot;ods_data&quot;</span>)</span><br><span class="line">      sparkSession.sql(</span><br><span class="line">        <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">          |select * from $dwdName</span></span><br><span class="line"><span class="string">          |where etl_date = $date</span></span><br><span class="line"><span class="string">          |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">        .createOrReplaceTempView(<span class="string">&quot;dwd_data&quot;</span>)</span><br><span class="line">      sparkSession.sql(</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">          |select * from ods_data</span></span><br><span class="line"><span class="string">          |union</span></span><br><span class="line"><span class="string">          |select * from dwd_data</span></span><br><span class="line"><span class="string">          |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line">        .withColumn(<span class="string">&quot;operate_time&quot;</span>,coalesce(col(<span class="string">&quot;operate_time&quot;</span>),col(<span class="string">&quot;create_time&quot;</span>)))</span><br><span class="line">        .createOrReplaceTempView(<span class="string">&quot;union_data&quot;</span>)</span><br><span class="line">      sparkSession.sql(</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">          |select *,row_number() over(partition by id order by operate_time desc) as time_rank</span></span><br><span class="line"><span class="string">          |from union_data</span></span><br><span class="line"><span class="string">          |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line">        .where(<span class="string">&quot;time_rank=1&quot;</span>)</span><br><span class="line">        .drop(<span class="string">&quot;time_rank&quot;</span>)</span><br><span class="line">        .withColumn(<span class="string">&quot;dwd_modify_time&quot;</span>,date_format(current_timestamp(),<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>))</span><br><span class="line">        .write.mode(<span class="string">&quot;overwrite&quot;</span>).partitionBy(<span class="string">&quot;etl_date&quot;</span>).saveAsTable(<span class="string">&quot;temptable&quot;</span>)</span><br><span class="line">      sparkSession.table(<span class="string">&quot;temptable&quot;</span>)</span><br><span class="line">        .write.mode(<span class="string">&quot;overwrite&quot;</span>).partitionBy(<span class="string">&quot;etl_date&quot;</span>)</span><br><span class="line">        .saveAsTable(dwdName)</span><br><span class="line">      sparkSession.sql(<span class="string">&quot;drop table temptable&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">odsSkuClear</span></span>(sparkSession: <span class="type">SparkSession</span>, odsName: <span class="type">String</span>, dwdName: <span class="type">String</span>): <span class="type">Unit</span> = &#123;</span><br><span class="line">      sparkSession.sql(</span><br><span class="line">        <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">           |select *,</span></span><br><span class="line"><span class="string">           |&#x27;user1&#x27; as dwd_insert_user,date_format(current_timestamp(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;) as dwd_insert_time,</span></span><br><span class="line"><span class="string">           |&#x27;user1&#x27; as dwd_modify_user,date_format(current_timestamp(),&#x27;yyyy-MM-dd HH:mm:ss&#x27;) as dwd_modify_time</span></span><br><span class="line"><span class="string">           |from $odsName</span></span><br><span class="line"><span class="string">           |where etl_date = $date</span></span><br><span class="line"><span class="string">           |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">        .drop(<span class="string">&quot;etl_date&quot;</span>)</span><br><span class="line">        .withColumn(<span class="string">&quot;etl_date&quot;</span>, lit(date))</span><br><span class="line">        .createOrReplaceTempView(<span class="string">&quot;ods_data&quot;</span>)</span><br><span class="line">      sparkSession.sql(</span><br><span class="line">        <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">           |select * from $dwdName</span></span><br><span class="line"><span class="string">           |where etl_date = $date</span></span><br><span class="line"><span class="string">           |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin)</span><br><span class="line">        .createOrReplaceTempView(<span class="string">&quot;dwd_data&quot;</span>)</span><br><span class="line">      sparkSession.sql(</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">          |select * from ods_data</span></span><br><span class="line"><span class="string">          |union</span></span><br><span class="line"><span class="string">          |select * from dwd_data</span></span><br><span class="line"><span class="string">          |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line">        .createOrReplaceTempView(<span class="string">&quot;union_data&quot;</span>)</span><br><span class="line">      sparkSession.sql(</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">          |select *,row_number() over(partition by id order by create_time desc) as time_rank</span></span><br><span class="line"><span class="string">          |from union_data</span></span><br><span class="line"><span class="string">          |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line">        .where(<span class="string">&quot;time_rank=1&quot;</span>)</span><br><span class="line">        .drop(<span class="string">&quot;time_rank&quot;</span>)</span><br><span class="line">        .withColumn(<span class="string">&quot;dwd_modify_time&quot;</span>, date_format(current_timestamp(), <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>))</span><br><span class="line">        .write.mode(<span class="string">&quot;overwrite&quot;</span>).partitionBy(<span class="string">&quot;etl_date&quot;</span>).saveAsTable(<span class="string">&quot;temptable&quot;</span>)</span><br><span class="line">      sparkSession.table(<span class="string">&quot;temptable&quot;</span>)</span><br><span class="line">        .write.mode(<span class="string">&quot;overwrite&quot;</span>).partitionBy(<span class="string">&quot;etl_date&quot;</span>)</span><br><span class="line">        .saveAsTable(dwdName)</span><br><span class="line">      sparkSession.sql(<span class="string">&quot;drop table temptable&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="指标计算">指标计算</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> gz07.real.subject3</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.&#123;<span class="type">DataFrame</span>, <span class="type">SparkSession</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">dataMath</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> spark: <span class="type">SparkSession</span> = <span class="type">SparkSession</span>.builder().master(<span class="string">&quot;local[*]&quot;</span>).appName(<span class="string">&quot;t3&quot;</span>)</span><br><span class="line">      .enableHiveSupport()</span><br><span class="line">      .config(<span class="string">&quot;hive.exec.dynamic.partition&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;hive.exec.dynamic.partition.mode&quot;</span>, <span class="string">&quot;nonstrict&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;spark.sql.parquet.writeLegacyFormat&quot;</span>, <span class="string">&quot;true&quot;</span>)</span><br><span class="line">      .getOrCreate()</span><br><span class="line">    <span class="keyword">import</span> spark.sql</span><br><span class="line">    <span class="keyword">val</span> t1: <span class="type">DataFrame</span> = sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |with t1 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |province_id,</span></span><br><span class="line"><span class="string">        |final_total_amount,</span></span><br><span class="line"><span class="string">        |substring(etl_date,1,4) as year,</span></span><br><span class="line"><span class="string">        |substring(etl_date,5,2) as month</span></span><br><span class="line"><span class="string">        |from dwd.fact_order_info foi), t2 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |province_id,</span></span><br><span class="line"><span class="string">        |sum(final_total_amount) as total_amount,</span></span><br><span class="line"><span class="string">        |count(1) as total_count,</span></span><br><span class="line"><span class="string">        |year,</span></span><br><span class="line"><span class="string">        |month</span></span><br><span class="line"><span class="string">        |from t1</span></span><br><span class="line"><span class="string">        |group by province_id,year,month)</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |province_id,</span></span><br><span class="line"><span class="string">        |dp.name as province_name,</span></span><br><span class="line"><span class="string">        |dr.id as region_id,</span></span><br><span class="line"><span class="string">        |dr.region_name as region_name,</span></span><br><span class="line"><span class="string">        |total_amount,</span></span><br><span class="line"><span class="string">        |total_count,</span></span><br><span class="line"><span class="string">        |row_number() over(partition by year,month,dr.id order by total_amount desc) as sequence,</span></span><br><span class="line"><span class="string">        |year,month</span></span><br><span class="line"><span class="string">        |from t2</span></span><br><span class="line"><span class="string">        |left join dwd.dim_province dp on dp.id = t2.province_id</span></span><br><span class="line"><span class="string">        |left join dwd.dim_region dr on dr.id = dp.region_id</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line">    t1.show()</span><br><span class="line">    t1.write.mode(<span class="string">&quot;overwrite&quot;</span>)</span><br><span class="line">      .saveAsTable(<span class="string">&quot;dws.province_consumption_day_aggr&quot;</span>)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |with t1 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |region_id,</span></span><br><span class="line"><span class="string">        |sum(total_amount)/sum(total_count) as regionavgconsumption</span></span><br><span class="line"><span class="string">        |from dws.province_consumption_day_aggr</span></span><br><span class="line"><span class="string">        |group by region_id), t2 as (</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |province_id as provinceid,</span></span><br><span class="line"><span class="string">        |province_name as provincename,</span></span><br><span class="line"><span class="string">        |total_amount/total_count as provinceavgconsumption,</span></span><br><span class="line"><span class="string">        |t1.region_id as regionid,</span></span><br><span class="line"><span class="string">        |region_name as regionname,</span></span><br><span class="line"><span class="string">        |t1.regionavgconsumption as regionavgconsumption</span></span><br><span class="line"><span class="string">        |from dws.province_consumption_day_aggr pcda</span></span><br><span class="line"><span class="string">        |left join t1 on pcda.region_id = t1.region_id)</span></span><br><span class="line"><span class="string">        |select t2.*,</span></span><br><span class="line"><span class="string">        |case</span></span><br><span class="line"><span class="string">        |   when provinceavgconsumption&gt;regionavgconsumption then &#x27;高&#x27;</span></span><br><span class="line"><span class="string">        |   when provinceavgconsumption=regionavgconsumption then &#x27;相同&#x27;</span></span><br><span class="line"><span class="string">        |   when provinceavgconsumption&lt;regionavgconsumption then &#x27;低&#x27; end</span></span><br><span class="line"><span class="string">        |from t2</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin).createOrReplaceTempView(<span class="string">&quot;t2TableTemp&quot;</span>)</span><br><span class="line">    mysqlTempTable(spark,<span class="string">&quot;provinceavgcmpregion&quot;</span>)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |insert overwrite table mysql_provinceavgcmpregion</span></span><br><span class="line"><span class="string">        |select * from t2TableTemp</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line"></span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |region_id,</span></span><br><span class="line"><span class="string">        |region_name,</span></span><br><span class="line"><span class="string">        |province_id,</span></span><br><span class="line"><span class="string">        |province_name,</span></span><br><span class="line"><span class="string">        |total_amount,</span></span><br><span class="line"><span class="string">        |row_number() over(partition by region_id order by total_amount desc) as threeprovince</span></span><br><span class="line"><span class="string">        |from dws.province_consumption_day_aggr</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin).where(<span class="string">&quot;threeprovince&lt;=3&quot;</span>).drop(<span class="string">&quot;threeprovince&quot;</span>).createOrReplaceTempView(<span class="string">&quot;t3Temp&quot;</span>)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |select</span></span><br><span class="line"><span class="string">        |region_id,</span></span><br><span class="line"><span class="string">        |region_name,</span></span><br><span class="line"><span class="string">        |concat_ws(&#x27;,&#x27;,collect_set(cast(province_id as string))) as provinceids,</span></span><br><span class="line"><span class="string">        |concat_ws(&#x27;,&#x27;,collect_set(province_name)) as provincenames,</span></span><br><span class="line"><span class="string">        |concat_ws(&#x27;,&#x27;,collect_set(cast(total_amount as string))) as provinceamount</span></span><br><span class="line"><span class="string">        |from</span></span><br><span class="line"><span class="string">        |t3Temp</span></span><br><span class="line"><span class="string">        |group by region_id,region_name</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin).createOrReplaceTempView(<span class="string">&quot;t333&quot;</span>)</span><br><span class="line">    mysqlTempTable(spark,<span class="string">&quot;regiontopthree&quot;</span>)</span><br><span class="line">    sql(</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |insert overwrite table mysql_regiontopthree</span></span><br><span class="line"><span class="string">        |select * from t333</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mysqlTempTable</span></span>(sparkSession: <span class="type">SparkSession</span>, mysqlName: <span class="type">String</span>): <span class="type">Unit</span> = &#123;</span><br><span class="line">      <span class="keyword">val</span> url = <span class="string">&quot;jdbc:mysql://172.16.42.128/shtd_result?useSSL = false&quot;</span></span><br><span class="line">      <span class="keyword">val</span> driver = <span class="string">&quot;org.mariadb.jdbc.Driver&quot;</span></span><br><span class="line">      <span class="keyword">val</span> user = <span class="string">&quot;root&quot;</span></span><br><span class="line">      <span class="keyword">val</span> password = <span class="string">&quot;admin&quot;</span></span><br><span class="line">      sparkSession.read.format(<span class="string">&quot;jdbc&quot;</span>)</span><br><span class="line">        .option(<span class="string">&quot;url&quot;</span>, url)</span><br><span class="line">        .option(<span class="string">&quot;driver&quot;</span>, driver)</span><br><span class="line">        .option(<span class="string">&quot;user&quot;</span>, user)</span><br><span class="line">        .option(<span class="string">&quot;password&quot;</span>, password)</span><br><span class="line">        .option(<span class="string">&quot;dbtable&quot;</span>, mysqlName).load().createTempView(<span class="string">s&quot;mysql_<span class="subst">$mysqlName</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="BUG点-4">BUG点</h2>
<p>指标计算最后一题的时候，是之前没怎么做过的类型，是列转行，想起来了collect_set和concat_ws两个方法能实现任务目标，但是报错了，看报错信息，明白了似乎是province_id的类型不对需要是array<string> 或者是string，就去用cast (xxx as string)转换成string再放进去，问题解决。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230307184042519.png" alt="image-20230307184042519"></p>
<h2 id="扩展学习">扩展学习</h2>
<p>想得到这样的表</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230307191546184.png" alt="image-20230307191546184"></p>
<p>多行变一行 有公共列</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDA4MDQ0NQ==,size_16,color_FFFFFF,t_70.png" alt="在这里插入图片描述"></p>
<p>1).先使用collect_set函数使多行成为一行数组</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select name,collect_set(subject)  res1 ,</span><br><span class="line">    &gt; collect_set(cast(score as string)) res2 </span><br><span class="line">    &gt; from stu group by name;</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/202106191527505.png" alt="在这里插入图片描述"></p>
<p>2). 加上concat_ws函数可以取出数组中的每一个元素的值在用分隔符连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select name,concat_ws(&#x27;@&#x27;,collect_set(subject))  res1 ,</span><br><span class="line">    &gt; concat_ws(&#x27;-&#x27;,collect_set(cast(score as string))) res2 </span><br><span class="line">    &gt; from stu group by name;</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/20210619152910469.png" alt="在这里插入图片描述"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hive&gt;select substr(&#x27;qwertyuio&#x27;,0,4)</span><br><span class="line">--qwer、</span><br><span class="line">对字符串的 </span><br><span class="line">第一个参数是从哪个位置开始</span><br><span class="line">第二个参数是取几位数 </span><br></pre></td></tr></table></figure>
<h2 id="日总结-5">日总结</h2>
<blockquote>
<p>今天做题的状态极佳，应该是前几天都在研究七月任务7，因此前面的抽取和清洗只花了大概1小时20分钟，剩下时间在做指标计算，指标计算已经熟悉表结构了而且连接的表不是很多就一两个，所以我认为难度一般，最后一题只是刚开始被吓到了，其实只要使用两个函数再结合分组就能很顺利的解决，整体做下来，将近快3个小时了，还是比四月份难很多的。过程中也是出现了几次小错误，也没浪费多少时间在修改上。</p>
</blockquote>
<h1 id="7月任务4-指标计算">7月任务4 指标计算</h1>
<h2 id="学习日期-3-9">学习日期: 3.9</h2>
<h2 id="所学内容概述-6">所学内容概述</h2>
<p>其他几题没什么问题，在第二题的时候犯了难。</p>
<h3 id="t1">t1</h3>
<p>简单的表连接和分组。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//TODO t1</span></span><br><span class="line">sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |with t1 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |final_total_amount,</span></span><br><span class="line"><span class="string">    |province_id,</span></span><br><span class="line"><span class="string">    |substring(etl_date,4,0) as year,</span></span><br><span class="line"><span class="string">    |substring(etl_date,5,2) as month</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |dwd.fact_order_info),</span></span><br><span class="line"><span class="string">    |t2 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |province_id,</span></span><br><span class="line"><span class="string">    |sum(t1.final_total_amount) as total_amount,</span></span><br><span class="line"><span class="string">    |count(1) as total_count,</span></span><br><span class="line"><span class="string">    |year,month</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t1</span></span><br><span class="line"><span class="string">    |group by province_id,year,month)</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |t2.province_id as province_id,</span></span><br><span class="line"><span class="string">    |dp.name as province_name,</span></span><br><span class="line"><span class="string">    |dr.id  as region_id,</span></span><br><span class="line"><span class="string">    |dr.region_name as region_name,</span></span><br><span class="line"><span class="string">    |t2.total_amount,</span></span><br><span class="line"><span class="string">    |t2.total_count,</span></span><br><span class="line"><span class="string">    |row_number() over(partition by year,month,region_id order by total_amount desc) as sequence,</span></span><br><span class="line"><span class="string">    |year,month</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t2</span></span><br><span class="line"><span class="string">    |left join dwd.dim_province dp on dp.id = t2.province_id</span></span><br><span class="line"><span class="string">    |left join dwd.dim_region dr on dr.id = dp.region_id</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin).write.mode(<span class="string">&quot;overwrite&quot;</span>)</span><br><span class="line">  .saveAsTable(<span class="string">&quot;dws.province_consumption_day_aggr&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="t2">t2</h3>
<p>任务如下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230313082722921.png" alt="image-20230313082722921"></p>
<blockquote>
<p>最开始的想法是将销售量和销售额前十的表都先查找出来，然后结合，结合以后排序即可。</p>
</blockquote>
<ul>
<li>结果如下，没有达到自己的要求，不是直接合并，而是出现了笛卡尔积，销售量表和销售额表的数据是直接相乘了。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230313082922761.png" alt="image-20230313082922761"></p>
<ul>
<li>又想到一种方法，将两个表都多出一行根据 各自需要降序排序的数据，列出排名，根据排名进行join，这样就能达到两个表的连接，然后使用drop删除左边的排序信息。实现代码如下</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//TODO t2</span></span><br><span class="line">sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |with t1 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |sku_id,sku_name,order_price,cast(sum(sku_num) as int) as skuSum,</span></span><br><span class="line"><span class="string">    |cast(sum(sku_num)*order_price as int) as skuOrderSum</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |dwd.fact_order_detail</span></span><br><span class="line"><span class="string">    |group by sku_id,sku_name,order_price),</span></span><br><span class="line"><span class="string">    |t2 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |t1.sku_id as topquantityid,</span></span><br><span class="line"><span class="string">    |t1.sku_name as topquantityname,</span></span><br><span class="line"><span class="string">    |t1.skuSum as topquantity,</span></span><br><span class="line"><span class="string">    |row_number() over(order by t1.skuSum desc,t1.sku_id) as topTenQuantity</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t1</span></span><br><span class="line"><span class="string">    |limit 10),</span></span><br><span class="line"><span class="string">    |t3 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |t1.sku_id as toppriceid,</span></span><br><span class="line"><span class="string">    |t1.sku_name as toppricename,</span></span><br><span class="line"><span class="string">    |t1.skuOrderSum as topprice,</span></span><br><span class="line"><span class="string">    |row_number() over(order by t1.skuOrderSum desc) as sequence</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t1</span></span><br><span class="line"><span class="string">    |limit 10)</span></span><br><span class="line"><span class="string">    |select topquantityid,</span></span><br><span class="line"><span class="string">    |topquantityname,</span></span><br><span class="line"><span class="string">    |topquantity,</span></span><br><span class="line"><span class="string">    |t3.*</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t2</span></span><br><span class="line"><span class="string">    |left join t3 on t2.topTenQuantity=t3.sequence</span></span><br><span class="line"><span class="string">    |order by t3.sequence</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin).createOrReplaceTempView(<span class="string">&quot;t2&quot;</span>)</span><br><span class="line">mysqlTempTable(spark,<span class="string">&quot;topten&quot;</span>)</span><br><span class="line">sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |insert overwrite table mysql_topten</span></span><br><span class="line"><span class="string">    |select * from t2</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>加入MySQL表 以及完成任务</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230313091804187.png" alt="image-20230313091804187"></p>
<p>###t3</p>
<p>这个是要求求中位数的之前没有使用过，但是题目提供了函数方法。</p>
<blockquote>
<p>percentile(col,doule) 该方法第一个参数是列，列的要求是整数bigint或者array(doule),因为是中位数，第二个参数就是0.5，如果要3/4的值的话就是0.75,以此类推</p>
</blockquote>
<p>问题就不会很难了，求两个表一个省份中位数，一个地区中位数，join即可</p>
<ul>
<li>代码实现如下</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//TODO t3</span></span><br><span class="line">sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |with t1 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |foi.province_id as provinceid,</span></span><br><span class="line"><span class="string">    |dp.name as provincename,</span></span><br><span class="line"><span class="string">    |dr.id as regionid,</span></span><br><span class="line"><span class="string">    |percentile(cast(final_total_amount as bigint),0.5) as provincemedian</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |dwd.fact_order_info foi</span></span><br><span class="line"><span class="string">    |left join dwd.dim_province dp on dp.id = foi.province_id</span></span><br><span class="line"><span class="string">    |left join dwd.dim_region dr on dr.id = dp.region_id</span></span><br><span class="line"><span class="string">    |group by foi.province_id,dp.name,dr.id),</span></span><br><span class="line"><span class="string">    |t2 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |dr.id as regionid,</span></span><br><span class="line"><span class="string">    |dr.region_name as regionname,</span></span><br><span class="line"><span class="string">    |percentile(cast(final_total_amount as bigint),0.5) as regionmedian</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |dwd.fact_order_info foi</span></span><br><span class="line"><span class="string">    |left join dwd.dim_province dp on dp.id = foi.province_id</span></span><br><span class="line"><span class="string">    |left join dwd.dim_region dr on dr.id = dp.region_id</span></span><br><span class="line"><span class="string">    |group by dr.id,region_name</span></span><br><span class="line"><span class="string">    |)</span></span><br><span class="line"><span class="string">    |select t1.provinceid,t1.provincename,t2.regionid,t2.regionname,</span></span><br><span class="line"><span class="string">    |t1.provincemedian,t2.regionmedian</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t1</span></span><br><span class="line"><span class="string">    |left join t2 on t1.regionid = t2.regionid</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin).createOrReplaceTempView(<span class="string">&quot;t3&quot;</span>)</span><br><span class="line">mysqlTempTable(spark, <span class="string">&quot;nationmedian&quot;</span>)</span><br><span class="line">sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |insert overwrite table mysql_nationmedian</span></span><br><span class="line"><span class="string">    |select * from t3</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>mysql执行命令以及结果</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230313100851640.png" alt="image-20230313100851640"></p>
<h2 id="BUG点-5">BUG点</h2>
<p>想将两个表给合并起来，就想到了之前使用过的select t1.x,t2.x from t2,t3报了错误，看报错信息是hive不支持笛卡尔积的使用，在hive中开启笛卡尔积就能解决报错。开启方法如下在截图最后两行。如果放在spark中提交的话，还是会报错。报错信息是crossJoin也是笛卡尔，需要用如下的代码解决</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spark.conf.set(<span class="string">&quot;spark.sql.crossJoin.enabled&quot;</span>,<span class="string">&quot;true&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230313081819796.png" alt="image-20230313081819796"></p>
<h2 id="日总结-6">日总结</h2>
<blockquote>
<p>今天完成了任务4的指标计算部分，上午花时间和小白老师以及江苏省第一的朋友探讨了一下，对题目模糊不清的要求的看法，清洗部分对dwd表是overwrite还是append等。改天会具体列出来，还有最后指标计算对order表要不要取最新分区的看法还没讨论出结果。然后就是任务四，一路上除了第二题出了点问题，还是顺利的，而且第二题也顺利解决了问题，今天学习状态也不错，做题顺利。</p>
</blockquote>
<h1 id="7月任务书讨论">7月任务书讨论</h1>
<h2 id="学习日期-3-10">学习日期: 3.10</h2>
<h2 id="所学内容概述-7">所学内容概述</h2>
<p>问题疑惑点如下:</p>
<p>###　问题一</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230313102707184.png" alt="image-20230313102707184"></p>
<blockquote>
<p>因为我们是不知道dwd表中的数据以及分区是什么样子的，只能推测。根据业务理解，可以认为ods的数据是比赛日期的昨天的，而dwd的数据是昨天之前的，也就是前天或者更早的，题目要求ods取昨天的分区，dwd取最新的分区，假设这个最新的分区就是前天的，那和ods通过id去重以后的数据再放入dwd的时候，是append还是overwrite，还是说append然后将重复的id删除了。</p>
<p>经过讨论认为直接append的就好了，虽然会有重复的id但是分区是不一样的。如果是真实的业务上的话，其实是应该对表的id去重的，因为userid是主键是唯一值。</p>
</blockquote>
<h3 id="问题二-未解决">问题二(未解决)</h3>
<p>在指标计算中都会有这么一句话，以前没有注意，看到以后发现是要取分区的，但是我又去看了小白的代码，发现他并没有对order表取最新分区。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230313104805961.png" alt="image-20230313104805961"></p>
<blockquote>
<p>小白给我的解释是order表是事实表不是维表所以不取分区，问了福建比赛的朋友，他也说不用取，但是江苏第一说他比赛的时候order取了最新的分区，一时间不知道听哪个的，我自己认为表的确是有维表和事实表的区别，所以题目要求维表，order的确是不用取最新分区的。但是江苏第一说他比赛的时候取的，结果是全对的。…等后面问四合的老师吧。</p>
</blockquote>
<h2 id="扩展学习-2">扩展学习</h2>
<p>将7月任务书综合分析部分都使用chatgpt，将问题回答完整并做了总结。总结完以后发现也就6个问题，每天背一下记一下，比赛前应该都能记住了。</p>
<h2 id="日总结-7">日总结</h2>
<blockquote>
<p>对任务书疑惑点进行讨论，结合大家看法，找到最合理的解决办法，以及题目理解。比较突出的其实就我列出来的两个问题，其他的大家的理解都基本一致。总结差不多都写上面了。然后就是7月任务书综合分析部分都使用chatgpt，将问题回答完整并做了总结。总结完以后发现也就6个问题，每天背一下记一下，比赛前应该都能记住了。</p>
</blockquote>
<h1 id="7月任务书5-指标计算">7月任务书5 指标计算</h1>
<h2 id="学习日期-3-13">学习日期: 3.13</h2>
<h2 id="所学内容概述-8">所学内容概述</h2>
<h3 id="第一题">第一题</h3>
<p>其他很多任务书都有这题，就不细说了</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |with t1 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |final_total_amount,</span></span><br><span class="line"><span class="string">    |province_id,</span></span><br><span class="line"><span class="string">    |substring(etl_date,4,0) as year,</span></span><br><span class="line"><span class="string">    |substring(etl_date,5,2) as month</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |dwd.fact_order_info),</span></span><br><span class="line"><span class="string">    |t2 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |province_id,</span></span><br><span class="line"><span class="string">    |sum(t1.final_total_amount) as total_amount,</span></span><br><span class="line"><span class="string">    |count(1) as total_count,</span></span><br><span class="line"><span class="string">    |year,month</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t1</span></span><br><span class="line"><span class="string">    |group by province_id,year,month)</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |t2.province_id as province_id,</span></span><br><span class="line"><span class="string">    |dp.name as province_name,</span></span><br><span class="line"><span class="string">    |dr.id  as region_id,</span></span><br><span class="line"><span class="string">    |dr.region_name as region_name,</span></span><br><span class="line"><span class="string">    |t2.total_amount,</span></span><br><span class="line"><span class="string">    |t2.total_count,</span></span><br><span class="line"><span class="string">    |row_number() over(partition by year,month,region_id order by total_amount desc) as sequence,</span></span><br><span class="line"><span class="string">    |year,month</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t2</span></span><br><span class="line"><span class="string">    |left join dwd.dim_province dp on dp.id = t2.province_id</span></span><br><span class="line"><span class="string">    |left join dwd.dim_region dr on dr.id = dp.region_id</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin).write.mode(<span class="string">&quot;overwrite&quot;</span>)</span><br><span class="line">  .saveAsTable(<span class="string">&quot;dws.province_consumption_day_aggr&quot;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="第二题">第二题</h3>
<blockquote>
<p>计算连续两天下单的用户与已下单用户的占比，将结果存入MySQL数据库shtd_result的userrepurchasedrate表中</p>
</blockquote>
<p>分析题目要求，求出下单用户，和连续两天下单的用户，然后占比，也就是一行即可，那就可以使用dsl的getLong获取数量，再最后导入表的时候使用常量值就行了。代码如下：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> l1: <span class="type">Long</span> = sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |select count(*) from dwd.fact_order_info</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin).first().getLong(<span class="number">0</span>) <span class="comment">//已下单人数</span></span><br><span class="line">println(l1+<span class="string">&quot;*******************************************************************&quot;</span>)</span><br><span class="line"><span class="keyword">val</span> l2: <span class="type">Long</span> = sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |with t1 as(</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |user_id as userid,</span></span><br><span class="line"><span class="string">    |cast(date_format(create_time,&#x27;yyyyMMdd&#x27;) as int) as day,</span></span><br><span class="line"><span class="string">    |final_total_amount</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |dwd.fact_order_info a),</span></span><br><span class="line"><span class="string">    |t2 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |userid,day,sum(final_total_amount) as sumorder</span></span><br><span class="line"><span class="string">    |from t1</span></span><br><span class="line"><span class="string">    |group by userid,day</span></span><br><span class="line"><span class="string">    |),t3 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |a.userid,</span></span><br><span class="line"><span class="string">    |concat(a.day,&#x27;_&#x27;,b.day),</span></span><br><span class="line"><span class="string">    |a.sumorder</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t2 a</span></span><br><span class="line"><span class="string">    |left join t2 b on a.userid=b.userid</span></span><br><span class="line"><span class="string">    |where</span></span><br><span class="line"><span class="string">    |a.day+1=b.day</span></span><br><span class="line"><span class="string">    |and</span></span><br><span class="line"><span class="string">    |a.sumorder&lt;b.sumorder</span></span><br><span class="line"><span class="string">    |)</span></span><br><span class="line"><span class="string">    |select count(*)</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t3</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin).first().getLong(<span class="number">0</span>) <span class="comment">//连续两天的人数</span></span><br><span class="line">print(l2+<span class="string">&quot;*******************************************************************&quot;</span>)</span><br><span class="line">sql(</span><br><span class="line">  <span class="string">s&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    |select $l1 as purchaseduser,</span></span><br><span class="line"><span class="string">    |$l2 as repurchaseduser,</span></span><br><span class="line"><span class="string">    |concat(round($l2/$l1,3)*100,&#x27;%&#x27;) as repurchaserate</span></span><br><span class="line"><span class="string">    |&quot;</span><span class="string">&quot;&quot;</span>.stripMargin).show() <span class="comment">//直接查 保留三位小数然后乘100加%就是百分比</span></span><br></pre></td></tr></table></figure>
<h3 id="第三题">第三题</h3>
<blockquote>
<p>第三题比较难，行转列，需要用scala中柯里化函数，因为scala学的不是很深入，所以这题如果自己做的话，应该是用union或者join来实现了。问了朋友明白代码用法，实现了功能，foldLeft其实还不是很理解。</p>
</blockquote>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> data = sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |b.name,count(*) as con</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |dwd.fact_order_info a</span></span><br><span class="line"><span class="string">    |join dwd.dim_province b on a.province_id=b.id</span></span><br><span class="line"><span class="string">    |group by b.name</span></span><br><span class="line"><span class="string">    |order by con desc</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin)</span><br><span class="line">  .rdd.map(x =&gt; (x.getString(<span class="number">0</span>),x.getLong(<span class="number">1</span>)))</span><br><span class="line">  .collect().toList</span><br><span class="line">print(data)</span><br><span class="line"><span class="keyword">import</span> spark.implicits._</span><br><span class="line"><span class="keyword">val</span> dum: <span class="type">DataFrame</span> = <span class="type">Seq</span>(<span class="string">&quot;1&quot;</span>).toDF(<span class="string">&quot;dum&quot;</span>)</span><br><span class="line">data.foldLeft(dum)((dum,d) =&gt; dum.withColumn(d._1,lit(d._2)))</span><br><span class="line">  .drop(<span class="string">&quot;dum&quot;</span>)</span><br><span class="line">  .show(<span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
<h2 id="BUG点-6">BUG点</h2>
<p>修了个hexo博客的bug,问题点在我文章h1标签，点击工作台会报错，而且无法跳转。查看博客源代码发现在main.js和util.js中有使用，一直深拔源码，发现是hexo-renderer-markdown-it这个插件的问题，因为seo标题就是h1标签，所以源码中跳转特意从h2开始的，源码改不了就只能改配置覆盖，在_config.yml中加入,问题顺利解决。</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">markdown:</span></span><br><span class="line">  <span class="attr">anchors:</span></span><br><span class="line">    <span class="attr">level:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230314143507008.png" alt="image-20230314143507008"></p>
<h2 id="日总结-8">日总结</h2>
<blockquote>
<p>今天的任务是任务书5的指标计算，任务5的指标计算和之前的很不同，之前的都是分组完了然后调用函数，任务5后面的两题就是比较新颖的，一题是单行的，另外一题列转行就比较难了，需要用scala函数柯里化。解决了之前博客点击跳转的BUG。新版博客链接https://u7u7.top</p>
</blockquote>
<h1 id="任务4修改">任务4修改</h1>
<h2 id="学习日期-3-14">学习日期: 3.14</h2>
<h2 id="所学内容概述-9">所学内容概述</h2>
<blockquote>
<p>刚开始的题目理解都是使用detail商品表，但是忘记了订单额，应该是算最终订单，也就是info表中的final_total_amount，所以之前的代码是有疑问的，而且因为两个表order_id是不相同的，讨论过后选择使用join，用两个表都有的id，修改以后如下:</p>
</blockquote>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//TODO t2</span></span><br><span class="line">sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |with t1 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |sku_id,sku_name,</span></span><br><span class="line"><span class="string">    |cast(sum(sku_num) as int) as skuSum,</span></span><br><span class="line"><span class="string">    |sum(final_total_amount) as topprice</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |dwd.fact_order_detail fod</span></span><br><span class="line"><span class="string">	|join dwd.fact_order_info foi on foi.id=fod.order_id  </span></span><br><span class="line"><span class="string">    |group by sku_id,sku_name),</span></span><br><span class="line"><span class="string">    |t2 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |t1.sku_id as topquantityid,</span></span><br><span class="line"><span class="string">    |t1.sku_name as topquantityname,</span></span><br><span class="line"><span class="string">    |t1.skuSum as topquantity,</span></span><br><span class="line"><span class="string">    |row_number() over(order by t1.skuSum desc,t1.sku_id) as topTenQuantity</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t1</span></span><br><span class="line"><span class="string">    |limit 10),</span></span><br><span class="line"><span class="string">    |t3 as (</span></span><br><span class="line"><span class="string">    |select</span></span><br><span class="line"><span class="string">    |t1.sku_id as toppriceid,</span></span><br><span class="line"><span class="string">    |t1.sku_name as toppricename,</span></span><br><span class="line"><span class="string">    |t1.topprice as topprice,</span></span><br><span class="line"><span class="string">    |row_number() over(order by t1.skuOrderSum desc) as sequence</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t1</span></span><br><span class="line"><span class="string">    |limit 10)</span></span><br><span class="line"><span class="string">    |select topquantityid,</span></span><br><span class="line"><span class="string">    |topquantityname,</span></span><br><span class="line"><span class="string">    |topquantity,</span></span><br><span class="line"><span class="string">    |t3.*</span></span><br><span class="line"><span class="string">    |from</span></span><br><span class="line"><span class="string">    |t2</span></span><br><span class="line"><span class="string">    |left join t3 on t2.topTenQuantity=t3.sequence</span></span><br><span class="line"><span class="string">    |order by t3.sequence</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin).createOrReplaceTempView(<span class="string">&quot;t2&quot;</span>)</span><br><span class="line">mysqlTempTable(spark,<span class="string">&quot;topten&quot;</span>)</span><br><span class="line">sql(</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |insert overwrite table mysql_topten</span></span><br><span class="line"><span class="string">    |select * from t2</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin)</span><br></pre></td></tr></table></figure>
<h2 id="日总结-9">日总结</h2>
<blockquote>
<p>明天开始每天都是要去做几道算法题了，蓝桥杯算法比赛快开始了，最近一些算法使用已经有点生疏了，今天讨论的时候又解决了一个任务不清晰的要求，今天主要是复习了一下java算法和解决大数据的问题以及背了一下综合分析。</p>
</blockquote>
<h1 id="任务5以及算法">任务5以及算法</h1>
<h2 id="学习日期-3-15">学习日期: 3.15</h2>
<h2 id="所学内容概述-10">所学内容概述</h2>
<h3 id="编号2120">编号2120</h3>
<p>题目不难，找到规律就行了。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/202303151845716.png" alt="image-20230315093825402"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">Scanner</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">    <span class="comment">//在此输入您的代码...</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">Ax</span> <span class="operator">=</span> scan.nextLine();</span><br><span class="line">    <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> Integer.parseInt(Ax.substring(<span class="number">1</span>));</span><br><span class="line">    <span class="type">int</span>[] a = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">6</span>]; <span class="comment">//A9超出 所以设置6个</span></span><br><span class="line">    <span class="type">int</span>[] b = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">5</span>];</span><br><span class="line">    <span class="type">int</span> <span class="variable">aNumOne</span> <span class="operator">=</span> <span class="number">1189</span>; <span class="comment">//定义初始值</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">bNumOne</span> <span class="operator">=</span> <span class="number">841</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;<span class="number">6</span>;i++)&#123;</span><br><span class="line">        a[i] = aNumOne;</span><br><span class="line">        aNumOne = aNumOne / <span class="number">2</span>; <span class="comment">//取整添加</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>;j&lt;<span class="number">5</span>;j++)&#123;</span><br><span class="line">        b[j] = bNumOne;</span><br><span class="line">        bNumOne = bNumOne / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(num%<span class="number">2</span>==<span class="number">0</span>)&#123;</span><br><span class="line">        System.out.println(a[num/<span class="number">2</span>]);<span class="comment">//偶数按索引取数组</span></span><br><span class="line">        System.out.println(b[num/<span class="number">2</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        System.out.println(b[(num-<span class="number">1</span>)/<span class="number">2</span>]);<span class="comment">//奇数数前后取头</span></span><br><span class="line">        System.out.println(a[(num+<span class="number">1</span>)/<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    scan.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="BUG点-7">BUG点</h2>
<p>任务书5第三题，是使用rdd算子实现的，在idea中能打印，能show，都是蛮正常的，但是放到服务器spark提交，就报很多错误，而且找不到关键信息，回到IDEA的时候，发现最上面是有报错信息的，代码却能正常执行。搞了一下午没解决，推测是因为环境使用的是mariadb的问题，因为IDEA中出现很多这个报错，Spark无法显示的原因，应该是mariadb的报错没有过滤，导致一报错就自动杀死自己的进程。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/202303151832559.png" alt="image-20230315183251364"></p>
<h2 id="扩展学习-3">扩展学习</h2>
<ul>
<li>研究了一下自己博客插件的源代码，并安装了看板娘在博客中，自己自定义了位置以及大小，写yml配置中</li>
<li>其他的live2d有些比较吃性能，自己的没有买云服务器所以只能找一个资源占用不大的模型:yml代码如下</li>
</ul>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">live2d:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">#开关插件版看板娘</span></span><br><span class="line">  <span class="attr">scriptFrom:</span> <span class="string">local</span> <span class="comment"># 默认</span></span><br><span class="line">  <span class="attr">pluginRootPath:</span> <span class="string">live2dw/</span> <span class="comment"># 插件在站点上的根目录(相对路径)</span></span><br><span class="line">  <span class="attr">pluginJsPath:</span> <span class="string">lib/</span> <span class="comment"># 脚本文件相对与插件根目录路径</span></span><br><span class="line">  <span class="attr">pluginModelPath:</span> <span class="string">assets/</span> <span class="comment"># 模型文件相对与插件根目录路径</span></span><br><span class="line">  <span class="attr">model:</span></span><br><span class="line">    <span class="attr">use:</span> <span class="string">live2d-widget-model-koharu</span> <span class="comment"># npm-module package name</span></span><br><span class="line">  <span class="attr">display:</span></span><br><span class="line">    <span class="attr">position:</span> <span class="string">left</span> <span class="comment">#控制看板娘位置</span></span><br><span class="line">    <span class="attr">width:</span> <span class="number">150</span> <span class="comment">#控制看板娘大小</span></span><br><span class="line">    <span class="attr">height:</span> <span class="number">300</span> <span class="comment">#控制看板娘大小</span></span><br><span class="line">  <span class="attr">mobile:</span></span><br><span class="line">    <span class="attr">show:</span> <span class="literal">true</span> <span class="comment"># 手机中是否展示</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>效果如下:</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/202303151856028.png" alt="image-20230315185643870"></p>
<h2 id="日总结-10">日总结</h2>
<blockquote>
<p>今天下午是大数据学习，可惜一直在解决BUG，而且没解决完。等后面服务器来了再测试一下吧，我怀疑是小白服务器的问题，真要改起来肯定会花费大量的时间和精力，所以打算先放一放。上午改了博客学习了一下Vue，vue没看几集时间不是很充裕，就没有记笔记。做了一道简单的算法题，做第二题的时候，难度上去了，一中午没做完，下午要大数据了，就先放明天弄了。今天学习状态一般。</p>
</blockquote>
<h1 id="Vue-TodoList案例完善">Vue TodoList案例完善</h1>
<h2 id="学习日期-3-17">学习日期: 3.17</h2>
<h2 id="所学内容概述-11">所学内容概述</h2>
<h3 id="全局事件总线（GlobalEventBus）">全局事件总线（GlobalEventBus）</h3>
<ol>
<li>
<p>一种组件间通信的方式，适用于<span style="color:red">任意组件间通信</span>。</p>
</li>
<li>
<p>安装全局事件总线：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">	......</span><br><span class="line">	<span class="title function_">beforeCreate</span>(<span class="params"></span>) &#123;</span><br><span class="line">		<span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$bus</span> = <span class="variable language_">this</span> <span class="comment">//安装全局事件总线，$bus就是当前应用的vm</span></span><br><span class="line">	&#125;,</span><br><span class="line">    ......</span><br><span class="line">&#125;) </span><br></pre></td></tr></table></figure>
</li>
<li>
<p>使用事件总线：</p>
<ol>
<li>
<p>接收数据：A组件想接收数据，则在A组件中给$bus绑定自定义事件，事件的<span style="color:red">回调留在A组件自身。</span></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">methods</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="title function_">demo</span>(<span class="params">data</span>)&#123;......&#125;</span><br><span class="line">&#125;</span><br><span class="line">......</span><br><span class="line"><span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">$bus</span>.$on(<span class="string">&#x27;xxxx&#x27;</span>,<span class="variable language_">this</span>.<span class="property">demo</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>提供数据：<code>this.$bus.$emit('xxxx',数据)</code></p>
</li>
</ol>
</li>
<li>
<p>最好在beforeDestroy钩子中，用$off去解绑<span style="color:red">当前组件所用到的</span>事件。</p>
</li>
</ol>
<h3 id="消息订阅与发布（pubsub）">消息订阅与发布（pubsub）</h3>
<ol>
<li>
<p>一种组件间通信的方式，适用于<span style="color:red">任意组件间通信</span>。</p>
</li>
<li>
<p>使用步骤：</p>
<ol>
<li>
<p>安装pubsub：<code>npm i pubsub-js</code></p>
</li>
<li>
<p>引入: <code>import pubsub from 'pubsub-js'</code></p>
</li>
<li>
<p>接收数据：A组件想接收数据，则在A组件中订阅消息，订阅的<span style="color:red">回调留在A组件自身。</span></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">methods</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="title function_">demo</span>(<span class="params">data</span>)&#123;......&#125;</span><br><span class="line">&#125;</span><br><span class="line">......</span><br><span class="line"><span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">pid</span> = pubsub.<span class="title function_">subscribe</span>(<span class="string">&#x27;xxx&#x27;</span>,<span class="variable language_">this</span>.<span class="property">demo</span>) <span class="comment">//订阅消息</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>提供数据：<code>pubsub.publish('xxx',数据)</code></p>
</li>
<li>
<p>最好在beforeDestroy钩子中，用<code>PubSub.unsubscribe(pid)</code>去<span style="color:red">取消订阅。</span></p>
</li>
</ol>
</li>
</ol>
<h3 id="nextTick">nextTick</h3>
<ol>
<li>语法：<code>this.$nextTick(回调函数)</code></li>
<li>作用：在下一次 DOM 更新结束后执行其指定的回调。</li>
<li>什么时候用：当改变数据后，要基于更新后的新DOM进行某些操作时，要在nextTick所指定的回调函数中执行。</li>
</ol>
<h2 id="扩展学习-4">扩展学习</h2>
<p>力扣算法练习 两个一般难度 暴力做的出来 算法优解理解了很久 两题做了一下午</p>
<h2 id="日总结-11">日总结</h2>
<blockquote>
<p>今天的学习内容不是很难，还是对案例的优化。重点在全局事件总线，它和消息订阅所实现的功能差不多的，但是还是全局事件比较方便而且不依靠第三方插件。然后是对文本框点击编辑按钮后，对文本框的聚焦，会发现是实现功能上先后逻辑顺序的问题导致无法实现的，我想到的是用一个setTimeout函数延时执行，也能实现，但是功能实用性不强就是了，nextTick就能很好的解决这个问题，在下一次DOM更新结束后执行，学习状态还不错。</p>
</blockquote>
<h1 id="Vuex">Vuex</h1>
<h2 id="学习日期-3-20">学习日期: 3.20</h2>
<h2 id="所学内容概述-12">所学内容概述</h2>
<h3 id="1-概念">1.概念</h3>
<p>​     在Vue中实现集中式状态（数据）管理的一个Vue插件，对vue应用中多个组件的共享状态进行集中式的管理（读/写），也是一种组件间通信的方式，且适用于任意组件间通信。</p>
<h3 id="2-使用情况">2.使用情况</h3>
<p>​     多个组件需要共享数据时</p>
<h3 id="3-搭建vuex环境">3.搭建vuex环境</h3>
<ol>
<li>
<p>创建文件：<code>src/store/index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//引入Vue核心库</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="comment">//引入Vuex</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="comment">//应用Vuex插件</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//准备actions对象——响应组件中用户的动作</span></span><br><span class="line"><span class="keyword">const</span> actions = &#123;&#125;</span><br><span class="line"><span class="comment">//准备mutations对象——修改state中的数据</span></span><br><span class="line"><span class="keyword">const</span> mutations = &#123;&#125;</span><br><span class="line"><span class="comment">//准备state对象——保存具体的数据</span></span><br><span class="line"><span class="keyword">const</span> state = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建并暴露store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">   actions,</span><br><span class="line">   mutations,</span><br><span class="line">   state</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>在<code>main.js</code>中创建vm时传入<code>store</code>配置项</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line"><span class="comment">//引入store</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line">......</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建vm</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">   <span class="attr">el</span>:<span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">   <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>),</span><br><span class="line">   store</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="4-基本使用">4.基本使用</h3>
<ol>
<li>
<p>初始化数据、配置<code>actions</code>、配置<code>mutations</code>，操作文件<code>store.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//引入Vue核心库</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="comment">//引入Vuex</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="comment">//引用Vuex</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">    <span class="comment">//响应组件中加的动作</span></span><br><span class="line">   <span class="title function_">jia</span>(<span class="params">context,value</span>)&#123;</span><br><span class="line">      <span class="comment">// console.log(&#x27;actions中的jia被调用了&#x27;,miniStore,value)</span></span><br><span class="line">      context.<span class="title function_">commit</span>(<span class="string">&#x27;JIA&#x27;</span>,value)</span><br><span class="line">   &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">    <span class="comment">//执行加</span></span><br><span class="line">   <span class="title function_">JIA</span>(<span class="params">state,value</span>)&#123;</span><br><span class="line">      <span class="comment">// console.log(&#x27;mutations中的JIA被调用了&#x27;,state,value)</span></span><br><span class="line">      state.<span class="property">sum</span> += value</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化数据</span></span><br><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">   <span class="attr">sum</span>:<span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建并暴露store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">   actions,</span><br><span class="line">   mutations,</span><br><span class="line">   state,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>组件中读取vuex中的数据：<code>$store.state.sum</code></p>
</li>
<li>
<p>组件中修改vuex中的数据：<code>$store.dispatch('action中的方法名',数据)</code> 或 <code>$store.commit('mutations中的方法名',数据)</code></p>
<blockquote>
<p>备注：若没有网络请求或其他业务逻辑，组件中也可以越过actions，即不写<code>dispatch</code>，直接编写<code>commit</code></p>
</blockquote>
</li>
</ol>
<h3 id="5-getters的使用">5.getters的使用</h3>
<ol>
<li>
<p>概念：当state中的数据需要经过加工后再使用时，可以使用getters加工。</p>
</li>
<li>
<p>在<code>store.js</code>中追加<code>getters</code>配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">......</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line">   <span class="title function_">bigSum</span>(<span class="params">state</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> state.<span class="property">sum</span> * <span class="number">10</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建并暴露store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">   ......</span><br><span class="line">   getters</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>组件中读取数据：<code>$store.getters.bigSum</code></p>
</li>
</ol>
<h3 id="6-四个map方法的使用">6.四个map方法的使用</h3>
<ol>
<li>
<p><strong>mapState方法：</strong>用于帮助我们映射<code>state</code>中的数据为计算属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="comment">//借助mapState生成计算属性：sum、school、subject（对象写法）</span></span><br><span class="line">     ...<span class="title function_">mapState</span>(&#123;<span class="attr">sum</span>:<span class="string">&#x27;sum&#x27;</span>,<span class="attr">school</span>:<span class="string">&#x27;school&#x27;</span>,<span class="attr">subject</span>:<span class="string">&#x27;subject&#x27;</span>&#125;),</span><br><span class="line">         </span><br><span class="line">    <span class="comment">//借助mapState生成计算属性：sum、school、subject（数组写法）</span></span><br><span class="line">    ...<span class="title function_">mapState</span>([<span class="string">&#x27;sum&#x27;</span>,<span class="string">&#x27;school&#x27;</span>,<span class="string">&#x27;subject&#x27;</span>]),</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>mapGetters方法：</strong>用于帮助我们映射<code>getters</code>中的数据为计算属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="comment">//借助mapGetters生成计算属性：bigSum（对象写法）</span></span><br><span class="line">    ...<span class="title function_">mapGetters</span>(&#123;<span class="attr">bigSum</span>:<span class="string">&#x27;bigSum&#x27;</span>&#125;),</span><br><span class="line"></span><br><span class="line">    <span class="comment">//借助mapGetters生成计算属性：bigSum（数组写法）</span></span><br><span class="line">    ...<span class="title function_">mapGetters</span>([<span class="string">&#x27;bigSum&#x27;</span>])</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>mapActions方法：</strong>用于帮助我们生成与<code>actions</code>对话的方法，即：包含<code>$store.dispatch(xxx)</code>的函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>:&#123;</span><br><span class="line">    <span class="comment">//靠mapActions生成：incrementOdd、incrementWait（对象形式）</span></span><br><span class="line">    ...<span class="title function_">mapActions</span>(&#123;<span class="attr">incrementOdd</span>:<span class="string">&#x27;jiaOdd&#x27;</span>,<span class="attr">incrementWait</span>:<span class="string">&#x27;jiaWait&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//靠mapActions生成：incrementOdd、incrementWait（数组形式）</span></span><br><span class="line">    ...<span class="title function_">mapActions</span>([<span class="string">&#x27;jiaOdd&#x27;</span>,<span class="string">&#x27;jiaWait&#x27;</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>mapMutations方法：</strong>用于帮助我们生成与<code>mutations</code>对话的方法，即：包含<code>$store.commit(xxx)</code>的函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>:&#123;</span><br><span class="line">    <span class="comment">//靠mapActions生成：increment、decrement（对象形式）</span></span><br><span class="line">    ...<span class="title function_">mapMutations</span>(&#123;<span class="attr">increment</span>:<span class="string">&#x27;JIA&#x27;</span>,<span class="attr">decrement</span>:<span class="string">&#x27;JIAN&#x27;</span>&#125;),</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//靠mapMutations生成：JIA、JIAN（对象形式）</span></span><br><span class="line">    ...<span class="title function_">mapMutations</span>([<span class="string">&#x27;JIA&#x27;</span>,<span class="string">&#x27;JIAN&#x27;</span>]),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>备注：mapActions与mapMutations使用时，若需要传递参数需要：在模板中绑定事件时传递好参数，否则参数是事件对象。</p>
</blockquote>
<h2 id="扩展学习-5">扩展学习</h2>
<h3 id="模块化-命名空间">模块化+命名空间</h3>
<ol>
<li>
<p>目的：让代码更好维护，让多种数据分类更加明确。</p>
</li>
<li>
<p>修改<code>store.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> countAbout = &#123;</span><br><span class="line">  <span class="attr">namespaced</span>:<span class="literal">true</span>,<span class="comment">//开启命名空间</span></span><br><span class="line">  <span class="attr">state</span>:&#123;<span class="attr">x</span>:<span class="number">1</span>&#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123; ... &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123; ... &#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="title function_">bigSum</span>(<span class="params">state</span>)&#123;</span><br><span class="line">       <span class="keyword">return</span> state.<span class="property">sum</span> * <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> personAbout = &#123;</span><br><span class="line">  <span class="attr">namespaced</span>:<span class="literal">true</span>,<span class="comment">//开启命名空间</span></span><br><span class="line">  <span class="attr">state</span>:&#123; ... &#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123; ... &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="attr">modules</span>: &#123;</span><br><span class="line">    countAbout,</span><br><span class="line">    personAbout</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>开启命名空间后，组件中读取state数据：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方式一：自己直接读取</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">state</span>.<span class="property">personAbout</span>.<span class="property">list</span></span><br><span class="line"><span class="comment">//方式二：借助mapState读取：</span></span><br><span class="line">...<span class="title function_">mapState</span>(<span class="string">&#x27;countAbout&#x27;</span>,[<span class="string">&#x27;sum&#x27;</span>,<span class="string">&#x27;school&#x27;</span>,<span class="string">&#x27;subject&#x27;</span>]),</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>开启命名空间后，组件中读取getters数据：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方式一：自己直接读取</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">getters</span>[<span class="string">&#x27;personAbout/firstPersonName&#x27;</span>]</span><br><span class="line"><span class="comment">//方式二：借助mapGetters读取：</span></span><br><span class="line">...<span class="title function_">mapGetters</span>(<span class="string">&#x27;countAbout&#x27;</span>,[<span class="string">&#x27;bigSum&#x27;</span>])</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>开启命名空间后，组件中调用dispatch</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方式一：自己直接dispatch</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;personAbout/addPersonWang&#x27;</span>,person)</span><br><span class="line"><span class="comment">//方式二：借助mapActions：</span></span><br><span class="line">...<span class="title function_">mapActions</span>(<span class="string">&#x27;countAbout&#x27;</span>,&#123;<span class="attr">incrementOdd</span>:<span class="string">&#x27;jiaOdd&#x27;</span>,<span class="attr">incrementWait</span>:<span class="string">&#x27;jiaWait&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>开启命名空间后，组件中调用commit</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方式一：自己直接commit</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">commit</span>(<span class="string">&#x27;personAbout/ADD_PERSON&#x27;</span>,person)</span><br><span class="line"><span class="comment">//方式二：借助mapMutations：</span></span><br><span class="line">...<span class="title function_">mapMutations</span>(<span class="string">&#x27;countAbout&#x27;</span>,&#123;<span class="attr">increment</span>:<span class="string">&#x27;JIA&#x27;</span>,<span class="attr">decrement</span>:<span class="string">&#x27;JIAN&#x27;</span>&#125;),</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="日总结-12">日总结</h2>
<blockquote>
<p>今天的学习内容是vuex，感觉它的功能就是像是一个Java中的static，设置全局变量或者全局方法，比之前的组件间通讯都好用，流程梳理明白掌握起来也不难，有复杂计算逻辑的需要放Mutations中，普通的就放actions中就行，所有可以使用计算属性的，都可以用mapstate，模块化是算扩展了，也不算很难，以后为了规范性以及代码可读性，估计还是使用vuex模块化的比较多。</p>
</blockquote>
<h1 id="mysql数据导入">mysql数据导入</h1>
<h2 id="学习日期-3-22">学习日期: 3.22</h2>
<h2 id="所学内容概述-13">所学内容概述</h2>
<h3 id="将小白样题数据导入">将小白样题数据导入</h3>
<p>source /opt/ds_db01.sql，发现有三个表报错了，解决了挺久的bug，因为sql文件比较大，所以导入或者修改的时候会很卡，而且迟迟不能成功。打开以后，慢慢找创建表语句，再慢慢修改。</p>
<h2 id="BUG点-8">BUG点</h2>
<blockquote>
<p>导入数据的时候出现的bug，导入小白样题的时候，发现只有20表，缺失了三个表，打开sql的源文件，单独创表，发现出现了报错。搜索以后发现是timestamp类型的不能超过两个default，原因是当你给一个timestamp设置为on updatecurrent_timestamp的时候，其他的timestamp字段需要显式设定default值。如果你有两个timestamp字段，但是只把第一个设定为current_timestamp而第二个没有设定默认值，<a target="_blank" rel="noopener" href="http://lib.csdn.net/base/mysql">MySQL</a>能成功建表,但是反过来就不行,需要把之前的改成datetime，后面null的都删除，BUG就解决了。</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/202303221756608.png" alt="image-20230322175615853"></p>
<h2 id="日总结-13">日总结</h2>
<blockquote>
<p>今天上午先是做了几道蓝桥杯的题目，有道填空题，是直接拿草稿纸推算的。下午的时候看了一下小白的样题，发现之前的sql文件是有点小bug的，无法导入，有两个表是有bug的，一下午解决了bug，然后分析了一下任务书，晚上将平时训练的计划规划了一下。</p>
</blockquote>
<h1 id="测试新镜像连接">测试新镜像连接</h1>
<h2 id="学习日期-3-23">学习日期: 3.23</h2>
<h2 id="所学内容概述-14">所学内容概述</h2>
<p>下载镜像导入VM，启动hadoop集群以及hive元数据，一切顺利。</p>
<h2 id="BUG点-9">BUG点</h2>
<p>今天使用IDEA测试连接的时候报错了，之前出现过这种报错也没找到原因，我认为就是mariadb的问题。重新放入配置文件，修改hosts中的ip映射都不行，就算了，有时候就是会突然坏一下，这几天都没关机什么都没干，直接在spark中跑也是一样的，而且比idea要快很多。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230323095003966.png" alt="image-20230323095003966"></p>
<h2 id="扩展学习-6">扩展学习</h2>
<h3 id="编号468">编号468</h3>
<p>回文日期</p>
<blockquote>
<p>题目很清晰明了，但是需要讨论的特殊条件比较多。就是日期规范性，每个月每个天数不一样，还有日期开头不为0，学份12月以内，不可为0，等等。在我最初的版本都是有一条一条if规范出来的。后来优化算法的时候，发现有些测试点，蓝桥杯是没有设置一些特殊检查点的所以像30天和28 29这种特殊月。所以后面闰月和2月都没用添加判断语句，但是也顺利通过了，耗时有点久。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="comment">// 1:无需package</span></span><br><span class="line"><span class="comment">// 2: 类名必须Main, 不可修改</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="comment">//在此输入您的代码...</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> scan.nextInt();</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> N+<span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">99999999</span>;</span><br><span class="line">        <span class="keyword">while</span>(i&lt;=<span class="number">99999999</span>)&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">num</span> <span class="operator">=</span> i+<span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">yearage</span>  <span class="operator">=</span> i/<span class="number">1000000</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">fanzhuanyearage</span> <span class="operator">=</span> yearage/<span class="number">10</span>+yearage%<span class="number">10</span>*<span class="number">10</span>;<span class="comment">//反转day</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">yearlaster</span>  <span class="operator">=</span> i%<span class="number">1000000</span>/<span class="number">10000</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">fanzhuanyearlaster</span>  <span class="operator">=</span> yearlaster/<span class="number">10</span>+yearlaster%<span class="number">10</span>*<span class="number">10</span>; <span class="comment">//反转month</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">month</span> <span class="operator">=</span> i%<span class="number">10000</span>/<span class="number">100</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">day</span>   <span class="operator">=</span> i%<span class="number">100</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">lastday</span> <span class="operator">=</span> i%<span class="number">10</span>; <span class="comment">//最后一天不能为0 因为反转以后首不为0</span></span><br><span class="line">            <span class="keyword">if</span>(month &lt;= <span class="number">12</span> &amp;&amp;  day &lt;= <span class="number">31</span> &amp;&amp;  lastday != <span class="number">0</span> &amp;&amp; fanzhuanyearage&lt;=<span class="number">31</span> &amp;&amp; fanzhuanyearlaster&lt;=<span class="number">12</span> &amp;&amp; fanzhuanyearlaster != <span class="number">0</span>)&#123;</span><br><span class="line">              <span class="keyword">if</span>(huiwen(num))&#123;</span><br><span class="line">                 <span class="comment">//设置回文 为第一个  </span></span><br><span class="line">                <span class="keyword">if</span>(res &gt; Integer.parseInt(num))&#123;</span><br><span class="line">                    res = Integer.parseInt(num);</span><br><span class="line">                    System.out.println(num);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//如果为AB回文直接停止</span></span><br><span class="line">                <span class="keyword">if</span>(ABhuiwen(num))&#123;</span><br><span class="line">                    System.out.println(num);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        scan.close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//判断闰年</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">ruiyear</span><span class="params">(String num)</span>&#123;</span><br><span class="line">      <span class="type">int</span> <span class="variable">year</span> <span class="operator">=</span> Integer.parseInt(num);</span><br><span class="line">      <span class="keyword">return</span> (year % <span class="number">4</span> == <span class="number">0</span> &amp;&amp; year % <span class="number">100</span> != <span class="number">0</span>) || year % <span class="number">400</span> == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//判断回文数</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">huiwen</span><span class="params">(String num)</span>&#123;</span><br><span class="line">      <span class="type">char</span>[] c  = num.toCharArray();</span><br><span class="line">      <span class="keyword">return</span> c[<span class="number">0</span>] == c[<span class="number">7</span>] &amp;&amp; c[<span class="number">1</span>] == c[<span class="number">6</span>] &amp;&amp; c[<span class="number">2</span>] == c[<span class="number">5</span>] &amp;&amp; c[<span class="number">3</span>] == c[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//判断AB回文数</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">ABhuiwen</span><span class="params">(String num)</span>&#123;</span><br><span class="line">      <span class="type">char</span>[] c  = num.toCharArray();</span><br><span class="line">      <span class="keyword">return</span> c[<span class="number">0</span>] == c[<span class="number">2</span>] &amp;&amp; c[<span class="number">2</span>] == c[<span class="number">5</span>] &amp;&amp; c[<span class="number">5</span>] == c[<span class="number">7</span>] &amp;&amp; c[<span class="number">1</span>] == c[<span class="number">3</span>] &amp;&amp; c[<span class="number">3</span>] == c[<span class="number">4</span>] &amp;&amp; c[<span class="number">4</span>] == c[<span class="number">6</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="日总结-14">日总结</h2>
<blockquote>
<p>今天的主要任务是设置大数据的学习计划，平时练习的计划，然后导入了数据库，然后导入了新的镜像，发现里面是自带数据的，值得注意的是，software的安装位置都改变了，在IDEA中需要修改配置文件。hive hdfs 和core，yarn是不需要的， 晚上做了算法题，做题还是很顺利的，但是有个任务点一直无法通过，优化了算法，节省了不必要的空间。</p>
</blockquote>
<h1 id="Spark架构以及集群搭建">Spark架构以及集群搭建</h1>
<h2 id="学习日期-3-24">学习日期: 3.24</h2>
<h2 id="所学内容概述-15">所学内容概述</h2>
<h3 id="Spark理论">Spark理论</h3>
<p>Spark资源调度策略，之前spark内存爆炸过。看内容是有调优策略的，主要原因是CPU资源占用满了，电脑的i5 3代太垃垮了，之前也使用过spark的调度程序，还是爆了，最后是通过重启hadoop服务成功的。</p>
<h2 id="BUG点-10">BUG点</h2>
<p>报错信息为截图，但是记住了。java.sql.SQLException: null, message from server: “Host ‘XXX‘ is not allowed to connect异常。是mysql拒绝了我的该网段的链接，是因为mysql中root用户只允许本地连接和 回环地址，之前IDEA无法直接运行的BUG也算是解决了。</p>
<p>解决步骤：</p>
<blockquote>
<p>use mysql;<br>
select user,host from user;<br>
update user set host = ‘%’ where user = ‘root’;<br>
flush privileges; --刷新权限</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230324103006317.png" alt="image-20230324103006317"></p>
<h2 id="日总结-15">日总结</h2>
<blockquote>
<p>今天的任务是看小白的spark教程，基础部分，自己基本都学过，就当过了一遍，在ch02开发和部署的实战部分，我就直接把样题数据从mysql导入hive中去了，当实操，用savetable，可以直接自动创建表，往hive中加入了部分假数据，基础部分感觉只有资源调度那边是有点用的，其他都是发展史。</p>
</blockquote>
<h1 id="Spark核心编程RDD">Spark核心编程RDD</h1>
<h2 id="学习日期-3-25">学习日期: 3.25</h2>
<h2 id="所学内容概述-16">所学内容概述</h2>
<h3 id="Spark集合方法">Spark集合方法</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构造这两个RDD 充当假数据</span></span><br><span class="line"><span class="keyword">val</span> rdd1 = sc.parallelize(<span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>))</span><br><span class="line">rdd1.collect</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> rdd2 = sc.parallelize(<span class="type">List</span>(<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>))</span><br><span class="line">rdd2.collect</span><br></pre></td></tr></table></figure>
<h4 id="union-otherDataset">union(otherDataset)</h4>
<p>合并两个rdd，并集。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> rdd3 = rdd1.union(rdd2)</span><br><span class="line">rdd3.collect</span><br></pre></td></tr></table></figure>
<h4 id="intersection-otherDataset">intersection(otherDataset)</h4>
<p>交集。只保留在两个rdd中都有的元素。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> rdd4 = rdd1.intersection(rdd2)</span><br><span class="line">rdd4.collect</span><br></pre></td></tr></table></figure>
<h4 id="subtract转换">subtract转换</h4>
<p>差集。只保留在第一个rdd中有而在第二个rdd中没有的元素。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> rdd5 = rdd1.subtract(rdd2)</span><br><span class="line">rdd5.collect</span><br></pre></td></tr></table></figure>
<h4 id="cartesian-otherDataset">cartesian(otherDataset)</h4>
<p>两个rdd的笛卡尔集。</p>
<p>当在类型为T和U的RDD上调用时，返回一个(T, U)对(所有元素对)的RDD。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> rdd6 = rdd1.cartesian(rdd2)</span><br><span class="line">rdd6.collect</span><br></pre></td></tr></table></figure>
<h2 id="BUG点-11">BUG点</h2>
<p>学习顺利没BUG</p>
<h2 id="扩展学习-7">扩展学习</h2>
<p>学习了action部分对表转换成rdd以后的操作函数还是有很多值得学习</p>
<h3 id="action操作函数">action操作函数</h3>
<ul>
<li>
<p>reduce(func)</p>
<p>使用函数func(接受两个参数并返回一个参数)聚合数据集的元素。这个函数应该是交换律和结合律，这样才能并行地正确地计算它。</p>
</li>
<li>
<p>collect()</p>
<p>将RDD操作的所有结果返回给驱动程序。这通常对产生足够小的数据集的操作很有用。</p>
</li>
<li>
<p>count()</p>
<p>这会返回数据集中的元素数量或RDD操作的结果输出。</p>
</li>
<li>
<p>first()</p>
<p>返回数据集的第一个元素或RDD操作产生的结果输出。它的工作原理类似于take(1)函数。</p>
</li>
<li>
<p>take(n)</p>
<p>返回RDD的前n个元素。它首先扫描一个分区，然后使用该分区的结果来估计满足该限制所需的其他分区的数量。这个方法应该只在预期得到的数组很小的情况下使用，因为所有的数据都加载到驱动程序的内存中。</p>
</li>
<li>
<p>top(n)</p>
<p>按照指定的隐式排序[T]从这个RDD中取出最大的k个元素，并维护排序。这与takeOrdered相反。这个方法应该只在预期得到的数组很小的情况下使用，因为所有的数据都加载到驱动程序的内存中。</p>
</li>
<li>
<p>takeOrdered(n)</p>
<p>返回RDD的前n个（最小的）元素，并维护排序。这和top是相反的。这个方法应该只在预期得到的数组很小的情况下使用，因为所有的数据都加载到驱动程序的内存中。</p>
</li>
<li>
<p>saveAsTextFile(path)</p>
<p>将数据集的元素作为文本文件(或文本文件集)写入本地文件系统、HDFS或任何其他hadoop支持的文件系统的给定目录中。Spark将对每个元素调用toString，将其转换为文件中的一行文本。</p>
</li>
<li>
<p>countByKey()</p>
<p>仅在类型(K, V)的RDDs上可用。返回(K, Int)对的hashmap和每个键的计数。</p>
</li>
<li>
<p>foreach(func)</p>
<p>在数据集的每个元素上运行函数func。</p>
</li>
</ul>
<h2 id="日总结-16">日总结</h2>
<blockquote>
<p>复习使用了spark中的RDD编程，集合部分感觉对大数据处理表数据的时候还是有帮助的，然后自己看了以前学期scala时候，中spark的RDD和scala中的方法，结合小白书苑还是有很多对于RDD方法的提升和理解的，使用sql编程，和RDD一起使用并独立完成了RDD的案例。</p>
</blockquote>
<h1 id="SparkSQL编程">SparkSQL编程</h1>
<h2 id="学习日期-3-27-3-28">学习日期: 3.27-3.28</h2>
<h2 id="所学内容概述-17">所学内容概述</h2>
<blockquote>
<p>因为27号sql部分基础所学的内容比较简单没什么可以值得记得，28号学习的sql高级有些需要记笔记的部分，因此将两天的所学内容放到一起。</p>
</blockquote>
<h3 id="Spark-SQL内置函数">Spark SQL内置函数</h3>
<p>SQL函数大致分为四类:</p>
<ul>
<li>标量函数：每一行返回单个的值。</li>
<li>聚合函数：每一组行返回单个的值。</li>
<li>窗口函数：每一组行返回多个值。</li>
<li>用户自定义函数（UDF）：包括自定义的标量函数或聚合函数。</li>
</ul>
<p>标量和聚合函数在spark的内置方法包中，使用需要导入包</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.functions._ <span class="comment">//(_通配，将functions所有方法都导入)</span></span><br></pre></td></tr></table></figure>
<p>常用的内置函数自己基本都使用过，就先不一一列出来了，找个时间全部梳理一下。</p>
<h3 id="Spark-SQL聚合函数">Spark SQL聚合函数</h3>
<p>这部分基本是和sql中的使用是一样的，参数也一样，就是分组聚合的函数，DSL风格通过groupBy(col)进行分组。</p>
<table>
<thead>
<tr>
<th style="text-align:center">聚合函数</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">count(col)</td>
<td style="text-align:center">返回每组中成员数量</td>
</tr>
<tr>
<td style="text-align:center">countDistinct(col)</td>
<td style="text-align:center">返回每组中成员唯一数量</td>
</tr>
<tr>
<td style="text-align:center">approx_count_distinct(col)</td>
<td style="text-align:center">返回每组中成员唯一近似数量</td>
</tr>
<tr>
<td style="text-align:center">min(col)</td>
<td style="text-align:center">返回每组中给定列的最小值</td>
</tr>
<tr>
<td style="text-align:center">max(col)</td>
<td style="text-align:center">返回每组中给定列的最大值</td>
</tr>
<tr>
<td style="text-align:center">sum(col)</td>
<td style="text-align:center">返回每组中给定列的值的和</td>
</tr>
<tr>
<td style="text-align:center">sumDistinct(col)</td>
<td style="text-align:center">返回每组中给定列的唯一值的和</td>
</tr>
<tr>
<td style="text-align:center">avg(col)</td>
<td style="text-align:center">返回每组中给定列的值的平均</td>
</tr>
<tr>
<td style="text-align:center">skewness(col)</td>
<td style="text-align:center">返回每组中给定列的值的分布的偏斜度</td>
</tr>
<tr>
<td style="text-align:center">kurtosis(col)</td>
<td style="text-align:center">返回每组中给定列的值的分布的峰度</td>
</tr>
<tr>
<td style="text-align:center">variance(col)</td>
<td style="text-align:center">返回每组中给定列的值的无偏方差</td>
</tr>
<tr>
<td style="text-align:center">stddev(col)</td>
<td style="text-align:center">返回每组中给定列的值的标准差</td>
</tr>
<tr>
<td style="text-align:center">collect_list(col)</td>
<td style="text-align:center">返回每组中给定列的值的集合。返回的集合可能包含重复的值</td>
</tr>
<tr>
<td style="text-align:center">collect_set(col)</td>
<td style="text-align:center">返回每组中给定列的唯一值的集合</td>
</tr>
</tbody>
</table>
<h3 id="数据缺失值处理">数据缺失值处理</h3>
<p>比如df表如下:</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230328195221944.png" alt="image-20230328195221944"></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ds1.na.drop().show() <span class="comment">//删除缺失值的行 有null的都删除</span></span><br><span class="line">ds1.na.drop(minNonNulls=<span class="number">2</span>).show() <span class="comment">//删除缺失值有两个及以上的行</span></span><br><span class="line">ds1.na.fill(<span class="string">&quot;不详&quot;</span>).show() <span class="comment">//将所有null值填充为不详</span></span><br><span class="line">ds1.na.fill(<span class="type">Map</span>(<span class="string">&quot;dynasty&quot;</span>-&gt;<span class="string">&quot;--&quot;</span>, <span class="string">&quot;dob&quot;</span>-&gt;<span class="string">&quot;不详&quot;</span>)).show() <span class="comment">//dynasty列填充为-- dob为不详</span></span><br></pre></td></tr></table></figure>
<p>新数据如下，验证去重函数<br>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/ch04_null_06.png" alt="img"></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ds1.dropDuplicates().show() <span class="comment">//完全重复的行删除 注意第2和4不一样，一个清朝一个清代</span></span><br><span class="line">ds1.dropDuplicates(<span class="string">&quot;name&quot;</span>).show() <span class="comment">//删除指定的列重复的行（基于一个列的子集删除重复）</span></span><br><span class="line">ds1.dropDuplicates(<span class="type">Array</span>(<span class="string">&quot;dynasty&quot;</span>,<span class="string">&quot;dob&quot;</span>)).show() <span class="comment">//删除dynasty和dob都重复的行</span></span><br></pre></td></tr></table></figure>
<h2 id="BUG点-12">BUG点</h2>
<p>安装使用Vue3中的vite初始化vue项目结束以后，需要npm i装插件的时候报错了，分析报错信息是npm版本太低了，有些插件装不了，因为vite是比较新的构建项目的一种方式，比较轻量化大小比较小，速度也快了不止一倍，在项目越大中和常规初始化的差距越明显。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230328200035204.png" alt="image-20230328200035204"></p>
<h2 id="扩展学习-8">扩展学习</h2>
<h3 id="蓝桥杯-123">蓝桥杯 123</h3>
<p>这题主要用到二分以及数据累加，难度一般，明天打算优化优化算法再研究研究。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blognoteImg/image-20230328202738987.png" alt="image-20230328202738987"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     a[i] = a[i-1] + i  前i个区间的个数之和</span></span><br><span class="line"><span class="comment">     s[i] = s[i-1] + i  i的前缀和</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">maxLen</span> <span class="operator">=</span> <span class="number">1414215</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span>[] a = <span class="keyword">new</span> <span class="title class_">long</span>[maxLen];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span>[] s = <span class="keyword">new</span> <span class="title class_">long</span>[maxLen];</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="comment">//在此输入您的代码...\</span></span><br><span class="line">        a[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; maxLen; i++) &#123;</span><br><span class="line">            a[i] = a[i-<span class="number">1</span>] + i;</span><br><span class="line">        &#125;</span><br><span class="line">        s[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; maxLen; i++) &#123;</span><br><span class="line">            s[i] = s[i-<span class="number">1</span>] + a[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> scan.nextInt();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">l</span> <span class="operator">=</span> scan.nextLong();</span><br><span class="line">            <span class="type">long</span> <span class="variable">r</span> <span class="operator">=</span> scan.nextLong();</span><br><span class="line">            System.out.println(preSum(r) - preSum(l-<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        scan.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">long</span> <span class="title function_">preSum</span><span class="params">(<span class="type">long</span> num)</span> &#123;</span><br><span class="line">        <span class="comment">//找到num处在哪个区间</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> <span class="number">0</span>,r = maxLen;</span><br><span class="line">        <span class="type">int</span> mid;</span><br><span class="line">        <span class="keyword">while</span> (l&lt;r)&#123;</span><br><span class="line">            mid = (l+r+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (a[mid] &gt; num)&#123;</span><br><span class="line">                r = mid - <span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> l = mid ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s[l] + a[(<span class="type">int</span>) (num - a[l])];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="日总结-17">日总结</h2>
<h3 id="27日">27日</h3>
<blockquote>
<p>今天学习时间只有上午部分，还好这个时间学习的内容不是很难，SparkSQL自己已经是非常熟悉了，对DF的创建以及操作，基础部分没什么难度，案例也没有必要去做了。今天的学习状态也还可以，明天学高级部分看能不能学习到有用的东西</p>
</blockquote>
<h3 id="28日">28日</h3>
<blockquote>
<p>大数据训练部分:今天上午学习的大数据,SparkSQL高级部分所能学到的东西还是听过的，比如自定义sql函数，以及如何处理字段为null的数据，删除或者替换，还有去重相同的数据，都是有方法的。基本这一章的内容就是对sql中高级的函数的讲解以及如何使用,大半部分是对dsl风格的讲解，因为之前学过一段时间了，前几天也着重复习了，所以这部分对自己没什么难度。</p>
</blockquote>
<h1 id="Vue路由-重点">Vue路由(重点)</h1>
<h2 id="学习日期：3-29">学习日期：3.29</h2>
<h2 id="所学内容概述-18">所学内容概述</h2>
<ol>
<li>理解： 一个路由（route）就是一组映射关系（key - value），多个路由需要路由器（router）进行管理。</li>
<li>前端路由：key是路径，value是组件。</li>
</ol>
<h3 id="1-基本使用">1.基本使用</h3>
<ol>
<li>
<p>安装vue-router，命令：<code>npm i vue-router</code></p>
</li>
<li>
<p>应用插件：<code>Vue.use(VueRouter)</code></p>
</li>
<li>
<p>编写router配置项:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//引入VueRouter</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">VueRouter</span> <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="comment">//引入Luyou 组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">About</span> <span class="keyword">from</span> <span class="string">&#x27;../components/About&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;../components/Home&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//创建router实例对象，去管理一组一组的路由规则</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">VueRouter</span>(&#123;</span><br><span class="line">	<span class="attr">routes</span>:[</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">path</span>:<span class="string">&#x27;/about&#x27;</span>,</span><br><span class="line">			<span class="attr">component</span>:<span class="title class_">About</span></span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">path</span>:<span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line">			<span class="attr">component</span>:<span class="title class_">Home</span></span><br><span class="line">		&#125;</span><br><span class="line">	]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//暴露router</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>实现切换（active-class可配置高亮样式）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link active-class=&quot;active&quot; to=&quot;/about&quot;&gt;About&lt;/router-link&gt;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>指定展示位置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-view&gt;&lt;/router-view&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2-几个注意点">2.几个注意点</h3>
<ol>
<li>路由组件通常存放在<code>pages</code>文件夹，一般组件通常存放在<code>components</code>文件夹。</li>
<li>通过切换，“隐藏”了的路由组件，默认是被销毁掉的，需要的时候再去挂载。</li>
<li>每个组件都有自己的<code>$route</code>属性，里面存储着自己的路由信息。</li>
<li>整个应用只有一个router，可以通过组件的<code>$router</code>属性获取到。</li>
</ol>
<h3 id="3-多级路由（多级路由）">3.多级路由（多级路由）</h3>
<ol>
<li>
<p>配置路由规则，使用children配置项：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">routes</span>:[</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="attr">path</span>:<span class="string">&#x27;/about&#x27;</span>,</span><br><span class="line">		<span class="attr">component</span>:<span class="title class_">About</span>,</span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="attr">path</span>:<span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line">		<span class="attr">component</span>:<span class="title class_">Home</span>,</span><br><span class="line">		<span class="attr">children</span>:[ <span class="comment">//通过children配置子级路由</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="attr">path</span>:<span class="string">&#x27;news&#x27;</span>, <span class="comment">//此处一定不要写：/news</span></span><br><span class="line">				<span class="attr">component</span>:<span class="title class_">News</span></span><br><span class="line">			&#125;,</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="attr">path</span>:<span class="string">&#x27;message&#x27;</span>,<span class="comment">//此处一定不要写：/message</span></span><br><span class="line">				<span class="attr">component</span>:<span class="title class_">Message</span></span><br><span class="line">			&#125;</span><br><span class="line">		]</span><br><span class="line">	&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>跳转（要写完整路径）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link to=&quot;/home/news&quot;&gt;News&lt;/router-link&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="4-路由的query参数">4.路由的query参数</h3>
<ol>
<li>
<p>传递参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 跳转并携带query参数，to的字符串写法 --&gt;</span><br><span class="line">&lt;router-link :to=&quot;/home/message/detail?id=666&amp;title=你好&quot;&gt;跳转&lt;/router-link&gt;</span><br><span class="line">				</span><br><span class="line">&lt;!-- 跳转并携带query参数，to的对象写法 --&gt;</span><br><span class="line">&lt;router-link </span><br><span class="line">	:to=&quot;&#123;</span><br><span class="line">		path:&#x27;/home/message/detail&#x27;,</span><br><span class="line">		query:&#123;</span><br><span class="line">		   id:666,</span><br><span class="line">            title:&#x27;你好&#x27;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;&quot;</span><br><span class="line">&gt;跳转&lt;/router-link&gt;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>接收参数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$route.<span class="property">query</span>.<span class="property">id</span></span><br><span class="line">$route.<span class="property">query</span>.<span class="property">title</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="5-命名路由">5.命名路由</h3>
<ol>
<li>
<p>作用：可以简化路由的跳转。</p>
</li>
<li>
<p>如何使用</p>
<ol>
<li>
<p>给路由命名：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">path</span>:<span class="string">&#x27;/demo&#x27;</span>,</span><br><span class="line">	<span class="attr">component</span>:<span class="title class_">Demo</span>,</span><br><span class="line">	<span class="attr">children</span>:[</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">path</span>:<span class="string">&#x27;test&#x27;</span>,</span><br><span class="line">			<span class="attr">component</span>:<span class="title class_">Test</span>,</span><br><span class="line">			<span class="attr">children</span>:[</span><br><span class="line">				&#123;</span><br><span class="line">                      <span class="attr">name</span>:<span class="string">&#x27;hello&#x27;</span> <span class="comment">//给路由命名</span></span><br><span class="line">					<span class="attr">path</span>:<span class="string">&#x27;welcome&#x27;</span>,</span><br><span class="line">					<span class="attr">component</span>:<span class="title class_">Hello</span>,</span><br><span class="line">				&#125;</span><br><span class="line">			]</span><br><span class="line">		&#125;</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>简化跳转：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--简化前，需要写完整的路径 --&gt;</span><br><span class="line">&lt;router-link to=&quot;/demo/test/welcome&quot;&gt;跳转&lt;/router-link&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--简化后，直接通过名字跳转 --&gt;</span><br><span class="line">&lt;router-link :to=&quot;&#123;name:&#x27;hello&#x27;&#125;&quot;&gt;跳转&lt;/router-link&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--简化写法配合传递参数 --&gt;</span><br><span class="line">&lt;router-link </span><br><span class="line">	:to=&quot;&#123;</span><br><span class="line">		name:&#x27;hello&#x27;,</span><br><span class="line">		query:&#123;</span><br><span class="line">		   id:666,</span><br><span class="line">            title:&#x27;你好&#x27;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;&quot;</span><br><span class="line">&gt;跳转&lt;/router-link&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<h3 id="6-路由的params参数">6.路由的params参数</h3>
<ol>
<li>
<p>配置路由，声明接收params参数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">path</span>:<span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line">	<span class="attr">component</span>:<span class="title class_">Home</span>,</span><br><span class="line">	<span class="attr">children</span>:[</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">path</span>:<span class="string">&#x27;news&#x27;</span>,</span><br><span class="line">			<span class="attr">component</span>:<span class="title class_">News</span></span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="attr">component</span>:<span class="title class_">Message</span>,</span><br><span class="line">			<span class="attr">children</span>:[</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="attr">name</span>:<span class="string">&#x27;xiangqing&#x27;</span>,</span><br><span class="line">					<span class="attr">path</span>:<span class="string">&#x27;detail/:id/:title&#x27;</span>, <span class="comment">//使用占位符声明接收params参数</span></span><br><span class="line">					<span class="attr">component</span>:<span class="title class_">Detail</span></span><br><span class="line">				&#125;</span><br><span class="line">			]</span><br><span class="line">		&#125;</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>传递参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 跳转并携带params参数，to的字符串写法 --&gt;</span><br><span class="line">&lt;router-link :to=&quot;/home/message/detail/666/你好&quot;&gt;跳转&lt;/router-link&gt;</span><br><span class="line">				</span><br><span class="line">&lt;!-- 跳转并携带params参数，to的对象写法 --&gt;</span><br><span class="line">&lt;router-link </span><br><span class="line">	:to=&quot;&#123;</span><br><span class="line">		name:&#x27;xiangqing&#x27;,</span><br><span class="line">		params:&#123;</span><br><span class="line">		   id:666,</span><br><span class="line">            title:&#x27;你好&#x27;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;&quot;</span><br><span class="line">&gt;跳转&lt;/router-link&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>特别注意：路由携带params参数时，若使用to的对象写法，则不能使用path配置项，必须使用name配置！</p>
</blockquote>
</li>
<li>
<p>接收参数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$route.<span class="property">params</span>.<span class="property">id</span></span><br><span class="line">$route.<span class="property">params</span>.<span class="property">title</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="7-路由的props配置">7.路由的props配置</h3>
<p>​	作用：让路由组件更方便的收到参数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">name</span>:<span class="string">&#x27;xiangqing&#x27;</span>,</span><br><span class="line">	<span class="attr">path</span>:<span class="string">&#x27;detail/:id&#x27;</span>,</span><br><span class="line">	<span class="attr">component</span>:<span class="title class_">Detail</span>,</span><br><span class="line"></span><br><span class="line">	<span class="comment">//第一种写法：props值为对象，该对象中所有的key-value的组合最终都会通过props传给Detail组件</span></span><br><span class="line">	<span class="comment">// props:&#123;a:900&#125;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//第二种写法：props值为布尔值，布尔值为true，则把路由收到的所有params参数通过props传给Detail组件</span></span><br><span class="line">	<span class="comment">// props:true</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//第三种写法：props值为函数，该函数返回的对象中每一组key-value都会通过props传给Detail组件</span></span><br><span class="line">	<span class="title function_">props</span>(<span class="params">route</span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			<span class="attr">id</span>:route.<span class="property">query</span>.<span class="property">id</span>,</span><br><span class="line">			<span class="attr">title</span>:route.<span class="property">query</span>.<span class="property">title</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8-router-link-的replace属性">8.<code>&lt;router-link&gt;</code>的replace属性</h3>
<ol>
<li>作用：控制路由跳转时操作浏览器历史记录的模式</li>
<li>浏览器的历史记录有两种写入方式：分别为<code>push</code>和<code>replace</code>，<code>push</code>是追加历史记录，<code>replace</code>是替换当前记录。路由跳转时候默认为<code>push</code></li>
<li>如何开启<code>replace</code>模式：<code>&lt;router-link replace .......&gt;News&lt;/router-link&gt;</code></li>
</ol>
<h3 id="9-编程式路由导航">9.编程式路由导航</h3>
<ol>
<li>
<p>作用：不借助<code>&lt;router-link&gt; </code>实现路由跳转，让路由跳转更加灵活</p>
</li>
<li>
<p>具体编码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//$router的两个API</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">	<span class="attr">name</span>:<span class="string">&#x27;xiangqing&#x27;</span>,</span><br><span class="line">		<span class="attr">params</span>:&#123;</span><br><span class="line">			<span class="attr">id</span>:xxx,</span><br><span class="line">			<span class="attr">title</span>:xxx</span><br><span class="line">		&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">replace</span>(&#123;</span><br><span class="line">	<span class="attr">name</span>:<span class="string">&#x27;xiangqing&#x27;</span>,</span><br><span class="line">		<span class="attr">params</span>:&#123;</span><br><span class="line">			<span class="attr">id</span>:xxx,</span><br><span class="line">			<span class="attr">title</span>:xxx</span><br><span class="line">		&#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">forward</span>() <span class="comment">//前进</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">back</span>() <span class="comment">//后退</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">go</span>() <span class="comment">//可前进也可后退</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="10-缓存路由组件">10.缓存路由组件</h3>
<ol>
<li>
<p>作用：让不展示的路由组件保持挂载，不被销毁。</p>
</li>
<li>
<p>具体编码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;keep-alive include=&quot;News&quot;&gt; </span><br><span class="line">    &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">&lt;/keep-alive&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="11-两个新的生命周期钩子">11.两个新的生命周期钩子</h3>
<ol>
<li>作用：路由组件所独有的两个钩子，用于捕获路由组件的激活状态。</li>
<li>具体名字：
<ol>
<li><code>activated</code>路由组件被激活时触发。</li>
<li><code>deactivated</code>路由组件失活时触发。</li>
</ol>
</li>
</ol>
<h3 id="12-路由守卫">12.路由守卫</h3>
<ol>
<li>
<p>作用：对路由进行权限控制</p>
</li>
<li>
<p>分类：全局守卫、独享守卫、组件内守卫</p>
</li>
<li>
<p>全局守卫:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//全局前置守卫：初始化时执行、每次路由切换前执行</span></span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to,<span class="keyword">from</span>,next</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;beforeEach&#x27;</span>,to,<span class="keyword">from</span>)</span><br><span class="line">	<span class="keyword">if</span>(to.<span class="property">meta</span>.<span class="property">isAuth</span>)&#123; <span class="comment">//判断当前路由是否需要进行权限控制</span></span><br><span class="line">		<span class="keyword">if</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;school&#x27;</span>) === <span class="string">&#x27;atguigu&#x27;</span>)&#123; <span class="comment">//权限控制的具体规则</span></span><br><span class="line">			<span class="title function_">next</span>() <span class="comment">//放行</span></span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="title function_">alert</span>(<span class="string">&#x27;暂无权限查看&#x27;</span>)</span><br><span class="line">			<span class="comment">// next(&#123;name:&#x27;guanyu&#x27;&#125;)</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="title function_">next</span>() <span class="comment">//放行</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//全局后置守卫：初始化时执行、每次路由切换后执行</span></span><br><span class="line">router.<span class="title function_">afterEach</span>(<span class="function">(<span class="params">to,<span class="keyword">from</span></span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;afterEach&#x27;</span>,to,<span class="keyword">from</span>)</span><br><span class="line">	<span class="keyword">if</span>(to.<span class="property">meta</span>.<span class="property">title</span>)&#123; </span><br><span class="line">		<span class="variable language_">document</span>.<span class="property">title</span> = to.<span class="property">meta</span>.<span class="property">title</span> <span class="comment">//修改网页的title</span></span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="variable language_">document</span>.<span class="property">title</span> = <span class="string">&#x27;vue_test&#x27;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>独享守卫:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">beforeEnter</span>(<span class="params">to,<span class="keyword">from</span>,next</span>)&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;beforeEnter&#x27;</span>,to,<span class="keyword">from</span>)</span><br><span class="line">	<span class="keyword">if</span>(to.<span class="property">meta</span>.<span class="property">isAuth</span>)&#123; <span class="comment">//判断当前路由是否需要进行权限控制</span></span><br><span class="line">		<span class="keyword">if</span>(<span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;school&#x27;</span>) === <span class="string">&#x27;atguigu&#x27;</span>)&#123;</span><br><span class="line">			<span class="title function_">next</span>()</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="title function_">alert</span>(<span class="string">&#x27;暂无权限查看&#x27;</span>)</span><br><span class="line">			<span class="comment">// next(&#123;name:&#x27;guanyu&#x27;&#125;)</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="title function_">next</span>()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>组件内守卫：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//进入守卫：通过路由规则，进入该组件时被调用</span></span><br><span class="line">beforeRouteEnter (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">//离开守卫：通过路由规则，离开该组件时被调用</span></span><br><span class="line">beforeRouteLeave (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="13-路由器的两种工作模式">13.路由器的两种工作模式</h3>
<ol>
<li>对于一个url来说，什么是hash值？—— #及其后面的内容就是hash值。</li>
<li>hash值不会包含在 HTTP 请求中，即：hash值不会带给服务器。</li>
<li>hash模式：
<ol>
<li>地址中永远带着#号，不美观 。</li>
<li>若以后将地址通过第三方手机app分享，若app校验严格，则地址会被标记为不合法。</li>
<li>兼容性较好。</li>
</ol>
</li>
<li>history模式：
<ol>
<li>地址干净，美观 。</li>
<li>兼容性和hash模式相比略差。</li>
<li>应用部署上线时需要后端人员支持，解决刷新页面服务端404的问题。</li>
</ol>
</li>
</ol>
<h2 id="总结">总结</h2>
<blockquote>
<p>这两天把Vue的重中之重的路由学完了，基本都是掌握了，内容还是挺多的，但是我觉得不是很难，之前给金师附小渲染的时候，主要接触的就是路由，所以掌握就没什么难度，我的理解就是通过路由实现跳转不同的组件，不用刷新页面，然后就是缓存以及守卫，也是比较简单，就几个方法几个参数，</p>
</blockquote>
<h1 id="Vue3-重点">Vue3(重点)</h1>
<h2 id="学习日期：3-30-3-31">学习日期：3.30-3.31</h2>
<h2 id="所学内容概述-19">所学内容概述</h2>
<h3 id="创建Vue3-0">创建Vue3.0</h3>
<h4 id="vue-cli创建">vue-cli创建</h4>
<p>和vue2一样了那就</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 查看@vue/cli版本，确保@vue/cli版本在4.5.0以上</span></span><br><span class="line">vue --version</span><br><span class="line"><span class="comment">## 安装或者升级你的@vue/cli</span></span><br><span class="line">npm install -g @vue/cli</span><br><span class="line"><span class="comment">## 创建</span></span><br><span class="line">vue create vue_test</span><br><span class="line"><span class="comment">## 启动</span></span><br><span class="line"><span class="built_in">cd</span> vue_test</span><br><span class="line">npm run serve</span><br></pre></td></tr></table></figure>
<h4 id="vite创建-推荐">vite创建(推荐)</h4>
<p>这种创建的方式运行和打包都会高效很多，端口号和普通的不一样默认是3000</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 创建工程</span></span><br><span class="line">npm init vite-app &lt;project-name&gt;</span><br><span class="line"><span class="comment">## 进入工程目录</span></span><br><span class="line"><span class="built_in">cd</span> &lt;project-name&gt;</span><br><span class="line"><span class="comment">## 安装依赖</span></span><br><span class="line">npm install</span><br><span class="line"><span class="comment">## 运行</span></span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure>
<h3 id="Composition-API-重点">Composition API(重点)</h3>
<p>这是Vue3的重中之重,因为内容比较多，放网站上去了。<a href="https://u7u7.top/posts/adf5c49.html%E4%B8%8B%E9%9D%A2vue3%E9%83%A8%E5%88%86">https://u7u7.top/posts/adf5c49.html下面vue3部分</a></p>
<h2 id="总结-2">总结</h2>
<blockquote>
<p>花了两三天的时间把Vue3基础给学习了，Vue3给我最直观的改变就是使用了composition API把setup作为舞台，将原来的vue2那种数据以及方法在不同生命周期地方，使用不同的方法，都放在了setup中，最后只要return就行了，和java和python中所定义的方法一样，里面有属性以及一些方法。而且代码看起来舒服很多，可读性对我而言强了，上手还是蛮快的，也没什么难点，生命周期部分也非常的知名见意，我觉得vue3的setup这样的写法还是很适合我的。而且原本Vue2中的语法在vue3中都是可以使用的，虽然官方不建议这么做，但是也能写能用，如果和Vue3有冲突的地方，会以Vue3为主，因为自己是使用vite创建的vue3工程，npm run dev跑起来真的比serve快了很多，打包也快了不少。我觉得Vue3的核心应该是响应式proxy，属性值的读写、属性的添加、属性的删除都可以通过proxy完成，所以我认为该点为核心部分，而且基本API都离不开proxy。</p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>大数据23年3月笔记</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://u7u7.top/posts/23biji03.html">https://u7u7.top/posts/23biji03.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>u7u7学习小屋</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2023-03-31</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2023-03-31</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%9C%88%E7%AC%94%E8%AE%B0/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>月笔记</a><a class="post-meta__tags" href="/tags/Scala/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>Scala</a><a class="post-meta__tags" href="/tags/Spark/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>Spark</a><a class="post-meta__tags" href="/tags/Hive/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>Hive</a><a class="post-meta__tags" href="/tags/SQL/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>SQL</a><a class="post-meta__tags" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>大数据</a><a class="post-meta__tags" href="/tags/Vue/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>Vue</a></div></div><link rel="stylesheet" href="/css/coin.css" media="defer" onload="this.media='all'"/><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">投喂作者</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://u7img.oss-cn-hangzhou.aliyuncs.com/wechat.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://u7img.oss-cn-hangzhou.aliyuncs.com/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></button></div><audio id="coinAudio" src="https://npm.elemecdn.com/akilar-candyassets@1.0.36/audio/aowu.m4a"></audio><script defer="defer" src="/js/coin.js"></script><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/23biji04.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-1ko2rv.webp" onerror="onerror=null;src='/assets/r2.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">大数据23年4月笔记</div></div></a></div><div class="next-post pull-right"><a href="/posts/suanfa.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wallhaven-jx5xyw.webp" onerror="onerror=null;src='/assets/r2.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">算法</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/23biji02.html" title="大数据23年2月笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-v97pzl.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-03-29</div><div class="title">大数据23年2月笔记</div></div></a></div><div><a href="/posts/23biji04.html" title="大数据23年4月笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-1ko2rv.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-04-05</div><div class="title">大数据23年4月笔记</div></div></a></div><div><a href="/posts/23biji05.html" title="中软杯23年5月笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-573239.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-05-31</div><div class="title">中软杯23年5月笔记</div></div></a></div><div><a href="/posts/23biji06.html" title="中软杯23年6月笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-oxyjvl.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-06-01</div><div class="title">中软杯23年6月笔记</div></div></a></div><div><a href="/posts/dashuju2.html" title="23年大数据应用省赛总结"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-572k81.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-05-29</div><div class="title">23年大数据应用省赛总结</div></div></a></div><div><a href="/posts/2d36b063.html" title="大数据22年9月笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/test4.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-03-11</div><div class="title">大数据22年9月笔记</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><svg class="meta_icon" style="width:22px;height:22px;position:relative;top:5px"><use xlink:href="#icon-mulu1"></use></svg><span style="font-weight:bold">目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#DSL%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC%E4%BD%BF%E7%94%A8"><span class="toc-text">DSL代码风格使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-2"><span class="toc-text">学习日期: 3.2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0"><span class="toc-text">所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sparksql%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-text">sparksql常用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#withColumn"><span class="toc-text">withColumn</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#drop"><span class="toc-text">drop</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lit"><span class="toc-text">lit</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#col"><span class="toc-text">col</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#coalesce"><span class="toc-text">coalesce</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#createOrReplaceTempView"><span class="toc-text">createOrReplaceTempView</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#partitionBy"><span class="toc-text">partitionBy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#write"><span class="toc-text">write</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mode"><span class="toc-text">mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#saveAsTable"><span class="toc-text">saveAsTable</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#insertInto"><span class="toc-text">insertInto</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93"><span class="toc-text">日总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%9C%AC%E5%9C%B0VM%E9%95%9C%E5%83%8F"><span class="toc-text">使用本地VM镜像</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-3"><span class="toc-text">学习日期: 3.3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-2"><span class="toc-text">所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8asbru%E4%B8%ADsftp"><span class="toc-text">使用asbru中sftp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9"><span class="toc-text">BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-2"><span class="toc-text">日总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL%E7%BB%93%E5%90%88DSL%E8%A1%A8%E6%B8%85%E6%B4%97"><span class="toc-text">SQL结合DSL表清洗</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-4"><span class="toc-text">学习日期: 3.4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-3"><span class="toc-text">所学内容概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-2"><span class="toc-text">BUG点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BUG1"><span class="toc-text">BUG1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BUG2"><span class="toc-text">BUG2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-3"><span class="toc-text">日总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7%E6%9C%88%E4%BB%BB%E5%8A%A11%E6%8C%87%E6%A0%87%E8%AE%A1%E7%AE%97"><span class="toc-text">7月任务1指标计算</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-6"><span class="toc-text">学习日期: 3.6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-4"><span class="toc-text">所学内容概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-3"><span class="toc-text">BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-4"><span class="toc-text">日总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7%E6%9C%88%E4%BB%BB%E5%8A%A13"><span class="toc-text">7月任务3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-7"><span class="toc-text">学习日期: 3.7</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-5"><span class="toc-text">所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%BD%E5%8F%96"><span class="toc-text">抽取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%85%E6%B4%97"><span class="toc-text">清洗</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E6%A0%87%E8%AE%A1%E7%AE%97"><span class="toc-text">指标计算</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-4"><span class="toc-text">BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0"><span class="toc-text">扩展学习</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-5"><span class="toc-text">日总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7%E6%9C%88%E4%BB%BB%E5%8A%A14-%E6%8C%87%E6%A0%87%E8%AE%A1%E7%AE%97"><span class="toc-text">7月任务4 指标计算</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-9"><span class="toc-text">学习日期: 3.9</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-6"><span class="toc-text">所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#t1"><span class="toc-text">t1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#t2"><span class="toc-text">t2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-5"><span class="toc-text">BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-6"><span class="toc-text">日总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7%E6%9C%88%E4%BB%BB%E5%8A%A1%E4%B9%A6%E8%AE%A8%E8%AE%BA"><span class="toc-text">7月任务书讨论</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-10"><span class="toc-text">学习日期: 3.10</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-7"><span class="toc-text">所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E4%BA%8C-%E6%9C%AA%E8%A7%A3%E5%86%B3"><span class="toc-text">问题二(未解决)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0-2"><span class="toc-text">扩展学习</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-7"><span class="toc-text">日总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7%E6%9C%88%E4%BB%BB%E5%8A%A1%E4%B9%A65-%E6%8C%87%E6%A0%87%E8%AE%A1%E7%AE%97"><span class="toc-text">7月任务书5 指标计算</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-13"><span class="toc-text">学习日期: 3.13</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-8"><span class="toc-text">所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%A2%98"><span class="toc-text">第一题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%A2%98"><span class="toc-text">第二题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E9%A2%98"><span class="toc-text">第三题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-6"><span class="toc-text">BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-8"><span class="toc-text">日总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A14%E4%BF%AE%E6%94%B9"><span class="toc-text">任务4修改</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-14"><span class="toc-text">学习日期: 3.14</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-9"><span class="toc-text">所学内容概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-9"><span class="toc-text">日总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A15%E4%BB%A5%E5%8F%8A%E7%AE%97%E6%B3%95"><span class="toc-text">任务5以及算法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-15"><span class="toc-text">学习日期: 3.15</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-10"><span class="toc-text">所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%8F%B72120"><span class="toc-text">编号2120</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-7"><span class="toc-text">BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0-3"><span class="toc-text">扩展学习</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-10"><span class="toc-text">日总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vue-TodoList%E6%A1%88%E4%BE%8B%E5%AE%8C%E5%96%84"><span class="toc-text">Vue TodoList案例完善</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-17"><span class="toc-text">学习日期: 3.17</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-11"><span class="toc-text">所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E4%BA%8B%E4%BB%B6%E6%80%BB%E7%BA%BF%EF%BC%88GlobalEventBus%EF%BC%89"><span class="toc-text">全局事件总线（GlobalEventBus）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E8%AE%A2%E9%98%85%E4%B8%8E%E5%8F%91%E5%B8%83%EF%BC%88pubsub%EF%BC%89"><span class="toc-text">消息订阅与发布（pubsub）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nextTick"><span class="toc-text">nextTick</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0-4"><span class="toc-text">扩展学习</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-11"><span class="toc-text">日总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vuex"><span class="toc-text">Vuex</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-20"><span class="toc-text">学习日期: 3.20</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-12"><span class="toc-text">所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%A6%82%E5%BF%B5"><span class="toc-text">1.概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5"><span class="toc-text">2.使用情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%90%AD%E5%BB%BAvuex%E7%8E%AF%E5%A2%83"><span class="toc-text">3.搭建vuex环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-text">4.基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-getters%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">5.getters的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%9B%9B%E4%B8%AAmap%E6%96%B9%E6%B3%95%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">6.四个map方法的使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0-5"><span class="toc-text">扩展学习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E5%8C%96-%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4"><span class="toc-text">模块化+命名空间</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-12"><span class="toc-text">日总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#mysql%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5"><span class="toc-text">mysql数据导入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-22"><span class="toc-text">学习日期: 3.22</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-13"><span class="toc-text">所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%B0%8F%E7%99%BD%E6%A0%B7%E9%A2%98%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5"><span class="toc-text">将小白样题数据导入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-8"><span class="toc-text">BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-13"><span class="toc-text">日总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E6%96%B0%E9%95%9C%E5%83%8F%E8%BF%9E%E6%8E%A5"><span class="toc-text">测试新镜像连接</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-23"><span class="toc-text">学习日期: 3.23</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-14"><span class="toc-text">所学内容概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-9"><span class="toc-text">BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0-6"><span class="toc-text">扩展学习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%8F%B7468"><span class="toc-text">编号468</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-14"><span class="toc-text">日总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spark%E6%9E%B6%E6%9E%84%E4%BB%A5%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA"><span class="toc-text">Spark架构以及集群搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-24"><span class="toc-text">学习日期: 3.24</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-15"><span class="toc-text">所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Spark%E7%90%86%E8%AE%BA"><span class="toc-text">Spark理论</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-10"><span class="toc-text">BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-15"><span class="toc-text">日总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Spark%E6%A0%B8%E5%BF%83%E7%BC%96%E7%A8%8BRDD"><span class="toc-text">Spark核心编程RDD</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-25"><span class="toc-text">学习日期: 3.25</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-16"><span class="toc-text">所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Spark%E9%9B%86%E5%90%88%E6%96%B9%E6%B3%95"><span class="toc-text">Spark集合方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#union-otherDataset"><span class="toc-text">union(otherDataset)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#intersection-otherDataset"><span class="toc-text">intersection(otherDataset)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#subtract%E8%BD%AC%E6%8D%A2"><span class="toc-text">subtract转换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#cartesian-otherDataset"><span class="toc-text">cartesian(otherDataset)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-11"><span class="toc-text">BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0-7"><span class="toc-text">扩展学习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#action%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0"><span class="toc-text">action操作函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-16"><span class="toc-text">日总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SparkSQL%E7%BC%96%E7%A8%8B"><span class="toc-text">SparkSQL编程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F-3-27-3-28"><span class="toc-text">学习日期: 3.27-3.28</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-17"><span class="toc-text">所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Spark-SQL%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0"><span class="toc-text">Spark SQL内置函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spark-SQL%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-text">Spark SQL聚合函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BC%BA%E5%A4%B1%E5%80%BC%E5%A4%84%E7%90%86"><span class="toc-text">数据缺失值处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BUG%E7%82%B9-12"><span class="toc-text">BUG点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0-8"><span class="toc-text">扩展学习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%93%9D%E6%A1%A5%E6%9D%AF-123"><span class="toc-text">蓝桥杯 123</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%80%BB%E7%BB%93-17"><span class="toc-text">日总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#27%E6%97%A5"><span class="toc-text">27日</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#28%E6%97%A5"><span class="toc-text">28日</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vue%E8%B7%AF%E7%94%B1-%E9%87%8D%E7%82%B9"><span class="toc-text">Vue路由(重点)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F%EF%BC%9A3-29"><span class="toc-text">学习日期：3.29</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-18"><span class="toc-text">所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-text">1.基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%87%A0%E4%B8%AA%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="toc-text">2.几个注意点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%A4%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%EF%BC%88%E5%A4%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%EF%BC%89"><span class="toc-text">3.多级路由（多级路由）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%B7%AF%E7%94%B1%E7%9A%84query%E5%8F%82%E6%95%B0"><span class="toc-text">4.路由的query参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%91%BD%E5%90%8D%E8%B7%AF%E7%94%B1"><span class="toc-text">5.命名路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%B7%AF%E7%94%B1%E7%9A%84params%E5%8F%82%E6%95%B0"><span class="toc-text">6.路由的params参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E8%B7%AF%E7%94%B1%E7%9A%84props%E9%85%8D%E7%BD%AE"><span class="toc-text">7.路由的props配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-router-link-%E7%9A%84replace%E5%B1%9E%E6%80%A7"><span class="toc-text">8.&lt;router-link&gt;的replace属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E7%BC%96%E7%A8%8B%E5%BC%8F%E8%B7%AF%E7%94%B1%E5%AF%BC%E8%88%AA"><span class="toc-text">9.编程式路由导航</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E7%BC%93%E5%AD%98%E8%B7%AF%E7%94%B1%E7%BB%84%E4%BB%B6"><span class="toc-text">10.缓存路由组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E4%B8%A4%E4%B8%AA%E6%96%B0%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%92%A9%E5%AD%90"><span class="toc-text">11.两个新的生命周期钩子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E8%B7%AF%E7%94%B1%E5%AE%88%E5%8D%AB"><span class="toc-text">12.路由守卫</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E4%B8%A4%E7%A7%8D%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F"><span class="toc-text">13.路由器的两种工作模式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vue3-%E9%87%8D%E7%82%B9"><span class="toc-text">Vue3(重点)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E6%97%A5%E6%9C%9F%EF%BC%9A3-30-3-31"><span class="toc-text">学习日期：3.30-3.31</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%80%E5%AD%A6%E5%86%85%E5%AE%B9%E6%A6%82%E8%BF%B0-19"><span class="toc-text">所学内容概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAVue3-0"><span class="toc-text">创建Vue3.0</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#vue-cli%E5%88%9B%E5%BB%BA"><span class="toc-text">vue-cli创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#vite%E5%88%9B%E5%BB%BA-%E6%8E%A8%E8%8D%90"><span class="toc-text">vite创建(推荐)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Composition-API-%E9%87%8D%E7%82%B9"><span class="toc-text">Composition API(重点)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-2"><span class="toc-text">总结</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-color: transparent;"><div id="footer-wrap"><div id="ft"><div class="ft-item-1"><div class="t-top"><div class="t-t-l"><p class="ft-t t-l-t">格言🧬</p><div class="bg-ad"><div>再看看那个光点，它就在这里，这是家园，这是我们 —— 你所爱的每一个人，你认识的一个人，你听说过的每一个人，曾经有过的每一个人，都在它上面度过他们的一生✨</div><div class="btn-xz-box"><a class="btn-xz" target="_blank" rel="noopener" href="https://stellarium.org/">点击开启星辰之旅</a></div></div></div><div class="t-t-r"><p class="ft-t t-l-t">猜你想看💡</p><ul class="ft-links"><li><a href="/comments/">留点什么</a><a href="/archives/">文章归档</a></li><li><a href="/categories/">文章分类</a><a href="/tags/">文章标签</a></li><li><a href="/box/Gallery/">我的画廊</a><a href="/personal/bb/">我的唠叨</a></li><li><a href="/site/time/">建设进程</a><a href="/site/census/">网站统计</a></li></ul></div></div></div><div class="ft-item-2"><p class="ft-t">推荐友链⌛</p><div class="ft-img-group"><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div></div></div></div><div class="copyright"><span><b>&copy;2022-2023</b></span><span><b>&nbsp;&nbsp;By u7u7学习小屋</b></span></div><div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" title="博客框架为Hexo_v6.3.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Frame-Hexo-blue.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" title="主题版本Butterfly_v4.3.1"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Theme-Butterfly-6513df.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" title="本站采用多线部署，主线路托管于Vercel"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Hosted-Vercel-brightgreen.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://user.51.la/" style="margin-inline:5px" title="本站数据分析得益于51la技术支持"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Analytics-51la-3db1eb.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=20230913" style="margin-inline:5px" title="本站已加入萌ICP豪华套餐，萌ICP备20230913号"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/202303221541743.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://bitiful.dogecast.com/buckets" style="margin-inline:5px" title="本网站经Service Worker分流至缤纷云对象存储"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Bucket-缤纷云-9c62da.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://www.netdun.net/" style="margin-inline:5px" title="本站使用网盾星球提供CDN加速与防护"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/CDN-网盾星球-fff2cc.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="本网站源码由Github提供存储仓库"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Source-Github-d021d6.svg" alt=""/></a></p></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><a class="icon-V hidden" onclick="switchNightMode()" title="浅色和深色模式转换"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button><button class="share" type="button" title="右键模式" onclick="changeMouseMode()"><i class="fas fa-mouse"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog right_side"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button class="share" type="button" title="分享链接" onclick="share()"><i class="fas fa-share-nodes"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i><span id="percent">0<span>%</span></span></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>复制</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.baidu.com/s?wd=&quot;+window.getSelection().toString());window.location.reload();"><i class="fa fa-search"></i><span>百度搜索</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());window.location.reload();"><i class="fa fa-link"></i><span>转到链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste()"><i class="fa fa-copy"></i><span>粘贴</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-post"><a class="rightMenu-item" href="#post-comment"><i class="fas fa-comment"></i><span>空降评论</span></a><a class="rightMenu-item" href="javascript:rmf.copyWordsLink()"><i class="fa fa-link"></i><span>复制本文地址</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-to"><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>新窗口打开</span></a><a class="rightMenu-item" id="menu-too" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>转到链接</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>保存图片</span></a><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>在新窗口打开</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制图片链接</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:randomPost()"><i class="fa fa-paper-plane"></i><span>随便逛逛</span></a><a class="rightMenu-item" href="javascript:switchNightMode();"><i class="fa fa-moon"></i><span>昼夜切换</span></a><a class="rightMenu-item" href="/personal/about/"><i class="fa fa-info-circle"></i><span>关于博客</span></a><a class="rightMenu-item" href="javascript:toggleWinbox();"><i class="fas fa-cog"></i><span>美化设置</span></a><a class="rightMenu-item" href="javascript:rmf.fullScreen();"><i class="fas fa-expand"></i><span>切换全屏</span></a><a class="rightMenu-item" href="javascript:window.print();"><i class="fa-solid fa-print"></i><span>打印页面</span></a></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.umd.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script async="async">var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())
setTimeout(function(){preloader.endLoading();}, 5000);
document.getElementById('loading-box').addEventListener('click',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://u7-cc.u7u7.top/',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://u7-cc.u7u7.top/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.staticfile.org/twikoo/1.6.8/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script src="https://cdn.staticfile.org/jquery/3.6.3/jquery.min.js"></script><script async src="https://cdn1.tianli0.top/npm/vue@2.6.14/dist/vue.min.js"></script><script async src="https://cdn1.tianli0.top/npm/element-ui@2.15.6/lib/index.js"></script><script async src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script><script defer type="text/javascript" src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://cdn1.tianli0.top/gh/nextapps-de/winbox/dist/winbox.bundle.min.js"></script><script async src="//at.alicdn.com/t/c/font_3586335_hsivh70x0fm.js"></script><script async src="//at.alicdn.com/t/c/font_3636804_gr02jmjr3y9.js"></script><script async src="//at.alicdn.com/t/c/font_3612150_kfv55xn3u2g.js"></script><script async src="https://cdn.wpon.cn/2022-sucai/Gold-ingot.js"></script><canvas id="universe"></canvas><canvas id="snow"></canvas><script defer src="/js/fomal.js"></script><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdn1.tianli0.top/npm/js-heo@1.0.12/metingjs/Meting.min.js"></script><script src="https://lib.baomitu.com/pjax/0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show","#web_bg",".js-pjax","#bibi","body > title","#app","#tag-echarts","#posts-echart","#categories-echarts"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --> <script data-pjax>if(document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/工作室月笔记/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍡 U7の月学习笔记 (5)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/大数据训练/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍼 U7の大数据训练笔记 (6)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/前后端项目/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍉 U7の项目笔记 (5)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/工作室月总结/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍨 U7の月总结 (6)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/算法/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍟 U7の算法学习笔记 (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://u7u7.top/categories/演示/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🍥 U7の案例演示笔记 (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><a class="magnet_link_more"  href="https://u7u7.top/categories/" style="flex:1;text-align: center;margin-bottom: 10px;">查看更多...</a></div></div>';
    console.log('已挂载magnet')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script><style>#catalog_magnet{flex-wrap: wrap;display: flex;width:100%;justify-content:space-between;padding: 10px 10px 0 10px;align-content: flex-start;}.magnet_item{flex-basis: calc(33.333333333333336% - 5px);background: #e9e9e9;margin-bottom: 10px;border-radius: 8px;transition: all 0.2s ease-in-out;}.magnet_item:hover{background: var(--text-bg-hover)}.magnet_link_more{color:#555}.magnet_link{color:black}.magnet_link:hover{color:white}@media screen and (max-width: 600px) {.magnet_item {flex-basis: 100%;}}.magnet_link_context{display:flex;padding: 10px;font-size:16px;transition: all 0.2s ease-in-out;}.magnet_link_context:hover{padding: 10px 20px;}</style>
    <style></style><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/dashuju2.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-572k81.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-27</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/dashuju2.html&quot;);" href="javascript:void(0);" alt="">23年大数据应用省赛总结</a><div class="blog-slider__text">离线模块---省赛踩坑点，以及难点使用</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/dashuju2.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/23biji06.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-oxyjvl.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-06-01</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/23biji06.html&quot;);" href="javascript:void(0);" alt="">中软杯23年6月笔记</a><div class="blog-slider__text">中软杯推荐每日笔记以及总结</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/23biji06.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/23biji05.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-573239.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-05-04</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/23biji05.html&quot;);" href="javascript:void(0);" alt="">中软杯23年5月笔记</a><div class="blog-slider__text">中软杯设计每日笔记以及总结</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/23biji05.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/a1e1aa91.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wallhaven-28mkg9_2560x1440.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-11</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/a1e1aa91.html&quot;);" href="javascript:void(0);" alt="">瑞吉外卖</a><div class="blog-slider__text">SpringBoot项目</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/a1e1aa91.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/23biji04.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/blogCoverImg/wallhaven-1ko2rv.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-04-05</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/23biji04.html&quot;);" href="javascript:void(0);" alt="">大数据23年4月笔记</a><div class="blog-slider__text">Spark大数据备赛————SparkSQL,国赛任务书训练</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/23biji04.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/dashuju.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wallhaven-pk6y2p.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-10</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/dashuju.html&quot;);" href="javascript:void(0);" alt="">GZ-07 综合分析</a><div class="blog-slider__text">大数据7月样题——电商综合分析</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/dashuju.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/adf5c49.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/test5.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-30</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/adf5c49.html&quot;);" href="javascript:void(0);" alt="">Vue笔记</a><div class="blog-slider__text">Vue前端学习笔记</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/adf5c49.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://u7img.oss-cn-hangzhou.aliyuncs.com/wallhaven-o59q2m.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt="">Markdown语法与外挂标签写法汇总</a><div class="blog-slider__text">🥧本文汇总Markdown格式以及外挂标签在网页端的渲染效果，可作为文档进行查询</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2013454d.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('gitZone');
      var item_html = '<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 320px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('已挂载gitcalendar')
      }

    if( document.getElementById('gitZone') && (location.pathname ==='/site/census/'|| '/site/census/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("/api?null",['#d9e0df', '#c6e0dc', '#a8dcd4', '#9adcd2', '#89ded1', '#77e0d0', '#5fdecb', '#47dcc6', '#39dcc3', '#1fdabe', '#00dab9'],'null')
    }
  </script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>